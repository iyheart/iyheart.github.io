<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>moeCTF--wp | iyheart的博客</title><meta name="author" content="iyheart"><meta name="copyright" content="iyheart"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言：比赛结束，博客解密。打算好好打打moeCTF，之前比赛虽然都有好好打，但是大多数比赛时没做出来的题目都没复现。">
<meta property="og:type" content="article">
<meta property="og:title" content="moeCTF--wp">
<meta property="og:url" content="http://iyheart.github.io/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/index.html">
<meta property="og:site_name" content="iyheart的博客">
<meta property="og:description" content="前言：比赛结束，博客解密。打算好好打打moeCTF，之前比赛虽然都有好好打，但是大多数比赛时没做出来的题目都没复现。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover101.png">
<meta property="article:published_time" content="2024-10-03T00:30:08.000Z">
<meta property="article:modified_time" content="2024-10-10T14:35:04.071Z">
<meta property="article:author" content="iyheart">
<meta property="article:tag" content="博客, 笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover101.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://iyheart.github.io/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'moeCTF--wp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-10-10 22:35:04'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/styles.css"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="iyheart的博客" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="http://pic.5tu.cn/uploads/allimg/1910/pic_5tu_big_2019010211653346247.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">131</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 历史</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-music"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="javascript:toRandomPost()"><i class="fa-fw fas fa-bus"></i><span> 随机文章</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover101.png')"><nav id="nav"><span id="blog-info"><a href="/" title="iyheart的博客"><img class="site-icon" src="http://img95.699pic.com/photo/40151/9175.gif_wh860.gif"/><span class="site-name">iyheart的博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 历史</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-music"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="javascript:toRandomPost()"><i class="fa-fw fas fa-bus"></i><span> 随机文章</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">moeCTF--wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-03T00:30:08.000Z" title="发表于 2024-10-03 08:30:08">2024-10-03</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-10-10T14:35:04.071Z" title="更新于 2024-10-10 22:35:04">2024-10-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/write-up/">write-up</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>26分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="moeCTF--wp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="misc">MISC</h1>
<h2 id="signin">signin</h2>
<ul>
<li>misc果然是脑洞题，我不是很做的来</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240925221800032.png" alt="image-20240925221800032"></p>
<ul>
<li>已签和未签的如下</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240925221831551.png" alt="image-20240925221831551"></p>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240925221841614.png" alt="image-20240925221841614"></p>
<ul>
<li>按照题目要求，直接就把luo记为缺勤，把其他人都签到了，即可得到flag，<code>moectf&#123;Thanks_For_You_signing_in_4ND_W3l0c0me_T0_M0ecTf_2024!!!&#125;</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240925221950816.png" alt="image-20240925221950816"></p>
<h2 id="ez_forensics">ez_Forensics</h2>
<ul>
<li>
<p>下载附件，看到是一个<code>.raw</code>文件，题目也说了是内存取证，所以我决定使用Linux下的<code>volatility</code>进行取证</p>
</li>
<li>
<p>题目描述中给了提示，在关闭<code>cmd</code>之前ubw保存了电脑的内存镜像</p>
</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240925220325061.png" alt="image-20240925220325061"></p>
<ul>
<li>题目给出了<code>cmd</code>是Windows下的终端，现在我要先使用<code>volatility -f ./flag.raw imageinfo</code>命令查看一下该<code>.raw</code>文件的信息</li>
<li>发现是可能是这些操作系统<code> Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418</code></li>
<li>经过筛查是<code>Win7SP1x64</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240925220623871.png" alt="image-20240925220623871"></p>
<ul>
<li>然后再使用<code>volatility -f /home/myheart/Forensic/flag.raw --profile=Win7SP1x64 pslist</code>命令提取进程</li>
<li>发现<code>cmd.exe</code>为<code>PID 344   PPID 2148  Thds 1  Hnds20 Sess 1 </code></li>
<li>从而确认了<code>cmd.exe</code>有在进程中运行</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240925220941496.png" alt="image-20240925220941496"></p>
<ul>
<li>然后再使用<code>volatility -f /home/myheart/Forensic/flag.raw --profile=Win7SP1x64 cmdscan</code></li>
<li><code>cmdscan</code>是一个插件，用于查找 <code>cmd.exe</code>（命令提示符）相关的命令历史记录。它会扫描内存中的数据，以寻找用户在命令提示符中输入的命令。然后发现有npm将flag写入flag.txt文件的历史记录，并且还可以看到flag的具体内容</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240925221410015.png" alt="image-20240925221410015"></p>
<ul>
<li>所以得到flag为<code>moectf&#123;WWBGY-TLVC5-XKYBZ&#125;</code></li>
</ul>
<h1 id="web">WEB</h1>
<h2 id="web渗透测试与审计入门指北">Web渗透测试与审计入门指北</h2>
<ul>
<li>下载pdf，浏览一遍pdf，在最后会看到一个附件，搭建网站就有flag</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003091713670.png" alt="image-20241003091713670"></p>
<ul>
<li>下载好phpstudy，然后启动一些服务</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003091851587.png" alt="image-20241003091851587"></p>
<ul>
<li>点击网站，再点击管理，打开根目录，将附件给的东西复制粘贴过去</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003091919475.png" alt="image-20241003091919475"></p>
<ul>
<li>这样再选择打开网站，就会得到flag</li>
</ul>
<img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003092045948.png" alt="image-20241003092045948" style="zoom:50%;">
<ul>
<li>网站如下，flag：<code>moectf&#123;H3r3'5_@_flYinG_kIss_f0r_yoU!&#125;</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003092058496.png" alt="image-20241003092058496"></p>
<h2 id="弗拉格之地的入口">弗拉格之地的入口</h2>
<ul>
<li>打开环境，进入环境对应的网站，会出现如下的提示</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003092340330.png" alt="image-20241003092340330"></p>
<ul>
<li>看到有爬虫字样，我想到了Python课讲到爬虫时会有一个爬虫协议，一般都是在网站的<code>robots.txt</code>这个网页下</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003092606655.png" alt="image-20241003092606655"></p>
<ul>
<li>进入网页果然看到了一些信息，发现这里面给出了一个<code>/webtutorEntry.php</code>，进入这个文件对应的网页</li>
<li>进入后就会看到flag了<code>moectf&#123;cONGraTU1atioN_foR_Kn0w1ng_RoboTS-txT250f2&#125;</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003092719956.png" alt="image-20241003092719956"></p>
<h2 id="弗拉格之地的挑战">弗拉格之地的挑战</h2>
<h2 id="垫刀之路01-moectf启动">垫刀之路01: MoeCTF？启动！</h2>
<ul>
<li>打开题目可以看到，这里已经是<code>getshell</code>了，并且可以输出执行命令的结果</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003094742832.png" alt="image-20241003094742832"></p>
<ul>
<li>然后先<code>ls</code>，查看一下该目录，发现是web网页的后端代码，这里应该是在web目录下</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003094936733.png" alt="image-20241003094936733"></p>
<ul>
<li>我这边直接<code>ls ../../../</code>，查看到了根目录下有<code>flag</code>，<code>cat flag</code>后却发现flag不再这里面，在环境变量里面</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003095052518.png" alt="image-20241003095052518"></p>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003095125592.png" alt="image-20241003095125592"></p>
<ul>
<li>所以我又执行了<code>env</code>发现环境变量里面有flag，这样flag就找到了，flag <code>moectf&#123;wEIc0m3-To-MOECtF_anD_rOaDI_ST@rTup-By_sxrHHh15f&#125;</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003095233782.png" alt="image-20241003095233782"></p>
<h2 id="ez_http">ez_http</h2>
<ul>
<li>打开环境，环境这边显示着要使用<code>post</code>方法，这么一看就需要<code>burp</code>进行抓包了</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003095952730.png" alt="image-20241003095952730"></p>
<ul>
<li>抓包到后的http包是这样的</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:60635</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>使用post参数</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:60635</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>none</span><br><span class="line"><span class="attribute">Sec-Fetch-User</span><span class="punctuation">: </span>?1</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>又看到提示，要求<code>POST</code>参数要<code>imoau=sb</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003100246989.png" alt="image-20241003100246989"></p>
<ul>
<li>上网搜了下，<code>POST</code>参数要放在<code>Priority: u=0, i</code>需要空一行，即post头结束后要空一行，然后<code>Content-Length: 8</code>这一行内容burp在发送时会自动补全，这边遇到问题，怎么发包都发不过去（问题是第二次做（复现）的时候遇到的，第一次做没遇到这个问题）。问题出来我没有使用<code>burp</code>的右键修改方法，而是直接手动修改<code>POST</code>参数导致发包出现问题。</li>
</ul>
<img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003104644673.png" alt="image-20241003104644673" style="zoom:50%;">
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:50088</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>cross-site</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>8</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">imoau</span><span class="operator">=</span>sb</span></span><br></pre></td></tr></table></figure>
<ul>
<li>之后收到提示，才get头这边添加参数，但是方法还是post，由于发包不支持中文，所以就将<code>大帅</code>转换成十六进制</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003110415410.png" alt="image-20241003110415410"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?xt=%E5%A4%A7%E5%B8%85b</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:50088</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>cross-site</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>8</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">imoau</span><span class="operator">=</span>sb</span></span><br></pre></td></tr></table></figure>
<ul>
<li>之后要求，即添加<code>Referer: https://www.xidian.edu.cn/</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003110611836.png" alt="image-20241003110611836"></p>
<ul>
<li>又要求<code>cookie</code>参数</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003110653715.png" alt="image-20241003110653715"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?xt=%E5%A4%A7%E5%B8%85b</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:50088</span><br><span class="line"><span class="attribute">cookie</span><span class="punctuation">: </span>user=admin</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://www.xidian.edu.cn/</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>cross-site</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>8</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">imoau</span><span class="operator">=</span>sb</span></span><br></pre></td></tr></table></figure>
<ul>
<li>要求使用指定浏览器源</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003110808320.png" alt="image-20241003110808320"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?xt=%E5%A4%A7%E5%B8%85b</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:50088</span><br><span class="line"><span class="attribute">cookie</span><span class="punctuation">: </span>user=admin</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>MoeDedicatedBrowser</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://www.xidian.edu.cn/</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>cross-site</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>8</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">imoau</span><span class="operator">=</span>sb</span></span><br></pre></td></tr></table></figure>
<ul>
<li>然后只要求本地通过</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/?xt=%E5%A4%A7%E5%B8%85b</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>127.0.0.1:50088</span><br><span class="line"><span class="attribute">cookie</span><span class="punctuation">: </span>user=admin</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>MoeDedicatedBrowser</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>https://www.xidian.edu.cn/</span><br><span class="line">X-Forwarded-For:127.0.0.1</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/png,image/svg+xml,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Sec-Fetch-Dest</span><span class="punctuation">: </span>document</span><br><span class="line"><span class="attribute">Sec-Fetch-Mode</span><span class="punctuation">: </span>navigate</span><br><span class="line"><span class="attribute">Sec-Fetch-Site</span><span class="punctuation">: </span>cross-site</span><br><span class="line"><span class="attribute">Priority</span><span class="punctuation">: </span>u=0, i</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/x-www-form-urlencoded</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>8</span><br><span class="line"></span><br><span class="line"><span class="language-abnf"><span class="attribute">imoau</span><span class="operator">=</span>sb</span></span><br></pre></td></tr></table></figure>
<ul>
<li>最后得到flag<code>moectf&#123;y0u-@Re_ReaIIy_Re4LLY_VerY-c13VER!!!46056&#125;</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241003111044152.png" alt="image-20241003111044152"></p>
<h1 id="crypto">CRYPTO</h1>
<h2 id="现代密码学入门指北">现代密码学入门指北</h2>
<ul>
<li>下载入门指北并阅读到末尾的时候,给出了题目，简单的rsa加密</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;q = <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 40600296529065757616876034307502386207424439675894291036278463517602256790833</span></span><br><span class="line"><span class="string">p = 197380555956482914197022424175976066223</span></span><br><span class="line"><span class="string">q = 205695522197318297682903544013139543071</span></span><br><span class="line"><span class="string">c = 36450632910287169149899281952743051320560762944710752155402435752196566406306</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>解密脚本如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">40600296529065757616876034307502386207424439675894291036278463517602256790833</span></span><br><span class="line">p = <span class="number">197380555956482914197022424175976066223</span></span><br><span class="line">q = <span class="number">205695522197318297682903544013139543071</span></span><br><span class="line">c = <span class="number">36450632910287169149899281952743051320560762944710752155402435752196566406306</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e,phi_n)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># moectf&#123;the_way_to_crypto&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="signin">Signin</h2>
<ul>
<li>题目给了一个简单的rsa加密，正常解密即可</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">pq = (p-<span class="number">1</span>)*(q-<span class="number">2</span>)</span><br><span class="line">qp = (q-<span class="number">1</span>)*(p-<span class="number">2</span>)</span><br><span class="line">p_q = p + q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pq = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;qp = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p_q = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746</span></span><br><span class="line"><span class="string">pq = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462</span></span><br><span class="line"><span class="string">qp = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860</span></span><br><span class="line"><span class="string">n = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687534959910892789661065614807265825078942931717855566686073463382398417205648946713373617006449901977718981043020664616841303517708207413215548110294271101267236070252015782044263961319221848136717220979435486850254298686692230935985442120369913666939804135884857831857184001072678312992442792825575636200505903</span></span><br><span class="line"><span class="string">p_q = 279533706577501791569740668595544511920056954944184570513187478007551195831693428589898548339751066551225424790534556602157835468618845221423643972870671556362200734472399328046960316064864571163851111207448753697980178391430044714097464866523838747053135392202848167518870720149808055682621080992998747265496</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>先根据方程，利用sage解出方程</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">p = var(&#x27;p&#x27;)</span><br><span class="line">q = var(&#x27;q&#x27;)</span><br><span class="line"></span><br><span class="line">eq1=(p-1)*(q-2)==18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462</span><br><span class="line">eq2 = (q-1)*(p-2)==18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860</span><br><span class="line">solve([eq1,eq2],p,q)</span><br></pre></td></tr></table></figure>
<ul>
<li>得到p、q后直接rsa解密即可</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">c = <span class="number">5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746</span></span><br><span class="line">pq = <span class="number">18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462</span></span><br><span class="line">qp = <span class="number">18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860</span></span><br><span class="line">n = <span class="number">18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687534959910892789661065614807265825078942931717855566686073463382398417205648946713373617006449901977718981043020664616841303517708207413215548110294271101267236070252015782044263961319221848136717220979435486850254298686692230935985442120369913666939804135884857831857184001072678312992442792825575636200505903</span></span><br><span class="line">p_q = <span class="number">279533706577501791569740668595544511920056954944184570513187478007551195831693428589898548339751066551225424790534556602157835468618845221423643972870671556362200734472399328046960316064864571163851111207448753697980178391430044714097464866523838747053135392202848167518870720149808055682621080992998747265496</span></span><br><span class="line">p = <span class="number">101195416461091716428326199733504078281010548412226222689665080411126731520752210150756388683557219973649948209094722629248795549538890771346214761833764975454769057589710497693291150424006859232283601953197097456280805871953601208233200402046794268614613979577032173301390416040533984248749301081715040789947</span></span><br><span class="line">q = <span class="number">178338290116410075141414468862040433639046406531958347823522397596424464310941218439142159656193846577575476581439833972909039919079954450077429211036906580907431676882688830353669165640857711931567509254251656241699372519476443505864264464477044478438521412625815994217480304109274071433871779911283706475549</span></span><br><span class="line">phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = gmpy2.invert(e,phi_n)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br><span class="line"><span class="comment"># moectf&#123;Just_4_signin_ch4ll3ng3_for_y0u&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="ez_hash">ez_hash</h2>
<ul>
<li>该题是hash爆破，这题原本暑假的时候就尝试做了，但是使用Python爆破不出来，然后去在线md5查询，查询出来了，但是看结果要钱，就没查看了</li>
<li>到了开学知道了有hashcat这个工具，可以使用显卡爆破，就爆破出来了</li>
<li>题目附件</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, secrets</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">b&#x27;moectf&#123;&#x27;</span> + secrets + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> secrets[:<span class="number">4</span>] == <span class="string">b&#x27;2100&#x27;</span> <span class="keyword">and</span> <span class="built_in">len</span>(secrets) == <span class="number">10</span></span><br><span class="line">hash_value = sha256(secrets).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;hash_value = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># secret = 2100******</span></span><br><span class="line"><span class="comment"># hash_value = &#x27;3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用hashcat爆破，在Linux下安装好hash，然后输入指令
<ul>
<li>SHA256: <code>-m 1400</code></li>
<li><code>-a 3</code> 指定使用掩码攻击（暴力破解）</li>
<li><code>2100</code> 固定为前 4 位,<code>?d?d?d?d?d?d</code> 表示 6 个未知的数字</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m 1400 -a 3 3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a 2100?d?d?d?d?d?d</span><br></pre></td></tr></table></figure>
<ul>
<li>爆破得到的结果为</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2100360168</span><br></pre></td></tr></table></figure>
<ul>
<li>flag：<code>moectf&#123;2100360168&#125;</code></li>
</ul>
<h2 id="big-and-small">Big and small</h2>
<ul>
<li>还是一个rsa加密，但是e很小，直接开方即可</li>
<li>题目:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line">m = long_to_bytes(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757</span></span><br><span class="line"><span class="string">e = 3</span></span><br><span class="line"><span class="string">n = 20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>exp:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">c = <span class="number">150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">n = <span class="number">20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787</span></span><br><span class="line">m = libnum.nroot(c,e)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># flag&#123;xt&gt;is&gt;s&gt;b&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="baby_equation">baby_equation</h2>
<ul>
<li>
<p>这题开了俩个提示，还是没思路，最后和某个已经做出来的师傅对了下思路，发现思路问题，之后思路正确了就做下去了</p>
</li>
<li>
<p>其中题目中的俩个提示也还是有用的</p>
</li>
<li>
<p>题目附件如下,主要聚焦到<code>assert</code>的这个式子中</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line">m1, m2 = flag[:l//<span class="number">2</span>], flag[l//<span class="number">2</span>:]</span><br><span class="line">a = bytes_to_long(m1)</span><br><span class="line">b = bytes_to_long(m2)</span><br><span class="line">k = <span class="number">0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40</span></span><br><span class="line"><span class="keyword">assert</span> ((a**<span class="number">2</span> + <span class="number">1</span>)*(b**<span class="number">2</span> + <span class="number">1</span>) - <span class="number">2</span>*(a - b)*(a*b - <span class="number">1</span>)) == <span class="number">4</span>*(k + a*b)</span><br></pre></td></tr></table></figure>
<ul>
<li>题目提示用yafu分解，我这边是将<code>4k</code>分解,得到，很明显，k能分解出这么多式子，甚至都是俩个或偶数个的素数，这就要想到，4k可以因式分解成与<code>a</code>和<code>b</code>相关的因式而且还是代平方的那种</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">P1 = 2</span><br><span class="line">P1 = 2</span><br><span class="line">P1 = 2</span><br><span class="line">P1 = 2</span><br><span class="line">P1 = 2</span><br><span class="line">P1 = 2</span><br><span class="line">P1 = 2</span><br><span class="line">P1 = 2</span><br><span class="line">P1 = 3</span><br><span class="line">P1 = 3</span><br><span class="line">P1 = 3</span><br><span class="line">P1 = 3</span><br><span class="line">P2 = 31</span><br><span class="line">P2 = 31</span><br><span class="line">P2 = 61</span><br><span class="line">P2 = 61</span><br><span class="line">P3 = 223</span><br><span class="line">P3 = 223</span><br><span class="line">P4 = 4013</span><br><span class="line">P4 = 4013</span><br><span class="line">P6 = 281317</span><br><span class="line">P6 = 281317</span><br><span class="line">P7 = 4151351</span><br><span class="line">P7 = 4151351</span><br><span class="line">P13 = 5404604441993</span><br><span class="line">P13 = 5404604441993</span><br><span class="line">P14 = 26798471753993</span><br><span class="line">P14 = 26798471753993</span><br><span class="line">P44 = 64889106213996537255229963986303510188999911</span><br><span class="line">P44 = 64889106213996537255229963986303510188999911</span><br><span class="line">P29 = 25866088332911027256931479223</span><br><span class="line">P29 = 25866088332911027256931479223</span><br><span class="line">P9 = 370523737</span><br><span class="line">P9 = 370523737</span><br><span class="line">P9 = 339386329</span><br><span class="line">P9 = 339386329</span><br></pre></td></tr></table></figure>
<ul>
<li>所以接下来就对<code>assert</code>的那个式子进行因式分解，结果分解半天分解错了<code>QAQ</code>。</li>
<li>最后得到的结果还是AI跑出来的</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241008013015286.png" alt="image-20241008013015286"></p>
<ul>
<li>接下来用上第二个提示，由于我并不知道<code>a+1</code>可以分解成那些素数的乘积，但我知道flag中有<code>moectf</code>（这也就是第二个提示），所以我就考虑使用随机数的办法进行爆破，结果当然是爆破出来了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">c = [<span class="number">64889106213996537255229963986303510188999911</span>,<span class="number">25866088332911027256931479223</span>,<span class="number">26798471753993</span>,<span class="number">339386329</span>,<span class="number">370523737</span>,<span class="number">5404604441993</span>,<span class="number">4151351</span>,<span class="number">281317</span>,<span class="number">4013</span>,<span class="number">223</span>,<span class="number">61</span>,<span class="number">31</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(c)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">        random_elements = random.sample(c, i)</span><br><span class="line">        p = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> random_elements:</span><br><span class="line">            p *= x</span><br><span class="line">        b = libnum.n2s(p)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;moectf&#x27;</span> <span class="keyword">in</span> b:</span><br><span class="line">            <span class="built_in">print</span>(b)</span><br><span class="line">            <span class="built_in">print</span>(libnum.s2n(b))</span><br><span class="line"><span class="comment"># b&#x27;moectf&#123;7he_Fund4m3nt4l_th30r4&#x27; 这个是a+1跑出来的，而不是a的值</span></span><br><span class="line"><span class="comment"># 2950365559902224963252311699604518749050102395042841254385700637274676</span></span><br></pre></td></tr></table></figure>
<ul>
<li>得到<code>a+1</code>的值就可以利用因式分解的值可以算出b的值，从而知道flag的后半部分了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a_plus_1 = <span class="number">2950365559902224963252311699604518749050102395042841254385700637274676</span></span><br><span class="line">a = a_plus_1-<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(a))</span><br><span class="line">b_1 = g//(a_plus_1**<span class="number">2</span>)</span><br><span class="line">b_1 = libnum.nroot(b_1,<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(b_1+<span class="number">1</span>))</span><br><span class="line"><span class="comment"># b&#x27;moectf&#123;7he_Fund4m3nt4l_th30r3&#x27;  这个才是真正的flag的前半部分</span></span><br><span class="line"><span class="comment"># b&#x27;m_0f_4rithm3tic_i5_p0w4rful!&#125;&#x27;</span></span><br><span class="line"><span class="comment"># moectf&#123;7he_Fund4m3nt4l_th30r3m_0f_4rithm3tic_i5_p0w4rful!&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="re">RE</h1>
<h2 id="逆向工程入门指北">逆向工程入门指北</h2>
<ul>
<li>下载pdf附件翻到第二页</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> password_enc[] = &#123;</span><br><span class="line">    <span class="number">123</span>, <span class="number">121</span>, <span class="number">115</span>, <span class="number">117</span>, <span class="number">98</span>, <span class="number">112</span>, <span class="number">109</span>, <span class="number">100</span>, <span class="number">37</span>, <span class="number">96</span>, <span class="number">37</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">37</span>, <span class="number">73</span>, <span class="number">39</span>,</span><br><span class="line">    <span class="number">101</span>, <span class="number">73</span>, <span class="number">119</span>, <span class="number">73</span>, <span class="number">122</span>, <span class="number">121</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">73</span>, <span class="number">122</span>, <span class="number">121</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">73</span>, <span class="number">97</span>, <span class="number">119</span>,</span><br><span class="line">    <span class="number">111</span>, <span class="number">73</span>, <span class="number">98</span>, <span class="number">121</span>, <span class="number">73</span>, <span class="number">115</span>, <span class="number">110</span>, <span class="number">102</span>, <span class="number">122</span>, <span class="number">121</span>, <span class="number">100</span>, <span class="number">115</span>, <span class="number">107</span>, <span class="number">22</span> &#125;;</span><br><span class="line">    <span class="comment">// 因为a^b=c时, b^c=a, 所以我们可以这样还原数据:</span></span><br><span class="line">    <span class="type">char</span> password[<span class="number">47</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">46</span>; i++) &#123;</span><br><span class="line">    password[i] = password_enc[i] ^ <span class="number">22</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    password[<span class="number">46</span>] = <span class="number">0</span>; <span class="comment">// 使用0字符来截断掉%s的无尽输出..</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, password); <span class="comment">// 哈哈，这就是本题的f l a g，自己运行一下交上去吧！</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>这个就是本题<code>flag</code>了</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">a = [ <span class="number">123</span>, <span class="number">121</span>, <span class="number">115</span>, <span class="number">117</span>, <span class="number">98</span>, <span class="number">112</span>, <span class="number">109</span>, <span class="number">100</span>, <span class="number">37</span>, <span class="number">96</span>, <span class="number">37</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">37</span>, <span class="number">73</span>, <span class="number">39</span>,</span><br><span class="line">    <span class="number">101</span>, <span class="number">73</span>, <span class="number">119</span>, <span class="number">73</span>, <span class="number">122</span>, <span class="number">121</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">73</span>, <span class="number">122</span>, <span class="number">121</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">73</span>, <span class="number">97</span>, <span class="number">119</span>,</span><br><span class="line">    <span class="number">111</span>, <span class="number">73</span>, <span class="number">98</span>, <span class="number">121</span>, <span class="number">73</span>, <span class="number">115</span>, <span class="number">110</span>, <span class="number">102</span>, <span class="number">122</span>, <span class="number">121</span>, <span class="number">100</span>, <span class="number">115</span>, <span class="number">107</span>, <span class="number">22</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="number">22</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># moectf&#123;r3v3rs3_1s_a_long_long_way_to_explore&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="异或">异或</h2>
<ul>
<li>使用IDA反编译附件，然后查看反编译的代码，发现就是简单的异或</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007222336914.png" alt="image-20241007222336914"></p>
<ul>
<li>加密后的数据保存在<code>byte_1400022B8</code>数据段中，使用<code>shift+E</code>提取数组</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007222423810.png" alt="image-20241007222423810"></p>
<ul>
<li>编写解密脚本</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = [ <span class="number">73</span>,  <span class="number">75</span>,  <span class="number">65</span>,  <span class="number">71</span>,  <span class="number">80</span>,  <span class="number">66</span>,  <span class="number">95</span>,  <span class="number">65</span>,  <span class="number">28</span>,  <span class="number">22</span>,</span><br><span class="line">   <span class="number">70</span>,  <span class="number">16</span>,  <span class="number">19</span>,  <span class="number">28</span>,  <span class="number">64</span>,   <span class="number">9</span>,  <span class="number">66</span>,  <span class="number">22</span>,  <span class="number">70</span>,  <span class="number">28</span>,</span><br><span class="line">    <span class="number">9</span>,  <span class="number">16</span>,  <span class="number">16</span>,  <span class="number">66</span>,  <span class="number">29</span>,   <span class="number">9</span>,  <span class="number">70</span>,  <span class="number">21</span>,  <span class="number">20</span>,  <span class="number">20</span>,</span><br><span class="line">    <span class="number">9</span>,  <span class="number">23</span>,  <span class="number">22</span>,  <span class="number">20</span>,  <span class="number">65</span>,  <span class="number">64</span>,  <span class="number">64</span>,  <span class="number">22</span>,  <span class="number">20</span>,  <span class="number">71</span>,</span><br><span class="line">   <span class="number">18</span>,  <span class="number">64</span>,  <span class="number">20</span>,  <span class="number">89</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i^<span class="number">0x24</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># moectf&#123;e82b478d-f2b8-44f9-b100-320edd20c6d0&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="upx">UPX</h2>
<ul>
<li>简单的upx脱壳，直接下载<code>upx</code>脱壳工具，使用指令<code>upx-d</code>脱壳，这里就不演示了</li>
<li>脱壳后使用IDA反编译，反编译完即可看到flag<code>moectf&#123;ec5390dd-f8cf-4b02-bc29-3bb0c5604c29&#125;</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007223024688.png" alt="image-20241007223024688"></p>
<h2 id="upx-revenge">upx-revenge</h2>
<ul>
<li>
<p>魔改的upx脱壳，下载附件后使用010Editor打开，然后将这两个地方分别改为<code>UPX0</code>和<code>UPX1</code></p>
</li>
<li>
<p>然后就可以使用upx脱壳软件<code>upx -d</code>进行自动脱壳了</p>
</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240927202757801.png" alt="image-20240927202757801"></p>
<ul>
<li>脱壳完之后再使用IDA打开，即可看到flag</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240927202824136.png" alt="image-20240927202824136"></p>
<ul>
<li>flag文件<code>moectf&#123;554ea35c-a1bb-4d8f-a323-bd697564bf27&#125;</code></li>
</ul>
<h2 id="rc4">RC4</h2>
<ul>
<li>下载附件后使用IDA打开，然后快速定位到<code>main</code>函数中</li>
<li>发现<code>A71A68ECD82711CC8C9B16155CD2673E82ADCE75D4BC5756C28A52B86BD6CCF8A4BA722FE05715B92411</code>是密文</li>
<li>密钥是<code>RC4_1s_4w3s0m3</code></li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007223630697.png" alt="image-20241007223630697"></p>
<ul>
<li>然后直接在线rc4解密即可，如果是为了学习而做题的话建议使用Python手搓rc4解密脚本，得到flag</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;why_Rc4_haS_The_Rev32sabl3_pr0ceSS&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007223759632.png" alt="image-20241007223759632"></p>
<h2 id="tea">Tea</h2>
<ul>
<li>
<p>在另一篇文章中写过了，这里直接复制粘贴</p>
</li>
<li>
<p>题目附件就只给一个<code>.exe</code>的可执行程序</p>
</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240827142857426.png" alt="image-20240827142857426"></p>
<ul>
<li>先运行一下这个点exe文件。发现程序已经给出后面一部分的flag。然后前面的flag使用未知数表示。该程序让用户输入前三段的flag</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240827142943495.png" alt="image-20240827142943495"></p>
<ul>
<li>然后使用IDA反编译一下，主要加密函数如下</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240827143206799.png" alt="image-20240827143206799"></p>
<ul>
<li>由于该题将库函数的符号表给去掉了，所以先推出一些函数，更方便看代码</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240827144926606.png" alt="image-20240827144926606"></p>
<ul>
<li>对于这一步就是要用户输入正确的部分flag</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240827143256972.png" alt="image-20240827143256972"></p>
<ul>
<li>接下来对下面进行分析，发现有几个变量
<ul>
<li>但是由于scanf后面需要跟一个变量，但是可能由于反编译的问题。</li>
<li>这样v10、v9、v11三个变量可能就是要求输入的明文</li>
<li>所以变量v4、v5是明文</li>
</ul>
</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240827145604067.png" alt="image-20240827145604067"></p>
<ul>
<li>然后查看循环和循环里面的式子
<ul>
<li>可以初步判断v6是循环次数，也就是TEA加密的轮数</li>
<li>而循环内部就是加密的算法</li>
</ul>
</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240827143829326.png" alt="image-20240827143829326"></p>
<ul>
<li>然后最后的是判断flag是否正确</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240827144143170.png" alt="image-20240827144143170"></p>
<ul>
<li>现在目前的重点在于分析该步骤的算法</li>
<li>由最后一步判断得知
<ul>
<li>v4加密后最终的值为<code>676078132</code></li>
<li>v5加密后最终的值为<code>957400408</code></li>
</ul>
</li>
<li>由一开始<code>v3=0</code>然后每次循环都有<code>v3 -= 1640531527</code>,可知最后一次加密时的值为<code>v3 =-1640531527*32</code></li>
<li>然后是最核心的算法，这里还要注意的是可能存在溢出或者回绕，可能需要取模或者进行位运算</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v4 += (v5+v3)^(<span class="number">16</span>*v5 + <span class="number">170260386</span>) ^ ((v5 &gt;&gt; <span class="number">5</span>) + <span class="number">1870148662</span>);</span><br><span class="line">v5 += (v4+v3)^(<span class="number">16</span>*v4 + <span class="number">1634038898</span>) ^ ((v4 &gt;&gt; <span class="number">5</span>) + <span class="number">1634038904</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>由于v5的最后一次加密与运算后的v4有关，所以解密的时候应该是v5先进行运算</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v5 = 957400408</span><br><span class="line">v4 = 676078132</span><br><span class="line">v3  = -1640531527*32</span><br><span class="line"></span><br><span class="line">v5 -=  (v4 + v3) ^ (16 * v4 + 1634038898) ^ ((v4 &gt;&gt; 5) + 1634038904);</span><br><span class="line">v4 -=  (v5 + v3) ^ (16 * v5 + 1702060386) ^ ((v5 &gt;&gt; 5) + 1870148662);</span><br><span class="line">v3 += 1640531527;</span><br></pre></td></tr></table></figure>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240827145956235.png" alt="image-20240827145956235"></p>
<ul>
<li>通过加密可以编写解密脚本，但是由于存在整数溢出和回绕的问题，为了不取模，直接编写C语言脚本进行解密。而不编写Python脚本解密</li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> v4 = <span class="number">676078132</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> v5 = <span class="number">957400408</span>;</span><br><span class="line">	<span class="type">int</span> v3 = <span class="number">-1640531527</span> * <span class="number">32</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,v6);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; <span class="number">32</span>;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		v5 -=  (v4 + v3) ^ (<span class="number">16</span> * v4 + <span class="number">1634038898</span>) ^ ((v4 &gt;&gt; <span class="number">5</span>) + <span class="number">1634038904</span>);</span><br><span class="line">		v4 -=  (v5 + v3) ^ (<span class="number">16</span> * v5 + <span class="number">1702060386</span>) ^ ((v5 &gt;&gt; <span class="number">5</span>) + <span class="number">1870148662</span>);</span><br><span class="line">		v3 += <span class="number">1640531527</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%u   %u&quot;</span>,v4,v5);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Python脚本实现解密是通过位运算</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">v4, v5, rounds</span>):</span><br><span class="line">    delta = <span class="number">1640531527</span></span><br><span class="line">    v3 = (-delta * rounds) &amp; <span class="number">0xFFFFFFFF</span>  <span class="comment"># 初始值，保持32位无符号整数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        <span class="comment"># 计算解密过程中的 v5</span></span><br><span class="line">        v5 = (v5 - ((v4 + v3) ^ (<span class="number">16</span> * v4 + <span class="number">1634038898</span>) ^ ((v4 &gt;&gt; <span class="number">5</span>) + <span class="number">1634038904</span>))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        <span class="comment"># 计算解密过程中的 v4</span></span><br><span class="line">        v4 = (v4 - ((v5 + v3) ^ (<span class="number">16</span> * v5 + <span class="number">1702060386</span>) ^ ((v5 &gt;&gt; <span class="number">5</span>) + <span class="number">1870148662</span>))) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        <span class="comment"># 更新 v3</span></span><br><span class="line">        v3 = (v3 + delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> v4, v5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例使用</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 假设这是加密后的 v4 和 v5 值</span></span><br><span class="line">    v4_encrypted = <span class="number">676078132</span></span><br><span class="line">    v5_encrypted = <span class="number">957400408</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 解密轮数 (与加密时使用的轮数相同)</span></span><br><span class="line">    rounds = <span class="number">32</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 解密</span></span><br><span class="line">    v4_decrypted, v5_decrypted = decrypt(v4_encrypted, v5_encrypted, rounds)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Decrypted v4 = <span class="subst">&#123;v4_decrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Decrypted v5 = <span class="subst">&#123;v5_decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>运行后将结果转换为16进制</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x836153a5</span><br><span class="line">0x8e0049bd</span><br><span class="line">将x那部分替换为836153a5，将y那部分替换为8e00，将z那部分替换为49bd。</span><br><span class="line">moectf&#123;836153a5-8e00-49bd-9c42-caf30620caaf&#125;</span><br></pre></td></tr></table></figure>
<h2 id="d0tn3t">d0tN3t</h2>
<ul>
<li>
<p><code>.dll</code>逆向，使用工具<code>ILSpy</code>逆向，可以直接反编译出内容，然后进行解密，主要问题就出在工具上。IDApro反编译不了<code>.dll</code>文件</p>
</li>
<li>
<p><code>ILSpy</code>下载地址：<a target="_blank" rel="noopener" href="https://github.com/icsharpcode/ILSpy/releases">Releases · icsharpcode/ILSpy (github.com)</a></p>
</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007215824029.png" alt="image-20241007215824029"></p>
<ul>
<li>下载<code>.exe</code>版后解压，进入解压文件，<code>.exe</code>文件，然后点击进去</li>
</ul>
<img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007215923583.png" alt="image-20241007215923583" style="zoom:67%;">
<ul>
<li>在程序内部打开附件就行</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007220006913.png" alt="image-20241007220006913"></p>
<ul>
<li>然后点击进入到这里，就可以看到加密逻辑了</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007220032190.png" alt="image-20241007220032190"></p>
<ul>
<li>加密逻辑如下图</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241007220046748.png" alt="image-20241007220046748"></p>
<ul>
<li>编写脚本一把梭，注意异或<code>i*i</code>有时候会超出255，所以要异或<code>i*i</code>后要与一个<code>0xFF</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">173</span>, <span class="number">146</span>, <span class="number">161</span>, <span class="number">174</span>, <span class="number">132</span>, <span class="number">179</span>, <span class="number">187</span>, <span class="number">234</span>, <span class="number">231</span>, <span class="number">244</span>,<span class="number">177</span>, <span class="number">161</span>, <span class="number">65</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">12</span>, <span class="number">166</span>, <span class="number">247</span>, <span class="number">229</span>, <span class="number">207</span>,<span class="number">125</span>, <span class="number">109</span>, <span class="number">67</span>, <span class="number">180</span>, <span class="number">230</span>, <span class="number">156</span>, <span class="number">125</span>, <span class="number">127</span>, <span class="number">182</span>, <span class="number">236</span>,<span class="number">105</span>, <span class="number">21</span>, <span class="number">215</span>, <span class="number">148</span>, <span class="number">92</span>, <span class="number">18</span>, <span class="number">199</span>, <span class="number">137</span>, <span class="number">124</span>, <span class="number">38</span>,<span class="number">228</span>, <span class="number">55</span>, <span class="number">62</span>, <span class="number">164</span>]</span><br><span class="line">b = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">     b.append(((a[i]^(i*i))&amp;<span class="number">0xff</span>^<span class="number">0x72</span>) - <span class="number">114</span>)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># moectf&#123;7ce581d2-b2ab-4ceb-9bbe-435873083db6&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="dynamic">dynamic</h2>
<ul>
<li>简单的动态调试题目，下载附件，使用IDA打开发现有给数据，但是给的数据是加密过后的数据，不是真正的flag</li>
<li>但是在程序运行的过程中就会调用加密（解密）函数，可以把flag给解密出来，这时就会出现flag，但是flag在栈上</li>
<li>所以我们需要动态调试取查看栈上的内容</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240927194435239.png" alt="image-20240927194435239"></p>
<ul>
<li>先在该处打下断点</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240927194643539.png" alt="image-20240927194643539"></p>
<ul>
<li>然后再按下<code>F9</code>键，选择该选项</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240927194724747.png" alt="image-20240927194724747"></p>
<ul>
<li>选择完后就会进入动态调试的模式，这样就在栈上可以看到flag的16进制模式</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240927194806319.png" alt="image-20240927194806319"></p>
<ul>
<li>将这一串16进制复制下来，丢入在线16进制转字符串</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240927194846304.png" alt="image-20240927194846304"></p>
<ul>
<li>flag其实已经得到了，但是由于是小端序的内存表示，所以我写了个Python脚本，将flag变成正常的flag</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;&#x27;&#x27;317B667463656F6D</span></span><br><span class="line"><span class="string">2D34343963346438</span></span><br><span class="line"><span class="string">3038342D63373439</span></span><br><span class="line"><span class="string">632D363335392D38</span></span><br><span class="line"><span class="string">3362366434336437</span></span><br><span class="line"><span class="string">000000007D373238&#x27;&#x27;&#x27;</span></span><br><span class="line">b = a.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="comment">#print(b[0][-2:16])</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">int</span>(<span class="string">&#x27;38&#x27;</span>,<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(i)-<span class="number">8</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(i[-<span class="number">2</span>-<span class="number">2</span>*j:<span class="number">16</span>-<span class="number">2</span>*j],<span class="number">16</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># moectf&#123;18d4c944-947c-4808-9536-c7d34d6b3827&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="just-run-it">Just-Run-It</h2>
<ul>
<li>下载附件，然后打开，发现给了4个程序，分别是<code>exe</code>、<code>elf</code>、<code>riscv.elf</code>、<code>apk</code>四个文件</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240928120901652.png" alt="image-20240928120901652"></p>
<ul>
<li>先运行一下<code>.exe</code>文件，这样就会给出一个十六进制的字符串</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240928120953384.png" alt="image-20240928120953384"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">6257396c5933526d657a55355a6d45</span><br></pre></td></tr></table></figure>
<ul>
<li>然后转字符串后就变成</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bW9lY3RmezU5ZmE</span><br></pre></td></tr></table></figure>
<ul>
<li>运行<code>apk</code>文件，就直接将该文件拖入雷电模拟器中，然后运行</li>
<li>运行了一下<code>0x3.riscv0x64.elf</code>,运行结果显示一串数组（十进制），将这一串数组转为字符串。</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240928122109231.png" alt="image-20240928122109231"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WU1NzRjZjliOX0=</span><br></pre></td></tr></table></figure>
<h2 id="逆向工程进阶之北">逆向工程进阶之北</h2>
<ul>
<li></li>
</ul>
<h2 id="ezmaze">ezMAZE</h2>
<ul>
<li>此题考点算是比较综合的了，深搜和广搜，位压缩，动态调试</li>
<li>拿到附件后使用IDA进行反编译，反编译之后就会解读代码</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241001092428464.png" alt="image-20241001092428464"></p>
<ul>
<li>然后在检查迷宫路径这边有一个函数，函数名称为<code>sub_7FF70B961190</code>,点击去查看，发现是检查位压缩的0、1位</li>
<li>所以<code> byte_7FF70B965000</code>就是地图了</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241001092509624.png" alt="image-20241001092509624"></p>
<ul>
<li>点击<code> byte_7FF70B965000</code>查看地图，发现是一个位压缩的地图形式，1为墙，0为路</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241001092641526.png" alt="image-20241001092641526"></p>
<ul>
<li>这样我就先在该位置打下断点</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241001092745346.png" alt="image-20241001092745346"></p>
<ul>
<li>进行动态调试，找到迷宫存放的地址，然后将迷宫提取为二进制文件</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241001092812481.png" alt="image-20241001092812481"></p>
<ul>
<li>使用Python将其转换为0、1字符串的迷宫</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">extract_and_convert_to_binary_string</span>(<span class="params">input_file</span>):</span><br><span class="line">    <span class="comment"># 读取二进制文件</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(input_file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将二进制数据转换为01字符串</span></span><br><span class="line">    binary_string = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">format</span>(byte, <span class="string">&#x27;08b&#x27;</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> binary_string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例使用</span></span><br><span class="line">binary_string = extract_and_convert_to_binary_string(<span class="string">&quot;D:\\aaa&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(binary_string)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例使用</span></span><br><span class="line"><span class="comment">#compress_binary_file(&quot;D:\\aaa&quot;, &#x27;D:\\output&#x27;)</span></span><br><span class="line">a = <span class="string">&#x27;1111111111111111111111111111111111111111111111111111111111111111111111111111111110111111111111111110101010101000101001001001001001001111111111111111111111111111100000000000000000111101000101001001010010010010101110000000000000000000111111111111111111111111101110111101101000011111001010010111101111111111111111101111111111000000000000000011101111011010110111000000000000000011000000000000000011111111110111111111111111111011110110101101110111111111111111110111111111111111111111111100000000000000001110111101101011011100000000000000001100000000000000001111111111111111111111111011100001000010000111111111111111111011111111111111111011111111110000000000000000111111111111111111110000000000000000110000000000000000111111111101111111111111111110000111110000111101111111111111111101111111111111111111111111000000000000000011101111111101101111000000000000000011000000000011111000011111111111111111111110111000011111000111111111111111111110111111111110111110110111111111111111111111101111110111110110111101001010010111101111111111101111101101111111111111111111111001100001111100001111111111111111111011111111111011111011011111100000000000000001001111111111111111100000000000000000100000000000111110110111111011111101111111011011111111111111111011111111111111111011111111111111101101111110010110101010110110000000000000000010000000000000000010000000011111111011011111100101101010101101111111111111111110111111111111111110111111110111111110110111111001010101001011011100000000000000001100000000000000001100000001111111101101111110010101010010110111011111111111111111011111111111111111011111111111111011011111101010101001011001110000000000000000110000000000000000110000000000000110110111111001001001010111011111111111111111101111111111111111101111111111111101101101111110010010100101000111000000000000000011000000000000000011000000000000011011011111100010100100101101110111111111111111110111111111111111110111111111111110110111111010111011010101011100000000000000001100000000000000001100000000000011101101111110010101010010101111111111111111111011111111111111111011111111111110111011011111100010100100101001001010010100001110110000000000000000111111111111101110110111111011111101111111011111111111111111100001111111111111111111111111111011101101111111111111111111111111010101011101011111111111111111111111111111111110111011011111100000000000000000111000110101010011010100101010100110000000000000001110110111111011111111111111101111010101000100101111111111111111101111111111111111101101111110100000000000000011111111111111111111000000000000000011000000000000000011011111101011111111111111111111110000000111110111111111111111110111111111111111110111111010000000000000001111111101111101111100000000000000001100000000000000001101111110111111111111111011111111011111011111111111111111111011111111111111111011011111101000000000000000111111110111110111110000000000000000110000000000000000110111111010111111111111111111111101111101111101111111111111111101111111111111111101111110100000000000000011111111011111011111000000000000000011000000000000000011011111101111111111111110111111110111110111111111111111111110111111111111111110110111111011110010001011101111111101111101111111111111111111101111111111111111101101111110101001001001001001111111011111011111111111111111111011111111111111111001011111101100101010000111001111110111110111100000000000000000100000000000000011010111111011000101010010111011111101111111111011111111111111111011111111111110110101111110101010001000101110000000000000000010000000000000000010000000011111100001011111101111010010100111111111111111111110111111111111111110111111110111111111110111111011001001010010101100000000000000001100000000000000001100000001111111111101111110110100100101001011011111111111111111011111111111111111011111111111111111011111101100100100101010110000000000000000110000000000000000110000000000000000110111111011001001010010010111111111111111101111111111111111101111111111111111101101111110110010010101001101000000000000000011000000000000000011000000000000000011011111101100100101001001010111111111111111110111111111111111110111111111111111110111111011001010010001001100000000000000000000000000000000111100000000000000001101111110110000100010010111111111111111111111111111111111111000011111111111111011011111101111001001000100010000111111111110000000000000000000111111111111111110110111111000000000000000000000000000000000001101111111111111111010010100100010100101111111111111111111111111111111111111111111111111111111111111111111111111111111111111&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(a)//<span class="number">80</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">56</span>-<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(a[<span class="number">0</span>+i*<span class="number">80</span>:<span class="number">80</span>+i*<span class="number">80</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>然后以迷宫56行，80列的形式输出</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241001093024171.png" alt="image-20241001093024171"></p>
<ul>
<li>起点坐标为<code>(2,2)</code>，真实起点应该为<code>(1,1)</code>,终点坐标为<code>(55,75)</code>,真实的终点应该为<code>(54,74)</code>，知道起点和终点，直接编写深度搜索和广度搜索算法寻找迷宫路径</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_valid_move</span>(<span class="params">maze, visited, row, col</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">0</span> &lt;= row &lt; <span class="built_in">len</span>(maze)) <span class="keyword">and</span> (<span class="number">0</span> &lt;= col &lt; <span class="built_in">len</span>(maze[<span class="number">0</span>])) <span class="keyword">and</span> (maze[row][col] == <span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> <span class="keyword">not</span> visited[row][col])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">iterative_dfs</span>(<span class="params">maze, start_row, start_col</span>):</span><br><span class="line">    stack = [(start_row, start_col, <span class="string">&#x27;&#x27;</span>)]  <span class="comment"># (行, 列, 路径)</span></span><br><span class="line">    visited = [[<span class="literal">False</span>] * <span class="built_in">len</span>(maze[<span class="number">0</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(maze))]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> stack:</span><br><span class="line">        row, col, path = stack.pop()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;DFS访问: 行=<span class="subst">&#123;row&#125;</span>, 列=<span class="subst">&#123;col&#125;</span>, 路径=<span class="subst">&#123;path&#125;</span>&quot;</span>)  <span class="comment"># 打印当前访问的位置和路径</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (row, col) == (<span class="number">54</span>, <span class="number">74</span>):  <span class="comment"># 到达终点</span></span><br><span class="line">            <span class="keyword">return</span> path</span><br><span class="line"></span><br><span class="line">        visited[row][col] = <span class="literal">True</span></span><br><span class="line">        directions = [(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;d&#x27;</span>), (<span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;s&#x27;</span>), (<span class="number">0</span>, -<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>), (-<span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;w&#x27;</span>)]  <span class="comment"># 右，下，左，上</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> dr, dc, direction <span class="keyword">in</span> directions:</span><br><span class="line">            new_row, new_col = row + dr, col + dc</span><br><span class="line">            <span class="keyword">if</span> is_valid_move(maze, visited, new_row, new_col):</span><br><span class="line">                stack.append((new_row, new_col, path + direction))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bfs</span>(<span class="params">maze</span>):</span><br><span class="line">    rows, cols = <span class="built_in">len</span>(maze), <span class="built_in">len</span>(maze[<span class="number">0</span>])</span><br><span class="line">    queue = deque([(<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;&#x27;</span>)])  <span class="comment"># 起点 (1, 1)</span></span><br><span class="line">    visited = [[<span class="literal">False</span>] * cols <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rows)]</span><br><span class="line">    visited[<span class="number">1</span>][<span class="number">1</span>] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    directions = [(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;d&#x27;</span>), (<span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;s&#x27;</span>), (<span class="number">0</span>, -<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>), (-<span class="number">1</span>, <span class="number">0</span>, <span class="string">&#x27;w&#x27;</span>)]  <span class="comment"># 右，下，左，上</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> queue:</span><br><span class="line">        row, col, path = queue.popleft()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;BFS访问: 行=<span class="subst">&#123;row&#125;</span>, 列=<span class="subst">&#123;col&#125;</span>, 路径=<span class="subst">&#123;path&#125;</span>&quot;</span>)  <span class="comment"># 打印当前访问的位置和路径</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (row, col) == (<span class="number">54</span>, <span class="number">74</span>):  <span class="comment"># 到达终点</span></span><br><span class="line">            <span class="keyword">return</span> path</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> dr, dc, direction <span class="keyword">in</span> directions:</span><br><span class="line">            new_row, new_col = row + dr, col + dc</span><br><span class="line">            <span class="keyword">if</span> is_valid_move(maze, visited, new_row, new_col):</span><br><span class="line">                visited[new_row][new_col] = <span class="literal">True</span></span><br><span class="line">                queue.append((new_row, new_col, path + direction))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="comment"># 示例迷宫字符串</span></span><br><span class="line">maze_str = <span class="string">&quot;&quot;&quot;\</span></span><br><span class="line"><span class="string">11111111111111111111111111111111111111111111111111111111111111111111111111111111</span></span><br><span class="line"><span class="string">10111111111111111110101010101000101001001001001001001111111111111111111111111111</span></span><br><span class="line"><span class="string">10000000000000000011110100010100100101001001001010111000000000000000000011111111</span></span><br><span class="line"><span class="string">11111111111111111011101111011010000111110010100101111011111111111111111011111111</span></span><br><span class="line"><span class="string">11000000000000000011101111011010110111000000000000000011000000000000000011111111</span></span><br><span class="line"><span class="string">11011111111111111111101111011010110111011111111111111111011111111111111111111111</span></span><br><span class="line"><span class="string">11000000000000000011101111011010110111000000000000000011000000000000000011111111</span></span><br><span class="line"><span class="string">11111111111111111011100001000010000111111111111111111011111111111111111011111111</span></span><br><span class="line"><span class="string">11000000000000000011111111111111111111000000000000000011000000000000000011111111</span></span><br><span class="line"><span class="string">11011111111111111111100001111100001111011111111111111111011111111111111111111111</span></span><br><span class="line"><span class="string">11000000000000000011101111111101101111000000000000000011000000000011111000011111</span></span><br><span class="line"><span class="string">11111111111111111011100001111100011111111111111111111011111111111011111011011111</span></span><br><span class="line"><span class="string">11111111111111111011111101111101101111010010100101111011111111111011111011011111</span></span><br><span class="line"><span class="string">11111111111111111001100001111100001111111111111111111011111111111011111011011111</span></span><br><span class="line"><span class="string">10000000000000000100111111111111111110000000000000000010000000000011111011011111</span></span><br><span class="line"><span class="string">10111111011111110110111111111111111110111111111111111110111111111111111011011111</span></span><br><span class="line"><span class="string">10010110101010110110000000000000000010000000000000000010000000011111111011011111</span></span><br><span class="line"><span class="string">10010110101010110111111111111111111011111111111111111011111111011111111011011111</span></span><br><span class="line"><span class="string">10010101010010110111000000000000000011000000000000000011000000011111111011011111</span></span><br><span class="line"><span class="string">10010101010010110111011111111111111111011111111111111111011111111111111011011111</span></span><br><span class="line"><span class="string">10101010100101100111000000000000000011000000000000000011000000000000011011011111</span></span><br><span class="line"><span class="string">10010010010101110111111111111111111011111111111111111011111111111111011011011111</span></span><br><span class="line"><span class="string">10010010100101000111000000000000000011000000000000000011000000000000011011011111</span></span><br><span class="line"><span class="string">10001010010010110111011111111111111111011111111111111111011111111111111011011111</span></span><br><span class="line"><span class="string">10101110110101010111000000000000000011000000000000000011000000000000111011011111</span></span><br><span class="line"><span class="string">10010101010010101111111111111111111011111111111111111011111111111110111011011111</span></span><br><span class="line"><span class="string">10001010010010100100101001010000111011000000000000000011111111111110111011011111</span></span><br><span class="line"><span class="string">10111111011111110111111111111111111000011111111111111111111111111110111011011111</span></span><br><span class="line"><span class="string">11111111111111111111010101011101011111111111111111111111111111111110111011011111</span></span><br><span class="line"><span class="string">10000000000000000011100011010101001101010010101010011000000000000000111011011111</span></span><br><span class="line"><span class="string">10111111111111111011110101010001001011111111111111111011111111111111111011011111</span></span><br><span class="line"><span class="string">10100000000000000011111111111111111111000000000000000011000000000000000011011111</span></span><br><span class="line"><span class="string">10101111111111111111111111000000011111011111111111111111011111111111111111011111</span></span><br><span class="line"><span class="string">10100000000000000011111111011111011111000000000000000011000000000000000011011111</span></span><br><span class="line"><span class="string">10111111111111111011111111011111011111111111111111111011111111111111111011011111</span></span><br><span class="line"><span class="string">10100000000000000011111111011111011111000000000000000011000000000000000011011111</span></span><br><span class="line"><span class="string">10101111111111111111111111011111011111011111111111111111011111111111111111011111</span></span><br><span class="line"><span class="string">10100000000000000011111111011111011111000000000000000011000000000000000011011111</span></span><br><span class="line"><span class="string">10111111111111111011111111011111011111111111111111111011111111111111111011011111</span></span><br><span class="line"><span class="string">10111100100010111011111111011111011111111111111111111011111111111111111011011111</span></span><br><span class="line"><span class="string">10101001001001001001111111011111011111111111111111111011111111111111111001011111</span></span><br><span class="line"><span class="string">10110010101000011100111111011111011110000000000000000010000000000000001101011111</span></span><br><span class="line"><span class="string">10110001010100101110111111011111111110111111111111111110111111111111101101011111</span></span><br><span class="line"><span class="string">10101010001000101110000000000000000010000000000000000010000000011111100001011111</span></span><br><span class="line"><span class="string">10111101001010011111111111111111111011111111111111111011111111011111111111011111</span></span><br><span class="line"><span class="string">10110010010100101011000000000000000011000000000000000011000000011111111111011111</span></span><br><span class="line"><span class="string">10110100100101001011011111111111111111011111111111111111011111111111111111011111</span></span><br><span class="line"><span class="string">10110010010010101011000000000000000011000000000000000011000000000000000011011111</span></span><br><span class="line"><span class="string">10110010010100100101111111111111111011111111111111111011111111111111111011011111</span></span><br><span class="line"><span class="string">10110010010101001101000000000000000011000000000000000011000000000000000011011111</span></span><br><span class="line"><span class="string">10110010010100100101011111111111111111011111111111111111011111111111111111011111</span></span><br><span class="line"><span class="string">10110010100100010011000000000000000000000000000000001111000000000000000011011111</span></span><br><span class="line"><span class="string">10110000100010010111111111111111111111111111111111111000011111111111111011011111</span></span><br><span class="line"><span class="string">10111100100100010001000011111111111000000000000000000011111111111111111011011111</span></span><br><span class="line"><span class="string">10000000000000000000000000000000000011011111111111111110100101001000101001011111</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">maze = [<span class="built_in">list</span>(row) <span class="keyword">for</span> row <span class="keyword">in</span> maze_str.strip().split(<span class="string">&#x27;\n&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用迭代DFS和BFS</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;DFS路径:&quot;</span>)</span><br><span class="line">dfs_path = iterative_dfs(maze, <span class="number">1</span>, <span class="number">1</span>)  <span class="comment"># 起点为 (1, 1)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;BFS路径:&quot;</span>)</span><br><span class="line">bfs_path = bfs(maze)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;DFS最终路径: <span class="subst">&#123;dfs_path&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;BFS最终路径: <span class="subst">&#123;bfs_path&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>得到最终路径</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DFS最终路径: sddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdsdssddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdddwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwddddddddddddddddwwwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwddwdsddddwdsdddddddwwddddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddssssaaaaaaaaaassdddddddssaaaaaassddddddddddddssaaaaaaaaaaaassdddddddddddsssssaaaaaaaaaaaaaassaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssssaaaaaaaaaaaaaaaassddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassaaaaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwawawwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaaaasssssssssssssssssssssssssdddddwwdssddwwwdsssddwdwwdsssddwdsdddwdsdwdsddddddddddddwddddddddddddddddddwdddwwwdddddddddddddddwwaaaaaaaaaaaaaaawwddddddwwaaaaaaawwddddddddddddddssdddwwwawwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwwwwwwwwwwwwwwwwwwwwdddssssssssssssssssssssssssssssssssssssssssssss</span><br><span class="line">BFS最终路径: sddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdsdssddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddsssdddwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwddddddddddddddddwwwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwddddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddssssaaaaaaaaaassdddddddssaaaaaassddddddddddddssaaaaaaaaaaaassdddddddddddsssssaaaaaaaaaaaaaassaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssssaaaaaaaaaaaaaaaassddddddddddddddddssaaaaaaaaaaaaaaassdddddddddddddddssaaaaaaaaaaaaaaassaaaaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaaawwawawwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaawwddddddddddddddwwaaaaaaaaaaaaaaaasssssssssssssssssssssssssddddddddddddddddddddddddddddddddddwddddddddddddddddddwdddwwwdddddddddddddddwwaaaaaaaaaaaaaaawwddddddwwaaaaaaawwddddddddddddddssdddwwwawwwaaaaaaaaaaaaaaawwdddddddddddddddwwaaaaaaaaaaaaaaawwdddddddddddddddwwwwwwwwwwwwwwwwwwwwwdddssssssssssssssssssssssssssssssssssssssssssss</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>最后输入最终路径，得到flag，这里只有输入<code>BFS最终路径</code>才能得到flag</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20241001094650144.png" alt="image-20241001094650144"></p>
<p><code>moectf&#123;the_18446744024826406994_amazing_maze!!&#125;</code></p>
<h1 id="pwn">PWN</h1>
<h2 id="二进制漏洞审计入门指北">二进制漏洞审计入门指北</h2>
<ul>
<li>题目给了个入门指北，最好还是看一下</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240904113011026.png" alt="image-20240904113011026"></p>
<ul>
<li>签到题，学会<code>nc</code>直接就送flag</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240904112505198.png" alt="image-20240904112505198"></p>
<p>flag：<code>moectf&#123;Welcome_to_the_journey_of_Pwn&#125;</code></p>
<h2 id="notenoughtime">NotEnoughTime</h2>
<ul>
<li>题目：说是检测数学能力，其实是练习接收与发送，与靶机交互。</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240904114303972.png" alt="image-20240904114303972"></p>
<ul>
<li>这题会发送一些数学四则运算的题目，算式均为 C 语言表达式，整数除法。还有时间限制</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240904114553199.png" alt="image-20240904114553199"></p>
<ul>
<li>这种情况就需要使用Python脚本实现交互
<ul>
<li>先将第一个和第二个固定的算式单独做一个接收和发送</li>
<li>然后再接收一行字符串</li>
<li>接下来使用Python的<code>eval()</code>函数，<code>eval()</code>函数执行其传递的参数内容，并返回结果</li>
<li>对接收的算式先进行处理，比如将<code>换行符</code>去掉，将最后接收到的<code>=</code>号去掉</li>
<li>最后使用<code>eval()</code>函数进行计算</li>
<li>再将计算结果发送出去，进而实现自动化计算脚本</li>
</ul>
</li>
<li>exp如下：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">p = remote(<span class="string">&quot;172.25.144.1&quot;</span>,<span class="number">50357</span>)</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;1 + 1 = &#x27;</span>,<span class="built_in">str</span>(<span class="number">2</span>).encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">p.sendlineafter(<span class="string">b&#x27;4 / 3 - 1 = &#x27;</span>,<span class="built_in">str</span>(<span class="number">0</span>).encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;OK, then some tough ones. Be WELL PREPARED!&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    a = p.recvuntil(<span class="string">b&#x27;=&#x27;</span>)</span><br><span class="line">    a = a.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    b = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;\n&#x27;</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;=&#x27;</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">            b += <span class="string">&#x27;//&#x27;</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        b += i</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;b = &#x27;</span>,b)</span><br><span class="line">    c = <span class="built_in">eval</span>(b)</span><br><span class="line">    <span class="built_in">print</span>(c)</span><br><span class="line">    p.send(<span class="built_in">str</span>(<span class="built_in">int</span>(c)).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    p.sendline(<span class="string">b&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment"># 最后得到flag	</span></span><br><span class="line"><span class="comment"># moectf&#123;ar1tHMETiC-IS_NOT_M@th3mATIcs1d259bb&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="no_more_gets">no_more_gets</h2>
<ul>
<li>题目：</li>
</ul>
<p><img src="/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/image-20240904120653431.png" alt="image-20240904120653431"></p>
<h1 id="ai">AI</h1>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://iyheart.github.io">iyheart</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://iyheart.github.io/2024/10/03/CTFblog/write%20up%E7%B3%BB%E5%88%97blog/2024%E5%B9%B4/moeCTF-wp/">http://iyheart.github.io/2024/10/03/CTFblog/write up系列blog/2024年/moeCTF-wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://iyheart.github.io" target="_blank">iyheart的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover101.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/ea2e5fb6fbb4c236fbabd387ef83339.jpg" target="_blank"><img class="post-qr-code-img" src="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/ea2e5fb6fbb4c236fbabd387ef83339.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/10/09/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%BA%95%E5%B1%82blog/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="计算机组成原理"><img class="cover" src="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover24.jpg" onerror="onerror=null;src='https://raw.githubusercontent.com/iyheart/tuchuang/main/img/f3c2605738aabdeedbc687356fa0e4e5.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">计算机组成原理</div></div></a></div><div class="next-post pull-right"><a href="/2024/10/01/AI/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A01/" title="机器学习1"><img class="cover" src="https://raw.githubusercontent.com/iyheart/tuchuang/main/img/cover105.png" onerror="onerror=null;src='https://raw.githubusercontent.com/iyheart/tuchuang/main/img/f3c2605738aabdeedbc687356fa0e4e5.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">机器学习1</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="http://pic.5tu.cn/uploads/allimg/1910/pic_5tu_big_2019010211653346247.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">iyheart</div><div class="author-info__description">悟已往之不谏，知来者之可追</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">131</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">40</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#signin"><span class="toc-number">1.1.</span> <span class="toc-text">signin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez_forensics"><span class="toc-number">1.2.</span> <span class="toc-text">ez_Forensics</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">2.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E4%B8%8E%E5%AE%A1%E8%AE%A1%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">2.1.</span> <span class="toc-text">Web渗透测试与审计入门指北</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%97%E6%8B%89%E6%A0%BC%E4%B9%8B%E5%9C%B0%E7%9A%84%E5%85%A5%E5%8F%A3"><span class="toc-number">2.2.</span> <span class="toc-text">弗拉格之地的入口</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%97%E6%8B%89%E6%A0%BC%E4%B9%8B%E5%9C%B0%E7%9A%84%E6%8C%91%E6%88%98"><span class="toc-number">2.3.</span> <span class="toc-text">弗拉格之地的挑战</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9E%AB%E5%88%80%E4%B9%8B%E8%B7%AF01-moectf%E5%90%AF%E5%8A%A8"><span class="toc-number">2.4.</span> <span class="toc-text">垫刀之路01: MoeCTF？启动！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez_http"><span class="toc-number">2.5.</span> <span class="toc-text">ez_http</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">3.</span> <span class="toc-text">CRYPTO</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">3.1.</span> <span class="toc-text">现代密码学入门指北</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#signin"><span class="toc-number">3.2.</span> <span class="toc-text">Signin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez_hash"><span class="toc-number">3.3.</span> <span class="toc-text">ez_hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#big-and-small"><span class="toc-number">3.4.</span> <span class="toc-text">Big and small</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#baby_equation"><span class="toc-number">3.5.</span> <span class="toc-text">baby_equation</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#re"><span class="toc-number">4.</span> <span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">4.1.</span> <span class="toc-text">逆向工程入门指北</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E6%88%96"><span class="toc-number">4.2.</span> <span class="toc-text">异或</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#upx"><span class="toc-number">4.3.</span> <span class="toc-text">UPX</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#upx-revenge"><span class="toc-number">4.4.</span> <span class="toc-text">upx-revenge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rc4"><span class="toc-number">4.5.</span> <span class="toc-text">RC4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tea"><span class="toc-number">4.6.</span> <span class="toc-text">Tea</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#d0tn3t"><span class="toc-number">4.7.</span> <span class="toc-text">d0tN3t</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dynamic"><span class="toc-number">4.8.</span> <span class="toc-text">dynamic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#just-run-it"><span class="toc-number">4.9.</span> <span class="toc-text">Just-Run-It</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E8%BF%9B%E9%98%B6%E4%B9%8B%E5%8C%97"><span class="toc-number">4.10.</span> <span class="toc-text">逆向工程进阶之北</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezmaze"><span class="toc-number">4.11.</span> <span class="toc-text">ezMAZE</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pwn"><span class="toc-number">5.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%BC%8F%E6%B4%9E%E5%AE%A1%E8%AE%A1%E5%85%A5%E9%97%A8%E6%8C%87%E5%8C%97"><span class="toc-number">5.1.</span> <span class="toc-text">二进制漏洞审计入门指北</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#notenoughtime"><span class="toc-number">5.2.</span> <span class="toc-text">NotEnoughTime</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#no_more_gets"><span class="toc-number">5.3.</span> <span class="toc-text">no_more_gets</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ai"><span class="toc-number">6.</span> <span class="toc-text">AI</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/25/CTFblog/PWN%E7%B3%BB%E5%88%97blog/Chrome_v8_pwn/Chrome-v8-%E5%85%A5%E9%97%A8/" title="Chrome-v8-入门">Chrome-v8-入门</a><time datetime="2025-02-25T12:15:28.000Z" title="发表于 2025-02-25 20:15:28">2025-02-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/24/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%B3%BB%E5%88%97blog/Linux%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B/Linux%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A8%8B1/" title="Linux系统编程1">Linux系统编程1</a><time datetime="2025-02-23T17:03:25.000Z" title="发表于 2025-02-24 01:03:25">2025-02-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/23/ORW%E7%9B%B8%E5%85%B3%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8/" title="ORW相关系统调用">ORW相关系统调用</a><time datetime="2025-02-23T15:19:56.000Z" title="发表于 2025-02-23 23:19:56">2025-02-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/22/CTFblog/PWN%E7%B3%BB%E5%88%97blog/VM_pwn/vm-pwn%E5%85%A5%E9%97%A8/" title="vm_pwn入门">vm_pwn入门</a><time datetime="2025-02-22T15:05:07.000Z" title="发表于 2025-02-22 23:05:07">2025-02-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/02/18/CTFblog/PWN%E7%B3%BB%E5%88%97blog/PWN%E5%88%B7%E9%A2%98/" title="PWN刷题">PWN刷题</a><time datetime="2025-02-17T16:01:34.000Z" title="发表于 2025-02-18 00:01:34">2025-02-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By iyheart</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat-btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script src="/zhheo/random.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>